/*! For license information please see main.js.LICENSE.txt */
(()=>{var t,e={70:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(540),r=6378137;function o(t){var e=0;if(t&&t.length>0){e+=Math.abs(s(t[0]));for(var i=1;i<t.length;i++)e-=Math.abs(s(t[i]))}return e}function s(t){var e,i,n,o,s,l,u=0,h=t.length;if(h>2){for(l=0;l<h;l++)l===h-2?(n=h-2,o=h-1,s=0):l===h-1?(n=h-1,o=0,s=1):(n=l,o=l+1,s=l+2),e=t[n],i=t[o],u+=(a(t[s][0])-a(e[0]))*Math.sin(a(i[1]));u=u*r*r/2}return u}function a(t){return t*Math.PI/180}e.default=function(t){return n.geomReduce(t,(function(t,e){return t+function(t){var e,i=0;switch(t.type){case"Polygon":return o(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)i+=o(t.coordinates[e]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}),0)}},705:(t,e,i)=>{"use strict";var n=i(540);function r(t){var e=[1/0,1/0,-1/0,-1/0];return n.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}r.default=r,e.Z=r},977:(t,e,i)=>{"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var r=n(i(209)),o=n(i(70)),s=i(102),a=i(611),l=i(540);function u(t){switch(t.type){case"Polygon":return o(t)>1?t:null;case"MultiPolygon":var e=[];if(l.flattenEach(t,(function(t){o(t)>1&&e.push(t.geometry.coordinates)})),e.length)return{type:"MultiPolygon",coordinates:e}}}t.exports=function(t,e){var i=a.getGeom(t),n=a.getGeom(e),o=t.properties||{};if(i=u(i),n=u(n),!i)return null;if(!n)return s.feature(i,o);var l=r.diff(i.coordinates,n.coordinates);return 0===l.length?null:1===l.length?s.polygon(l[0],o):s.multiPolygon(l,o)}},102:(t,e)=>{"use strict";function i(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function n(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!f(t[0])||!f(t[1]))throw new Error("coordinates must contain numbers");return i({type:"Point",coordinates:t},e,n)}function r(t,e,n){void 0===n&&(n={});for(var r=0,o=t;r<o.length;r++){var s=o[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return i({type:"Polygon",coordinates:t},e,n)}function o(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return i({type:"LineString",coordinates:t},e,n)}function s(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function a(t,e,n){return void 0===n&&(n={}),i({type:"MultiLineString",coordinates:t},e,n)}function l(t,e,n){return void 0===n&&(n={}),i({type:"MultiPoint",coordinates:t},e,n)}function u(t,e,n){return void 0===n&&(n={}),i({type:"MultiPolygon",coordinates:t},e,n)}function h(t,i){void 0===i&&(i="kilometers");var n=e.factors[i];if(!n)throw new Error(i+" units is invalid");return t*n}function c(t,i){void 0===i&&(i="kilometers");var n=e.factors[i];if(!n)throw new Error(i+" units is invalid");return t/n}function d(t){return 180*(t%(2*Math.PI))/Math.PI}function f(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:e.earthRadius/1.0936},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1/1.0936},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=i,e.geometry=function(t,e,i){switch(void 0===i&&(i={}),t){case"Point":return n(e).geometry;case"LineString":return o(e).geometry;case"Polygon":return r(e).geometry;case"MultiPoint":return l(e).geometry;case"MultiLineString":return a(e).geometry;case"MultiPolygon":return u(e).geometry;default:throw new Error(t+" is invalid")}},e.point=n,e.points=function(t,e,i){return void 0===i&&(i={}),s(t.map((function(t){return n(t,e)})),i)},e.polygon=r,e.polygons=function(t,e,i){return void 0===i&&(i={}),s(t.map((function(t){return r(t,e)})),i)},e.lineString=o,e.lineStrings=function(t,e,i){return void 0===i&&(i={}),s(t.map((function(t){return o(t,e)})),i)},e.featureCollection=s,e.multiLineString=a,e.multiPoint=l,e.multiPolygon=u,e.geometryCollection=function(t,e,n){return void 0===n&&(n={}),i({type:"GeometryCollection",geometries:t},e,n)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var i=Math.pow(10,e||0);return Math.round(t*i)/i},e.radiansToLength=h,e.lengthToRadians=c,e.lengthToDegrees=function(t,e){return d(c(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=d,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,i){if(void 0===e&&(e="kilometers"),void 0===i&&(i="kilometers"),!(t>=0))throw new Error("length must be a positive number");return h(c(t,e),i)},e.convertArea=function(t,i,n){if(void 0===i&&(i="meters"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var r=e.areaFactors[i];if(!r)throw new Error("invalid original units");var o=e.areaFactors[n];if(!o)throw new Error("invalid final units");return t/r*o},e.isNumber=f,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!f(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},611:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(102);e.getCoord=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")},e.getCoords=function(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},e.containsNumber=function t(e){if(e.length>1&&n.isNumber(e[0])&&n.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},e.geojsonType=function(t,e,i){if(!e||!i)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+i+": must be a "+e+", given "+t.type)},e.featureOf=function(t,e,i){if(!t)throw new Error("No feature passed");if(!i)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+i+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+i+": must be a "+e+", given "+t.geometry.type)},e.collectionOf=function(t,e,i){if(!t)throw new Error("No featureCollection passed");if(!i)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+i+", FeatureCollection required");for(var n=0,r=t.features;n<r.length;n++){var o=r[n];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+i+", Feature with geometry required");if(!o.geometry||o.geometry.type!==e)throw new Error("Invalid input to "+i+": must be a "+e+", given "+o.geometry.type)}},e.getGeom=function(t){return"Feature"===t.type?t.geometry:t},e.getType=function(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}},540:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(102);function r(t,e,i){if(null!==t)for(var n,o,s,a,l,u,h,c,d=0,f=0,p=t.type,g="FeatureCollection"===p,m="Feature"===p,v=g?t.features.length:1,y=0;y<v;y++){l=(c=!!(h=g?t.features[y].geometry:m?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1;for(var _=0;_<l;_++){var b=0,w=0;if(null!==(a=c?h.geometries[_]:h)){u=a.coordinates;var x=a.type;switch(d=!i||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===e(u,f,y,b,w))return!1;f++,b++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(!1===e(u[n],f,y,b,w))return!1;f++,"MultiPoint"===x&&b++}"LineString"===x&&b++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(o=0;o<u[n].length-d;o++){if(!1===e(u[n][o],f,y,b,w))return!1;f++}"MultiLineString"===x&&b++,"Polygon"===x&&w++}"Polygon"===x&&b++;break;case"MultiPolygon":for(n=0;n<u.length;n++){for(w=0,o=0;o<u[n].length;o++){for(s=0;s<u[n][o].length-d;s++){if(!1===e(u[n][o][s],f,y,b,w))return!1;f++}w++}b++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===r(a.geometries[n],e,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e){var i;switch(t.type){case"FeatureCollection":for(i=0;i<t.features.length&&!1!==e(t.features[i].properties,i);i++);break;case"Feature":e(t.properties,0)}}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function a(t,e){var i,n,r,o,s,a,l,u,h,c,d=0,f="FeatureCollection"===t.type,p="Feature"===t.type,g=f?t.features.length:1;for(i=0;i<g;i++){for(a=f?t.features[i].geometry:p?t.geometry:t,u=f?t.features[i].properties:p?t.properties:{},h=f?t.features[i].bbox:p?t.bbox:void 0,c=f?t.features[i].id:p?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=l?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,d,u,h,c))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===e(o.geometries[n],d,u,h,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,u,h,c))return!1;d++}}function l(t,e){a(t,(function(t,i,r,o,s){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(n.feature(t,r,{bbox:o,id:s}),i,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<t.coordinates.length;u++){var h={type:a,coordinates:t.coordinates[u]};if(!1===e(n.feature(h,r),i,u))return!1}}))}function u(t,e){l(t,(function(t,i,o){var s=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var l,u=0,h=0,c=0;return!1!==r(t,(function(r,a,d,f,p){if(void 0===l||i>u||f>h||p>c)return l=r,u=i,h=f,c=p,void(s=0);var g=n.lineString([l,r],t.properties);if(!1===e(g,i,o,p,s))return!1;s++,l=r}))&&void 0}}}))}function h(t,e){if(!t)throw new Error("geojson is required");l(t,(function(t,i,r){if(null!==t.geometry){var o=t.geometry.type,s=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,i,r,0,0))return!1;break;case"Polygon":for(var a=0;a<s.length;a++)if(!1===e(n.lineString(s[a],t.properties),i,r,a))return!1}}}))}e.coordEach=r,e.coordReduce=function(t,e,i,n){var o=i;return r(t,(function(t,n,r,s,a){o=0===n&&void 0===i?t:e(o,t,n,r,s,a)}),n),o},e.propEach=o,e.propReduce=function(t,e,i){var n=i;return o(t,(function(t,r){n=0===r&&void 0===i?t:e(n,t,r)})),n},e.featureEach=s,e.featureReduce=function(t,e,i){var n=i;return s(t,(function(t,r){n=0===r&&void 0===i?t:e(n,t,r)})),n},e.coordAll=function(t){var e=[];return r(t,(function(t){e.push(t)})),e},e.geomEach=a,e.geomReduce=function(t,e,i){var n=i;return a(t,(function(t,r,o,s,a){n=0===r&&void 0===i?t:e(n,t,r,o,s,a)})),n},e.flattenEach=l,e.flattenReduce=function(t,e,i){var n=i;return l(t,(function(t,r,o){n=0===r&&0===o&&void 0===i?t:e(n,t,r,o)})),n},e.segmentEach=u,e.segmentReduce=function(t,e,i){var n=i,r=!1;return u(t,(function(t,o,s,a,l){n=!1===r&&void 0===i?t:e(n,t,o,s,a,l),r=!0})),n},e.lineEach=h,e.lineReduce=function(t,e,i){var n=i;return h(t,(function(t,r,o,s){n=0===r&&void 0===i?t:e(n,t,r,o,s)})),n},e.findSegment=function(t,e){if(e=e||{},!n.isObject(e))throw new Error("options is invalid");var i,r=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.segmentIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),l=l||t.features[r].properties,i=t.features[r].geometry;break;case"Feature":l=l||t.properties,i=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=t;break;default:throw new Error("geojson is invalid")}if(null===i)return null;var u=i.coordinates;switch(i.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=u.length+a-1),n.lineString([u[a],u[a+1]],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a-1),n.lineString([u[s][a],u[s][a+1]],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a-1),n.lineString([u[o][a],u[o][a+1]],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a-1),n.lineString([u[o][s][a],u[o][s][a+1]],l,e)}throw new Error("geojson is invalid")},e.findPoint=function(t,e){if(e=e||{},!n.isObject(e))throw new Error("options is invalid");var i,r=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.coordIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),l=l||t.features[r].properties,i=t.features[r].geometry;break;case"Feature":l=l||t.properties,i=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=t;break;default:throw new Error("geojson is invalid")}if(null===i)return null;var u=i.coordinates;switch(i.type){case"Point":return n.point(u,l,e);case"MultiPoint":return o<0&&(o=u.length+o),n.point(u[o],l,e);case"LineString":return a<0&&(a=u.length+a),n.point(u[a],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a),n.point(u[s][a],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),n.point(u[o][a],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a),n.point(u[o][s][a],l,e)}throw new Error("geojson is invalid")}},789:t=>{var e=function(){var t={};function e(t,e){return new P(null,t+"    uniform sampler2D texture;    uniform vec2 texSize;    varying vec2 texCoord;    void main() {        vec2 coord = texCoord * texSize;        "+e+"        gl_FragColor = texture2D(texture, coord / texSize);        vec2 clampedCoord = clamp(coord, vec2(0.0), texSize);        if (coord != clampedCoord) {            /* fade to transparent if we are outside the image */            gl_FragColor.a *= max(0.0, 1.0 - length(coord - clampedCoord));        }    }")}var i="    float random(vec3 scale, float seed) {        /* use the fragment position for a different seed per-pixel */        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);    }";function n(t,e){return A.brightnessContrast=A.brightnessContrast||new P(null,"        uniform sampler2D texture;        uniform float brightness;        uniform float contrast;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            color.rgb += brightness;            if (contrast > 0.0) {                color.rgb = (color.rgb - 0.5) / (1.0 - contrast) + 0.5;            } else {                color.rgb = (color.rgb - 0.5) * (1.0 + contrast) + 0.5;            }            gl_FragColor = color;        }    "),$.call(this,A.brightnessContrast,{brightness:k(-1,t,1),contrast:k(-1,e,1)}),this}function r(t){return A.gamma=A.gamma||new P(null,"        uniform sampler2D texture;        uniform float gamma;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            color.rgb = pow(color.rgb, vec3(gamma));            gl_FragColor = color;        }    "),$.call(this,A.gamma,{gamma:k(0,t,5)}),this}function o(t){return A.vibrance=A.vibrance||new P(null,"        uniform sampler2D texture;        uniform float amount;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            float average = (color.r + color.g + color.b) / 3.0;            float mx = max(color.r, max(color.g, color.b));            float amt = (mx - average) * (-amount * 3.0);            color.rgb = mix(color.rgb, vec3(mx), amt);            gl_FragColor = color;        }    "),$.call(this,A.vibrance,{amount:k(-1,t,1)}),this}function s(t){for(var e=new V(t),i=[],n=0;n<256;n++)i.push(k(0,Math.floor(256*e.interpolate(n/255)),255));return i}function a(t,e,i){t=s(t),1==arguments.length?e=i=t:(e=s(e),i=s(i));for(var n=[],r=0;r<256;r++)n.splice(n.length,0,t[r],e[r],i[r],255);return this._.extraTexture.initFromBytes(256,1,n),this._.extraTexture.use(1),A.curves=A.curves||new P(null,"        uniform sampler2D texture;        uniform sampler2D map;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            color.r = texture2D(map, vec2(color.r)).r;            color.g = texture2D(map, vec2(color.g)).g;            color.b = texture2D(map, vec2(color.b)).b;            gl_FragColor = color;        }    "),A.curves.textures({map:1}),$.call(this,A.curves,{}),this}function l(t,e,i){return A.brightnessRGB=A.brightnessRGB||new P(null,"        uniform sampler2D texture;        uniform float r;        uniform float g;        uniform float b;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            color.r += r;            color.g += g;            color.b += b;            gl_FragColor = color;        }    "),$.call(this,A.brightnessRGB,{r:k(-1,t,1),g:k(-1,e,1),b:k(-1,i,1)}),this}function u(t,e){return A.vignette=A.vignette||new P(null,"        uniform sampler2D texture;        uniform float size;        uniform float amount;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);                        float dist = distance(texCoord, vec2(0.5, 0.5));            color.rgb *= smoothstep(0.8, size * 0.799, dist * (amount + size));                        gl_FragColor = color;        }    "),$.call(this,A.vignette,{size:k(0,t,1),amount:k(0,e,1)}),this}function h(t){return A.noise=A.noise||new P(null,"        uniform sampler2D texture;        uniform float amount;        varying vec2 texCoord;        float rand(vec2 co) {            return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);        }        void main() {            vec4 color = texture2D(texture, texCoord);                        float diff = (rand(texCoord) - 0.5) * amount;            color.r += diff;            color.g += diff;            color.b += diff;                        gl_FragColor = color;        }    "),$.call(this,A.noise,{amount:k(0,t,1)}),this}function c(t){A.denoise=A.denoise||new P(null,"        uniform sampler2D texture;        uniform float exponent;        uniform float strength;        uniform vec2 texSize;        varying vec2 texCoord;        void main() {            vec4 center = texture2D(texture, texCoord);            vec4 color = vec4(0.0);            float total = 0.0;            for (float x = -4.0; x <= 4.0; x += 1.0) {                for (float y = -4.0; y <= 4.0; y += 1.0) {                    vec4 sample = texture2D(texture, texCoord + vec2(x, y) / texSize);                    float weight = 1.0 - abs(dot(sample.rgb - center.rgb, vec3(0.25)));                    weight = pow(weight, exponent);                    color += sample * weight;                    total += weight;                }            }            gl_FragColor = color / total;        }    ");for(var e=0;e<2;e++)$.call(this,A.denoise,{exponent:Math.max(0,t),texSize:[this.width,this.height]});return this}function d(t){return A.sepia=A.sepia||new P(null,"        uniform sampler2D texture;        uniform float amount;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            float r = color.r;            float g = color.g;            float b = color.b;                        color.r = min(1.0, (r * (1.0 - (0.607 * amount))) + (g * (0.769 * amount)) + (b * (0.189 * amount)));            color.g = min(1.0, (r * 0.349 * amount) + (g * (1.0 - (0.314 * amount))) + (b * 0.168 * amount));            color.b = min(1.0, (r * 0.272 * amount) + (g * 0.534 * amount) + (b * (1.0 - (0.869 * amount))));                        gl_FragColor = color;        }    "),$.call(this,A.sepia,{amount:k(0,t,1)}),this}function f(t,e){return A.unsharpMask=A.unsharpMask||new P(null,"        uniform sampler2D blurredTexture;        uniform sampler2D originalTexture;        uniform float strength;        uniform float threshold;        varying vec2 texCoord;        void main() {            vec4 blurred = texture2D(blurredTexture, texCoord);            vec4 original = texture2D(originalTexture, texCoord);            gl_FragColor = mix(blurred, original, 1.0 + strength);        }    "),this._.extraTexture.ensureFormat(this._.texture),this._.texture.use(),this._.extraTexture.drawTo((function(){P.getDefaultShader().drawRect()})),this._.extraTexture.use(1),this.triangleBlur(t),A.unsharpMask.textures({originalTexture:1}),$.call(this,A.unsharpMask,{strength:e}),this._.extraTexture.unuse(1),this}function p(t,e){return A.hueSaturation=A.hueSaturation||new P(null,"        uniform sampler2D texture;        uniform float hue;        uniform float saturation;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);                        /* hue adjustment, wolfram alpha: RotationTransform[angle, {1, 1, 1}][{x, y, z}] */            float angle = hue * 3.14159265;            float s = sin(angle), c = cos(angle);            vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;            float len = length(color.rgb);            color.rgb = vec3(                dot(color.rgb, weights.xyz),                dot(color.rgb, weights.zxy),                dot(color.rgb, weights.yzx)            );                        /* saturation adjustment */            float average = (color.r + color.g + color.b) / 3.0;            if (saturation > 0.0) {                color.rgb += (average - color.rgb) * (1.0 - 1.0 / (1.001 - saturation));            } else {                color.rgb += (average - color.rgb) * (-saturation);            }                        gl_FragColor = color;        }    "),$.call(this,A.hueSaturation,{hue:k(-1,t,1),saturation:k(-1,e,1)}),this}function g(t,i,n,r){return A.swirl=A.swirl||e("        uniform float radius;        uniform float angle;        uniform vec2 center;    ","        coord -= center;        float distance = length(coord);        if (distance < radius) {            float percent = (radius - distance) / radius;            float theta = percent * percent * angle;            float s = sin(theta);            float c = cos(theta);            coord = vec2(                coord.x * c - coord.y * s,                coord.x * s + coord.y * c            );        }        coord += center;    "),$.call(this,A.swirl,{radius:n,center:[t,i],angle:r,texSize:[this.width,this.height]}),this}function m(t,e){var i=U.apply(null,e),n=U.apply(null,t),r=function(t,e){return[t[0]*e[0]+t[1]*e[3]+t[2]*e[6],t[0]*e[1]+t[1]*e[4]+t[2]*e[7],t[0]*e[2]+t[1]*e[5]+t[2]*e[8],t[3]*e[0]+t[4]*e[3]+t[5]*e[6],t[3]*e[1]+t[4]*e[4]+t[5]*e[7],t[3]*e[2]+t[4]*e[5]+t[5]*e[8],t[6]*e[0]+t[7]*e[3]+t[8]*e[6],t[6]*e[1]+t[7]*e[4]+t[8]*e[7],t[6]*e[2]+t[7]*e[5]+t[8]*e[8]]}(z(i),n);return this.matrixWarp(r)}function v(t,i,n,r){return A.bulgePinch=A.bulgePinch||e("        uniform float radius;        uniform float strength;        uniform vec2 center;    ","        coord -= center;        float distance = length(coord);        if (distance < radius) {            float percent = distance / radius;            if (strength > 0.0) {                coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);            } else {                coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);            }        }        coord += center;    "),$.call(this,A.bulgePinch,{radius:n,strength:k(-1,r,1),center:[t,i],texSize:[this.width,this.height]}),this}function y(t,i,n){if(A.matrixWarp=A.matrixWarp||e("        uniform mat3 matrix;        uniform bool useTextureSpace;    ","        if (useTextureSpace) coord = coord / texSize * 2.0 - 1.0;        vec3 warp = matrix * vec3(coord, 1.0);        coord = warp.xy / warp.z;        if (useTextureSpace) coord = (coord * 0.5 + 0.5) * texSize;    "),4==(t=Array.prototype.concat.apply([],t)).length)t=[t[0],t[1],0,t[2],t[3],0,0,0,1];else if(9!=t.length)throw"can only warp with 2x2 or 3x3 matrix";return $.call(this,A.matrixWarp,{matrix:i?z(t):t,texSize:[this.width,this.height],useTextureSpace:0|n}),this}function _(t,e,n){return A.zoomBlur=A.zoomBlur||new P(null,"        uniform sampler2D texture;        uniform vec2 center;        uniform float strength;        uniform vec2 texSize;        varying vec2 texCoord;        "+i+"        void main() {            vec4 color = vec4(0.0);            float total = 0.0;            vec2 toCenter = center - texCoord * texSize;                        /* randomize the lookup values to hide the fixed number of samples */            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);                        for (float t = 0.0; t <= 40.0; t++) {                float percent = (t + offset) / 40.0;                float weight = 4.0 * (percent - percent * percent);                vec4 sample = texture2D(texture, texCoord + toCenter * percent * strength / texSize);                                /* switch to pre-multiplied alpha to correctly blur transparent images */                sample.rgb *= sample.a;                                color += sample * weight;                total += weight;            }                        gl_FragColor = color / total;                        /* switch back from pre-multiplied alpha */            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;        }    "),$.call(this,A.zoomBlur,{center:[t,e],strength:n,texSize:[this.width,this.height]}),this}function b(t,e,n,r,o,s){A.tiltShift=A.tiltShift||new P(null,"        uniform sampler2D texture;        uniform float blurRadius;        uniform float gradientRadius;        uniform vec2 start;        uniform vec2 end;        uniform vec2 delta;        uniform vec2 texSize;        varying vec2 texCoord;        "+i+"        void main() {            vec4 color = vec4(0.0);            float total = 0.0;                        /* randomize the lookup values to hide the fixed number of samples */            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);                        vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));            float radius = smoothstep(0.0, 1.0, abs(dot(texCoord * texSize - start, normal)) / gradientRadius) * blurRadius;            for (float t = -30.0; t <= 30.0; t++) {                float percent = (t + offset - 0.5) / 30.0;                float weight = 1.0 - abs(percent);                vec4 sample = texture2D(texture, texCoord + delta / texSize * percent * radius);                                /* switch to pre-multiplied alpha to correctly blur transparent images */                sample.rgb *= sample.a;                                color += sample * weight;                total += weight;            }                        gl_FragColor = color / total;                        /* switch back from pre-multiplied alpha */            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;        }    ");var a=n-t,l=r-e,u=Math.sqrt(a*a+l*l);return $.call(this,A.tiltShift,{blurRadius:o,gradientRadius:s,start:[t,e],end:[n,r],delta:[a/u,l/u],texSize:[this.width,this.height]}),$.call(this,A.tiltShift,{blurRadius:o,gradientRadius:s,start:[t,e],end:[n,r],delta:[-l/u,a/u],texSize:[this.width,this.height]}),this}function w(t){return A.triangleBlur=A.triangleBlur||new P(null,"        uniform sampler2D texture;        uniform vec2 delta;        varying vec2 texCoord;        "+i+"        void main() {            vec4 color = vec4(0.0);            float total = 0.0;                        /* randomize the lookup values to hide the fixed number of samples */            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);                        for (float t = -30.0; t <= 30.0; t++) {                float percent = (t + offset - 0.5) / 30.0;                float weight = 1.0 - abs(percent);                vec4 sample = texture2D(texture, texCoord + delta * percent);                                /* switch to pre-multiplied alpha to correctly blur transparent images */                sample.rgb *= sample.a;                                color += sample * weight;                total += weight;            }                        gl_FragColor = color / total;                        /* switch back from pre-multiplied alpha */            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;        }    "),$.call(this,A.triangleBlur,{delta:[t/this.width,0]}),$.call(this,A.triangleBlur,{delta:[0,t/this.height]}),this}function x(t,e,n){A.lensBlurPrePass=A.lensBlurPrePass||new P(null,"        uniform sampler2D texture;        uniform float power;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            color = pow(color, vec4(power));            gl_FragColor = vec4(color);        }    ");var r="        uniform sampler2D texture0;        uniform sampler2D texture1;        uniform vec2 delta0;        uniform vec2 delta1;        uniform float power;        varying vec2 texCoord;        "+i+"        vec4 sample(vec2 delta) {            /* randomize the lookup values to hide the fixed number of samples */            float offset = random(vec3(delta, 151.7182), 0.0);                        vec4 color = vec4(0.0);            float total = 0.0;            for (float t = 0.0; t <= 30.0; t++) {                float percent = (t + offset) / 30.0;                color += texture2D(texture0, texCoord + delta * percent);                total += 1.0;            }            return color / total;        }    ";A.lensBlur0=A.lensBlur0||new P(null,r+"        void main() {            gl_FragColor = sample(delta0);        }    "),A.lensBlur1=A.lensBlur1||new P(null,r+"        void main() {            gl_FragColor = (sample(delta0) + sample(delta1)) * 0.5;        }    "),A.lensBlur2=A.lensBlur2||new P(null,r+"        void main() {            vec4 color = (sample(delta0) + 2.0 * texture2D(texture1, texCoord)) / 3.0;            gl_FragColor = pow(color, vec4(power));        }    ").textures({texture1:1});for(var o=[],s=0;s<3;s++){var a=n+s*Math.PI*2/3;o.push([t*Math.sin(a)/this.width,t*Math.cos(a)/this.height])}var l=Math.pow(10,k(-1,e,1));return $.call(this,A.lensBlurPrePass,{power:l}),this._.extraTexture.ensureFormat(this._.texture),$.call(this,A.lensBlur0,{delta0:o[0]},this._.texture,this._.extraTexture),$.call(this,A.lensBlur1,{delta0:o[1],delta1:o[2]},this._.extraTexture,this._.extraTexture),$.call(this,A.lensBlur0,{delta0:o[1]}),this._.extraTexture.use(1),$.call(this,A.lensBlur2,{power:1/l,delta0:o[2]}),this}function S(t){return A.edgeWork1=A.edgeWork1||new P(null,"        uniform sampler2D texture;        uniform vec2 delta;        varying vec2 texCoord;        "+i+"        void main() {            vec2 color = vec2(0.0);            vec2 total = vec2(0.0);                        /* randomize the lookup values to hide the fixed number of samples */            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);                        for (float t = -30.0; t <= 30.0; t++) {                float percent = (t + offset - 0.5) / 30.0;                float weight = 1.0 - abs(percent);                vec3 sample = texture2D(texture, texCoord + delta * percent).rgb;                float average = (sample.r + sample.g + sample.b) / 3.0;                color.x += average * weight;                total.x += weight;                if (abs(t) < 15.0) {                    weight = weight * 2.0 - 1.0;                    color.y += average * weight;                    total.y += weight;                }            }            gl_FragColor = vec4(color / total, 0.0, 1.0);        }    "),A.edgeWork2=A.edgeWork2||new P(null,"        uniform sampler2D texture;        uniform vec2 delta;        varying vec2 texCoord;        "+i+"        void main() {            vec2 color = vec2(0.0);            vec2 total = vec2(0.0);                        /* randomize the lookup values to hide the fixed number of samples */            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);                        for (float t = -30.0; t <= 30.0; t++) {                float percent = (t + offset - 0.5) / 30.0;                float weight = 1.0 - abs(percent);                vec2 sample = texture2D(texture, texCoord + delta * percent).xy;                color.x += sample.x * weight;                total.x += weight;                if (abs(t) < 15.0) {                    weight = weight * 2.0 - 1.0;                    color.y += sample.y * weight;                    total.y += weight;                }            }            float c = clamp(10000.0 * (color.y / total.y - color.x / total.x) + 0.5, 0.0, 1.0);            gl_FragColor = vec4(c, c, c, 1.0);        }    "),$.call(this,A.edgeWork1,{delta:[t/this.width,0]}),$.call(this,A.edgeWork2,{delta:[0,t/this.height]}),this}function C(t,e,i,n){return A.colorHalftone=A.colorHalftone||new P(null,"        uniform sampler2D texture;        uniform vec2 center;        uniform float angle;        uniform float scale;        uniform vec2 texSize;        varying vec2 texCoord;                float pattern(float angle) {            float s = sin(angle), c = cos(angle);            vec2 tex = texCoord * texSize - center;            vec2 point = vec2(                c * tex.x - s * tex.y,                s * tex.x + c * tex.y            ) * scale;            return (sin(point.x) * sin(point.y)) * 4.0;        }                void main() {            vec4 color = texture2D(texture, texCoord);            vec3 cmy = 1.0 - color.rgb;            float k = min(cmy.x, min(cmy.y, cmy.z));            cmy = (cmy - k) / (1.0 - k);            cmy = clamp(cmy * 10.0 - 3.0 + vec3(pattern(angle + 0.26179), pattern(angle + 1.30899), pattern(angle)), 0.0, 1.0);            k = clamp(k * 10.0 - 5.0 + pattern(angle + 0.78539), 0.0, 1.0);            gl_FragColor = vec4(1.0 - cmy - k, color.a);        }    "),$.call(this,A.colorHalftone,{center:[t,e],angle:i,scale:Math.PI/n,texSize:[this.width,this.height]}),this}function T(t,e,i){return A.hexagonalPixelate=A.hexagonalPixelate||new P(null,"        uniform sampler2D texture;        uniform vec2 center;        uniform float scale;        uniform vec2 texSize;        varying vec2 texCoord;        void main() {            vec2 tex = (texCoord * texSize - center) / scale;            tex.y /= 0.866025404;            tex.x -= tex.y * 0.5;                        vec2 a;            if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) a = vec2(floor(tex.x), floor(tex.y));            else a = vec2(ceil(tex.x), ceil(tex.y));            vec2 b = vec2(ceil(tex.x), floor(tex.y));            vec2 c = vec2(floor(tex.x), ceil(tex.y));                        vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);            vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);            vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);            vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);                        float alen = length(TEX - A);            float blen = length(TEX - B);            float clen = length(TEX - C);                        vec2 choice;            if (alen < blen) {                if (alen < clen) choice = a;                else choice = c;            } else {                if (blen < clen) choice = b;                else choice = c;            }                        choice.x += choice.y * 0.5;            choice.y *= 0.866025404;            choice *= scale / texSize;            gl_FragColor = texture2D(texture, choice + center / texSize);        }    "),$.call(this,A.hexagonalPixelate,{center:[t,e],scale:i,texSize:[this.width,this.height]}),this}function E(t){return A.ink=A.ink||new P(null,"        uniform sampler2D texture;        uniform float strength;        uniform vec2 texSize;        varying vec2 texCoord;        void main() {            vec2 dx = vec2(1.0 / texSize.x, 0.0);            vec2 dy = vec2(0.0, 1.0 / texSize.y);            vec4 color = texture2D(texture, texCoord);            float bigTotal = 0.0;            float smallTotal = 0.0;            vec3 bigAverage = vec3(0.0);            vec3 smallAverage = vec3(0.0);            for (float x = -2.0; x <= 2.0; x += 1.0) {                for (float y = -2.0; y <= 2.0; y += 1.0) {                    vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;                    bigAverage += sample;                    bigTotal += 1.0;                    if (abs(x) + abs(y) < 2.0) {                        smallAverage += sample;                        smallTotal += 1.0;                    }                }            }            vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);            gl_FragColor = vec4(color.rgb - dot(edge, edge) * strength * 100000.0, color.a);        }    "),$.call(this,A.ink,{strength:t*t*t*t*t,texSize:[this.width,this.height]}),this}function I(t,e,i,n){return A.dotScreen=A.dotScreen||new P(null,"        uniform sampler2D texture;        uniform vec2 center;        uniform float angle;        uniform float scale;        uniform vec2 texSize;        varying vec2 texCoord;                float pattern() {            float s = sin(angle), c = cos(angle);            vec2 tex = texCoord * texSize - center;            vec2 point = vec2(                c * tex.x - s * tex.y,                s * tex.x + c * tex.y            ) * scale;            return (sin(point.x) * sin(point.y)) * 4.0;        }                void main() {            vec4 color = texture2D(texture, texCoord);            float average = (color.r + color.g + color.b) / 3.0;            gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);        }    "),$.call(this,A.dotScreen,{center:[t,e],angle:i,scale:Math.PI/n,texSize:[this.width,this.height]}),this}var A,P=function(){function t(t){return"[object Number]"==Object.prototype.toString.call(t)}function e(t,e){var i=A.createShader(t);if(A.shaderSource(i,e),A.compileShader(i),!A.getShaderParameter(i,A.COMPILE_STATUS))throw"compile error: "+A.getShaderInfoLog(i);return i}function i(t,i){if(this.vertexAttribute=null,this.texCoordAttribute=null,this.program=A.createProgram(),t=t||"    attribute vec2 vertex;    attribute vec2 _texCoord;    varying vec2 texCoord;    void main() {        texCoord = _texCoord;        gl_Position = vec4(vertex * 2.0 - 1.0, 0.0, 1.0);    }",i="precision highp float;"+(i=i||"    uniform sampler2D texture;    varying vec2 texCoord;    void main() {        gl_FragColor = texture2D(texture, texCoord);    }"),A.attachShader(this.program,e(A.VERTEX_SHADER,t)),A.attachShader(this.program,e(A.FRAGMENT_SHADER,i)),A.linkProgram(this.program),!A.getProgramParameter(this.program,A.LINK_STATUS))throw"link error: "+A.getProgramInfoLog(this.program)}return i.prototype.destroy=function(){A.deleteProgram(this.program),this.program=null},i.prototype.uniforms=function(e){for(var i in A.useProgram(this.program),e)if(e.hasOwnProperty(i)){var n=A.getUniformLocation(this.program,i);if(null!==n){var r=e[i];if(o=r,"[object Array]"==Object.prototype.toString.call(o))switch(r.length){case 1:A.uniform1fv(n,new Float32Array(r));break;case 2:A.uniform2fv(n,new Float32Array(r));break;case 3:A.uniform3fv(n,new Float32Array(r));break;case 4:A.uniform4fv(n,new Float32Array(r));break;case 9:A.uniformMatrix3fv(n,!1,new Float32Array(r));break;case 16:A.uniformMatrix4fv(n,!1,new Float32Array(r));break;default:throw"dont't know how to load uniform \""+i+'" of length '+r.length}else{if(!t(r))throw'attempted to set uniform "'+i+'" to invalid value '+(r||"undefined").toString();A.uniform1f(n,r)}}}var o;return this},i.prototype.textures=function(t){for(var e in A.useProgram(this.program),t)t.hasOwnProperty(e)&&A.uniform1i(A.getUniformLocation(this.program,e),t[e]);return this},i.prototype.drawRect=function(t,e,i,n){var r,o=A.getParameter(A.VIEWPORT);e=e!==r?(e-o[1])/o[3]:0,t=t!==r?(t-o[0])/o[2]:0,i=i!==r?(i-o[0])/o[2]:1,n=n!==r?(n-o[1])/o[3]:1,null==A.vertexBuffer&&(A.vertexBuffer=A.createBuffer()),A.bindBuffer(A.ARRAY_BUFFER,A.vertexBuffer),A.bufferData(A.ARRAY_BUFFER,new Float32Array([t,e,t,n,i,e,i,n]),A.STATIC_DRAW),null==A.texCoordBuffer&&(A.texCoordBuffer=A.createBuffer(),A.bindBuffer(A.ARRAY_BUFFER,A.texCoordBuffer),A.bufferData(A.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),A.STATIC_DRAW)),null==this.vertexAttribute&&(this.vertexAttribute=A.getAttribLocation(this.program,"vertex"),A.enableVertexAttribArray(this.vertexAttribute)),null==this.texCoordAttribute&&(this.texCoordAttribute=A.getAttribLocation(this.program,"_texCoord"),A.enableVertexAttribArray(this.texCoordAttribute)),A.useProgram(this.program),A.bindBuffer(A.ARRAY_BUFFER,A.vertexBuffer),A.vertexAttribPointer(this.vertexAttribute,2,A.FLOAT,!1,0,0),A.bindBuffer(A.ARRAY_BUFFER,A.texCoordBuffer),A.vertexAttribPointer(this.texCoordAttribute,2,A.FLOAT,!1,0,0),A.drawArrays(A.TRIANGLE_STRIP,0,4)},i.getDefaultShader=function(){return A.defaultShader=A.defaultShader||new i,A.defaultShader},i}();function k(t,e,i){return Math.max(t,Math.min(e,i))}function R(t){return{_:t,loadContentsOf:function(t){A=this._.gl,this._.loadContentsOf(t)},destroy:function(){A=this._.gl,this._.destroy()}}}function L(t){return R(G.fromElement(t))}function F(t,e){var i=A.UNSIGNED_BYTE;if(A.getExtension("OES_texture_float")&&A.getExtension("OES_texture_float_linear")){A.getExtension("WEBGL_color_buffer_float");var n=new G(100,100,A.RGBA,A.FLOAT);try{n.drawTo((function(){i=A.FLOAT}))}catch(t){}n.destroy()}this._.texture&&this._.texture.destroy(),this._.spareTexture&&this._.spareTexture.destroy(),this.width=t,this.height=e,this._.texture=new G(t,e,A.RGBA,i),this._.spareTexture=new G(t,e,A.RGBA,i),this._.extraTexture=this._.extraTexture||new G(0,0,A.RGBA,i),this._.flippedShader=this._.flippedShader||new P(null,"        uniform sampler2D texture;        varying vec2 texCoord;        void main() {            gl_FragColor = texture2D(texture, vec2(texCoord.x, 1.0 - texCoord.y));        }    "),this._.isInitialized=!0}function M(t,e,i){return this._.isInitialized&&t._.width==this.width&&t._.height==this.height||F.call(this,e||t._.width,i||t._.height),t._.use(),this._.texture.drawTo((function(){P.getDefaultShader().drawRect()})),this}function O(){return this._.texture.use(),this._.flippedShader.drawRect(),this}function $(t,e,i,n){(i||this._.texture).use(),this._.spareTexture.drawTo((function(){t.uniforms(e).drawRect()})),this._.spareTexture.swapWith(n||this._.texture)}function D(t){return t.parentNode.insertBefore(this,t),t.parentNode.removeChild(t),this}function j(){var t=new G(this._.texture.width,this._.texture.height,A.RGBA,A.UNSIGNED_BYTE);return this._.texture.use(),t.drawTo((function(){P.getDefaultShader().drawRect()})),R(t)}function N(){var t=this._.texture.width,e=this._.texture.height,i=new Uint8Array(t*e*4);return this._.texture.drawTo((function(){A.readPixels(0,0,t,e,A.RGBA,A.UNSIGNED_BYTE,i)})),i}function B(t){return function(){return A=this._.gl,t.apply(this,arguments)}}function U(t,e,i,n,r,o,s,a){var l=i-r,u=n-o,h=s-r,c=a-o,d=t-i+r-s,f=e-n+o-a,p=l*c-h*u,g=(d*c-h*f)/p,m=(l*f-d*u)/p;return[i-t+g*i,n-e+g*n,g,s-t+m*s,a-e+m*a,m,t,e,1]}function z(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],s=t[5],a=t[6],l=t[7],u=t[8],h=e*o*u-e*s*l-i*r*u+i*s*a+n*r*l-n*o*a;return[(o*u-s*l)/h,(n*l-i*u)/h,(i*s-n*o)/h,(s*a-r*u)/h,(e*u-n*a)/h,(n*r-e*s)/h,(r*l-o*a)/h,(i*a-e*l)/h,(e*o-i*r)/h]}function V(t){var e=t.length;this.xa=[],this.ya=[],this.u=[],this.y2=[],t.sort((function(t,e){return t[0]-e[0]}));for(var i=0;i<e;i++)this.xa.push(t[i][0]),this.ya.push(t[i][1]);this.u[0]=0,this.y2[0]=0;for(i=1;i<e-1;++i){var n=this.xa[i+1]-this.xa[i-1],r=(this.xa[i]-this.xa[i-1])/n,o=r*this.y2[i-1]+2;this.y2[i]=(r-1)/o;var s=(this.ya[i+1]-this.ya[i])/(this.xa[i+1]-this.xa[i])-(this.ya[i]-this.ya[i-1])/(this.xa[i]-this.xa[i-1]);this.u[i]=(6*s/n-r*this.u[i-1])/o}this.y2[e-1]=0;for(i=e-2;i>=0;--i)this.y2[i]=this.y2[i]*this.y2[i+1]+this.u[i]}t.canvas=function(){var t=document.createElement("canvas");try{A=t.getContext("experimental-webgl",{premultipliedAlpha:!1})}catch(t){A=null}if(!A)throw"This browser does not support WebGL";return t._={gl:A,isInitialized:!1,texture:null,spareTexture:null,flippedShader:null},t.texture=B(L),t.draw=B(M),t.update=B(O),t.replace=B(D),t.contents=B(j),t.getPixelArray=B(N),t.brightnessContrast=B(n),t.brightnessRGB=B(l),t.hexagonalPixelate=B(T),t.hueSaturation=B(p),t.colorHalftone=B(C),t.triangleBlur=B(w),t.unsharpMask=B(f),t.perspective=B(m),t.matrixWarp=B(y),t.bulgePinch=B(v),t.tiltShift=B(b),t.dotScreen=B(I),t.edgeWork=B(S),t.lensBlur=B(x),t.zoomBlur=B(_),t.noise=B(h),t.denoise=B(c),t.curves=B(a),t.swirl=B(g),t.ink=B(E),t.vignette=B(u),t.vibrance=B(o),t.sepia=B(d),t.gamma=B(r),t},t.splineInterpolate=s,V.prototype.interpolate=function(t){for(var e=0,i=this.ya.length-1;i-e>1;){var n=i+e>>1;this.xa[n]>t?i=n:e=n}var r=this.xa[i]-this.xa[e],o=(this.xa[i]-t)/r,s=(t-this.xa[e])/r;return o*this.ya[e]+s*this.ya[i]+((o*o*o-o)*this.y2[e]+(s*s*s-s)*this.y2[i])*(r*r)/6};var G=function(){function t(t,e,i,n){this.gl=A,this.id=A.createTexture(),this.width=t,this.height=e,this.format=i,this.type=n,A.bindTexture(A.TEXTURE_2D,this.id),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,A.CLAMP_TO_EDGE),t&&e&&A.texImage2D(A.TEXTURE_2D,0,this.format,t,e,0,this.format,this.type,null)}t.fromElement=function(e){var i=new t(0,0,A.RGBA,A.UNSIGNED_BYTE);return i.loadContentsOf(e),i},t.prototype.loadContentsOf=function(t){this.width=t.width||t.videoWidth,this.height=t.height||t.videoHeight,A.bindTexture(A.TEXTURE_2D,this.id),A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,this.type,t)},t.prototype.initFromBytes=function(t,e,i){this.width=t,this.height=e,this.format=A.RGBA,this.type=A.UNSIGNED_BYTE,A.bindTexture(A.TEXTURE_2D,this.id),A.texImage2D(A.TEXTURE_2D,0,A.RGBA,t,e,0,A.RGBA,this.type,new Uint8Array(i))},t.prototype.destroy=function(){A.deleteTexture(this.id),this.id=null},t.prototype.use=function(t){A.activeTexture(A.TEXTURE0+(t||0)),A.bindTexture(A.TEXTURE_2D,this.id)},t.prototype.unuse=function(t){A.activeTexture(A.TEXTURE0+(t||0)),A.bindTexture(A.TEXTURE_2D,null)},t.prototype.ensureFormat=function(t,e,i,n){if(1==arguments.length){var r=arguments[0];t=r.width,e=r.height,i=r.format,n=r.type}t==this.width&&e==this.height&&i==this.format&&n==this.type||(this.width=t,this.height=e,this.format=i,this.type=n,A.bindTexture(A.TEXTURE_2D,this.id),A.texImage2D(A.TEXTURE_2D,0,this.format,t,e,0,this.format,this.type,null))},t.prototype.drawTo=function(t){if(A.framebuffer=A.framebuffer||A.createFramebuffer(),A.bindFramebuffer(A.FRAMEBUFFER,A.framebuffer),A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_2D,this.id,0),A.checkFramebufferStatus(A.FRAMEBUFFER)!==A.FRAMEBUFFER_COMPLETE)throw new Error("incomplete framebuffer");A.viewport(0,0,this.width,this.height),t(),A.bindFramebuffer(A.FRAMEBUFFER,null)};var e=null;function i(t){null==e&&(e=document.createElement("canvas")),e.width=t.width,e.height=t.height;var i=e.getContext("2d");return i.clearRect(0,0,e.width,e.height),i}return t.prototype.fillUsingCanvas=function(t){return t(i(this)),this.format=A.RGBA,this.type=A.UNSIGNED_BYTE,A.bindTexture(A.TEXTURE_2D,this.id),A.texImage2D(A.TEXTURE_2D,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,e),this},t.prototype.toImage=function(t){this.use(),P.getDefaultShader().drawRect();var n=this.width*this.height*4,r=new Uint8Array(n),o=i(this),s=o.createImageData(this.width,this.height);A.readPixels(0,0,this.width,this.height,A.RGBA,A.UNSIGNED_BYTE,r);for(var a=0;a<n;a++)s.data[a]=r[a];o.putImageData(s,0,0),t.src=e.toDataURL()},t.prototype.swapWith=function(t){var e;e=t.id,t.id=this.id,this.id=e,e=t.width,t.width=this.width,this.width=e,e=t.height,t.height=this.height,this.height=e,e=t.format,t.format=this.format,this.format=e},t}();return t}();t.exports=e},755:()=>{window.addEventListener("load",(function(){var t=(new Date).getTime(),e=window.setInterval((function(){(new Date).getTime()-t>72e5?window.clearInterval(e):Vue.http.post("heartbeat").then((function(){t=(new Date).getTime()}),(function(){window.clearInterval(e)}))}),36e5)}))},282:(t,e,i)=>{"use strict";var n=Object.freeze({});function r(t){return null==t}function o(t){return null!=t}function s(t){return!0===t}function a(t){return"string"==typeof t||"number"==typeof t||"symbol"==typeof t||"boolean"==typeof t}function l(t){return null!==t&&"object"==typeof t}var u=Object.prototype.toString;function h(t){return"[object Object]"===u.call(t)}function c(t){return"[object RegExp]"===u.call(t)}function d(t){var e=parseFloat(String(t));return e>=0&&Math.floor(e)===e&&isFinite(t)}function f(t){return o(t)&&"function"==typeof t.then&&"function"==typeof t.catch}function p(t){return null==t?"":Array.isArray(t)||h(t)&&t.toString===u?JSON.stringify(t,null,2):String(t)}function g(t){var e=parseFloat(t);return isNaN(e)?t:e}function m(t,e){for(var i=Object.create(null),n=t.split(","),r=0;r<n.length;r++)i[n[r]]=!0;return e?function(t){return i[t.toLowerCase()]}:function(t){return i[t]}}var v=m("slot,component",!0),y=m("key,ref,slot,slot-scope,is");function _(t,e){if(t.length){var i=t.indexOf(e);if(i>-1)return t.splice(i,1)}}var b=Object.prototype.hasOwnProperty;function w(t,e){return b.call(t,e)}function x(t){var e=Object.create(null);return function(i){return e[i]||(e[i]=t(i))}}var S=/-(\w)/g,C=x((function(t){return t.replace(S,(function(t,e){return e?e.toUpperCase():""}))})),T=x((function(t){return t.charAt(0).toUpperCase()+t.slice(1)})),E=/\B([A-Z])/g,I=x((function(t){return t.replace(E,"-$1").toLowerCase()}));var A=Function.prototype.bind?function(t,e){return t.bind(e)}:function(t,e){function i(i){var n=arguments.length;return n?n>1?t.apply(e,arguments):t.call(e,i):t.call(e)}return i._length=t.length,i};function P(t,e){e=e||0;for(var i=t.length-e,n=new Array(i);i--;)n[i]=t[i+e];return n}function k(t,e){for(var i in e)t[i]=e[i];return t}function R(t){for(var e={},i=0;i<t.length;i++)t[i]&&k(e,t[i]);return e}function L(t,e,i){}var F=function(t,e,i){return!1},M=function(t){return t};function O(t,e){if(t===e)return!0;var i=l(t),n=l(e);if(!i||!n)return!i&&!n&&String(t)===String(e);try{var r=Array.isArray(t),o=Array.isArray(e);if(r&&o)return t.length===e.length&&t.every((function(t,i){return O(t,e[i])}));if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(r||o)return!1;var s=Object.keys(t),a=Object.keys(e);return s.length===a.length&&s.every((function(i){return O(t[i],e[i])}))}catch(t){return!1}}function $(t,e){for(var i=0;i<t.length;i++)if(O(t[i],e))return i;return-1}function D(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}var j="data-server-rendered",N=["component","directive","filter"],B=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],U={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:F,isReservedAttr:F,isUnknownElement:F,getTagNamespace:L,parsePlatformTagName:M,mustUseProp:F,async:!0,_lifecycleHooks:B},z=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function V(t){var e=(t+"").charCodeAt(0);return 36===e||95===e}function G(t,e,i,n){Object.defineProperty(t,e,{value:i,enumerable:!!n,writable:!0,configurable:!0})}var q=new RegExp("[^"+z.source+".$_\\d]");var W,K="__proto__"in{},X="undefined"!=typeof window,Y="undefined"!=typeof WXEnvironment&&!!WXEnvironment.platform,H=Y&&WXEnvironment.platform.toLowerCase(),Z=X&&window.navigator.userAgent.toLowerCase(),J=Z&&/msie|trident/.test(Z),Q=Z&&Z.indexOf("msie 9.0")>0,tt=Z&&Z.indexOf("edge/")>0,et=(Z&&Z.indexOf("android"),Z&&/iphone|ipad|ipod|ios/.test(Z)||"ios"===H),it=(Z&&/chrome\/\d+/.test(Z),Z&&/phantomjs/.test(Z),Z&&Z.match(/firefox\/(\d+)/)),nt={}.watch,rt=!1;if(X)try{var ot={};Object.defineProperty(ot,"passive",{get:function(){rt=!0}}),window.addEventListener("test-passive",null,ot)}catch(rd){}var st=function(){return void 0===W&&(W=!X&&!Y&&void 0!==i.g&&(i.g.process&&"server"===i.g.process.env.VUE_ENV)),W},at=X&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function lt(t){return"function"==typeof t&&/native code/.test(t.toString())}var ut,ht="undefined"!=typeof Symbol&&lt(Symbol)&&"undefined"!=typeof Reflect&&lt(Reflect.ownKeys);ut="undefined"!=typeof Set&&lt(Set)?Set:function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(t){return!0===this.set[t]},t.prototype.add=function(t){this.set[t]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}();var ct=L,dt=0,ft=function(){this.id=dt++,this.subs=[]};ft.prototype.addSub=function(t){this.subs.push(t)},ft.prototype.removeSub=function(t){_(this.subs,t)},ft.prototype.depend=function(){ft.target&&ft.target.addDep(this)},ft.prototype.notify=function(){var t=this.subs.slice();for(var e=0,i=t.length;e<i;e++)t[e].update()},ft.target=null;var pt=[];function gt(t){pt.push(t),ft.target=t}function mt(){pt.pop(),ft.target=pt[pt.length-1]}var vt=function(t,e,i,n,r,o,s,a){this.tag=t,this.data=e,this.children=i,this.text=n,this.elm=r,this.ns=void 0,this.context=o,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=s,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=a,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},yt={child:{configurable:!0}};yt.child.get=function(){return this.componentInstance},Object.defineProperties(vt.prototype,yt);var _t=function(t){void 0===t&&(t="");var e=new vt;return e.text=t,e.isComment=!0,e};function bt(t){return new vt(void 0,void 0,void 0,String(t))}function wt(t){var e=new vt(t.tag,t.data,t.children&&t.children.slice(),t.text,t.elm,t.context,t.componentOptions,t.asyncFactory);return e.ns=t.ns,e.isStatic=t.isStatic,e.key=t.key,e.isComment=t.isComment,e.fnContext=t.fnContext,e.fnOptions=t.fnOptions,e.fnScopeId=t.fnScopeId,e.asyncMeta=t.asyncMeta,e.isCloned=!0,e}var xt=Array.prototype,St=Object.create(xt);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(t){var e=xt[t];G(St,t,(function(){for(var i=[],n=arguments.length;n--;)i[n]=arguments[n];var r,o=e.apply(this,i),s=this.__ob__;switch(t){case"push":case"unshift":r=i;break;case"splice":r=i.slice(2)}return r&&s.observeArray(r),s.dep.notify(),o}))}));var Ct=Object.getOwnPropertyNames(St),Tt=!0;function Et(t){Tt=t}var It=function(t){this.value=t,this.dep=new ft,this.vmCount=0,G(t,"__ob__",this),Array.isArray(t)?(K?function(t,e){t.__proto__=e}(t,St):function(t,e,i){for(var n=0,r=i.length;n<r;n++){var o=i[n];G(t,o,e[o])}}(t,St,Ct),this.observeArray(t)):this.walk(t)};function At(t,e){var i;if(l(t)&&!(t instanceof vt))return w(t,"__ob__")&&t.__ob__ instanceof It?i=t.__ob__:Tt&&!st()&&(Array.isArray(t)||h(t))&&Object.isExtensible(t)&&!t._isVue&&(i=new It(t)),e&&i&&i.vmCount++,i}function Pt(t,e,i,n,r){var o=new ft,s=Object.getOwnPropertyDescriptor(t,e);if(!s||!1!==s.configurable){var a=s&&s.get,l=s&&s.set;a&&!l||2!==arguments.length||(i=t[e]);var u=!r&&At(i);Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var e=a?a.call(t):i;return ft.target&&(o.depend(),u&&(u.dep.depend(),Array.isArray(e)&&Lt(e))),e},set:function(e){var n=a?a.call(t):i;e===n||e!=e&&n!=n||a&&!l||(l?l.call(t,e):i=e,u=!r&&At(e),o.notify())}})}}function kt(t,e,i){if(Array.isArray(t)&&d(e))return t.length=Math.max(t.length,e),t.splice(e,1,i),i;if(e in t&&!(e in Object.prototype))return t[e]=i,i;var n=t.__ob__;return t._isVue||n&&n.vmCount?i:n?(Pt(n.value,e,i),n.dep.notify(),i):(t[e]=i,i)}function Rt(t,e){if(Array.isArray(t)&&d(e))t.splice(e,1);else{var i=t.__ob__;t._isVue||i&&i.vmCount||w(t,e)&&(delete t[e],i&&i.dep.notify())}}function Lt(t){for(var e=void 0,i=0,n=t.length;i<n;i++)(e=t[i])&&e.__ob__&&e.__ob__.dep.depend(),Array.isArray(e)&&Lt(e)}It.prototype.walk=function(t){for(var e=Object.keys(t),i=0;i<e.length;i++)Pt(t,e[i])},It.prototype.observeArray=function(t){for(var e=0,i=t.length;e<i;e++)At(t[e])};var Ft=U.optionMergeStrategies;function Mt(t,e){if(!e)return t;for(var i,n,r,o=ht?Reflect.ownKeys(e):Object.keys(e),s=0;s<o.length;s++)"__ob__"!==(i=o[s])&&(n=t[i],r=e[i],w(t,i)?n!==r&&h(n)&&h(r)&&Mt(n,r):kt(t,i,r));return t}function Ot(t,e,i){return i?function(){var n="function"==typeof e?e.call(i,i):e,r="function"==typeof t?t.call(i,i):t;return n?Mt(n,r):r}:e?t?function(){return Mt("function"==typeof e?e.call(this,this):e,"function"==typeof t?t.call(this,this):t)}:e:t}function $t(t,e){var i=e?t?t.concat(e):Array.isArray(e)?e:[e]:t;return i?function(t){for(var e=[],i=0;i<t.length;i++)-1===e.indexOf(t[i])&&e.push(t[i]);return e}(i):i}function Dt(t,e,i,n){var r=Object.create(t||null);return e?k(r,e):r}Ft.data=function(t,e,i){return i?Ot(t,e,i):e&&"function"!=typeof e?t:Ot(t,e)},B.forEach((function(t){Ft[t]=$t})),N.forEach((function(t){Ft[t+"s"]=Dt})),Ft.watch=function(t,e,i,n){if(t===nt&&(t=void 0),e===nt&&(e=void 0),!e)return Object.create(t||null);if(!t)return e;var r={};for(var o in k(r,t),e){var s=r[o],a=e[o];s&&!Array.isArray(s)&&(s=[s]),r[o]=s?s.concat(a):Array.isArray(a)?a:[a]}return r},Ft.props=Ft.methods=Ft.inject=Ft.computed=function(t,e,i,n){if(!t)return e;var r=Object.create(null);return k(r,t),e&&k(r,e),r},Ft.provide=Ot;var jt=function(t,e){return void 0===e?t:e};function Nt(t,e,i){if("function"==typeof e&&(e=e.options),function(t,e){var i=t.props;if(i){var n,r,o={};if(Array.isArray(i))for(n=i.length;n--;)"string"==typeof(r=i[n])&&(o[C(r)]={type:null});else if(h(i))for(var s in i)r=i[s],o[C(s)]=h(r)?r:{type:r};t.props=o}}(e),function(t,e){var i=t.inject;if(i){var n=t.inject={};if(Array.isArray(i))for(var r=0;r<i.length;r++)n[i[r]]={from:i[r]};else if(h(i))for(var o in i){var s=i[o];n[o]=h(s)?k({from:o},s):{from:s}}}}(e),function(t){var e=t.directives;if(e)for(var i in e){var n=e[i];"function"==typeof n&&(e[i]={bind:n,update:n})}}(e),!e._base&&(e.extends&&(t=Nt(t,e.extends,i)),e.mixins))for(var n=0,r=e.mixins.length;n<r;n++)t=Nt(t,e.mixins[n],i);var o,s={};for(o in t)a(o);for(o in e)w(t,o)||a(o);function a(n){var r=Ft[n]||jt;s[n]=r(t[n],e[n],i,n)}return s}function Bt(t,e,i,n){if("string"==typeof i){var r=t[e];if(w(r,i))return r[i];var o=C(i);if(w(r,o))return r[o];var s=T(o);return w(r,s)?r[s]:r[i]||r[o]||r[s]}}function Ut(t,e,i,n){var r=e[t],o=!w(i,t),s=i[t],a=Gt(Boolean,r.type);if(a>-1)if(o&&!w(r,"default"))s=!1;else if(""===s||s===I(t)){var l=Gt(String,r.type);(l<0||a<l)&&(s=!0)}if(void 0===s){s=function(t,e,i){if(!w(e,"default"))return;var n=e.default;0;if(t&&t.$options.propsData&&void 0===t.$options.propsData[i]&&void 0!==t._props[i])return t._props[i];return"function"==typeof n&&"Function"!==zt(e.type)?n.call(t):n}(n,r,t);var u=Tt;Et(!0),At(s),Et(u)}return s}function zt(t){var e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:""}function Vt(t,e){return zt(t)===zt(e)}function Gt(t,e){if(!Array.isArray(e))return Vt(e,t)?0:-1;for(var i=0,n=e.length;i<n;i++)if(Vt(e[i],t))return i;return-1}function qt(t,e,i){gt();try{if(e)for(var n=e;n=n.$parent;){var r=n.$options.errorCaptured;if(r)for(var o=0;o<r.length;o++)try{if(!1===r[o].call(n,t,e,i))return}catch(t){Kt(t,n,"errorCaptured hook")}}Kt(t,e,i)}finally{mt()}}function Wt(t,e,i,n,r){var o;try{(o=i?t.apply(e,i):t.call(e))&&!o._isVue&&f(o)&&!o._handled&&(o.catch((function(t){return qt(t,n,r+" (Promise/async)")})),o._handled=!0)}catch(t){qt(t,n,r)}return o}function Kt(t,e,i){if(U.errorHandler)try{return U.errorHandler.call(null,t,e,i)}catch(e){e!==t&&Xt(e,null,"config.errorHandler")}Xt(t,e,i)}function Xt(t,e,i){if(!X&&!Y||"undefined"==typeof console)throw t;console.error(t)}var Yt,Ht=!1,Zt=[],Jt=!1;function Qt(){Jt=!1;var t=Zt.slice(0);Zt.length=0;for(var e=0;e<t.length;e++)t[e]()}if("undefined"!=typeof Promise&&lt(Promise)){var te=Promise.resolve();Yt=function(){te.then(Qt),et&&setTimeout(L)},Ht=!0}else if(J||"undefined"==typeof MutationObserver||!lt(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())Yt="undefined"!=typeof setImmediate&&lt(setImmediate)?function(){setImmediate(Qt)}:function(){setTimeout(Qt,0)};else{var ee=1,ie=new MutationObserver(Qt),ne=document.createTextNode(String(ee));ie.observe(ne,{characterData:!0}),Yt=function(){ee=(ee+1)%2,ne.data=String(ee)},Ht=!0}function re(t,e){var i;if(Zt.push((function(){if(t)try{t.call(e)}catch(t){qt(t,e,"nextTick")}else i&&i(e)})),Jt||(Jt=!0,Yt()),!t&&"undefined"!=typeof Promise)return new Promise((function(t){i=t}))}var oe=new ut;function se(t){ae(t,oe),oe.clear()}function ae(t,e){var i,n,r=Array.isArray(t);if(!(!r&&!l(t)||Object.isFrozen(t)||t instanceof vt)){if(t.__ob__){var o=t.__ob__.dep.id;if(e.has(o))return;e.add(o)}if(r)for(i=t.length;i--;)ae(t[i],e);else for(i=(n=Object.keys(t)).length;i--;)ae(t[n[i]],e)}}var le=x((function(t){var e="&"===t.charAt(0),i="~"===(t=e?t.slice(1):t).charAt(0),n="!"===(t=i?t.slice(1):t).charAt(0);return{name:t=n?t.slice(1):t,once:i,capture:n,passive:e}}));function ue(t,e){function i(){var t=arguments,n=i.fns;if(!Array.isArray(n))return Wt(n,null,arguments,e,"v-on handler");for(var r=n.slice(),o=0;o<r.length;o++)Wt(r[o],null,t,e,"v-on handler")}return i.fns=t,i}function he(t,e,i,n,o,a){var l,u,h,c;for(l in t)u=t[l],h=e[l],c=le(l),r(u)||(r(h)?(r(u.fns)&&(u=t[l]=ue(u,a)),s(c.once)&&(u=t[l]=o(c.name,u,c.capture)),i(c.name,u,c.capture,c.passive,c.params)):u!==h&&(h.fns=u,t[l]=h));for(l in e)r(t[l])&&n((c=le(l)).name,e[l],c.capture)}function ce(t,e,i){var n;t instanceof vt&&(t=t.data.hook||(t.data.hook={}));var a=t[e];function l(){i.apply(this,arguments),_(n.fns,l)}r(a)?n=ue([l]):o(a.fns)&&s(a.merged)?(n=a).fns.push(l):n=ue([a,l]),n.merged=!0,t[e]=n}function de(t,e,i,n,r){if(o(e)){if(w(e,i))return t[i]=e[i],r||delete e[i],!0;if(w(e,n))return t[i]=e[n],r||delete e[n],!0}return!1}function fe(t){return a(t)?[bt(t)]:Array.isArray(t)?ge(t):void 0}function pe(t){return o(t)&&o(t.text)&&!1===t.isComment}function ge(t,e){var i,n,l,u,h=[];for(i=0;i<t.length;i++)r(n=t[i])||"boolean"==typeof n||(u=h[l=h.length-1],Array.isArray(n)?n.length>0&&(pe((n=ge(n,(e||"")+"_"+i))[0])&&pe(u)&&(h[l]=bt(u.text+n[0].text),n.shift()),h.push.apply(h,n)):a(n)?pe(u)?h[l]=bt(u.text+n):""!==n&&h.push(bt(n)):pe(n)&&pe(u)?h[l]=bt(u.text+n.text):(s(t._isVList)&&o(n.tag)&&r(n.key)&&o(e)&&(n.key="__vlist"+e+"_"+i+"__"),h.push(n)));return h}function me(t,e){if(t){for(var i=Object.create(null),n=ht?Reflect.ownKeys(t):Object.keys(t),r=0;r<n.length;r++){var o=n[r];if("__ob__"!==o){for(var s=t[o].from,a=e;a;){if(a._provided&&w(a._provided,s)){i[o]=a._provided[s];break}a=a.$parent}if(!a)if("default"in t[o]){var l=t[o].default;i[o]="function"==typeof l?l.call(e):l}else 0}}return i}}function ve(t,e){if(!t||!t.length)return{};for(var i={},n=0,r=t.length;n<r;n++){var o=t[n],s=o.data;if(s&&s.attrs&&s.attrs.slot&&delete s.attrs.slot,o.context!==e&&o.fnContext!==e||!s||null==s.slot)(i.default||(i.default=[])).push(o);else{var a=s.slot,l=i[a]||(i[a]=[]);"template"===o.tag?l.push.apply(l,o.children||[]):l.push(o)}}for(var u in i)i[u].every(ye)&&delete i[u];return i}function ye(t){return t.isComment&&!t.asyncFactory||" "===t.text}function _e(t,e,i){var r,o=Object.keys(e).length>0,s=t?!!t.$stable:!o,a=t&&t.$key;if(t){if(t._normalized)return t._normalized;if(s&&i&&i!==n&&a===i.$key&&!o&&!i.$hasNormal)return i;for(var l in r={},t)t[l]&&"$"!==l[0]&&(r[l]=be(e,l,t[l]))}else r={};for(var u in e)u in r||(r[u]=we(e,u));return t&&Object.isExtensible(t)&&(t._normalized=r),G(r,"$stable",s),G(r,"$key",a),G(r,"$hasNormal",o),r}function be(t,e,i){var n=function(){var t=arguments.length?i.apply(null,arguments):i({});return(t=t&&"object"==typeof t&&!Array.isArray(t)?[t]:fe(t))&&(0===t.length||1===t.length&&t[0].isComment)?void 0:t};return i.proxy&&Object.defineProperty(t,e,{get:n,enumerable:!0,configurable:!0}),n}function we(t,e){return function(){return t[e]}}function xe(t,e){var i,n,r,s,a;if(Array.isArray(t)||"string"==typeof t)for(i=new Array(t.length),n=0,r=t.length;n<r;n++)i[n]=e(t[n],n);else if("number"==typeof t)for(i=new Array(t),n=0;n<t;n++)i[n]=e(n+1,n);else if(l(t))if(ht&&t[Symbol.iterator]){i=[];for(var u=t[Symbol.iterator](),h=u.next();!h.done;)i.push(e(h.value,i.length)),h=u.next()}else for(s=Object.keys(t),i=new Array(s.length),n=0,r=s.length;n<r;n++)a=s[n],i[n]=e(t[a],a,n);return o(i)||(i=[]),i._isVList=!0,i}function Se(t,e,i,n){var r,o=this.$scopedSlots[t];o?(i=i||{},n&&(i=k(k({},n),i)),r=o(i)||e):r=this.$slots[t]||e;var s=i&&i.slot;return s?this.$createElement("template",{slot:s},r):r}function Ce(t){return Bt(this.$options,"filters",t)||M}function Te(t,e){return Array.isArray(t)?-1===t.indexOf(e):t!==e}function Ee(t,e,i,n,r){var o=U.keyCodes[e]||i;return r&&n&&!U.keyCodes[e]?Te(r,n):o?Te(o,t):n?I(n)!==e:void 0}function Ie(t,e,i,n,r){if(i)if(l(i)){var o;Array.isArray(i)&&(i=R(i));var s=function(s){if("class"===s||"style"===s||y(s))o=t;else{var a=t.attrs&&t.attrs.type;o=n||U.mustUseProp(e,a,s)?t.domProps||(t.domProps={}):t.attrs||(t.attrs={})}var l=C(s),u=I(s);l in o||u in o||(o[s]=i[s],r&&((t.on||(t.on={}))["update:"+s]=function(t){i[s]=t}))};for(var a in i)s(a)}else;return t}function Ae(t,e){var i=this._staticTrees||(this._staticTrees=[]),n=i[t];return n&&!e||ke(n=i[t]=this.$options.staticRenderFns[t].call(this._renderProxy,null,this),"__static__"+t,!1),n}function Pe(t,e,i){return ke(t,"__once__"+e+(i?"_"+i:""),!0),t}function ke(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n]&&"string"!=typeof t[n]&&Re(t[n],e+"_"+n,i);else Re(t,e,i)}function Re(t,e,i){t.isStatic=!0,t.key=e,t.isOnce=i}function Le(t,e){if(e)if(h(e)){var i=t.on=t.on?k({},t.on):{};for(var n in e){var r=i[n],o=e[n];i[n]=r?[].concat(r,o):o}}else;return t}function Fe(t,e,i,n){e=e||{$stable:!i};for(var r=0;r<t.length;r++){var o=t[r];Array.isArray(o)?Fe(o,e,i):o&&(o.proxy&&(o.fn.proxy=!0),e[o.key]=o.fn)}return n&&(e.$key=n),e}function Me(t,e){for(var i=0;i<e.length;i+=2){var n=e[i];"string"==typeof n&&n&&(t[e[i]]=e[i+1])}return t}function Oe(t,e){return"string"==typeof t?e+t:t}function $e(t){t._o=Pe,t._n=g,t._s=p,t._l=xe,t._t=Se,t._q=O,t._i=$,t._m=Ae,t._f=Ce,t._k=Ee,t._b=Ie,t._v=bt,t._e=_t,t._u=Fe,t._g=Le,t._d=Me,t._p=Oe}function De(t,e,i,r,o){var a,l=this,u=o.options;w(r,"_uid")?(a=Object.create(r))._original=r:(a=r,r=r._original);var h=s(u._compiled),c=!h;this.data=t,this.props=e,this.children=i,this.parent=r,this.listeners=t.on||n,this.injections=me(u.inject,r),this.slots=function(){return l.$slots||_e(t.scopedSlots,l.$slots=ve(i,r)),l.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return _e(t.scopedSlots,this.slots())}}),h&&(this.$options=u,this.$slots=this.slots(),this.$scopedSlots=_e(t.scopedSlots,this.$slots)),u._scopeId?this._c=function(t,e,i,n){var o=Ge(a,t,e,i,n,c);return o&&!Array.isArray(o)&&(o.fnScopeId=u._scopeId,o.fnContext=r),o}:this._c=function(t,e,i,n){return Ge(a,t,e,i,n,c)}}function je(t,e,i,n,r){var o=wt(t);return o.fnContext=i,o.fnOptions=n,e.slot&&((o.data||(o.data={})).slot=e.slot),o}function Ne(t,e){for(var i in e)t[C(i)]=e[i]}$e(De.prototype);var Be={init:function(t,e){if(t.componentInstance&&!t.componentInstance._isDestroyed&&t.data.keepAlive){var i=t;Be.prepatch(i,i)}else{(t.componentInstance=function(t,e){var i={_isComponent:!0,_parentVnode:t,parent:e},n=t.data.inlineTemplate;o(n)&&(i.render=n.render,i.staticRenderFns=n.staticRenderFns);return new t.componentOptions.Ctor(i)}(t,ei)).$mount(e?t.elm:void 0,e)}},prepatch:function(t,e){var i=e.componentOptions;!function(t,e,i,r,o){0;var s=r.data.scopedSlots,a=t.$scopedSlots,l=!!(s&&!s.$stable||a!==n&&!a.$stable||s&&t.$scopedSlots.$key!==s.$key),u=!!(o||t.$options._renderChildren||l);t.$options._parentVnode=r,t.$vnode=r,t._vnode&&(t._vnode.parent=r);if(t.$options._renderChildren=o,t.$attrs=r.data.attrs||n,t.$listeners=i||n,e&&t.$options.props){Et(!1);for(var h=t._props,c=t.$options._propKeys||[],d=0;d<c.length;d++){var f=c[d],p=t.$options.props;h[f]=Ut(f,p,e,t)}Et(!0),t.$options.propsData=e}i=i||n;var g=t.$options._parentListeners;t.$options._parentListeners=i,ti(t,i,g),u&&(t.$slots=ve(o,r.context),t.$forceUpdate());0}(e.componentInstance=t.componentInstance,i.propsData,i.listeners,e,i.children)},insert:function(t){var e,i=t.context,n=t.componentInstance;n._isMounted||(n._isMounted=!0,si(n,"mounted")),t.data.keepAlive&&(i._isMounted?((e=n)._inactive=!1,li.push(e)):ri(n,!0))},destroy:function(t){var e=t.componentInstance;e._isDestroyed||(t.data.keepAlive?oi(e,!0):e.$destroy())}},Ue=Object.keys(Be);function ze(t,e,i,a,u){if(!r(t)){var h=i.$options._base;if(l(t)&&(t=h.extend(t)),"function"==typeof t){var c;if(r(t.cid)&&void 0===(t=function(t,e){if(s(t.error)&&o(t.errorComp))return t.errorComp;if(o(t.resolved))return t.resolved;var i=Ke;i&&o(t.owners)&&-1===t.owners.indexOf(i)&&t.owners.push(i);if(s(t.loading)&&o(t.loadingComp))return t.loadingComp;if(i&&!o(t.owners)){var n=t.owners=[i],a=!0,u=null,h=null;i.$on("hook:destroyed",(function(){return _(n,i)}));var c=function(t){for(var e=0,i=n.length;e<i;e++)n[e].$forceUpdate();t&&(n.length=0,null!==u&&(clearTimeout(u),u=null),null!==h&&(clearTimeout(h),h=null))},d=D((function(i){t.resolved=Xe(i,e),a?n.length=0:c(!0)})),p=D((function(e){o(t.errorComp)&&(t.error=!0,c(!0))})),g=t(d,p);return l(g)&&(f(g)?r(t.resolved)&&g.then(d,p):f(g.component)&&(g.component.then(d,p),o(g.error)&&(t.errorComp=Xe(g.error,e)),o(g.loading)&&(t.loadingComp=Xe(g.loading,e),0===g.delay?t.loading=!0:u=setTimeout((function(){u=null,r(t.resolved)&&r(t.error)&&(t.loading=!0,c(!1))}),g.delay||200)),o(g.timeout)&&(h=setTimeout((function(){h=null,r(t.resolved)&&p(null)}),g.timeout)))),a=!1,t.loading?t.loadingComp:t.resolved}}(c=t,h)))return function(t,e,i,n,r){var o=_t();return o.asyncFactory=t,o.asyncMeta={data:e,context:i,children:n,tag:r},o}(c,e,i,a,u);e=e||{},Ai(t),o(e.model)&&function(t,e){var i=t.model&&t.model.prop||"value",n=t.model&&t.model.event||"input";(e.attrs||(e.attrs={}))[i]=e.model.value;var r=e.on||(e.on={}),s=r[n],a=e.model.callback;o(s)?(Array.isArray(s)?-1===s.indexOf(a):s!==a)&&(r[n]=[a].concat(s)):r[n]=a}(t.options,e);var d=function(t,e,i){var n=e.options.props;if(!r(n)){var s={},a=t.attrs,l=t.props;if(o(a)||o(l))for(var u in n){var h=I(u);de(s,l,u,h,!0)||de(s,a,u,h,!1)}return s}}(e,t);if(s(t.options.functional))return function(t,e,i,r,s){var a=t.options,l={},u=a.props;if(o(u))for(var h in u)l[h]=Ut(h,u,e||n);else o(i.attrs)&&Ne(l,i.attrs),o(i.props)&&Ne(l,i.props);var c=new De(i,l,s,r,t),d=a.render.call(null,c._c,c);if(d instanceof vt)return je(d,i,c.parent,a);if(Array.isArray(d)){for(var f=fe(d)||[],p=new Array(f.length),g=0;g<f.length;g++)p[g]=je(f[g],i,c.parent,a);return p}}(t,d,e,i,a);var p=e.on;if(e.on=e.nativeOn,s(t.options.abstract)){var g=e.slot;e={},g&&(e.slot=g)}!function(t){for(var e=t.hook||(t.hook={}),i=0;i<Ue.length;i++){var n=Ue[i],r=e[n],o=Be[n];r===o||r&&r._merged||(e[n]=r?Ve(o,r):o)}}(e);var m=t.options.name||u;return new vt("vue-component-"+t.cid+(m?"-"+m:""),e,void 0,void 0,void 0,i,{Ctor:t,propsData:d,listeners:p,tag:u,children:a},c)}}}function Ve(t,e){var i=function(i,n){t(i,n),e(i,n)};return i._merged=!0,i}function Ge(t,e,i,n,r,u){return(Array.isArray(i)||a(i))&&(r=n,n=i,i=void 0),s(u)&&(r=2),function(t,e,i,n,r){if(o(i)&&o(i.__ob__))return _t();o(i)&&o(i.is)&&(e=i.is);if(!e)return _t();0;Array.isArray(n)&&"function"==typeof n[0]&&((i=i||{}).scopedSlots={default:n[0]},n.length=0);2===r?n=fe(n):1===r&&(n=function(t){for(var e=0;e<t.length;e++)if(Array.isArray(t[e]))return Array.prototype.concat.apply([],t);return t}(n));var s,a;if("string"==typeof e){var u;a=t.$vnode&&t.$vnode.ns||U.getTagNamespace(e),s=U.isReservedTag(e)?new vt(U.parsePlatformTagName(e),i,n,void 0,void 0,t):i&&i.pre||!o(u=Bt(t.$options,"components",e))?new vt(e,i,n,void 0,void 0,t):ze(u,i,t,n,e)}else s=ze(e,i,t,n);return Array.isArray(s)?s:o(s)?(o(a)&&qe(s,a),o(i)&&function(t){l(t.style)&&se(t.style);l(t.class)&&se(t.class)}(i),s):_t()}(t,e,i,n,r)}function qe(t,e,i){if(t.ns=e,"foreignObject"===t.tag&&(e=void 0,i=!0),o(t.children))for(var n=0,a=t.children.length;n<a;n++){var l=t.children[n];o(l.tag)&&(r(l.ns)||s(i)&&"svg"!==l.tag)&&qe(l,e,i)}}var We,Ke=null;function Xe(t,e){return(t.__esModule||ht&&"Module"===t[Symbol.toStringTag])&&(t=t.default),l(t)?e.extend(t):t}function Ye(t){return t.isComment&&t.asyncFactory}function He(t){if(Array.isArray(t))for(var e=0;e<t.length;e++){var i=t[e];if(o(i)&&(o(i.componentOptions)||Ye(i)))return i}}function Ze(t,e){We.$on(t,e)}function Je(t,e){We.$off(t,e)}function Qe(t,e){var i=We;return function n(){var r=e.apply(null,arguments);null!==r&&i.$off(t,n)}}function ti(t,e,i){We=t,he(e,i||{},Ze,Je,Qe,t),We=void 0}var ei=null;function ii(t){var e=ei;return ei=t,function(){ei=e}}function ni(t){for(;t&&(t=t.$parent);)if(t._inactive)return!0;return!1}function ri(t,e){if(e){if(t._directInactive=!1,ni(t))return}else if(t._directInactive)return;if(t._inactive||null===t._inactive){t._inactive=!1;for(var i=0;i<t.$children.length;i++)ri(t.$children[i]);si(t,"activated")}}function oi(t,e){if(!(e&&(t._directInactive=!0,ni(t))||t._inactive)){t._inactive=!0;for(var i=0;i<t.$children.length;i++)oi(t.$children[i]);si(t,"deactivated")}}function si(t,e){gt();var i=t.$options[e],n=e+" hook";if(i)for(var r=0,o=i.length;r<o;r++)Wt(i[r],t,null,t,n);t._hasHookEvent&&t.$emit("hook:"+e),mt()}var ai=[],li=[],ui={},hi=!1,ci=!1,di=0;var fi=0,pi=Date.now;if(X&&!J){var gi=window.performance;gi&&"function"==typeof gi.now&&pi()>document.createEvent("Event").timeStamp&&(pi=function(){return gi.now()})}function mi(){var t,e;for(fi=pi(),ci=!0,ai.sort((function(t,e){return t.id-e.id})),di=0;di<ai.length;di++)(t=ai[di]).before&&t.before(),e=t.id,ui[e]=null,t.run();var i=li.slice(),n=ai.slice();di=ai.length=li.length=0,ui={},hi=ci=!1,function(t){for(var e=0;e<t.length;e++)t[e]._inactive=!0,ri(t[e],!0)}(i),function(t){var e=t.length;for(;e--;){var i=t[e],n=i.vm;n._watcher===i&&n._isMounted&&!n._isDestroyed&&si(n,"updated")}}(n),at&&U.devtools&&at.emit("flush")}var vi=0,yi=function(t,e,i,n,r){this.vm=t,r&&(t._watcher=this),t._watchers.push(this),n?(this.deep=!!n.deep,this.user=!!n.user,this.lazy=!!n.lazy,this.sync=!!n.sync,this.before=n.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=i,this.id=++vi,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new ut,this.newDepIds=new ut,this.expression="","function"==typeof e?this.getter=e:(this.getter=function(t){if(!q.test(t)){var e=t.split(".");return function(t){for(var i=0;i<e.length;i++){if(!t)return;t=t[e[i]]}return t}}}(e),this.getter||(this.getter=L)),this.value=this.lazy?void 0:this.get()};yi.prototype.get=function(){var t;gt(this);var e=this.vm;try{t=this.getter.call(e,e)}catch(t){if(!this.user)throw t;qt(t,e,'getter for watcher "'+this.expression+'"')}finally{this.deep&&se(t),mt(),this.cleanupDeps()}return t},yi.prototype.addDep=function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))},yi.prototype.cleanupDeps=function(){for(var t=this.deps.length;t--;){var e=this.deps[t];this.newDepIds.has(e.id)||e.removeSub(this)}var i=this.depIds;this.depIds=this.newDepIds,this.newDepIds=i,this.newDepIds.clear(),i=this.deps,this.deps=this.newDeps,this.newDeps=i,this.newDeps.length=0},yi.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():function(t){var e=t.id;if(null==ui[e]){if(ui[e]=!0,ci){for(var i=ai.length-1;i>di&&ai[i].id>t.id;)i--;ai.splice(i+1,0,t)}else ai.push(t);hi||(hi=!0,re(mi))}}(this)},yi.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||l(t)||this.deep){var e=this.value;if(this.value=t,this.user)try{this.cb.call(this.vm,t,e)}catch(t){qt(t,this.vm,'callback for watcher "'+this.expression+'"')}else this.cb.call(this.vm,t,e)}}},yi.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},yi.prototype.depend=function(){for(var t=this.deps.length;t--;)this.deps[t].depend()},yi.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||_(this.vm._watchers,this);for(var t=this.deps.length;t--;)this.deps[t].removeSub(this);this.active=!1}};var _i={enumerable:!0,configurable:!0,get:L,set:L};function bi(t,e,i){_i.get=function(){return this[e][i]},_i.set=function(t){this[e][i]=t},Object.defineProperty(t,i,_i)}function wi(t){t._watchers=[];var e=t.$options;e.props&&function(t,e){var i=t.$options.propsData||{},n=t._props={},r=t.$options._propKeys=[];t.$parent&&Et(!1);var o=function(o){r.push(o);var s=Ut(o,e,i,t);Pt(n,o,s),o in t||bi(t,"_props",o)};for(var s in e)o(s);Et(!0)}(t,e.props),e.methods&&function(t,e){t.$options.props;for(var i in e)t[i]="function"!=typeof e[i]?L:A(e[i],t)}(t,e.methods),e.data?function(t){var e=t.$options.data;h(e=t._data="function"==typeof e?function(t,e){gt();try{return t.call(e,e)}catch(t){return qt(t,e,"data()"),{}}finally{mt()}}(e,t):e||{})||(e={});var i=Object.keys(e),n=t.$options.props,r=(t.$options.methods,i.length);for(;r--;){var o=i[r];0,n&&w(n,o)||V(o)||bi(t,"_data",o)}At(e,!0)}(t):At(t._data={},!0),e.computed&&function(t,e){var i=t._computedWatchers=Object.create(null),n=st();for(var r in e){var o=e[r],s="function"==typeof o?o:o.get;0,n||(i[r]=new yi(t,s||L,L,xi)),r in t||Si(t,r,o)}}(t,e.computed),e.watch&&e.watch!==nt&&function(t,e){for(var i in e){var n=e[i];if(Array.isArray(n))for(var r=0;r<n.length;r++)Ei(t,i,n[r]);else Ei(t,i,n)}}(t,e.watch)}var xi={lazy:!0};function Si(t,e,i){var n=!st();"function"==typeof i?(_i.get=n?Ci(e):Ti(i),_i.set=L):(_i.get=i.get?n&&!1!==i.cache?Ci(e):Ti(i.get):L,_i.set=i.set||L),Object.defineProperty(t,e,_i)}function Ci(t){return function(){var e=this._computedWatchers&&this._computedWatchers[t];if(e)return e.dirty&&e.evaluate(),ft.target&&e.depend(),e.value}}function Ti(t){return function(){return t.call(this,this)}}function Ei(t,e,i,n){return h(i)&&(n=i,i=i.handler),"string"==typeof i&&(i=t[i]),t.$watch(e,i,n)}var Ii=0;function Ai(t){var e=t.options;if(t.super){var i=Ai(t.super);if(i!==t.superOptions){t.superOptions=i;var n=function(t){var e,i=t.options,n=t.sealedOptions;for(var r in i)i[r]!==n[r]&&(e||(e={}),e[r]=i[r]);return e}(t);n&&k(t.extendOptions,n),(e=t.options=Nt(i,t.extendOptions)).name&&(e.components[e.name]=t)}}return e}function Pi(t){this._init(t)}function ki(t){t.cid=0;var e=1;t.extend=function(t){t=t||{};var i=this,n=i.cid,r=t._Ctor||(t._Ctor={});if(r[n])return r[n];var o=t.name||i.options.name;var s=function(t){this._init(t)};return(s.prototype=Object.create(i.prototype)).constructor=s,s.cid=e++,s.options=Nt(i.options,t),s.super=i,s.options.props&&function(t){var e=t.options.props;for(var i in e)bi(t.prototype,"_props",i)}(s),s.options.computed&&function(t){var e=t.options.computed;for(var i in e)Si(t.prototype,i,e[i])}(s),s.extend=i.extend,s.mixin=i.mixin,s.use=i.use,N.forEach((function(t){s[t]=i[t]})),o&&(s.options.components[o]=s),s.superOptions=i.options,s.extendOptions=t,s.sealedOptions=k({},s.options),r[n]=s,s}}function Ri(t){return t&&(t.Ctor.options.name||t.tag)}function Li(t,e){return Array.isArray(t)?t.indexOf(e)>-1:"string"==typeof t?t.split(",").indexOf(e)>-1:!!c(t)&&t.test(e)}function Fi(t,e){var i=t.cache,n=t.keys,r=t._vnode;for(var o in i){var s=i[o];if(s){var a=Ri(s.componentOptions);a&&!e(a)&&Mi(i,o,n,r)}}}function Mi(t,e,i,n){var r=t[e];!r||n&&r.tag===n.tag||r.componentInstance.$destroy(),t[e]=null,_(i,e)}!function(t){t.prototype._init=function(t){var e=this;e._uid=Ii++,e._isVue=!0,t&&t._isComponent?function(t,e){var i=t.$options=Object.create(t.constructor.options),n=e._parentVnode;i.parent=e.parent,i._parentVnode=n;var r=n.componentOptions;i.propsData=r.propsData,i._parentListeners=r.listeners,i._renderChildren=r.children,i._componentTag=r.tag,e.render&&(i.render=e.render,i.staticRenderFns=e.staticRenderFns)}(e,t):e.$options=Nt(Ai(e.constructor),t||{},e),e._renderProxy=e,e._self=e,function(t){var e=t.$options,i=e.parent;if(i&&!e.abstract){for(;i.$options.abstract&&i.$parent;)i=i.$parent;i.$children.push(t)}t.$parent=i,t.$root=i?i.$root:t,t.$children=[],t.$refs={},t._watcher=null,t._inactive=null,t._directInactive=!1,t._isMounted=!1,t._isDestroyed=!1,t._isBeingDestroyed=!1}(e),function(t){t._events=Object.create(null),t._hasHookEvent=!1;var e=t.$options._parentListeners;e&&ti(t,e)}(e),function(t){t._vnode=null,t._staticTrees=null;var e=t.$options,i=t.$vnode=e._parentVnode,r=i&&i.context;t.$slots=ve(e._renderChildren,r),t.$scopedSlots=n,t._c=function(e,i,n,r){return Ge(t,e,i,n,r,!1)},t.$createElement=function(e,i,n,r){return Ge(t,e,i,n,r,!0)};var o=i&&i.data;Pt(t,"$attrs",o&&o.attrs||n,null,!0),Pt(t,"$listeners",e._parentListeners||n,null,!0)}(e),si(e,"beforeCreate"),function(t){var e=me(t.$options.inject,t);e&&(Et(!1),Object.keys(e).forEach((function(i){Pt(t,i,e[i])})),Et(!0))}(e),wi(e),function(t){var e=t.$options.provide;e&&(t._provided="function"==typeof e?e.call(t):e)}(e),si(e,"created"),e.$options.el&&e.$mount(e.$options.el)}}(Pi),function(t){var e={get:function(){return this._data}},i={get:function(){return this._props}};Object.defineProperty(t.prototype,"$data",e),Object.defineProperty(t.prototype,"$props",i),t.prototype.$set=kt,t.prototype.$delete=Rt,t.prototype.$watch=function(t,e,i){var n=this;if(h(e))return Ei(n,t,e,i);(i=i||{}).user=!0;var r=new yi(n,t,e,i);if(i.immediate)try{e.call(n,r.value)}catch(t){qt(t,n,'callback for immediate watcher "'+r.expression+'"')}return function(){r.teardown()}}}(Pi),function(t){var e=/^hook:/;t.prototype.$on=function(t,i){var n=this;if(Array.isArray(t))for(var r=0,o=t.length;r<o;r++)n.$on(t[r],i);else(n._events[t]||(n._events[t]=[])).push(i),e.test(t)&&(n._hasHookEvent=!0);return n},t.prototype.$once=function(t,e){var i=this;function n(){i.$off(t,n),e.apply(i,arguments)}return n.fn=e,i.$on(t,n),i},t.prototype.$off=function(t,e){var i=this;if(!arguments.length)return i._events=Object.create(null),i;if(Array.isArray(t)){for(var n=0,r=t.length;n<r;n++)i.$off(t[n],e);return i}var o,s=i._events[t];if(!s)return i;if(!e)return i._events[t]=null,i;for(var a=s.length;a--;)if((o=s[a])===e||o.fn===e){s.splice(a,1);break}return i},t.prototype.$emit=function(t){var e=this,i=e._events[t];if(i){i=i.length>1?P(i):i;for(var n=P(arguments,1),r='event handler for "'+t+'"',o=0,s=i.length;o<s;o++)Wt(i[o],e,n,e,r)}return e}}(Pi),function(t){t.prototype._update=function(t,e){var i=this,n=i.$el,r=i._vnode,o=ii(i);i._vnode=t,i.$el=r?i.__patch__(r,t):i.__patch__(i.$el,t,e,!1),o(),n&&(n.__vue__=null),i.$el&&(i.$el.__vue__=i),i.$vnode&&i.$parent&&i.$vnode===i.$parent._vnode&&(i.$parent.$el=i.$el)},t.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},t.prototype.$destroy=function(){var t=this;if(!t._isBeingDestroyed){si(t,"beforeDestroy"),t._isBeingDestroyed=!0;var e=t.$parent;!e||e._isBeingDestroyed||t.$options.abstract||_(e.$children,t),t._watcher&&t._watcher.teardown();for(var i=t._watchers.length;i--;)t._watchers[i].teardown();t._data.__ob__&&t._data.__ob__.vmCount--,t._isDestroyed=!0,t.__patch__(t._vnode,null),si(t,"destroyed"),t.$off(),t.$el&&(t.$el.__vue__=null),t.$vnode&&(t.$vnode.parent=null)}}}(Pi),function(t){$e(t.prototype),t.prototype.$nextTick=function(t){return re(t,this)},t.prototype._render=function(){var t,e=this,i=e.$options,n=i.render,r=i._parentVnode;r&&(e.$scopedSlots=_e(r.data.scopedSlots,e.$slots,e.$scopedSlots)),e.$vnode=r;try{Ke=e,t=n.call(e._renderProxy,e.$createElement)}catch(i){qt(i,e,"render"),t=e._vnode}finally{Ke=null}return Array.isArray(t)&&1===t.length&&(t=t[0]),t instanceof vt||(t=_t()),t.parent=r,t}}(Pi);var Oi=[String,RegExp,Array],$i={KeepAlive:{name:"keep-alive",abstract:!0,props:{include:Oi,exclude:Oi,max:[String,Number]},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var t in this.cache)Mi(this.cache,t,this.keys)},mounted:function(){var t=this;this.$watch("include",(function(e){Fi(t,(function(t){return Li(e,t)}))})),this.$watch("exclude",(function(e){Fi(t,(function(t){return!Li(e,t)}))}))},render:function(){var t=this.$slots.default,e=He(t),i=e&&e.componentOptions;if(i){var n=Ri(i),r=this.include,o=this.exclude;if(r&&(!n||!Li(r,n))||o&&n&&Li(o,n))return e;var s=this.cache,a=this.keys,l=null==e.key?i.Ctor.cid+(i.tag?"::"+i.tag:""):e.key;s[l]?(e.componentInstance=s[l].componentInstance,_(a,l),a.push(l)):(s[l]=e,a.push(l),this.max&&a.length>parseInt(this.max)&&Mi(s,a[0],a,this._vnode)),e.data.keepAlive=!0}return e||t&&t[0]}}};!function(t){var e={get:function(){return U}};Object.defineProperty(t,"config",e),t.util={warn:ct,extend:k,mergeOptions:Nt,defineReactive:Pt},t.set=kt,t.delete=Rt,t.nextTick=re,t.observable=function(t){return At(t),t},t.options=Object.create(null),N.forEach((function(e){t.options[e+"s"]=Object.create(null)})),t.options._base=t,k(t.options.components,$i),function(t){t.use=function(t){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(t)>-1)return this;var i=P(arguments,1);return i.unshift(this),"function"==typeof t.install?t.install.apply(t,i):"function"==typeof t&&t.apply(null,i),e.push(t),this}}(t),function(t){t.mixin=function(t){return this.options=Nt(this.options,t),this}}(t),ki(t),function(t){N.forEach((function(e){t[e]=function(t,i){return i?("component"===e&&h(i)&&(i.name=i.name||t,i=this.options._base.extend(i)),"directive"===e&&"function"==typeof i&&(i={bind:i,update:i}),this.options[e+"s"][t]=i,i):this.options[e+"s"][t]}}))}(t)}(Pi),Object.defineProperty(Pi.prototype,"$isServer",{get:st}),Object.defineProperty(Pi.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(Pi,"FunctionalRenderContext",{value:De}),Pi.version="2.6.12";var Di=m("style,class"),ji=m("input,textarea,option,select,progress"),Ni=function(t,e,i){return"value"===i&&ji(t)&&"button"!==e||"selected"===i&&"option"===t||"checked"===i&&"input"===t||"muted"===i&&"video"===t},Bi=m("contenteditable,draggable,spellcheck"),Ui=m("events,caret,typing,plaintext-only"),zi=m("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,translate,truespeed,typemustmatch,visible"),Vi="http://www.w3.org/1999/xlink",Gi=function(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)},qi=function(t){return Gi(t)?t.slice(6,t.length):""},Wi=function(t){return null==t||!1===t};function Ki(t){for(var e=t.data,i=t,n=t;o(n.componentInstance);)(n=n.componentInstance._vnode)&&n.data&&(e=Xi(n.data,e));for(;o(i=i.parent);)i&&i.data&&(e=Xi(e,i.data));return function(t,e){if(o(t)||o(e))return Yi(t,Hi(e));return""}(e.staticClass,e.class)}function Xi(t,e){return{staticClass:Yi(t.staticClass,e.staticClass),class:o(t.class)?[t.class,e.class]:e.class}}function Yi(t,e){return t?e?t+" "+e:t:e||""}function Hi(t){return Array.isArray(t)?function(t){for(var e,i="",n=0,r=t.length;n<r;n++)o(e=Hi(t[n]))&&""!==e&&(i&&(i+=" "),i+=e);return i}(t):l(t)?function(t){var e="";for(var i in t)t[i]&&(e&&(e+=" "),e+=i);return e}(t):"string"==typeof t?t:""}var Zi={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},Ji=m("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),Qi=m("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignObject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),tn=function(t){return Ji(t)||Qi(t)};function en(t){return Qi(t)?"svg":"math"===t?"math":void 0}var nn=Object.create(null);var rn=m("text,number,password,search,email,tel,url");function on(t){if("string"==typeof t){var e=document.querySelector(t);return e||document.createElement("div")}return t}var sn=Object.freeze({createElement:function(t,e){var i=document.createElement(t);return"select"!==t||e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&i.setAttribute("multiple","multiple"),i},createElementNS:function(t,e){return document.createElementNS(Zi[t],e)},createTextNode:function(t){return document.createTextNode(t)},createComment:function(t){return document.createComment(t)},insertBefore:function(t,e,i){t.insertBefore(e,i)},removeChild:function(t,e){t.removeChild(e)},appendChild:function(t,e){t.appendChild(e)},parentNode:function(t){return t.parentNode},nextSibling:function(t){return t.nextSibling},tagName:function(t){return t.tagName},setTextContent:function(t,e){t.textContent=e},setStyleScope:function(t,e){t.setAttribute(e,"")}}),an={create:function(t,e){ln(e)},update:function(t,e){t.data.ref!==e.data.ref&&(ln(t,!0),ln(e))},destroy:function(t){ln(t,!0)}};function ln(t,e){var i=t.data.ref;if(o(i)){var n=t.context,r=t.componentInstance||t.elm,s=n.$refs;e?Array.isArray(s[i])?_(s[i],r):s[i]===r&&(s[i]=void 0):t.data.refInFor?Array.isArray(s[i])?s[i].indexOf(r)<0&&s[i].push(r):s[i]=[r]:s[i]=r}}var un=new vt("",{},[]),hn=["create","activate","update","remove","destroy"];function cn(t,e){return t.key===e.key&&(t.tag===e.tag&&t.isComment===e.isComment&&o(t.data)===o(e.data)&&function(t,e){if("input"!==t.tag)return!0;var i,n=o(i=t.data)&&o(i=i.attrs)&&i.type,r=o(i=e.data)&&o(i=i.attrs)&&i.type;return n===r||rn(n)&&rn(r)}(t,e)||s(t.isAsyncPlaceholder)&&t.asyncFactory===e.asyncFactory&&r(e.asyncFactory.error))}function dn(t,e,i){var n,r,s={};for(n=e;n<=i;++n)o(r=t[n].key)&&(s[r]=n);return s}var fn={create:pn,update:pn,destroy:function(t){pn(t,un)}};function pn(t,e){(t.data.directives||e.data.directives)&&function(t,e){var i,n,r,o=t===un,s=e===un,a=mn(t.data.directives,t.context),l=mn(e.data.directives,e.context),u=[],h=[];for(i in l)n=a[i],r=l[i],n?(r.oldValue=n.value,r.oldArg=n.arg,yn(r,"update",e,t),r.def&&r.def.componentUpdated&&h.push(r)):(yn(r,"bind",e,t),r.def&&r.def.inserted&&u.push(r));if(u.length){var c=function(){for(var i=0;i<u.length;i++)yn(u[i],"inserted",e,t)};o?ce(e,"insert",c):c()}h.length&&ce(e,"postpatch",(function(){for(var i=0;i<h.length;i++)yn(h[i],"componentUpdated",e,t)}));if(!o)for(i in a)l[i]||yn(a[i],"unbind",t,t,s)}(t,e)}var gn=Object.create(null);function mn(t,e){var i,n,r=Object.create(null);if(!t)return r;for(i=0;i<t.length;i++)(n=t[i]).modifiers||(n.modifiers=gn),r[vn(n)]=n,n.def=Bt(e.$options,"directives",n.name);return r}function vn(t){return t.rawName||t.name+"."+Object.keys(t.modifiers||{}).join(".")}function yn(t,e,i,n,r){var o=t.def&&t.def[e];if(o)try{o(i.elm,t,i,n,r)}catch(n){qt(n,i.context,"directive "+t.name+" "+e+" hook")}}var _n=[an,fn];function bn(t,e){var i=e.componentOptions;if(!(o(i)&&!1===i.Ctor.options.inheritAttrs||r(t.data.attrs)&&r(e.data.attrs))){var n,s,a=e.elm,l=t.data.attrs||{},u=e.data.attrs||{};for(n in o(u.__ob__)&&(u=e.data.attrs=k({},u)),u)s=u[n],l[n]!==s&&wn(a,n,s);for(n in(J||tt)&&u.value!==l.value&&wn(a,"value",u.value),l)r(u[n])&&(Gi(n)?a.removeAttributeNS(Vi,qi(n)):Bi(n)||a.removeAttribute(n))}}function wn(t,e,i){t.tagName.indexOf("-")>-1?xn(t,e,i):zi(e)?Wi(i)?t.removeAttribute(e):(i="allowfullscreen"===e&&"EMBED"===t.tagName?"true":e,t.setAttribute(e,i)):Bi(e)?t.setAttribute(e,function(t,e){return Wi(e)||"false"===e?"false":"contenteditable"===t&&Ui(e)?e:"true"}(e,i)):Gi(e)?Wi(i)?t.removeAttributeNS(Vi,qi(e)):t.setAttributeNS(Vi,e,i):xn(t,e,i)}function xn(t,e,i){if(Wi(i))t.removeAttribute(e);else{if(J&&!Q&&"TEXTAREA"===t.tagName&&"placeholder"===e&&""!==i&&!t.__ieph){var n=function(e){e.stopImmediatePropagation(),t.removeEventListener("input",n)};t.addEventListener("input",n),t.__ieph=!0}t.setAttribute(e,i)}}var Sn={create:bn,update:bn};function Cn(t,e){var i=e.elm,n=e.data,s=t.data;if(!(r(n.staticClass)&&r(n.class)&&(r(s)||r(s.staticClass)&&r(s.class)))){var a=Ki(e),l=i._transitionClasses;o(l)&&(a=Yi(a,Hi(l))),a!==i._prevClass&&(i.setAttribute("class",a),i._prevClass=a)}}var Tn,En,In,An,Pn,kn,Rn={create:Cn,update:Cn},Ln=/[\w).+\-_$\]]/;function Fn(t){var e,i,n,r,o,s=!1,a=!1,l=!1,u=!1,h=0,c=0,d=0,f=0;for(n=0;n<t.length;n++)if(i=e,e=t.charCodeAt(n),s)39===e&&92!==i&&(s=!1);else if(a)34===e&&92!==i&&(a=!1);else if(l)96===e&&92!==i&&(l=!1);else if(u)47===e&&92!==i&&(u=!1);else if(124!==e||124===t.charCodeAt(n+1)||124===t.charCodeAt(n-1)||h||c||d){switch(e){case 34:a=!0;break;case 39:s=!0;break;case 96:l=!0;break;case 40:d++;break;case 41:d--;break;case 91:c++;break;case 93:c--;break;case 123:h++;break;case 125:h--}if(47===e){for(var p=n-1,g=void 0;p>=0&&" "===(g=t.charAt(p));p--);g&&Ln.test(g)||(u=!0)}}else void 0===r?(f=n+1,r=t.slice(0,n).trim()):m();function m(){(o||(o=[])).push(t.slice(f,n).trim()),f=n+1}if(void 0===r?r=t.slice(0,n).trim():0!==f&&m(),o)for(n=0;n<o.length;n++)r=Mn(r,o[n]);return r}function Mn(t,e){var i=e.indexOf("(");if(i<0)return'_f("'+e+'")('+t+")";var n=e.slice(0,i),r=e.slice(i+1);return'_f("'+n+'")('+t+(")"!==r?","+r:r)}function On(t,e){console.error("[Vue compiler]: "+t)}function $n(t,e){return t?t.map((function(t){return t[e]})).filter((function(t){return t})):[]}function Dn(t,e,i,n,r){(t.props||(t.props=[])).push(Wn({name:e,value:i,dynamic:r},n)),t.plain=!1}function jn(t,e,i,n,r){(r?t.dynamicAttrs||(t.dynamicAttrs=[]):t.attrs||(t.attrs=[])).push(Wn({name:e,value:i,dynamic:r},n)),t.plain=!1}function Nn(t,e,i,n){t.attrsMap[e]=i,t.attrsList.push(Wn({name:e,value:i},n))}function Bn(t,e,i,n,r,o,s,a){(t.directives||(t.directives=[])).push(Wn({name:e,rawName:i,value:n,arg:r,isDynamicArg:o,modifiers:s},a)),t.plain=!1}function Un(t,e,i){return i?"_p("+e+',"'+t+'")':t+e}function zn(t,e,i,r,o,s,a,l){var u;(r=r||n).right?l?e="("+e+")==='click'?'contextmenu':("+e+")":"click"===e&&(e="contextmenu",delete r.right):r.middle&&(l?e="("+e+")==='click'?'mouseup':("+e+")":"click"===e&&(e="mouseup")),r.capture&&(delete r.capture,e=Un("!",e,l)),r.once&&(delete r.once,e=Un("~",e,l)),r.passive&&(delete r.passive,e=Un("&",e,l)),r.native?(delete r.native,u=t.nativeEvents||(t.nativeEvents={})):u=t.events||(t.events={});var h=Wn({value:i.trim(),dynamic:l},a);r!==n&&(h.modifiers=r);var c=u[e];Array.isArray(c)?o?c.unshift(h):c.push(h):u[e]=c?o?[h,c]:[c,h]:h,t.plain=!1}function Vn(t,e,i){var n=Gn(t,":"+e)||Gn(t,"v-bind:"+e);if(null!=n)return Fn(n);if(!1!==i){var r=Gn(t,e);if(null!=r)return JSON.stringify(r)}}function Gn(t,e,i){var n;if(null!=(n=t.attrsMap[e]))for(var r=t.attrsList,o=0,s=r.length;o<s;o++)if(r[o].name===e){r.splice(o,1);break}return i&&delete t.attrsMap[e],n}function qn(t,e){for(var i=t.attrsList,n=0,r=i.length;n<r;n++){var o=i[n];if(e.test(o.name))return i.splice(n,1),o}}function Wn(t,e){return e&&(null!=e.start&&(t.start=e.start),null!=e.end&&(t.end=e.end)),t}function Kn(t,e,i){var n=i||{},r=n.number,o="$$v",s=o;n.trim&&(s="(typeof $$v === 'string'? $$v.trim(): $$v)"),r&&(s="_n("+s+")");var a=Xn(e,s);t.model={value:"("+e+")",expression:JSON.stringify(e),callback:"function ($$v) {"+a+"}"}}function Xn(t,e){var i=function(t){if(t=t.trim(),Tn=t.length,t.indexOf("[")<0||t.lastIndexOf("]")<Tn-1)return(An=t.lastIndexOf("."))>-1?{exp:t.slice(0,An),key:'"'+t.slice(An+1)+'"'}:{exp:t,key:null};En=t,An=Pn=kn=0;for(;!Hn();)Zn(In=Yn())?Qn(In):91===In&&Jn(In);return{exp:t.slice(0,Pn),key:t.slice(Pn+1,kn)}}(t);return null===i.key?t+"="+e:"$set("+i.exp+", "+i.key+", "+e+")"}function Yn(){return En.charCodeAt(++An)}function Hn(){return An>=Tn}function Zn(t){return 34===t||39===t}function Jn(t){var e=1;for(Pn=An;!Hn();)if(Zn(t=Yn()))Qn(t);else if(91===t&&e++,93===t&&e--,0===e){kn=An;break}}function Qn(t){for(var e=t;!Hn()&&(t=Yn())!==e;);}var tr,er="__r";function ir(t,e,i){var n=tr;return function r(){var o=e.apply(null,arguments);null!==o&&or(t,r,i,n)}}var nr=Ht&&!(it&&Number(it[1])<=53);function rr(t,e,i,n){if(nr){var r=fi,o=e;e=o._wrapper=function(t){if(t.target===t.currentTarget||t.timeStamp>=r||t.timeStamp<=0||t.target.ownerDocument!==document)return o.apply(this,arguments)}}tr.addEventListener(t,e,rt?{capture:i,passive:n}:i)}function or(t,e,i,n){(n||tr).removeEventListener(t,e._wrapper||e,i)}function sr(t,e){if(!r(t.data.on)||!r(e.data.on)){var i=e.data.on||{},n=t.data.on||{};tr=e.elm,function(t){if(o(t.__r)){var e=J?"change":"input";t[e]=[].concat(t.__r,t[e]||[]),delete t.__r}o(t.__c)&&(t.change=[].concat(t.__c,t.change||[]),delete t.__c)}(i),he(i,n,rr,or,ir,e.context),tr=void 0}}var ar,lr={create:sr,update:sr};function ur(t,e){if(!r(t.data.domProps)||!r(e.data.domProps)){var i,n,s=e.elm,a=t.data.domProps||{},l=e.data.domProps||{};for(i in o(l.__ob__)&&(l=e.data.domProps=k({},l)),a)i in l||(s[i]="");for(i in l){if(n=l[i],"textContent"===i||"innerHTML"===i){if(e.children&&(e.children.length=0),n===a[i])continue;1===s.childNodes.length&&s.removeChild(s.childNodes[0])}if("value"===i&&"PROGRESS"!==s.tagName){s._value=n;var u=r(n)?"":String(n);hr(s,u)&&(s.value=u)}else if("innerHTML"===i&&Qi(s.tagName)&&r(s.innerHTML)){(ar=ar||document.createElement("div")).innerHTML="<svg>"+n+"</svg>";for(var h=ar.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;h.firstChild;)s.appendChild(h.firstChild)}else if(n!==a[i])try{s[i]=n}catch(t){}}}}function hr(t,e){return!t.composing&&("OPTION"===t.tagName||function(t,e){var i=!0;try{i=document.activeElement!==t}catch(t){}return i&&t.value!==e}(t,e)||function(t,e){var i=t.value,n=t._vModifiers;if(o(n)){if(n.number)return g(i)!==g(e);if(n.trim)return i.trim()!==e.trim()}return i!==e}(t,e))}var cr={create:ur,update:ur},dr=x((function(t){var e={},i=/:(.+)/;return t.split(/;(?![^(]*\))/g).forEach((function(t){if(t){var n=t.split(i);n.length>1&&(e[n[0].trim()]=n[1].trim())}})),e}));function fr(t){var e=pr(t.style);return t.staticStyle?k(t.staticStyle,e):e}function pr(t){return Array.isArray(t)?R(t):"string"==typeof t?dr(t):t}var gr,mr=/^--/,vr=/\s*!important$/,yr=function(t,e,i){if(mr.test(e))t.style.setProperty(e,i);else if(vr.test(i))t.style.setProperty(I(e),i.replace(vr,""),"important");else{var n=br(e);if(Array.isArray(i))for(var r=0,o=i.length;r<o;r++)t.style[n]=i[r];else t.style[n]=i}},_r=["Webkit","Moz","ms"],br=x((function(t){if(gr=gr||document.createElement("div").style,"filter"!==(t=C(t))&&t in gr)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<_r.length;i++){var n=_r[i]+e;if(n in gr)return n}}));function wr(t,e){var i=e.data,n=t.data;if(!(r(i.staticStyle)&&r(i.style)&&r(n.staticStyle)&&r(n.style))){var s,a,l=e.elm,u=n.staticStyle,h=n.normalizedStyle||n.style||{},c=u||h,d=pr(e.data.style)||{};e.data.normalizedStyle=o(d.__ob__)?k({},d):d;var f=function(t,e){var i,n={};if(e)for(var r=t;r.componentInstance;)(r=r.componentInstance._vnode)&&r.data&&(i=fr(r.data))&&k(n,i);(i=fr(t.data))&&k(n,i);for(var o=t;o=o.parent;)o.data&&(i=fr(o.data))&&k(n,i);return n}(e,!0);for(a in c)r(f[a])&&yr(l,a,"");for(a in f)(s=f[a])!==c[a]&&yr(l,a,null==s?"":s)}}var xr={create:wr,update:wr},Sr=/\s+/;function Cr(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(Sr).forEach((function(e){return t.classList.add(e)})):t.classList.add(e);else{var i=" "+(t.getAttribute("class")||"")+" ";i.indexOf(" "+e+" ")<0&&t.setAttribute("class",(i+e).trim())}}function Tr(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(Sr).forEach((function(e){return t.classList.remove(e)})):t.classList.remove(e),t.classList.length||t.removeAttribute("class");else{for(var i=" "+(t.getAttribute("class")||"")+" ",n=" "+e+" ";i.indexOf(n)>=0;)i=i.replace(n," ");(i=i.trim())?t.setAttribute("class",i):t.removeAttribute("class")}}function Er(t){if(t){if("object"==typeof t){var e={};return!1!==t.css&&k(e,Ir(t.name||"v")),k(e,t),e}return"string"==typeof t?Ir(t):void 0}}var Ir=x((function(t){return{enterClass:t+"-enter",enterToClass:t+"-enter-to",enterActiveClass:t+"-enter-active",leaveClass:t+"-leave",leaveToClass:t+"-leave-to",leaveActiveClass:t+"-leave-active"}})),Ar=X&&!Q,Pr="transition",kr="animation",Rr="transition",Lr="transitionend",Fr="animation",Mr="animationend";Ar&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(Rr="WebkitTransition",Lr="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Fr="WebkitAnimation",Mr="webkitAnimationEnd"));var Or=X?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(t){return t()};function $r(t){Or((function(){Or(t)}))}function Dr(t,e){var i=t._transitionClasses||(t._transitionClasses=[]);i.indexOf(e)<0&&(i.push(e),Cr(t,e))}function jr(t,e){t._transitionClasses&&_(t._transitionClasses,e),Tr(t,e)}function Nr(t,e,i){var n=Ur(t,e),r=n.type,o=n.timeout,s=n.propCount;if(!r)return i();var a=r===Pr?Lr:Mr,l=0,u=function(){t.removeEventListener(a,h),i()},h=function(e){e.target===t&&++l>=s&&u()};setTimeout((function(){l<s&&u()}),o+1),t.addEventListener(a,h)}var Br=/\b(transform|all)(,|$)/;function Ur(t,e){var i,n=window.getComputedStyle(t),r=(n[Rr+"Delay"]||"").split(", "),o=(n[Rr+"Duration"]||"").split(", "),s=zr(r,o),a=(n[Fr+"Delay"]||"").split(", "),l=(n[Fr+"Duration"]||"").split(", "),u=zr(a,l),h=0,c=0;return e===Pr?s>0&&(i=Pr,h=s,c=o.length):e===kr?u>0&&(i=kr,h=u,c=l.length):c=(i=(h=Math.max(s,u))>0?s>u?Pr:kr:null)?i===Pr?o.length:l.length:0,{type:i,timeout:h,propCount:c,hasTransform:i===Pr&&Br.test(n[Rr+"Property"])}}function zr(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max.apply(null,e.map((function(e,i){return Vr(e)+Vr(t[i])})))}function Vr(t){return 1e3*Number(t.slice(0,-1).replace(",","."))}function Gr(t,e){var i=t.elm;o(i._leaveCb)&&(i._leaveCb.cancelled=!0,i._leaveCb());var n=Er(t.data.transition);if(!r(n)&&!o(i._enterCb)&&1===i.nodeType){for(var s=n.css,a=n.type,u=n.enterClass,h=n.enterToClass,c=n.enterActiveClass,d=n.appearClass,f=n.appearToClass,p=n.appearActiveClass,m=n.beforeEnter,v=n.enter,y=n.afterEnter,_=n.enterCancelled,b=n.beforeAppear,w=n.appear,x=n.afterAppear,S=n.appearCancelled,C=n.duration,T=ei,E=ei.$vnode;E&&E.parent;)T=E.context,E=E.parent;var I=!T._isMounted||!t.isRootInsert;if(!I||w||""===w){var A=I&&d?d:u,P=I&&p?p:c,k=I&&f?f:h,R=I&&b||m,L=I&&"function"==typeof w?w:v,F=I&&x||y,M=I&&S||_,O=g(l(C)?C.enter:C);0;var $=!1!==s&&!Q,j=Kr(L),N=i._enterCb=D((function(){$&&(jr(i,k),jr(i,P)),N.cancelled?($&&jr(i,A),M&&M(i)):F&&F(i),i._enterCb=null}));t.data.show||ce(t,"insert",(function(){var e=i.parentNode,n=e&&e._pending&&e._pending[t.key];n&&n.tag===t.tag&&n.elm._leaveCb&&n.elm._leaveCb(),L&&L(i,N)})),R&&R(i),$&&(Dr(i,A),Dr(i,P),$r((function(){jr(i,A),N.cancelled||(Dr(i,k),j||(Wr(O)?setTimeout(N,O):Nr(i,a,N)))}))),t.data.show&&(e&&e(),L&&L(i,N)),$||j||N()}}}function qr(t,e){var i=t.elm;o(i._enterCb)&&(i._enterCb.cancelled=!0,i._enterCb());var n=Er(t.data.transition);if(r(n)||1!==i.nodeType)return e();if(!o(i._leaveCb)){var s=n.css,a=n.type,u=n.leaveClass,h=n.leaveToClass,c=n.leaveActiveClass,d=n.beforeLeave,f=n.leave,p=n.afterLeave,m=n.leaveCancelled,v=n.delayLeave,y=n.duration,_=!1!==s&&!Q,b=Kr(f),w=g(l(y)?y.leave:y);0;var x=i._leaveCb=D((function(){i.parentNode&&i.parentNode._pending&&(i.parentNode._pending[t.key]=null),_&&(jr(i,h),jr(i,c)),x.cancelled?(_&&jr(i,u),m&&m(i)):(e(),p&&p(i)),i._leaveCb=null}));v?v(S):S()}function S(){x.cancelled||(!t.data.show&&i.parentNode&&((i.parentNode._pending||(i.parentNode._pending={}))[t.key]=t),d&&d(i),_&&(Dr(i,u),Dr(i,c),$r((function(){jr(i,u),x.cancelled||(Dr(i,h),b||(Wr(w)?setTimeout(x,w):Nr(i,a,x)))}))),f&&f(i,x),_||b||x())}}function Wr(t){return"number"==typeof t&&!isNaN(t)}function Kr(t){if(r(t))return!1;var e=t.fns;return o(e)?Kr(Array.isArray(e)?e[0]:e):(t._length||t.length)>1}function Xr(t,e){!0!==e.data.show&&Gr(e)}var Yr=function(t){var e,i,n={},l=t.modules,u=t.nodeOps;for(e=0;e<hn.length;++e)for(n[hn[e]]=[],i=0;i<l.length;++i)o(l[i][hn[e]])&&n[hn[e]].push(l[i][hn[e]]);function h(t){var e=u.parentNode(t);o(e)&&u.removeChild(e,t)}function c(t,e,i,r,a,l,h){if(o(t.elm)&&o(l)&&(t=l[h]=wt(t)),t.isRootInsert=!a,!function(t,e,i,r){var a=t.data;if(o(a)){var l=o(t.componentInstance)&&a.keepAlive;if(o(a=a.hook)&&o(a=a.init)&&a(t,!1),o(t.componentInstance))return d(t,e),f(i,t.elm,r),s(l)&&function(t,e,i,r){var s,a=t;for(;a.componentInstance;)if(o(s=(a=a.componentInstance._vnode).data)&&o(s=s.transition)){for(s=0;s<n.activate.length;++s)n.activate[s](un,a);e.push(a);break}f(i,t.elm,r)}(t,e,i,r),!0}}(t,e,i,r)){var c=t.data,g=t.children,m=t.tag;o(m)?(t.elm=t.ns?u.createElementNS(t.ns,m):u.createElement(m,t),y(t),p(t,g,e),o(c)&&v(t,e),f(i,t.elm,r)):s(t.isComment)?(t.elm=u.createComment(t.text),f(i,t.elm,r)):(t.elm=u.createTextNode(t.text),f(i,t.elm,r))}}function d(t,e){o(t.data.pendingInsert)&&(e.push.apply(e,t.data.pendingInsert),t.data.pendingInsert=null),t.elm=t.componentInstance.$el,g(t)?(v(t,e),y(t)):(ln(t),e.push(t))}function f(t,e,i){o(t)&&(o(i)?u.parentNode(i)===t&&u.insertBefore(t,e,i):u.appendChild(t,e))}function p(t,e,i){if(Array.isArray(e)){0;for(var n=0;n<e.length;++n)c(e[n],i,t.elm,null,!0,e,n)}else a(t.text)&&u.appendChild(t.elm,u.createTextNode(String(t.text)))}function g(t){for(;t.componentInstance;)t=t.componentInstance._vnode;return o(t.tag)}function v(t,i){for(var r=0;r<n.create.length;++r)n.create[r](un,t);o(e=t.data.hook)&&(o(e.create)&&e.create(un,t),o(e.insert)&&i.push(t))}function y(t){var e;if(o(e=t.fnScopeId))u.setStyleScope(t.elm,e);else for(var i=t;i;)o(e=i.context)&&o(e=e.$options._scopeId)&&u.setStyleScope(t.elm,e),i=i.parent;o(e=ei)&&e!==t.context&&e!==t.fnContext&&o(e=e.$options._scopeId)&&u.setStyleScope(t.elm,e)}function _(t,e,i,n,r,o){for(;n<=r;++n)c(i[n],o,t,e,!1,i,n)}function b(t){var e,i,r=t.data;if(o(r))for(o(e=r.hook)&&o(e=e.destroy)&&e(t),e=0;e<n.destroy.length;++e)n.destroy[e](t);if(o(e=t.children))for(i=0;i<t.children.length;++i)b(t.children[i])}function w(t,e,i){for(;e<=i;++e){var n=t[e];o(n)&&(o(n.tag)?(x(n),b(n)):h(n.elm))}}function x(t,e){if(o(e)||o(t.data)){var i,r=n.remove.length+1;for(o(e)?e.listeners+=r:e=function(t,e){function i(){0==--i.listeners&&h(t)}return i.listeners=e,i}(t.elm,r),o(i=t.componentInstance)&&o(i=i._vnode)&&o(i.data)&&x(i,e),i=0;i<n.remove.length;++i)n.remove[i](t,e);o(i=t.data.hook)&&o(i=i.remove)?i(t,e):e()}else h(t.elm)}function S(t,e,i,n){for(var r=i;r<n;r++){var s=e[r];if(o(s)&&cn(t,s))return r}}function C(t,e,i,a,l,h){if(t!==e){o(e.elm)&&o(a)&&(e=a[l]=wt(e));var d=e.elm=t.elm;if(s(t.isAsyncPlaceholder))o(e.asyncFactory.resolved)?I(t.elm,e,i):e.isAsyncPlaceholder=!0;else if(s(e.isStatic)&&s(t.isStatic)&&e.key===t.key&&(s(e.isCloned)||s(e.isOnce)))e.componentInstance=t.componentInstance;else{var f,p=e.data;o(p)&&o(f=p.hook)&&o(f=f.prepatch)&&f(t,e);var m=t.children,v=e.children;if(o(p)&&g(e)){for(f=0;f<n.update.length;++f)n.update[f](t,e);o(f=p.hook)&&o(f=f.update)&&f(t,e)}r(e.text)?o(m)&&o(v)?m!==v&&function(t,e,i,n,s){var a,l,h,d=0,f=0,p=e.length-1,g=e[0],m=e[p],v=i.length-1,y=i[0],b=i[v],x=!s;for(;d<=p&&f<=v;)r(g)?g=e[++d]:r(m)?m=e[--p]:cn(g,y)?(C(g,y,n,i,f),g=e[++d],y=i[++f]):cn(m,b)?(C(m,b,n,i,v),m=e[--p],b=i[--v]):cn(g,b)?(C(g,b,n,i,v),x&&u.insertBefore(t,g.elm,u.nextSibling(m.elm)),g=e[++d],b=i[--v]):cn(m,y)?(C(m,y,n,i,f),x&&u.insertBefore(t,m.elm,g.elm),m=e[--p],y=i[++f]):(r(a)&&(a=dn(e,d,p)),r(l=o(y.key)?a[y.key]:S(y,e,d,p))?c(y,n,t,g.elm,!1,i,f):cn(h=e[l],y)?(C(h,y,n,i,f),e[l]=void 0,x&&u.insertBefore(t,h.elm,g.elm)):c(y,n,t,g.elm,!1,i,f),y=i[++f]);d>p?_(t,r(i[v+1])?null:i[v+1].elm,i,f,v,n):f>v&&w(e,d,p)}(d,m,v,i,h):o(v)?(o(t.text)&&u.setTextContent(d,""),_(d,null,v,0,v.length-1,i)):o(m)?w(m,0,m.length-1):o(t.text)&&u.setTextContent(d,""):t.text!==e.text&&u.setTextContent(d,e.text),o(p)&&o(f=p.hook)&&o(f=f.postpatch)&&f(t,e)}}}function T(t,e,i){if(s(i)&&o(t.parent))t.parent.data.pendingInsert=e;else for(var n=0;n<e.length;++n)e[n].data.hook.insert(e[n])}var E=m("attrs,class,staticClass,staticStyle,key");function I(t,e,i,n){var r,a=e.tag,l=e.data,u=e.children;if(n=n||l&&l.pre,e.elm=t,s(e.isComment)&&o(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(o(l)&&(o(r=l.hook)&&o(r=r.init)&&r(e,!0),o(r=e.componentInstance)))return d(e,i),!0;if(o(a)){if(o(u))if(t.hasChildNodes())if(o(r=l)&&o(r=r.domProps)&&o(r=r.innerHTML)){if(r!==t.innerHTML)return!1}else{for(var h=!0,c=t.firstChild,f=0;f<u.length;f++){if(!c||!I(c,u[f],i,n)){h=!1;break}c=c.nextSibling}if(!h||c)return!1}else p(e,u,i);if(o(l)){var g=!1;for(var m in l)if(!E(m)){g=!0,v(e,i);break}!g&&l.class&&se(l.class)}}else t.data!==e.text&&(t.data=e.text);return!0}return function(t,e,i,a){if(!r(e)){var l,h=!1,d=[];if(r(t))h=!0,c(e,d);else{var f=o(t.nodeType);if(!f&&cn(t,e))C(t,e,d,null,null,a);else{if(f){if(1===t.nodeType&&t.hasAttribute(j)&&(t.removeAttribute(j),i=!0),s(i)&&I(t,e,d))return T(e,d,!0),t;l=t,t=new vt(u.tagName(l).toLowerCase(),{},[],void 0,l)}var p=t.elm,m=u.parentNode(p);if(c(e,d,p._leaveCb?null:m,u.nextSibling(p)),o(e.parent))for(var v=e.parent,y=g(e);v;){for(var _=0;_<n.destroy.length;++_)n.destroy[_](v);if(v.elm=e.elm,y){for(var x=0;x<n.create.length;++x)n.create[x](un,v);var S=v.data.hook.insert;if(S.merged)for(var E=1;E<S.fns.length;E++)S.fns[E]()}else ln(v);v=v.parent}o(m)?w([t],0,0):o(t.tag)&&b(t)}}return T(e,d,h),e.elm}o(t)&&b(t)}}({nodeOps:sn,modules:[Sn,Rn,lr,cr,xr,X?{create:Xr,activate:Xr,remove:function(t,e){!0!==t.data.show?qr(t,e):e()}}:{}].concat(_n)});Q&&document.addEventListener("selectionchange",(function(){var t=document.activeElement;t&&t.vmodel&&no(t,"input")}));var Hr={inserted:function(t,e,i,n){"select"===i.tag?(n.elm&&!n.elm._vOptions?ce(i,"postpatch",(function(){Hr.componentUpdated(t,e,i)})):Zr(t,e,i.context),t._vOptions=[].map.call(t.options,to)):("textarea"===i.tag||rn(t.type))&&(t._vModifiers=e.modifiers,e.modifiers.lazy||(t.addEventListener("compositionstart",eo),t.addEventListener("compositionend",io),t.addEventListener("change",io),Q&&(t.vmodel=!0)))},componentUpdated:function(t,e,i){if("select"===i.tag){Zr(t,e,i.context);var n=t._vOptions,r=t._vOptions=[].map.call(t.options,to);if(r.some((function(t,e){return!O(t,n[e])})))(t.multiple?e.value.some((function(t){return Qr(t,r)})):e.value!==e.oldValue&&Qr(e.value,r))&&no(t,"change")}}};function Zr(t,e,i){Jr(t,e,i),(J||tt)&&setTimeout((function(){Jr(t,e,i)}),0)}function Jr(t,e,i){var n=e.value,r=t.multiple;if(!r||Array.isArray(n)){for(var o,s,a=0,l=t.options.length;a<l;a++)if(s=t.options[a],r)o=$(n,to(s))>-1,s.selected!==o&&(s.selected=o);else if(O(to(s),n))return void(t.selectedIndex!==a&&(t.selectedIndex=a));r||(t.selectedIndex=-1)}}function Qr(t,e){return e.every((function(e){return!O(e,t)}))}function to(t){return"_value"in t?t._value:t.value}function eo(t){t.target.composing=!0}function io(t){t.target.composing&&(t.target.composing=!1,no(t.target,"input"))}function no(t,e){var i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!0),t.dispatchEvent(i)}function ro(t){return!t.componentInstance||t.data&&t.data.transition?t:ro(t.componentInstance._vnode)}var oo={model:Hr,show:{bind:function(t,e,i){var n=e.value,r=(i=ro(i)).data&&i.data.transition,o=t.__vOriginalDisplay="none"===t.style.display?"":t.style.display;n&&r?(i.data.show=!0,Gr(i,(function(){t.style.display=o}))):t.style.display=n?o:"none"},update:function(t,e,i){var n=e.value;!n!=!e.oldValue&&((i=ro(i)).data&&i.data.transition?(i.data.show=!0,n?Gr(i,(function(){t.style.display=t.__vOriginalDisplay})):qr(i,(function(){t.style.display="none"}))):t.style.display=n?t.__vOriginalDisplay:"none")},unbind:function(t,e,i,n,r){r||(t.style.display=t.__vOriginalDisplay)}}},so={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function ao(t){var e=t&&t.componentOptions;return e&&e.Ctor.options.abstract?ao(He(e.children)):t}function lo(t){var e={},i=t.$options;for(var n in i.propsData)e[n]=t[n];var r=i._parentListeners;for(var o in r)e[C(o)]=r[o];return e}function uo(t,e){if(/\d-keep-alive$/.test(e.tag))return t("keep-alive",{props:e.componentOptions.propsData})}var ho=function(t){return t.tag||Ye(t)},co=function(t){return"show"===t.name},fo={name:"transition",props:so,abstract:!0,render:function(t){var e=this,i=this.$slots.default;if(i&&(i=i.filter(ho)).length){0;var n=this.mode;0;var r=i[0];if(function(t){for(;t=t.parent;)if(t.data.transition)return!0}(this.$vnode))return r;var o=ao(r);if(!o)return r;if(this._leaving)return uo(t,r);var s="__transition-"+this._uid+"-";o.key=null==o.key?o.isComment?s+"comment":s+o.tag:a(o.key)?0===String(o.key).indexOf(s)?o.key:s+o.key:o.key;var l=(o.data||(o.data={})).transition=lo(this),u=this._vnode,h=ao(u);if(o.data.directives&&o.data.directives.some(co)&&(o.data.show=!0),h&&h.data&&!function(t,e){return e.key===t.key&&e.tag===t.tag}(o,h)&&!Ye(h)&&(!h.componentInstance||!h.componentInstance._vnode.isComment)){var c=h.data.transition=k({},l);if("out-in"===n)return this._leaving=!0,ce(c,"afterLeave",(function(){e._leaving=!1,e.$forceUpdate()})),uo(t,r);if("in-out"===n){if(Ye(o))return u;var d,f=function(){d()};ce(l,"afterEnter",f),ce(l,"enterCancelled",f),ce(c,"delayLeave",(function(t){d=t}))}}return r}}},po=k({tag:String,moveClass:String},so);function go(t){t.elm._moveCb&&t.elm._moveCb(),t.elm._enterCb&&t.elm._enterCb()}function mo(t){t.data.newPos=t.elm.getBoundingClientRect()}function vo(t){var e=t.data.pos,i=t.data.newPos,n=e.left-i.left,r=e.top-i.top;if(n||r){t.data.moved=!0;var o=t.elm.style;o.transform=o.WebkitTransform="translate("+n+"px,"+r+"px)",o.transitionDuration="0s"}}delete po.mode;var yo={Transition:fo,TransitionGroup:{props:po,beforeMount:function(){var t=this,e=this._update;this._update=function(i,n){var r=ii(t);t.__patch__(t._vnode,t.kept,!1,!0),t._vnode=t.kept,r(),e.call(t,i,n)}},render:function(t){for(var e=this.tag||this.$vnode.data.tag||"span",i=Object.create(null),n=this.prevChildren=this.children,r=this.$slots.default||[],o=this.children=[],s=lo(this),a=0;a<r.length;a++){var l=r[a];if(l.tag)if(null!=l.key&&0!==String(l.key).indexOf("__vlist"))o.push(l),i[l.key]=l,(l.data||(l.data={})).transition=s;else;}if(n){for(var u=[],h=[],c=0;c<n.length;c++){var d=n[c];d.data.transition=s,d.data.pos=d.elm.getBoundingClientRect(),i[d.key]?u.push(d):h.push(d)}this.kept=t(e,null,u),this.removed=h}return t(e,null,o)},updated:function(){var t=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";t.length&&this.hasMove(t[0].elm,e)&&(t.forEach(go),t.forEach(mo),t.forEach(vo),this._reflow=document.body.offsetHeight,t.forEach((function(t){if(t.data.moved){var i=t.elm,n=i.style;Dr(i,e),n.transform=n.WebkitTransform=n.transitionDuration="",i.addEventListener(Lr,i._moveCb=function t(n){n&&n.target!==i||n&&!/transform$/.test(n.propertyName)||(i.removeEventListener(Lr,t),i._moveCb=null,jr(i,e))})}})))},methods:{hasMove:function(t,e){if(!Ar)return!1;if(this._hasMove)return this._hasMove;var i=t.cloneNode();t._transitionClasses&&t._transitionClasses.forEach((function(t){Tr(i,t)})),Cr(i,e),i.style.display="none",this.$el.appendChild(i);var n=Ur(i);return this.$el.removeChild(i),this._hasMove=n.hasTransform}}}};Pi.config.mustUseProp=Ni,Pi.config.isReservedTag=tn,Pi.config.isReservedAttr=Di,Pi.config.getTagNamespace=en,Pi.config.isUnknownElement=function(t){if(!X)return!0;if(tn(t))return!1;if(t=t.toLowerCase(),null!=nn[t])return nn[t];var e=document.createElement(t);return t.indexOf("-")>-1?nn[t]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:nn[t]=/HTMLUnknownElement/.test(e.toString())},k(Pi.options.directives,oo),k(Pi.options.components,yo),Pi.prototype.__patch__=X?Yr:L,Pi.prototype.$mount=function(t,e){return function(t,e,i){var n;return t.$el=e,t.$options.render||(t.$options.render=_t),si(t,"beforeMount"),n=function(){t._update(t._render(),i)},new yi(t,n,L,{before:function(){t._isMounted&&!t._isDestroyed&&si(t,"beforeUpdate")}},!0),i=!1,null==t.$vnode&&(t._isMounted=!0,si(t,"mounted")),t}(this,t=t&&X?on(t):void 0,e)},X&&setTimeout((function(){U.devtools&&at&&at.emit("init",Pi)}),0);var _o=/\{\{((?:.|\r?\n)+?)\}\}/g,bo=/[-.*+?^${}()|[\]\/\\]/g,wo=x((function(t){var e=t[0].replace(bo,"\\$&"),i=t[1].replace(bo,"\\$&");return new RegExp(e+"((?:.|\\n)+?)"+i,"g")}));var xo={staticKeys:["staticClass"],transformNode:function(t,e){e.warn;var i=Gn(t,"class");i&&(t.staticClass=JSON.stringify(i));var n=Vn(t,"class",!1);n&&(t.classBinding=n)},genData:function(t){var e="";return t.staticClass&&(e+="staticClass:"+t.staticClass+","),t.classBinding&&(e+="class:"+t.classBinding+","),e}};var So,Co={staticKeys:["staticStyle"],transformNode:function(t,e){e.warn;var i=Gn(t,"style");i&&(t.staticStyle=JSON.stringify(dr(i)));var n=Vn(t,"style",!1);n&&(t.styleBinding=n)},genData:function(t){var e="";return t.staticStyle&&(e+="staticStyle:"+t.staticStyle+","),t.styleBinding&&(e+="style:("+t.styleBinding+"),"),e}},To=function(t){return(So=So||document.createElement("div")).innerHTML=t,So.textContent},Eo=m("area,base,br,col,embed,frame,hr,img,input,isindex,keygen,link,meta,param,source,track,wbr"),Io=m("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr,source"),Ao=m("address,article,aside,base,blockquote,body,caption,col,colgroup,dd,details,dialog,div,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,legend,li,menuitem,meta,optgroup,option,param,rp,rt,source,style,summary,tbody,td,tfoot,th,thead,title,tr,track"),Po=/^\s*([^\s"'<>\/=]+)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,ko=/^\s*((?:v-[\w-]+:|@|:|#)\[[^=]+\][^\s"'<>\/=]*)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,Ro="[a-zA-Z_][\\-\\.0-9_a-zA-Z"+z.source+"]*",Lo="((?:"+Ro+"\\:)?"+Ro+")",Fo=new RegExp("^<"+Lo),Mo=/^\s*(\/?)>/,Oo=new RegExp("^<\\/"+Lo+"[^>]*>"),$o=/^<!DOCTYPE [^>]+>/i,Do=/^<!\--/,jo=/^<!\[/,No=m("script,style,textarea",!0),Bo={},Uo={"&lt;":"<","&gt;":">","&quot;":'"',"&amp;":"&","&#10;":"\n","&#9;":"\t","&#39;":"'"},zo=/&(?:lt|gt|quot|amp|#39);/g,Vo=/&(?:lt|gt|quot|amp|#39|#10|#9);/g,Go=m("pre,textarea",!0),qo=function(t,e){return t&&Go(t)&&"\n"===e[0]};function Wo(t,e){var i=e?Vo:zo;return t.replace(i,(function(t){return Uo[t]}))}var Ko,Xo,Yo,Ho,Zo,Jo,Qo,ts,es=/^@|^v-on:/,is=/^v-|^@|^:|^#/,ns=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,rs=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,os=/^\(|\)$/g,ss=/^\[.*\]$/,as=/:(.*)$/,ls=/^:|^\.|^v-bind:/,us=/\.[^.\]]+(?=[^\]]*$)/g,hs=/^v-slot(:|$)|^#/,cs=/[\r\n]/,ds=/\s+/g,fs=x(To),ps="_empty_";function gs(t,e,i){return{type:1,tag:t,attrsList:e,attrsMap:xs(e),rawAttrsMap:{},parent:i,children:[]}}function ms(t,e){Ko=e.warn||On,Jo=e.isPreTag||F,Qo=e.mustUseProp||F,ts=e.getTagNamespace||F;var i=e.isReservedTag||F;(function(t){return!!t.component||!i(t.tag)}),Yo=$n(e.modules,"transformNode"),Ho=$n(e.modules,"preTransformNode"),Zo=$n(e.modules,"postTransformNode"),Xo=e.delimiters;var n,r,o=[],s=!1!==e.preserveWhitespace,a=e.whitespace,l=!1,u=!1;function h(t){if(c(t),l||t.processed||(t=vs(t,e)),o.length||t===n||n.if&&(t.elseif||t.else)&&_s(n,{exp:t.elseif,block:t}),r&&!t.forbidden)if(t.elseif||t.else)s=t,(a=function(t){for(var e=t.length;e--;){if(1===t[e].type)return t[e];t.pop()}}(r.children))&&a.if&&_s(a,{exp:s.elseif,block:s});else{if(t.slotScope){var i=t.slotTarget||'"default"';(r.scopedSlots||(r.scopedSlots={}))[i]=t}r.children.push(t),t.parent=r}var s,a;t.children=t.children.filter((function(t){return!t.slotScope})),c(t),t.pre&&(l=!1),Jo(t.tag)&&(u=!1);for(var h=0;h<Zo.length;h++)Zo[h](t,e)}function c(t){if(!u)for(var e;(e=t.children[t.children.length-1])&&3===e.type&&" "===e.text;)t.children.pop()}return function(t,e){for(var i,n,r=[],o=e.expectHTML,s=e.isUnaryTag||F,a=e.canBeLeftOpenTag||F,l=0;t;){if(i=t,n&&No(n)){var u=0,h=n.toLowerCase(),c=Bo[h]||(Bo[h]=new RegExp("([\\s\\S]*?)(</"+h+"[^>]*>)","i")),d=t.replace(c,(function(t,i,n){return u=n.length,No(h)||"noscript"===h||(i=i.replace(/<!\--([\s\S]*?)-->/g,"$1").replace(/<!\[CDATA\[([\s\S]*?)]]>/g,"$1")),qo(h,i)&&(i=i.slice(1)),e.chars&&e.chars(i),""}));l+=t.length-d.length,t=d,E(h,l-u,l)}else{var f=t.indexOf("<");if(0===f){if(Do.test(t)){var p=t.indexOf("--\x3e");if(p>=0){e.shouldKeepComment&&e.comment(t.substring(4,p),l,l+p+3),S(p+3);continue}}if(jo.test(t)){var g=t.indexOf("]>");if(g>=0){S(g+2);continue}}var m=t.match($o);if(m){S(m[0].length);continue}var v=t.match(Oo);if(v){var y=l;S(v[0].length),E(v[1],y,l);continue}var _=C();if(_){T(_),qo(_.tagName,t)&&S(1);continue}}var b=void 0,w=void 0,x=void 0;if(f>=0){for(w=t.slice(f);!(Oo.test(w)||Fo.test(w)||Do.test(w)||jo.test(w)||(x=w.indexOf("<",1))<0);)f+=x,w=t.slice(f);b=t.substring(0,f)}f<0&&(b=t),b&&S(b.length),e.chars&&b&&e.chars(b,l-b.length,l)}if(t===i){e.chars&&e.chars(t);break}}function S(e){l+=e,t=t.substring(e)}function C(){var e=t.match(Fo);if(e){var i,n,r={tagName:e[1],attrs:[],start:l};for(S(e[0].length);!(i=t.match(Mo))&&(n=t.match(ko)||t.match(Po));)n.start=l,S(n[0].length),n.end=l,r.attrs.push(n);if(i)return r.unarySlash=i[1],S(i[0].length),r.end=l,r}}function T(t){var i=t.tagName,l=t.unarySlash;o&&("p"===n&&Ao(i)&&E(n),a(i)&&n===i&&E(i));for(var u=s(i)||!!l,h=t.attrs.length,c=new Array(h),d=0;d<h;d++){var f=t.attrs[d],p=f[3]||f[4]||f[5]||"",g="a"===i&&"href"===f[1]?e.shouldDecodeNewlinesForHref:e.shouldDecodeNewlines;c[d]={name:f[1],value:Wo(p,g)}}u||(r.push({tag:i,lowerCasedTag:i.toLowerCase(),attrs:c,start:t.start,end:t.end}),n=i),e.start&&e.start(i,c,u,t.start,t.end)}function E(t,i,o){var s,a;if(null==i&&(i=l),null==o&&(o=l),t)for(a=t.toLowerCase(),s=r.length-1;s>=0&&r[s].lowerCasedTag!==a;s--);else s=0;if(s>=0){for(var u=r.length-1;u>=s;u--)e.end&&e.end(r[u].tag,i,o);r.length=s,n=s&&r[s-1].tag}else"br"===a?e.start&&e.start(t,[],!0,i,o):"p"===a&&(e.start&&e.start(t,[],!1,i,o),e.end&&e.end(t,i,o))}E()}(t,{warn:Ko,expectHTML:e.expectHTML,isUnaryTag:e.isUnaryTag,canBeLeftOpenTag:e.canBeLeftOpenTag,shouldDecodeNewlines:e.shouldDecodeNewlines,shouldDecodeNewlinesForHref:e.shouldDecodeNewlinesForHref,shouldKeepComment:e.comments,outputSourceRange:e.outputSourceRange,start:function(t,i,s,a,c){var d=r&&r.ns||ts(t);J&&"svg"===d&&(i=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];Ss.test(n.name)||(n.name=n.name.replace(Cs,""),e.push(n))}return e}(i));var f,p=gs(t,i,r);d&&(p.ns=d),"style"!==(f=p).tag&&("script"!==f.tag||f.attrsMap.type&&"text/javascript"!==f.attrsMap.type)||st()||(p.forbidden=!0);for(var g=0;g<Ho.length;g++)p=Ho[g](p,e)||p;l||(!function(t){null!=Gn(t,"v-pre")&&(t.pre=!0)}(p),p.pre&&(l=!0)),Jo(p.tag)&&(u=!0),l?function(t){var e=t.attrsList,i=e.length;if(i)for(var n=t.attrs=new Array(i),r=0;r<i;r++)n[r]={name:e[r].name,value:JSON.stringify(e[r].value)},null!=e[r].start&&(n[r].start=e[r].start,n[r].end=e[r].end);else t.pre||(t.plain=!0)}(p):p.processed||(ys(p),function(t){var e=Gn(t,"v-if");if(e)t.if=e,_s(t,{exp:e,block:t});else{null!=Gn(t,"v-else")&&(t.else=!0);var i=Gn(t,"v-else-if");i&&(t.elseif=i)}}(p),function(t){null!=Gn(t,"v-once")&&(t.once=!0)}(p)),n||(n=p),s?h(p):(r=p,o.push(p))},end:function(t,e,i){var n=o[o.length-1];o.length-=1,r=o[o.length-1],h(n)},chars:function(t,e,i){if(r&&(!J||"textarea"!==r.tag||r.attrsMap.placeholder!==t)){var n,o,h,c=r.children;if(t=u||t.trim()?"script"===(n=r).tag||"style"===n.tag?t:fs(t):c.length?a?"condense"===a&&cs.test(t)?"":" ":s?" ":"":"")u||"condense"!==a||(t=t.replace(ds," ")),!l&&" "!==t&&(o=function(t,e){var i=e?wo(e):_o;if(i.test(t)){for(var n,r,o,s=[],a=[],l=i.lastIndex=0;n=i.exec(t);){(r=n.index)>l&&(a.push(o=t.slice(l,r)),s.push(JSON.stringify(o)));var u=Fn(n[1].trim());s.push("_s("+u+")"),a.push({"@binding":u}),l=r+n[0].length}return l<t.length&&(a.push(o=t.slice(l)),s.push(JSON.stringify(o))),{expression:s.join("+"),tokens:a}}}(t,Xo))?h={type:2,expression:o.expression,tokens:o.tokens,text:t}:" "===t&&c.length&&" "===c[c.length-1].text||(h={type:3,text:t}),h&&c.push(h)}},comment:function(t,e,i){if(r){var n={type:3,text:t,isComment:!0};0,r.children.push(n)}}}),n}function vs(t,e){var i;!function(t){var e=Vn(t,"key");if(e){t.key=e}}(t),t.plain=!t.key&&!t.scopedSlots&&!t.attrsList.length,function(t){var e=Vn(t,"ref");e&&(t.ref=e,t.refInFor=function(t){var e=t;for(;e;){if(void 0!==e.for)return!0;e=e.parent}return!1}(t))}(t),function(t){var e;"template"===t.tag?(e=Gn(t,"scope"),t.slotScope=e||Gn(t,"slot-scope")):(e=Gn(t,"slot-scope"))&&(t.slotScope=e);var i=Vn(t,"slot");i&&(t.slotTarget='""'===i?'"default"':i,t.slotTargetDynamic=!(!t.attrsMap[":slot"]&&!t.attrsMap["v-bind:slot"]),"template"===t.tag||t.slotScope||jn(t,"slot",i,function(t,e){return t.rawAttrsMap[":"+e]||t.rawAttrsMap["v-bind:"+e]||t.rawAttrsMap[e]}(t,"slot")));if("template"===t.tag){var n=qn(t,hs);if(n){0;var r=bs(n),o=r.name,s=r.dynamic;t.slotTarget=o,t.slotTargetDynamic=s,t.slotScope=n.value||ps}}else{var a=qn(t,hs);if(a){0;var l=t.scopedSlots||(t.scopedSlots={}),u=bs(a),h=u.name,c=u.dynamic,d=l[h]=gs("template",[],t);d.slotTarget=h,d.slotTargetDynamic=c,d.children=t.children.filter((function(t){if(!t.slotScope)return t.parent=d,!0})),d.slotScope=a.value||ps,t.children=[],t.plain=!1}}}(t),"slot"===(i=t).tag&&(i.slotName=Vn(i,"name")),function(t){var e;(e=Vn(t,"is"))&&(t.component=e);null!=Gn(t,"inline-template")&&(t.inlineTemplate=!0)}(t);for(var n=0;n<Yo.length;n++)t=Yo[n](t,e)||t;return function(t){var e,i,n,r,o,s,a,l,u=t.attrsList;for(e=0,i=u.length;e<i;e++){if(n=r=u[e].name,o=u[e].value,is.test(n))if(t.hasBindings=!0,(s=ws(n.replace(is,"")))&&(n=n.replace(us,"")),ls.test(n))n=n.replace(ls,""),o=Fn(o),(l=ss.test(n))&&(n=n.slice(1,-1)),s&&(s.prop&&!l&&"innerHtml"===(n=C(n))&&(n="innerHTML"),s.camel&&!l&&(n=C(n)),s.sync&&(a=Xn(o,"$event"),l?zn(t,'"update:"+('+n+")",a,null,!1,0,u[e],!0):(zn(t,"update:"+C(n),a,null,!1,0,u[e]),I(n)!==C(n)&&zn(t,"update:"+I(n),a,null,!1,0,u[e])))),s&&s.prop||!t.component&&Qo(t.tag,t.attrsMap.type,n)?Dn(t,n,o,u[e],l):jn(t,n,o,u[e],l);else if(es.test(n))n=n.replace(es,""),(l=ss.test(n))&&(n=n.slice(1,-1)),zn(t,n,o,s,!1,0,u[e],l);else{var h=(n=n.replace(is,"")).match(as),c=h&&h[1];l=!1,c&&(n=n.slice(0,-(c.length+1)),ss.test(c)&&(c=c.slice(1,-1),l=!0)),Bn(t,n,r,o,c,l,s,u[e])}else jn(t,n,JSON.stringify(o),u[e]),!t.component&&"muted"===n&&Qo(t.tag,t.attrsMap.type,n)&&Dn(t,n,"true",u[e])}}(t),t}function ys(t){var e;if(e=Gn(t,"v-for")){var i=function(t){var e=t.match(ns);if(!e)return;var i={};i.for=e[2].trim();var n=e[1].trim().replace(os,""),r=n.match(rs);r?(i.alias=n.replace(rs,"").trim(),i.iterator1=r[1].trim(),r[2]&&(i.iterator2=r[2].trim())):i.alias=n;return i}(e);i&&k(t,i)}}function _s(t,e){t.ifConditions||(t.ifConditions=[]),t.ifConditions.push(e)}function bs(t){var e=t.name.replace(hs,"");return e||"#"!==t.name[0]&&(e="default"),ss.test(e)?{name:e.slice(1,-1),dynamic:!0}:{name:'"'+e+'"',dynamic:!1}}function ws(t){var e=t.match(us);if(e){var i={};return e.forEach((function(t){i[t.slice(1)]=!0})),i}}function xs(t){for(var e={},i=0,n=t.length;i<n;i++)e[t[i].name]=t[i].value;return e}var Ss=/^xmlns:NS\d+/,Cs=/^NS\d+:/;function Ts(t){return gs(t.tag,t.attrsList.slice(),t.parent)}var Es=[xo,Co,{preTransformNode:function(t,e){if("input"===t.tag){var i,n=t.attrsMap;if(!n["v-model"])return;if((n[":type"]||n["v-bind:type"])&&(i=Vn(t,"type")),n.type||i||!n["v-bind"]||(i="("+n["v-bind"]+").type"),i){var r=Gn(t,"v-if",!0),o=r?"&&("+r+")":"",s=null!=Gn(t,"v-else",!0),a=Gn(t,"v-else-if",!0),l=Ts(t);ys(l),Nn(l,"type","checkbox"),vs(l,e),l.processed=!0,l.if="("+i+")==='checkbox'"+o,_s(l,{exp:l.if,block:l});var u=Ts(t);Gn(u,"v-for",!0),Nn(u,"type","radio"),vs(u,e),_s(l,{exp:"("+i+")==='radio'"+o,block:u});var h=Ts(t);return Gn(h,"v-for",!0),Nn(h,":type",i),vs(h,e),_s(l,{exp:r,block:h}),s?l.else=!0:a&&(l.elseif=a),l}}}}];var Is,As,Ps={expectHTML:!0,modules:Es,directives:{model:function(t,e,i){i;var n=e.value,r=e.modifiers,o=t.tag,s=t.attrsMap.type;if(t.component)return Kn(t,n,r),!1;if("select"===o)!function(t,e,i){var n='var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = "_value" in o ? o._value : o.value;return '+(i&&i.number?"_n(val)":"val")+"});";n=n+" "+Xn(e,"$event.target.multiple ? $$selectedVal : $$selectedVal[0]"),zn(t,"change",n,null,!0)}(t,n,r);else if("input"===o&&"checkbox"===s)!function(t,e,i){var n=i&&i.number,r=Vn(t,"value")||"null",o=Vn(t,"true-value")||"true",s=Vn(t,"false-value")||"false";Dn(t,"checked","Array.isArray("+e+")?_i("+e+","+r+")>-1"+("true"===o?":("+e+")":":_q("+e+","+o+")")),zn(t,"change","var $$a="+e+",$$el=$event.target,$$c=$$el.checked?("+o+"):("+s+");if(Array.isArray($$a)){var $$v="+(n?"_n("+r+")":r)+",$$i=_i($$a,$$v);if($$el.checked){$$i<0&&("+Xn(e,"$$a.concat([$$v])")+")}else{$$i>-1&&("+Xn(e,"$$a.slice(0,$$i).concat($$a.slice($$i+1))")+")}}else{"+Xn(e,"$$c")+"}",null,!0)}(t,n,r);else if("input"===o&&"radio"===s)!function(t,e,i){var n=i&&i.number,r=Vn(t,"value")||"null";Dn(t,"checked","_q("+e+","+(r=n?"_n("+r+")":r)+")"),zn(t,"change",Xn(e,r),null,!0)}(t,n,r);else if("input"===o||"textarea"===o)!function(t,e,i){var n=t.attrsMap.type;0;var r=i||{},o=r.lazy,s=r.number,a=r.trim,l=!o&&"range"!==n,u=o?"change":"range"===n?er:"input",h="$event.target.value";a&&(h="$event.target.value.trim()");s&&(h="_n("+h+")");var c=Xn(e,h);l&&(c="if($event.target.composing)return;"+c);Dn(t,"value","("+e+")"),zn(t,u,c,null,!0),(a||s)&&zn(t,"blur","$forceUpdate()")}(t,n,r);else{if(!U.isReservedTag(o))return Kn(t,n,r),!1}return!0},text:function(t,e){e.value&&Dn(t,"textContent","_s("+e.value+")",e)},html:function(t,e){e.value&&Dn(t,"innerHTML","_s("+e.value+")",e)}},isPreTag:function(t){return"pre"===t},isUnaryTag:Eo,mustUseProp:Ni,canBeLeftOpenTag:Io,isReservedTag:tn,getTagNamespace:en,staticKeys:function(t){return t.reduce((function(t,e){return t.concat(e.staticKeys||[])}),[]).join(",")}(Es)},ks=x((function(t){return m("type,tag,attrsList,attrsMap,plain,parent,children,attrs,start,end,rawAttrsMap"+(t?","+t:""))}));function Rs(t,e){t&&(Is=ks(e.staticKeys||""),As=e.isReservedTag||F,Ls(t),Fs(t,!1))}function Ls(t){if(t.static=function(t){if(2===t.type)return!1;if(3===t.type)return!0;return!(!t.pre&&(t.hasBindings||t.if||t.for||v(t.tag)||!As(t.tag)||function(t){for(;t.parent;){if("template"!==(t=t.parent).tag)return!1;if(t.for)return!0}return!1}(t)||!Object.keys(t).every(Is)))}(t),1===t.type){if(!As(t.tag)&&"slot"!==t.tag&&null==t.attrsMap["inline-template"])return;for(var e=0,i=t.children.length;e<i;e++){var n=t.children[e];Ls(n),n.static||(t.static=!1)}if(t.ifConditions)for(var r=1,o=t.ifConditions.length;r<o;r++){var s=t.ifConditions[r].block;Ls(s),s.static||(t.static=!1)}}}function Fs(t,e){if(1===t.type){if((t.static||t.once)&&(t.staticInFor=e),t.static&&t.children.length&&(1!==t.children.length||3!==t.children[0].type))return void(t.staticRoot=!0);if(t.staticRoot=!1,t.children)for(var i=0,n=t.children.length;i<n;i++)Fs(t.children[i],e||!!t.for);if(t.ifConditions)for(var r=1,o=t.ifConditions.length;r<o;r++)Fs(t.ifConditions[r].block,e)}}var Ms=/^([\w$_]+|\([^)]*?\))\s*=>|^function(?:\s+[\w$]+)?\s*\(/,Os=/\([^)]*?\);*$/,$s=/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['[^']*?']|\["[^"]*?"]|\[\d+]|\[[A-Za-z_$][\w$]*])*$/,Ds={esc:27,tab:9,enter:13,space:32,up:38,left:37,right:39,down:40,delete:[8,46]},js={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete","Del"]},Ns=function(t){return"if("+t+")return null;"},Bs={stop:"$event.stopPropagation();",prevent:"$event.preventDefault();",self:Ns("$event.target !== $event.currentTarget"),ctrl:Ns("!$event.ctrlKey"),shift:Ns("!$event.shiftKey"),alt:Ns("!$event.altKey"),meta:Ns("!$event.metaKey"),left:Ns("'button' in $event && $event.button !== 0"),middle:Ns("'button' in $event && $event.button !== 1"),right:Ns("'button' in $event && $event.button !== 2")};function Us(t,e){var i=e?"nativeOn:":"on:",n="",r="";for(var o in t){var s=zs(t[o]);t[o]&&t[o].dynamic?r+=o+","+s+",":n+='"'+o+'":'+s+","}return n="{"+n.slice(0,-1)+"}",r?i+"_d("+n+",["+r.slice(0,-1)+"])":i+n}function zs(t){if(!t)return"function(){}";if(Array.isArray(t))return"["+t.map((function(t){return zs(t)})).join(",")+"]";var e=$s.test(t.value),i=Ms.test(t.value),n=$s.test(t.value.replace(Os,""));if(t.modifiers){var r="",o="",s=[];for(var a in t.modifiers)if(Bs[a])o+=Bs[a],Ds[a]&&s.push(a);else if("exact"===a){var l=t.modifiers;o+=Ns(["ctrl","shift","alt","meta"].filter((function(t){return!l[t]})).map((function(t){return"$event."+t+"Key"})).join("||"))}else s.push(a);return s.length&&(r+=function(t){return"if(!$event.type.indexOf('key')&&"+t.map(Vs).join("&&")+")return null;"}(s)),o&&(r+=o),"function($event){"+r+(e?"return "+t.value+"($event)":i?"return ("+t.value+")($event)":n?"return "+t.value:t.value)+"}"}return e||i?t.value:"function($event){"+(n?"return "+t.value:t.value)+"}"}function Vs(t){var e=parseInt(t,10);if(e)return"$event.keyCode!=="+e;var i=Ds[t],n=js[t];return"_k($event.keyCode,"+JSON.stringify(t)+","+JSON.stringify(i)+",$event.key,"+JSON.stringify(n)+")"}var Gs={on:function(t,e){t.wrapListeners=function(t){return"_g("+t+","+e.value+")"}},bind:function(t,e){t.wrapData=function(i){return"_b("+i+",'"+t.tag+"',"+e.value+","+(e.modifiers&&e.modifiers.prop?"true":"false")+(e.modifiers&&e.modifiers.sync?",true":"")+")"}},cloak:L},qs=function(t){this.options=t,this.warn=t.warn||On,this.transforms=$n(t.modules,"transformCode"),this.dataGenFns=$n(t.modules,"genData"),this.directives=k(k({},Gs),t.directives);var e=t.isReservedTag||F;this.maybeComponent=function(t){return!!t.component||!e(t.tag)},this.onceId=0,this.staticRenderFns=[],this.pre=!1};function Ws(t,e){var i=new qs(e);return{render:"with(this){return "+(t?Ks(t,i):'_c("div")')+"}",staticRenderFns:i.staticRenderFns}}function Ks(t,e){if(t.parent&&(t.pre=t.pre||t.parent.pre),t.staticRoot&&!t.staticProcessed)return Xs(t,e);if(t.once&&!t.onceProcessed)return Ys(t,e);if(t.for&&!t.forProcessed)return Js(t,e);if(t.if&&!t.ifProcessed)return Hs(t,e);if("template"!==t.tag||t.slotTarget||e.pre){if("slot"===t.tag)return function(t,e){var i=t.slotName||'"default"',n=ia(t,e),r="_t("+i+(n?","+n:""),o=t.attrs||t.dynamicAttrs?oa((t.attrs||[]).concat(t.dynamicAttrs||[]).map((function(t){return{name:C(t.name),value:t.value,dynamic:t.dynamic}}))):null,s=t.attrsMap["v-bind"];!o&&!s||n||(r+=",null");o&&(r+=","+o);s&&(r+=(o?"":",null")+","+s);return r+")"}(t,e);var i;if(t.component)i=function(t,e,i){var n=e.inlineTemplate?null:ia(e,i,!0);return"_c("+t+","+Qs(e,i)+(n?","+n:"")+")"}(t.component,t,e);else{var n;(!t.plain||t.pre&&e.maybeComponent(t))&&(n=Qs(t,e));var r=t.inlineTemplate?null:ia(t,e,!0);i="_c('"+t.tag+"'"+(n?","+n:"")+(r?","+r:"")+")"}for(var o=0;o<e.transforms.length;o++)i=e.transforms[o](t,i);return i}return ia(t,e)||"void 0"}function Xs(t,e){t.staticProcessed=!0;var i=e.pre;return t.pre&&(e.pre=t.pre),e.staticRenderFns.push("with(this){return "+Ks(t,e)+"}"),e.pre=i,"_m("+(e.staticRenderFns.length-1)+(t.staticInFor?",true":"")+")"}function Ys(t,e){if(t.onceProcessed=!0,t.if&&!t.ifProcessed)return Hs(t,e);if(t.staticInFor){for(var i="",n=t.parent;n;){if(n.for){i=n.key;break}n=n.parent}return i?"_o("+Ks(t,e)+","+e.onceId+++","+i+")":Ks(t,e)}return Xs(t,e)}function Hs(t,e,i,n){return t.ifProcessed=!0,Zs(t.ifConditions.slice(),e,i,n)}function Zs(t,e,i,n){if(!t.length)return n||"_e()";var r=t.shift();return r.exp?"("+r.exp+")?"+o(r.block)+":"+Zs(t,e,i,n):""+o(r.block);function o(t){return i?i(t,e):t.once?Ys(t,e):Ks(t,e)}}function Js(t,e,i,n){var r=t.for,o=t.alias,s=t.iterator1?","+t.iterator1:"",a=t.iterator2?","+t.iterator2:"";return t.forProcessed=!0,(n||"_l")+"(("+r+"),function("+o+s+a+"){return "+(i||Ks)(t,e)+"})"}function Qs(t,e){var i="{",n=function(t,e){var i=t.directives;if(!i)return;var n,r,o,s,a="directives:[",l=!1;for(n=0,r=i.length;n<r;n++){o=i[n],s=!0;var u=e.directives[o.name];u&&(s=!!u(t,o,e.warn)),s&&(l=!0,a+='{name:"'+o.name+'",rawName:"'+o.rawName+'"'+(o.value?",value:("+o.value+"),expression:"+JSON.stringify(o.value):"")+(o.arg?",arg:"+(o.isDynamicArg?o.arg:'"'+o.arg+'"'):"")+(o.modifiers?",modifiers:"+JSON.stringify(o.modifiers):"")+"},")}if(l)return a.slice(0,-1)+"]"}(t,e);n&&(i+=n+","),t.key&&(i+="key:"+t.key+","),t.ref&&(i+="ref:"+t.ref+","),t.refInFor&&(i+="refInFor:true,"),t.pre&&(i+="pre:true,"),t.component&&(i+='tag:"'+t.tag+'",');for(var r=0;r<e.dataGenFns.length;r++)i+=e.dataGenFns[r](t);if(t.attrs&&(i+="attrs:"+oa(t.attrs)+","),t.props&&(i+="domProps:"+oa(t.props)+","),t.events&&(i+=Us(t.events,!1)+","),t.nativeEvents&&(i+=Us(t.nativeEvents,!0)+","),t.slotTarget&&!t.slotScope&&(i+="slot:"+t.slotTarget+","),t.scopedSlots&&(i+=function(t,e,i){var n=t.for||Object.keys(e).some((function(t){var i=e[t];return i.slotTargetDynamic||i.if||i.for||ta(i)})),r=!!t.if;if(!n)for(var o=t.parent;o;){if(o.slotScope&&o.slotScope!==ps||o.for){n=!0;break}o.if&&(r=!0),o=o.parent}var s=Object.keys(e).map((function(t){return ea(e[t],i)})).join(",");return"scopedSlots:_u(["+s+"]"+(n?",null,true":"")+(!n&&r?",null,false,"+function(t){var e=5381,i=t.length;for(;i;)e=33*e^t.charCodeAt(--i);return e>>>0}(s):"")+")"}(t,t.scopedSlots,e)+","),t.model&&(i+="model:{value:"+t.model.value+",callback:"+t.model.callback+",expression:"+t.model.expression+"},"),t.inlineTemplate){var o=function(t,e){var i=t.children[0];0;if(i&&1===i.type){var n=Ws(i,e.options);return"inlineTemplate:{render:function(){"+n.render+"},staticRenderFns:["+n.staticRenderFns.map((function(t){return"function(){"+t+"}"})).join(",")+"]}"}}(t,e);o&&(i+=o+",")}return i=i.replace(/,$/,"")+"}",t.dynamicAttrs&&(i="_b("+i+',"'+t.tag+'",'+oa(t.dynamicAttrs)+")"),t.wrapData&&(i=t.wrapData(i)),t.wrapListeners&&(i=t.wrapListeners(i)),i}function ta(t){return 1===t.type&&("slot"===t.tag||t.children.some(ta))}function ea(t,e){var i=t.attrsMap["slot-scope"];if(t.if&&!t.ifProcessed&&!i)return Hs(t,e,ea,"null");if(t.for&&!t.forProcessed)return Js(t,e,ea);var n=t.slotScope===ps?"":String(t.slotScope),r="function("+n+"){return "+("template"===t.tag?t.if&&i?"("+t.if+")?"+(ia(t,e)||"undefined")+":undefined":ia(t,e)||"undefined":Ks(t,e))+"}",o=n?"":",proxy:true";return"{key:"+(t.slotTarget||'"default"')+",fn:"+r+o+"}"}function ia(t,e,i,n,r){var o=t.children;if(o.length){var s=o[0];if(1===o.length&&s.for&&"template"!==s.tag&&"slot"!==s.tag){var a=i?e.maybeComponent(s)?",1":",0":"";return""+(n||Ks)(s,e)+a}var l=i?function(t,e){for(var i=0,n=0;n<t.length;n++){var r=t[n];if(1===r.type){if(na(r)||r.ifConditions&&r.ifConditions.some((function(t){return na(t.block)}))){i=2;break}(e(r)||r.ifConditions&&r.ifConditions.some((function(t){return e(t.block)})))&&(i=1)}}return i}(o,e.maybeComponent):0,u=r||ra;return"["+o.map((function(t){return u(t,e)})).join(",")+"]"+(l?","+l:"")}}function na(t){return void 0!==t.for||"template"===t.tag||"slot"===t.tag}function ra(t,e){return 1===t.type?Ks(t,e):3===t.type&&t.isComment?function(t){return"_e("+JSON.stringify(t.text)+")"}(t):"_v("+(2===(i=t).type?i.expression:sa(JSON.stringify(i.text)))+")";var i}function oa(t){for(var e="",i="",n=0;n<t.length;n++){var r=t[n],o=sa(r.value);r.dynamic?i+=r.name+","+o+",":e+='"'+r.name+'":'+o+","}return e="{"+e.slice(0,-1)+"}",i?"_d("+e+",["+i.slice(0,-1)+"])":e}function sa(t){return t.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}new RegExp("\\b"+"do,if,for,let,new,try,var,case,else,with,await,break,catch,class,const,super,throw,while,yield,delete,export,import,return,switch,default,extends,finally,continue,debugger,function,arguments".split(",").join("\\b|\\b")+"\\b"),new RegExp("\\b"+"delete,typeof,void".split(",").join("\\s*\\([^\\)]*\\)|\\b")+"\\s*\\([^\\)]*\\)");function aa(t,e){try{return new Function(t)}catch(i){return e.push({err:i,code:t}),L}}function la(t){var e=Object.create(null);return function(i,n,r){(n=k({},n)).warn;delete n.warn;var o=n.delimiters?String(n.delimiters)+i:i;if(e[o])return e[o];var s=t(i,n);var a={},l=[];return a.render=aa(s.render,l),a.staticRenderFns=s.staticRenderFns.map((function(t){return aa(t,l)})),e[o]=a}}var ua,ha,ca=(ua=function(t,e){var i=ms(t.trim(),e);!1!==e.optimize&&Rs(i,e);var n=Ws(i,e);return{ast:i,render:n.render,staticRenderFns:n.staticRenderFns}},function(t){function e(e,i){var n=Object.create(t),r=[],o=[];if(i)for(var s in i.modules&&(n.modules=(t.modules||[]).concat(i.modules)),i.directives&&(n.directives=k(Object.create(t.directives||null),i.directives)),i)"modules"!==s&&"directives"!==s&&(n[s]=i[s]);n.warn=function(t,e,i){(i?o:r).push(t)};var a=ua(e.trim(),n);return a.errors=r,a.tips=o,a}return{compile:e,compileToFunctions:la(e)}})(Ps),da=(ca.compile,ca.compileToFunctions);function fa(t){return(ha=ha||document.createElement("div")).innerHTML=t?'<a href="\n"/>':'<div a="\n"/>',ha.innerHTML.indexOf("&#10;")>0}var pa=!!X&&fa(!1),ga=!!X&&fa(!0),ma=x((function(t){var e=on(t);return e&&e.innerHTML})),va=Pi.prototype.$mount;Pi.prototype.$mount=function(t,e){if((t=t&&on(t))===document.body||t===document.documentElement)return this;var i=this.$options;if(!i.render){var n=i.template;if(n)if("string"==typeof n)"#"===n.charAt(0)&&(n=ma(n));else{if(!n.nodeType)return this;n=n.innerHTML}else t&&(n=function(t){if(t.outerHTML)return t.outerHTML;var e=document.createElement("div");return e.appendChild(t.cloneNode(!0)),e.innerHTML}(t));if(n){0;var r=da(n,{outputSourceRange:!1,shouldDecodeNewlines:pa,shouldDecodeNewlinesForHref:ga,delimiters:i.delimiters,comments:i.comments},this),o=r.render,s=r.staticRenderFns;i.render=o,i.staticRenderFns=s}}return va.call(this,t,e)},Pi.compile=da;const ya=Pi;function _a(t){this.state=2,this.value=void 0,this.deferred=[];var e=this;try{t((function(t){e.resolve(t)}),(function(t){e.reject(t)}))}catch(t){e.reject(t)}}_a.reject=function(t){return new _a((function(e,i){i(t)}))},_a.resolve=function(t){return new _a((function(e,i){e(t)}))},_a.all=function(t){return new _a((function(e,i){var n=0,r=[];function o(i){return function(o){r[i]=o,(n+=1)===t.length&&e(r)}}0===t.length&&e(r);for(var s=0;s<t.length;s+=1)_a.resolve(t[s]).then(o(s),i)}))},_a.race=function(t){return new _a((function(e,i){for(var n=0;n<t.length;n+=1)_a.resolve(t[n]).then(e,i)}))};var ba=_a.prototype;function wa(t,e){this.promise=t instanceof Promise?t:new Promise(t.bind(e)),this.context=e}ba.resolve=function(t){var e=this;if(2===e.state){if(t===e)throw new TypeError("Promise settled with itself.");var i=!1;try{var n=t&&t.then;if(null!==t&&"object"==typeof t&&"function"==typeof n)return void n.call(t,(function(t){i||e.resolve(t),i=!0}),(function(t){i||e.reject(t),i=!0}))}catch(t){return void(i||e.reject(t))}e.state=0,e.value=t,e.notify()}},ba.reject=function(t){var e=this;if(2===e.state){if(t===e)throw new TypeError("Promise settled with itself.");e.state=1,e.value=t,e.notify()}},ba.notify=function(){var t,e=this;Sa((function(){if(2!==e.state)for(;e.deferred.length;){var t=e.deferred.shift(),i=t[0],n=t[1],r=t[2],o=t[3];try{0===e.state?r("function"==typeof i?i.call(void 0,e.value):e.value):1===e.state&&("function"==typeof n?r(n.call(void 0,e.value)):o(e.value))}catch(t){o(t)}}}),t)},ba.then=function(t,e){var i=this;return new _a((function(n,r){i.deferred.push([t,e,n,r]),i.notify()}))},ba.catch=function(t){return this.then(void 0,t)},"undefined"==typeof Promise&&(window.Promise=_a),wa.all=function(t,e){return new wa(Promise.all(t),e)},wa.resolve=function(t,e){return new wa(Promise.resolve(t),e)},wa.reject=function(t,e){return new wa(Promise.reject(t),e)},wa.race=function(t,e){return new wa(Promise.race(t),e)};var xa=wa.prototype;xa.bind=function(t){return this.context=t,this},xa.then=function(t,e){return t&&t.bind&&this.context&&(t=t.bind(this.context)),e&&e.bind&&this.context&&(e=e.bind(this.context)),new wa(this.promise.then(t,e),this.context)},xa.catch=function(t){return t&&t.bind&&this.context&&(t=t.bind(this.context)),new wa(this.promise.catch(t),this.context)},xa.finally=function(t){return this.then((function(e){return t.call(this),e}),(function(e){return t.call(this),Promise.reject(e)}))};var Sa,Ca={}.hasOwnProperty,Ta=[].slice,Ea=!1,Ia="undefined"!=typeof window;function Aa(t){return t?t.replace(/^\s*|\s*$/g,""):""}function Pa(t){return t?t.toLowerCase():""}function ka(t){return t?t.toUpperCase():""}var Ra=Array.isArray;function La(t){return"string"==typeof t}function Fa(t){return"function"==typeof t}function Ma(t){return null!==t&&"object"==typeof t}function Oa(t){return Ma(t)&&Object.getPrototypeOf(t)==Object.prototype}function $a(t,e,i){var n=wa.resolve(t);return arguments.length<2?n:n.then(e,i)}function Da(t,e,i){return Fa(i=i||{})&&(i=i.call(e)),Ba(t.bind({$vm:e,$options:i}),t,{$options:i})}function ja(t,e){var i,n;if(Ra(t))for(i=0;i<t.length;i++)e.call(t[i],t[i],i);else if(Ma(t))for(n in t)Ca.call(t,n)&&e.call(t[n],t[n],n);return t}var Na=Object.assign||function(t){var e=Ta.call(arguments,1);return e.forEach((function(e){Ua(t,e)})),t};function Ba(t){var e=Ta.call(arguments,1);return e.forEach((function(e){Ua(t,e,!0)})),t}function Ua(t,e,i){for(var n in e)i&&(Oa(e[n])||Ra(e[n]))?(Oa(e[n])&&!Oa(t[n])&&(t[n]={}),Ra(e[n])&&!Ra(t[n])&&(t[n]=[]),Ua(t[n],e[n],i)):void 0!==e[n]&&(t[n]=e[n])}function za(t,e,i){var n=function(t){var e=["+","#",".","/",";","?","&"],i=[];return{vars:i,expand:function(n){return t.replace(/\{([^{}]+)\}|([^{}]+)/g,(function(t,r,o){if(r){var s=null,a=[];if(-1!==e.indexOf(r.charAt(0))&&(s=r.charAt(0),r=r.substr(1)),r.split(/,/g).forEach((function(t){var e=/([^:*]*)(?::(\d+)|(\*))?/.exec(t);a.push.apply(a,function(t,e,i,n){var r=t[i],o=[];if(Va(r)&&""!==r)if("string"==typeof r||"number"==typeof r||"boolean"==typeof r)r=r.toString(),n&&"*"!==n&&(r=r.substring(0,parseInt(n,10))),o.push(qa(e,r,Ga(e)?i:null));else if("*"===n)Array.isArray(r)?r.filter(Va).forEach((function(t){o.push(qa(e,t,Ga(e)?i:null))})):Object.keys(r).forEach((function(t){Va(r[t])&&o.push(qa(e,r[t],t))}));else{var s=[];Array.isArray(r)?r.filter(Va).forEach((function(t){s.push(qa(e,t))})):Object.keys(r).forEach((function(t){Va(r[t])&&(s.push(encodeURIComponent(t)),s.push(qa(e,r[t].toString())))})),Ga(e)?o.push(encodeURIComponent(i)+"="+s.join(",")):0!==s.length&&o.push(s.join(","))}else";"===e?o.push(encodeURIComponent(i)):""!==r||"&"!==e&&"?"!==e?""===r&&o.push(""):o.push(encodeURIComponent(i)+"=");return o}(n,s,e[1],e[2]||e[3])),i.push(e[1])})),s&&"+"!==s){var l=",";return"?"===s?l="&":"#"!==s&&(l=s),(0!==a.length?s:"")+a.join(l)}return a.join(",")}return Wa(o)}))}}}(t),r=n.expand(e);return i&&i.push.apply(i,n.vars),r}function Va(t){return null!=t}function Ga(t){return";"===t||"&"===t||"?"===t}function qa(t,e,i){return e="+"===t||"#"===t?Wa(e):encodeURIComponent(e),i?encodeURIComponent(i)+"="+e:e}function Wa(t){return t.split(/(%[0-9A-Fa-f]{2})/g).map((function(t){return/%[0-9A-Fa-f]/.test(t)||(t=encodeURI(t)),t})).join("")}function Ka(t,e){var i,n=this||{},r=t;return La(t)&&(r={url:t,params:e}),r=Ba({},Ka.options,n.$options,r),Ka.transforms.forEach((function(t){La(t)&&(t=Ka.transform[t]),Fa(t)&&(i=function(t,e,i){return function(n){return t.call(i,n,e)}}(t,i,n.$vm))})),i(r)}function Xa(t,e,i){var n,r=Ra(e),o=Oa(e);ja(e,(function(e,s){n=Ma(e)||Ra(e),i&&(s=i+"["+(o||n?s:"")+"]"),!i&&r?t.add(e.name,e.value):n?Xa(t,e,s):t.add(s,e)}))}function Ya(t){return new wa((function(e){var i=new XDomainRequest,n=function(n){var r=n.type,o=0;"load"===r?o=200:"error"===r&&(o=500),e(t.respondWith(i.responseText,{status:o}))};t.abort=function(){return i.abort()},i.open(t.method,t.getUrl()),t.timeout&&(i.timeout=t.timeout),i.onload=n,i.onabort=n,i.onerror=n,i.ontimeout=n,i.onprogress=function(){},i.send(t.getBody())}))}Ka.options={url:"",root:null,params:{}},Ka.transform={template:function(t){var e=[],i=za(t.url,t.params,e);return e.forEach((function(e){delete t.params[e]})),i},query:function(t,e){var i=Object.keys(Ka.options.params),n={},r=e(t);return ja(t.params,(function(t,e){-1===i.indexOf(e)&&(n[e]=t)})),(n=Ka.params(n))&&(r+=(-1==r.indexOf("?")?"?":"&")+n),r},root:function(t,e){var i=e(t);return La(t.root)&&!/^(https?:)?\//.test(i)&&(i=function(t,e){return t&&void 0===e?t.replace(/\s+$/,""):t&&e?t.replace(new RegExp("["+e+"]+$"),""):t}(t.root,"/")+"/"+i),i}},Ka.transforms=["template","query","root"],Ka.params=function(t){var e=[],i=encodeURIComponent;return e.add=function(t,e){Fa(e)&&(e=e()),null===e&&(e=""),this.push(i(t)+"="+i(e))},Xa(e,t),e.join("&").replace(/%20/g,"+")},Ka.parse=function(t){var e=document.createElement("a");return document.documentMode&&(e.href=t,t=e.href),e.href=t,{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",port:e.port,host:e.host,hostname:e.hostname,pathname:"/"===e.pathname.charAt(0)?e.pathname:"/"+e.pathname,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):""}};var Ha=Ia&&"withCredentials"in new XMLHttpRequest;function Za(t){return new wa((function(e){var i,n,r=t.jsonp||"callback",o=t.jsonpCallback||"_jsonp"+Math.random().toString(36).substr(2),s=null;i=function(i){var r=i.type,a=0;"load"===r&&null!==s?a=200:"error"===r&&(a=500),a&&window[o]&&(delete window[o],document.body.removeChild(n)),e(t.respondWith(s,{status:a}))},window[o]=function(t){s=JSON.stringify(t)},t.abort=function(){i({type:"abort"})},t.params[r]=o,t.timeout&&setTimeout(t.abort,t.timeout),(n=document.createElement("script")).src=t.getUrl(),n.type="text/javascript",n.async=!0,n.onload=i,n.onerror=i,document.body.appendChild(n)}))}function Ja(t){return new wa((function(e){var i=new XMLHttpRequest,n=function(n){var r=t.respondWith("response"in i?i.response:i.responseText,{status:1223===i.status?204:i.status,statusText:1223===i.status?"No Content":Aa(i.statusText)});ja(Aa(i.getAllResponseHeaders()).split("\n"),(function(t){r.headers.append(t.slice(0,t.indexOf(":")),t.slice(t.indexOf(":")+1))})),e(r)};t.abort=function(){return i.abort()},i.open(t.method,t.getUrl(),!0),t.timeout&&(i.timeout=t.timeout),t.responseType&&"responseType"in i&&(i.responseType=t.responseType),(t.withCredentials||t.credentials)&&(i.withCredentials=!0),t.crossOrigin||t.headers.set("X-Requested-With","XMLHttpRequest"),Fa(t.progress)&&"GET"===t.method&&i.addEventListener("progress",t.progress),Fa(t.downloadProgress)&&i.addEventListener("progress",t.downloadProgress),Fa(t.progress)&&/^(POST|PUT)$/i.test(t.method)&&i.upload.addEventListener("progress",t.progress),Fa(t.uploadProgress)&&i.upload&&i.upload.addEventListener("progress",t.uploadProgress),t.headers.forEach((function(t,e){i.setRequestHeader(e,t)})),i.onload=n,i.onabort=n,i.onerror=n,i.ontimeout=n,i.send(t.getBody())}))}function Qa(t){var e=i(608);return new wa((function(i){var n,r=t.getUrl(),o=t.getBody(),s=t.method,a={};t.headers.forEach((function(t,e){a[e]=t})),e(r,{body:o,method:s,headers:a}).then(n=function(e){var n=t.respondWith(e.body,{status:e.statusCode,statusText:Aa(e.statusMessage)});ja(e.headers,(function(t,e){n.headers.set(e,t)})),i(n)},(function(t){return n(t.response)}))}))}function tl(t){return(t.client||(Ia?Ja:Qa))(t)}var el=function(){function t(t){var e=this;this.map={},ja(t,(function(t,i){return e.append(i,t)}))}var e=t.prototype;return e.has=function(t){return null!==il(this.map,t)},e.get=function(t){var e=this.map[il(this.map,t)];return e?e.join():null},e.getAll=function(t){return this.map[il(this.map,t)]||[]},e.set=function(t,e){this.map[function(t){if(/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return Aa(t)}(il(this.map,t)||t)]=[Aa(e)]},e.append=function(t,e){var i=this.map[il(this.map,t)];i?i.push(Aa(e)):this.set(t,e)},e.delete=function(t){delete this.map[il(this.map,t)]},e.deleteAll=function(){this.map={}},e.forEach=function(t,e){var i=this;ja(this.map,(function(n,r){ja(n,(function(n){return t.call(e,n,r,i)}))}))},t}();function il(t,e){return Object.keys(t).reduce((function(t,i){return Pa(e)===Pa(i)?i:t}),null)}var nl=function(){function t(t,e){var i,n=e.url,r=e.headers,o=e.status,s=e.statusText;this.url=n,this.ok=o>=200&&o<300,this.status=o||0,this.statusText=s||"",this.headers=new el(r),this.body=t,La(t)?this.bodyText=t:(i=t,"undefined"!=typeof Blob&&i instanceof Blob&&(this.bodyBlob=t,function(t){return 0===t.type.indexOf("text")||-1!==t.type.indexOf("json")}(t)&&(this.bodyText=function(t){return new wa((function(e){var i=new FileReader;i.readAsText(t),i.onload=function(){e(i.result)}}))}(t))))}var e=t.prototype;return e.blob=function(){return $a(this.bodyBlob)},e.text=function(){return $a(this.bodyText)},e.json=function(){return $a(this.text(),(function(t){return JSON.parse(t)}))},t}();Object.defineProperty(nl.prototype,"data",{get:function(){return this.body},set:function(t){this.body=t}});var rl=function(){function t(t){this.body=null,this.params={},Na(this,t,{method:ka(t.method||"GET")}),this.headers instanceof el||(this.headers=new el(this.headers))}var e=t.prototype;return e.getUrl=function(){return Ka(this)},e.getBody=function(){return this.body},e.respondWith=function(t,e){return new nl(t,Na(e||{},{url:this.getUrl()}))},t}(),ol={"Content-Type":"application/json;charset=utf-8"};function sl(t){var e=this||{},i=function(t){var e=[tl],i=[];function n(n){for(;e.length;){var r=e.pop();if(Fa(r)){var o=function(){var e=void 0,o=void 0;if(Ma(e=r.call(t,n,(function(t){return o=t}))||o))return{v:new wa((function(n,r){i.forEach((function(i){e=$a(e,(function(e){return i.call(t,e)||e}),r)})),$a(e,n,r)}),t)};Fa(e)&&i.unshift(e)}();if("object"==typeof o)return o.v}else s="Invalid interceptor of type "+typeof r+", must be a function","undefined"!=typeof console&&Ea&&console.warn("[VueResource warn]: "+s)}var s}return Ma(t)||(t=null),n.use=function(t){e.push(t)},n}(e.$vm);return function(t){Ta.call(arguments,1).forEach((function(e){for(var i in e)void 0===t[i]&&(t[i]=e[i])}))}(t||{},e.$options,sl.options),sl.interceptors.forEach((function(t){La(t)&&(t=sl.interceptor[t]),Fa(t)&&i.use(t)})),i(new rl(t)).then((function(t){return t.ok?t:wa.reject(t)}),(function(t){var e;return t instanceof Error&&(e=t,"undefined"!=typeof console&&console.error(e)),wa.reject(t)}))}function al(t,e,i,n){var r=this||{},o={};return ja(i=Na({},al.actions,i),(function(i,s){i=Ba({url:t,params:Na({},e)},n,i),o[s]=function(){return(r.$http||sl)(ll(i,arguments))}})),o}function ll(t,e){var i,n=Na({},t),r={};switch(e.length){case 2:r=e[0],i=e[1];break;case 1:/^(POST|PUT|PATCH)$/i.test(n.method)?i=e[0]:r=e[0];break;case 0:break;default:throw"Expected up to 2 arguments [params, body], got "+e.length+" arguments"}return n.body=i,n.params=Na({},n.params,r),n}function ul(t){ul.installed||(!function(t){var e=t.config,i=t.nextTick;Sa=i,Ea=e.debug||!e.silent}(t),t.url=Ka,t.http=sl,t.resource=al,t.Promise=wa,Object.defineProperties(t.prototype,{$url:{get:function(){return Da(t.url,this,this.$options.url)}},$http:{get:function(){return Da(t.http,this,this.$options.http)}},$resource:{get:function(){return t.resource.bind(this)}},$promise:{get:function(){var e=this;return function(i){return new t.Promise(i,e)}}}}))}sl.options={},sl.headers={put:ol,post:ol,patch:ol,delete:ol,common:{Accept:"application/json, text/plain, */*"},custom:{}},sl.interceptor={before:function(t){Fa(t.before)&&t.before.call(this,t)},method:function(t){t.emulateHTTP&&/^(PUT|PATCH|DELETE)$/i.test(t.method)&&(t.headers.set("X-HTTP-Method-Override",t.method),t.method="POST")},jsonp:function(t){"JSONP"==t.method&&(t.client=Za)},json:function(t){var e=t.headers.get("Content-Type")||"";return Ma(t.body)&&0===e.indexOf("application/json")&&(t.body=JSON.stringify(t.body)),function(t){return t.bodyText?$a(t.text(),(function(e){if(0===(t.headers.get("Content-Type")||"").indexOf("application/json")||function(t){var e=t.match(/^\s*(\[|\{)/),i={"[":/]\s*$/,"{":/}\s*$/};return e&&i[e[1]].test(t)}(e))try{t.body=JSON.parse(e)}catch(e){t.body=null}else t.body=e;return t})):t}},form:function(t){var e;e=t.body,"undefined"!=typeof FormData&&e instanceof FormData?t.headers.delete("Content-Type"):Ma(t.body)&&t.emulateJSON&&(t.body=Ka.params(t.body),t.headers.set("Content-Type","application/x-www-form-urlencoded"))},header:function(t){ja(Na({},sl.headers.common,t.crossOrigin?{}:sl.headers.custom,sl.headers[Pa(t.method)]),(function(e,i){t.headers.has(i)||t.headers.set(i,e)}))},cors:function(t){if(Ia){var e=Ka.parse(location.href),i=Ka.parse(t.getUrl());i.protocol===e.protocol&&i.host===e.host||(t.crossOrigin=!0,t.emulateHTTP=!1,Ha||(t.client=Ya))}}},sl.interceptors=["before","method","jsonp","json","form","header","cors"],["get","delete","head","jsonp"].forEach((function(t){sl[t]=function(e,i){return this(Na(i||{},{url:e,method:t}))}})),["post","put","patch"].forEach((function(t){sl[t]=function(e,i,n){return this(Na(n||{},{url:e,method:t,body:i}))}})),al.actions={get:{method:"GET"},save:{method:"POST"},query:{method:"GET"},update:{method:"PUT"},remove:{method:"DELETE"},delete:{method:"DELETE"}},"undefined"!=typeof window&&window.Vue&&!window.Vue.resource&&window.Vue.use(ul);const hl=ul;window.Vue=ya,window.Vue.use(hl);var cl=document.querySelector('meta[name="csrf-token"]');if(cl){var dl=["HEAD","GET","OPTIONS"];ya.http.interceptors.push((function(t){dl.includes(t.method)||t.crossOrigin||t.headers.set("X-CSRF-TOKEN",cl.getAttribute("content"))}))}var fl=function(t,e){window.addEventListener("load",(function(){var i=document.getElementById(t);i&&(e instanceof Vue||(e=new Vue(e)),e.$mount(i))}))},pl=function(t){t=Array.isArray(t)?t:t.split("."),window.biigle||(window.biigle={});for(var e=window.biigle,i=0,n=t.length;i<n;i++)e.hasOwnProperty(t[i])||(e[t[i]]={}),e=e[t[i]];return e};const gl=Vue.resource("api/v1/annotations{/id}",{},{attachLabel:{method:"POST",url:"api/v1/annotations{/id}/labels"},detachLabel:{method:"DELETE",url:"api/v1/annotation-labels{/annotation_label_id}"}}),ml=Vue.resource("api/v1/images{/id}",{},{getFile:{method:"GET",url:"api/v1/images{/id}/file"},getAnnotations:{method:"GET",url:"api/v1/images{/id}/annotations"},saveAnnotations:{method:"POST",url:"api/v1/images{/id}/annotations"}}),vl=Vue.resource("api/v1/labels{/id}",{},{save:{method:"POST",url:"api/v1/label-trees{/label_tree_id}/labels"}}),yl=Vue.resource("api/v1/label-sources{/id}/find"),_l=Vue.resource("api/v1/label-trees{/id}",{},{addAuthorizedProject:{method:"POST",url:"api/v1/label-trees{/id}/authorized-projects"},removeAuthorizedProject:{method:"DELETE",url:"api/v1/label-trees{/id}/authorized-projects{/project_id}"},addUser:{method:"POST",url:"api/v1/label-trees{/id}/users"},updateUser:{method:"PUT",url:"api/v1/label-trees{/id}/users{/user_id}"},removeUser:{method:"DELETE",url:"api/v1/label-trees{/id}/users{/user_id}"}}),bl=Vue.resource("api/v1/label-tree-versions{/id}",{},{save:{method:"POST",url:"api/v1/label-trees{/id}/version"}}),wl=Vue.resource("api/v1/notifications{/id}",{},{markRead:{method:"PUT"}}),xl=Vue.resource("api/v1/projects{/id}",{},{queryVolumes:{method:"GET",url:"api/v1/projects{/id}/volumes"},saveVolume:{method:"POST",url:"api/v1/projects{/id}/volumes"},attachVolume:{method:"POST",url:"api/v1/projects{/id}/volumes{/volume_id}"},detachVolume:{method:"DELETE",url:"api/v1/projects{/id}/volumes{/volume_id}"},addUser:{method:"POST",url:"api/v1/projects{/id}/users{/user_id}"},updateUser:{method:"PUT",url:"api/v1/projects{/id}/users{/user_id}"},removeUser:{method:"DELETE",url:"api/v1/projects{/id}/users{/user_id}"},queryAvailableLabelTrees:{method:"GET",url:"api/v1/projects{/id}/label-trees/available"},attachLabelTree:{method:"POST",url:"api/v1/projects{/id}/label-trees"},detachLabelTree:{method:"DELETE",url:"api/v1/projects{/id}/label-trees{/label_tree_id}"}}),Sl=Vue.resource("api/v1/users{/id}",{},{find:{method:"GET",url:"api/v1/users/find{/query}"}}),Cl=Vue.resource("api/v1/volumes{/id}");function Tl(t,e,i,n,r,o,s,a){var l,u="function"==typeof t?t.options:t;if(e&&(u.render=e,u.staticRenderFns=i,u._compiled=!0),n&&(u.functional=!0),o&&(u._scopeId="data-v-"+o),s?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},u._ssrRegister=l):r&&(l=a?function(){r.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:r),l)if(u.functional){u._injectStyles=l;var h=u.render;u.render=function(t,e){return l.call(e),h(t,e)}}else{var c=u.beforeCreate;u.beforeCreate=c?[].concat(c,l):[l]}return{exports:t,options:u}}const El=Tl({props:{active:{type:Boolean,required:!0},fancy:{type:Boolean,default:!1}},computed:{classObject:function(){return{"loader--active":this.active,"loader--fancy":this.fancy}}}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",{staticClass:"loader",class:t.classObject})}),[],!1,null,null,null).exports;const Il=Tl({props:{text:{type:String,default:""}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"message-curtain"},[t._t("default",[i("span",{staticClass:"lead message-curtain--text",domProps:{textContent:t._s(t.text)}})])],2)}),[],!1,null,null,null).exports;const Al=Tl({components:{loader:El,messageCurtain:Il},props:{active:{type:Boolean,required:!0}},computed:{classObject:function(){return{"loader-block--inactive":!this.active}}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("message-curtain",{class:t.classObject},[i("loader",{attrs:{active:t.active,fancy:!0}})],1)}),[],!1,null,null,null).exports;const Pl=Tl({props:{active:{type:Boolean,required:!0},title:{type:String,default:""},titleOn:{type:String,default:""},titleOff:{type:String,default:""},type:{type:String,default:"info"},icon:{type:String,default:"power-off"},disabled:{type:Boolean,default:!1}},computed:{currentTitle:function(){return this.active?this.titleOn||this.title:this.titleOff||this.title},label:function(){return this.$slots.default?this.$slots.default[0].text:""},objectClass:function(){var t={active:this.active};return t["btn-".concat(this.type)]=this.active,t},iconClass:function(){return"fa-".concat(this.icon)}},methods:{handleClick:function(){this.active?this.$emit("off"):this.$emit("on")}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"power-toggle"},[i("button",{staticClass:"btn btn-default",class:t.objectClass,attrs:{type:"button",title:t.currentTitle,disabled:t.disabled},on:{click:t.handleClick}},[i("i",{staticClass:"fa fa-fw",class:t.iconClass})]),t._v(" "),t.label?i("span",{staticClass:"power-toggle__label",domProps:{textContent:t._s(t.label)}}):t._e()])}),[],!1,null,null,null).exports;const kl=Tl({props:{tab:{type:Object,required:!0},direction:{type:String,default:"right",validator:function(t){return"left"===t||"right"===t}}},computed:{highlightClass:function(){return"string"==typeof this.tab.highlight?"btn-".concat(this.tab.highlight):"btn-info"},iconClass:function(){return"fa fa-".concat(this.tab.icon)},chevronClass:function(){return"fa fa-chevron-".concat(this.direction)},classObject:function(){var t={active:this.open};return!1!==this.tab.highlight&&(t[this.highlightClass]=!0),t},disabled:function(){return this.tab.disabled},href:function(){return this.disabled?null:this.tab.href},open:function(){return this.tab.open}},methods:{toggle:function(t){this.disabled||this.href||(t.preventDefault(),this.open?this.$parent.$emit("close",this.tab.name):this.$parent.$emit("open",this.tab.name))}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a",{staticClass:"sidebar__button btn btn-default btn-lg",class:t.classObject,attrs:{href:t.href,disabled:t.disabled,title:t.tab.title},on:{click:t.toggle}},[t.open?i("span",{class:t.chevronClass,attrs:{"aria-hidden":"true"}}):i("span",{class:t.iconClass,attrs:{"aria-hidden":"true"}})])}),[],!1,null,null,null).exports,Rl=new Vue;const Ll=Tl(new Vue({data:{activeListenerSetName:"default",listenerSets:{default:{}},compatibilityMaps:[{hyper:"os",meta:"os",super:"os"},{meta:"os",scrolllock:"Scroll"," ":"spacebar",arrowdown:"down",arrowleft:"left",arrowright:"right",arrowup:"up",crsel:"crsel",delete:"del",exsel:"exsel",contextmenu:"apps",escape:"esc"}],ignoredTags:["input","textarea","select"],pressedKeysArray:[]},computed:{activeListenerSet:function(){return this.listenerSets[this.activeListenerSetName]||{}},pressedKeys:function(){return this.pressedKeysArray.slice().sort().join("+")}},methods:{isKeyIdentifier:function(t){return"string"==typeof t||t instanceof String},prepareKeys:function(t){var e=this;return Array.isArray(t)||(t=t.split("+")),t.slice().map((function(t){if(!e.isKeyIdentifier(t))throw"".concat(t," is not a valid key.");return t.toLowerCase()})).sort()},shouldIgnoreTarget:function(t){return-1!==this.ignoredTags.indexOf(t.target.tagName.toLowerCase())},handleKeyDown:function(t){t=t||event,this.shouldIgnoreTarget(t)||(t.repeat||this.pressedKeysArray.push(t.key.toLowerCase()),this.maybeInjectModifierKeys(t),this.handleKeyEvents(t,this.pressedKeys))},maybeInjectModifierKeys:function(t){t.altKey&&-1===this.pressedKeysArray.indexOf("alt")&&this.pressedKeysArray.push("alt"),t.ctrlKey&&-1===this.pressedKeysArray.indexOf("control")&&this.pressedKeysArray.push("control"),t.metaKey&&-1===this.pressedKeysArray.indexOf("meta")&&this.pressedKeysArray.push("meta"),t.shiftKey&&-1===this.pressedKeysArray.indexOf("shift")&&this.pressedKeysArray.push("shift")},handleKeyUp:function(t){var e=this.pressedKeysArray.indexOf(t.key.toLowerCase());-1!==e&&this.pressedKeysArray.splice(e,1)},handleKeyEvents:function(t,e){this.activeListenerSet.hasOwnProperty(e)&&this.executeCallbacks(this.activeListenerSet[e],t)},clearPressedKeys:function(){this.pressedKeysArray=[]},executeCallbacks:function(t,e){e.preventDefault();for(var i=t.length-1;i>=0;i--)if(!1===t[i].callback(e))return},on:function(t,e,i,n){var r=this,o=(t=this.prepareKeys(t)).join("+");this.compatibilityMaps.forEach((function(s){var a=t.map((function(t){return s.hasOwnProperty(t)?s[t]:t}));o!==a.join("+")&&r.on(a,e,i,n)}));var s={callback:e,priority:i=i||0};n=n||"default",this.listenerSets.hasOwnProperty(n)||(this.listenerSets[n]={});var a=this.listenerSets[n];if(a.hasOwnProperty(o)){var l,u=a[o];for(l=0;l<u.length&&!(u[l].priority>=i);l++);l===u.length-1?u.push(s):u.splice(l,0,s)}else a[o]=[s]},off:function(t,e,i){t=this.prepareKeys(t).join("+"),i=i||"default";var n=this.listenerSets[i];if(n&&n.hasOwnProperty(t))for(var r=n[t],o=r.length-1;o>=0;o--)if(r[o].callback===e){r.splice(o,1);break}},setActiveSet:function(t){this.activeListenerSetName=t}},created:function(){document.body.addEventListener("keydown",this.handleKeyDown),document.body.addEventListener("keyup",this.handleKeyUp),window.addEventListener("focus",this.clearPressedKeys)}}),undefined,undefined,!1,null,null,null).exports;const Fl=Tl({components:{sidebarButton:kl},data:function(){return{open:!1,tabs:[],lastOpenedTab:null,tabIdSequence:0}},props:{openTab:{type:String},showButtons:{type:Boolean,default:!0},direction:{type:String,default:"right",validator:function(t){return"left"===t||"right"===t}},toggleOnKeyboard:{type:Boolean,default:!1}},computed:{classObject:function(){return{"sidebar--open":this.open,"sidebar--left":this.isLeft,"sidebar--right":!this.isLeft}},isLeft:function(){return"left"===this.direction}},methods:{registerTab:function(t){t.id=this.tabIdSequence++,this.tabs.push(t)},handleOpenTab:function(t){this.open=!0,this.lastOpenedTab=t,this.$emit("toggle",t),Rl.$emit("sidebar.toggle",t),Rl.$emit("sidebar.open.".concat(t))},handleCloseTab:function(t){this.open=!1,this.$emit("toggle",t),Rl.$emit("sidebar.toggle",t),Rl.$emit("sidebar.close.".concat(t))},toggleLastOpenedTab:function(t){this.open?(t.preventDefault(),this.$emit("close",this.lastOpenedTab)):this.lastOpenedTab?(t.preventDefault(),this.$emit("open",this.lastOpenedTab)):this.tabs.length>0&&(t.preventDefault(),this.$emit("open",this.tabs[0].name))}},watch:{openTab:function(t){this.$emit("open",t)}},created:function(){this.$on("open",this.handleOpenTab),this.$on("close",this.handleCloseTab),this.toggleOnKeyboard&&Ll.on("Tab",this.toggleLastOpenedTab)},mounted:function(){this.openTab&&this.$emit("open",this.openTab)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("aside",{staticClass:"sidebar",class:t.classObject},[t.showButtons?i("div",{staticClass:"sidebar__buttons"},t._l(t.tabs,(function(e){return i("sidebar-button",{key:e.id,attrs:{tab:e,direction:t.direction}})})),1):t._e(),t._v(" "),i("div",{staticClass:"sidebar__tabs"},[t._t("default")],2)])}),[],!1,null,null,null).exports;const Ml=Tl({data:function(){return{id:null,open:!1}},props:{name:{type:String,required:!0},icon:{type:String,required:!0},title:{type:String},href:{type:String},disabled:{type:Boolean,default:!1},highlight:{default:!1}},computed:{classObject:function(){return{"sidebar__tab--open":this.open}}},beforeCreate:function(){var t=this;this.$parent.$on("open",(function(e){t.open=e===t.name})),this.$parent.$on("close",(function(){t.open=!1})),this.$parent.registerTab(this)}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"sidebar__tab",class:t.classObject},[t._t("default")],2)}),[],!1,null,null,null).exports;function Ol(t){return null!=t}function $l(t){return"string"==typeof t}var Dl="focus",jl="blur",Nl="click",Bl="input",Ul="keydown",zl="touchend";function Vl(t,e,i){t.addEventListener(e,i)}function Gl(t,e,i){t.removeEventListener(e,i)}function ql(t){return t&&t.nodeType===Node.ELEMENT_NODE}function Wl(t){ql(t)&&(!t.getAttribute("tabindex")&&t.setAttribute("tabindex","-1"),t.focus())}function Kl(t,e,i,n,r,o,s,a,l,u){"boolean"!=typeof s&&(l=a,a=s,s=!1);var h,c="function"==typeof i?i.options:i;if(t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,r&&(c.functional=!0)),n&&(c._scopeId=n),o?(h=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},c._ssrRegister=h):e&&(h=s?function(t){e.call(this,u(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,a(t))}),h)if(c.functional){var d=c.render;c.render=function(t,e){return h.call(e),d(t,e)}}else{var f=c.beforeCreate;c.beforeCreate=f?[].concat(f,h):[h]}return i}var Xl={components:{Dropdown:{render:function(t){return t(this.tag,{class:{"btn-group":"div"===this.tag,dropdown:!this.dropup,dropup:this.dropup,open:this.show}},[this.$slots.default,t("ul",{class:{"dropdown-menu":!0,"dropdown-menu-right":this.menuRight},ref:"dropdown"},[this.$slots.dropdown])])},props:{tag:{type:String,default:"div"},appendToBody:{type:Boolean,default:!1},value:Boolean,dropup:{type:Boolean,default:!1},menuRight:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},notCloseElements:Array,positionElement:null},data:function(){return{show:!1,triggerEl:void 0}},watch:{value:function(t){this.toggle(t)}},mounted:function(){this.initTrigger(),this.triggerEl&&(Vl(this.triggerEl,Nl,this.toggle),Vl(this.triggerEl,Ul,this.onKeyPress)),Vl(this.$refs.dropdown,Ul,this.onKeyPress),Vl(window,Nl,this.windowClicked),Vl(window,zl,this.windowClicked),this.value&&this.toggle(!0)},beforeDestroy:function(){this.removeDropdownFromBody(),this.triggerEl&&(Gl(this.triggerEl,Nl,this.toggle),Gl(this.triggerEl,Ul,this.onKeyPress)),Gl(this.$refs.dropdown,Ul,this.onKeyPress),Gl(window,Nl,this.windowClicked),Gl(window,zl,this.windowClicked)},methods:{getFocusItem:function(){return this.$refs.dropdown.querySelector("li > a:focus")},onKeyPress:function(t){if(this.show){var e=this.$refs.dropdown,i=t.keyCode;if(27===i)this.toggle(!1),this.triggerEl&&this.triggerEl.focus();else if(13===i){var n=this.getFocusItem();n&&n.click()}else if(38===i||40===i){t.preventDefault(),t.stopPropagation();var r=this.getFocusItem(),o=e.querySelectorAll("li:not(.disabled) > a");if(r){for(var s=0;s<o.length;s++)if(r===o[s]){38===i&&s<o.length>0?Wl(o[s-1]):40===i&&s<o.length-1&&Wl(o[s+1]);break}}else Wl(o[0])}}},initTrigger:function(){var t=this.$el.querySelector('[data-role="trigger"]')||this.$el.querySelector(".dropdown-toggle")||this.$el.firstChild;this.triggerEl=t&&t!==this.$refs.dropdown?t:null},toggle:function(t){var e;this.disabled||(e=t,this.show="boolean"==typeof e?t:!this.show,this.appendToBody&&(this.show?this.appendDropdownToBody():this.removeDropdownFromBody()),this.$emit("input",this.show))},windowClicked:function(t){var e=t.target;if(this.show&&e){var i=!1;if(this.notCloseElements)for(var n=0,r=this.notCloseElements.length;n<r;n++){var o=this.notCloseElements[n].contains(e),s=o;if(this.appendToBody){var a=this.$refs.dropdown.contains(e),l=this.notCloseElements.indexOf(this.$el)>=0;s=o||a&&l}if(s){i=!0;break}}var u=this.$refs.dropdown.contains(e),h=this.$el.contains(e)&&!u,c=u&&"touchend"===t.type;h||i||c||this.toggle(!1)}},appendDropdownToBody:function(){try{var t=this.$refs.dropdown;t.style.display="block",document.body.appendChild(t),function(t,e,i){void 0===i&&(i={});var n=document.documentElement,r=(window.pageXOffset||n.scrollLeft)-(n.clientLeft||0),o=(window.pageYOffset||n.scrollTop)-(n.clientTop||0),s=e.getBoundingClientRect(),a=t.getBoundingClientRect();t.style.right="auto",t.style.bottom="auto",i.menuRight?t.style.left=r+s.left+s.width-a.width+"px":t.style.left=r+s.left+"px",i.dropup?t.style.top=o+s.top-a.height-4+"px":t.style.top=o+s.top+s.height+"px"}(t,this.positionElement||this.$el,this)}catch(t){}},removeDropdownFromBody:function(){try{var t=this.$refs.dropdown;t.removeAttribute("style"),this.$el.appendChild(t)}catch(t){}}}}},props:{value:{required:!0},data:Array,itemKey:String,appendToBody:{type:Boolean,default:!1},ignoreCase:{type:Boolean,default:!0},matchStart:{type:Boolean,default:!1},forceSelect:{type:Boolean,default:!1},forceClear:{type:Boolean,default:!1},limit:{type:Number,default:10},asyncSrc:String,asyncKey:String,asyncFunction:Function,debounce:{type:Number,default:200},openOnFocus:{type:Boolean,default:!0},openOnEmpty:{type:Boolean,default:!1},target:{required:!0},preselect:{type:Boolean,default:!0}},data:function(){return{inputEl:null,items:[],activeIndex:0,timeoutID:0,elements:[],open:!1,dropdownMenuEl:null}},computed:{regexOptions:function(){var t="";return this.ignoreCase&&(t+="i"),this.matchStart||(t+="g"),t}},mounted:function(){var t=this;Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),i=e.length;--i>=0&&e.item(i)!==this;);return i>-1}),this.$nextTick((function(){t.initInputElByTarget(t.target),t.initListeners(),t.dropdownMenuEl=t.$refs.dropdown.$el.querySelector(".dropdown-menu"),t.value&&t.setInputTextByValue(t.value)}))},beforeDestroy:function(){this.removeListeners()},watch:{target:function(t){this.removeListeners(),this.initInputElByTarget(t),this.initListeners()},value:function(t){this.setInputTextByValue(t)}},methods:{setInputTextByValue:function(t){$l(t)?this.inputEl.value=t:t?this.inputEl.value=this.itemKey?t[this.itemKey]:t:null===t&&(this.inputEl.value="")},hasEmptySlot:function(){return!!this.$slots.empty||!!this.$scopedSlots.empty},initInputElByTarget:function(t){var e;t&&(this.inputEl=$l(e=t)?document.querySelector(e):ql(e)?e:ql(e.$el)?e.$el:null)},initListeners:function(){this.inputEl&&(this.elements=[this.inputEl],Vl(this.inputEl,Dl,this.inputFocused),Vl(this.inputEl,jl,this.inputBlured),Vl(this.inputEl,Bl,this.inputChanged),Vl(this.inputEl,Ul,this.inputKeyPressed))},removeListeners:function(){this.elements=[],this.inputEl&&(Gl(this.inputEl,Dl,this.inputFocused),Gl(this.inputEl,jl,this.inputBlured),Gl(this.inputEl,Bl,this.inputChanged),Gl(this.inputEl,Ul,this.inputKeyPressed))},prepareItems:function(t,e){if(void 0===e&&(e=!1),e)this.items=t.slice(0,this.limit);else{this.items=[],this.activeIndex=this.preselect?0:-1;for(var i=0,n=t.length;i<n;i++){var r=t[i],o=this.itemKey?r[this.itemKey]:r;o=o.toString();var s=-1;if(s=this.ignoreCase?o.toLowerCase().indexOf(this.inputEl.value.toLowerCase()):o.indexOf(this.inputEl.value),(this.matchStart?0===s:s>=0)&&this.items.push(r),this.items.length>=this.limit)break}}},fetchItems:function(t,e){var i=this;if(clearTimeout(this.timeoutID),""!==t||this.openOnEmpty){if(this.data)this.prepareItems(this.data),this.open=this.hasEmptySlot()||Boolean(this.items.length);else if(this.asyncSrc)this.timeoutID=setTimeout((function(){i.$emit("loading"),function(t,e){void 0===e&&(e="GET");var i=new window.XMLHttpRequest,n={},r={then:function(t,e){return r.done(t).fail(e)},catch:function(t){return r.fail(t)},always:function(t){return r.done(t).fail(t)}};return["done","fail"].forEach((function(t){n[t]=[],r[t]=function(e){return e instanceof Function&&n[t].push(e),r}})),r.done(JSON.parse),i.onreadystatechange=function(){if(4===i.readyState){var t={status:i.status};if(200===i.status){var e=i.responseText;for(var r in n.done)if(s=n.done,a=r,Object.prototype.hasOwnProperty.call(s,a)&&"function"==typeof n.done[r]){var o=n.done[r](e);Ol(o)&&(e=o)}}else n.fail.forEach((function(e){return e(t)}))}var s,a},i.open(e,t),i.setRequestHeader("Accept","application/json"),i.send(),r}(i.asyncSrc+encodeURIComponent(t)).then((function(t){i.inputEl.matches(":focus")&&(i.prepareItems(i.asyncKey?t[i.asyncKey]:t,!0),i.open=i.hasEmptySlot()||Boolean(i.items.length)),i.$emit("loaded")})).catch((function(t){console.error(t),i.$emit("loaded-error")}))}),e);else if(this.asyncFunction){var n=function(t){i.inputEl.matches(":focus")&&(i.prepareItems(t,!0),i.open=i.hasEmptySlot()||Boolean(i.items.length)),i.$emit("loaded")};this.timeoutID=setTimeout((function(){i.$emit("loading"),i.asyncFunction(t,n)}),e)}}else this.open=!1},inputChanged:function(){var t=this.inputEl.value;this.fetchItems(t,this.debounce),this.$emit("input",this.forceSelect?void 0:t)},inputFocused:function(){if(this.openOnFocus){var t=this.inputEl.value;this.fetchItems(t,0)}},inputBlured:function(){var t=this;this.dropdownMenuEl.matches(":hover")||(this.open=!1),this.inputEl&&this.forceClear&&this.$nextTick((function(){void 0===t.value&&(t.inputEl.value="")}))},inputKeyPressed:function(t){if(t.stopPropagation(),this.open)switch(t.keyCode){case 13:this.activeIndex>=0?this.selectItem(this.items[this.activeIndex]):this.open=!1,t.preventDefault();break;case 27:this.open=!1;break;case 38:this.activeIndex=this.activeIndex>0?this.activeIndex-1:0;break;case 40:var e=this.items.length-1;this.activeIndex=this.activeIndex<e?this.activeIndex+1:e}},selectItem:function(t){this.$emit("input",t),this.open=!1},highlight:function(t){var e=this.itemKey?t[this.itemKey]:t,i=this.inputEl.value.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");return e.replace(new RegExp(""+i,this.regexOptions),"<b>$&</b>")}}},Yl=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("dropdown",{ref:"dropdown",attrs:{tag:"section","append-to-body":t.appendToBody,"not-close-elements":t.elements,"position-element":t.inputEl},model:{value:t.open,callback:function(e){t.open=e},expression:"open"}},[i("template",{slot:"dropdown"},[t._t("item",t._l(t.items,(function(e,n){return i("li",{class:{active:t.activeIndex===n}},[i("a",{attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.selectItem(e)}}},[i("span",{domProps:{innerHTML:t._s(t.highlight(e))}})])])})),{items:t.items,activeIndex:t.activeIndex,select:t.selectItem,highlight:t.highlight}),t._v(" "),t.items&&0!==t.items.length?t._e():t._t("empty")],2)],2)};Yl._withStripped=!0;const Hl=Kl({render:Yl,staticRenderFns:[]},undefined,Xl,undefined,false,undefined,!1,void 0,void 0,void 0);var Zl=Tl({props:{props:{type:Object,required:!0},item:{type:Object,required:!0},itemKey:{type:String,default:""}},computed:{info:function(){return this.itemKey?this.itemKey.split(".").reduce((function(t,e){return t?t[e]:t}),this.item):""}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",[i("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.props.select(t.item)}}},[i("span",{domProps:{innerHTML:t._s(t.props.highlight(t.item))}}),t._v(" "),t.info?i("span",[i("br"),i("small",{staticClass:"typeahead-item-info",attrs:{title:t.info},domProps:{textContent:t._s(t.info)}})]):t._e()])])}),[],!1,null,null,null);function Jl(t){return(Jl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}const Ql=Tl({components:{typeahead:Hl,typeaheadItem:Zl.exports},props:{items:{type:Array,required:!0},placeholder:{type:String,default:"Item name"},disabled:{type:Boolean,default:!1},value:{type:String,default:""},clearOnSelect:{type:Boolean,default:!1},moreInfo:{type:String,default:""},limit:{type:Number,default:5}},data:function(){return{inputElement:null,internalValue:void 0}},methods:{clear:function(){this.internalValue=void 0,this.$refs.input.value=""},emitFocus:function(t){this.$emit("focus",t)},emitBlur:function(t){this.$emit("blur",t)}},watch:{internalValue:function(t){"object"===Jl(t)&&(this.$emit("input",t),this.$emit("select",t),this.clearOnSelect&&this.clear())},value:function(t){this.internalValue=t}},created:function(){this.internalValue=this.value},mounted:function(){this.inputElement=this.$refs.input}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"typeahead clearfix"},[i("input",{ref:"input",staticClass:"form-control",attrs:{type:"text",disabled:t.disabled,placeholder:t.placeholder},on:{focus:t.emitFocus,blue:t.emitBlur}}),t._v(" "),i("typeahead",{attrs:{target:t.inputElement,data:t.items,"force-select":!0,limit:t.limit,"item-key":"name"},scopedSlots:t._u([{key:"item",fn:function(e){return t._l(e.items,(function(n,r){return i("typeahead-item",{key:r,class:{active:e.activeIndex===r},attrs:{props:e,item:n,"item-key":t.moreInfo}})}))}}]),model:{value:t.internalValue,callback:function(e){t.internalValue=e},expression:"internalValue"}})],1)}),[],!1,null,null,null).exports;var tu={},eu=function(t,e,i){tu.hasOwnProperty(i)&&window.clearTimeout(tu[i]),tu[i]=window.setTimeout(t,e)},iu=new Vue({data:{params:{}},methods:{setSlug:function(t,e){e=e||-1;var i=window.location.pathname.replace(/\/$/,""),n=i.split("/");n.splice(e,1,t),n=n.join("/"),this.replaceState(window.location.href.replace(i,n))},set:function(t){this.params=t,this.updateSearch()},unset:function(t){delete this.params[t],this.updateSearch()},get:function(t){return this.params[t]},updateSearch:function(){var t=[],e=window.location.href;for(var i in this.params)this.params.hasOwnProperty(i)&&t.push(i+"="+this.params[i]);t=t.length>0?"?"+t.join("&"):"",window.location.search?this.replaceState(e.replace(window.location.search,t)):-1!==e.indexOf("#")?window.location.hash?this.replaceState(e.replace(window.location.hash,t+window.location.hash)):this.replaceState(e.slice(0,-1)+t):this.replaceState(e+t)},replaceState:function(t){history.replaceState(null,null,t)}},created:function(){var t=window.location.search.substr(1);if(t)for(var e,i=(t=t.split("&")).length-1;i>=0;i--)e=t[i].split("="),this.params[e[0]]=e[1]}}),nu={},ru={},ou=function(t,e,i){ru[i]=t,nu.hasOwnProperty(i)||(nu[i]=window.setTimeout((function(){ru[i](),delete nu[i]}),e))},su=function(t){return"string"!=typeof t?"":t.charAt(0).toUpperCase()+t.slice(1)},au=new Vue({data:{max:1,all:[]},methods:{post:function(t,e){document.fullscreenElement&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()),this.all.unshift({id:Date.now(),type:t,text:e}),this.all.length>this.max&&this.all.pop()},danger:function(t){this.post("danger",t)},warning:function(t){this.post("warning",t)},success:function(t){this.post("success",t)},info:function(t){this.post("info",t)},close:function(t){for(var e=this.all.length-1;e>=0;e--)this.all[e].id===t&&this.all.splice(e,1)},handleErrorResponse:function(t){var e=t.body;if(e){if(422===t.status&&e.errors){for(var i in e.errors)this.danger(e.errors[i][0]);return}if(e.message)return void this.danger(e.message);if("string"==typeof e)return void this.danger(e)}403===t.status?this.danger("You have no permission to do that."):401===t.status?this.danger("Please log in (again)."):this.danger("The server didn't respond, sorry.")},handleResponseError:function(t){return this.handleErrorResponse(t)}}}),lu=au.handleErrorResponse;const uu=Tl(au,undefined,undefined,!1,null,null,null).exports;const hu=Tl({data:function(){return{editing:!1}},methods:{startEditing:function(){this.editing=!0,this.$emit("editing.start")},finishEditing:function(){this.editing=!1,this.$emit("editing.stop")},toggleEditing:function(){this.editing?this.finishEditing():this.startEditing()}}},undefined,undefined,!1,null,null,null).exports;const cu=Tl({components:{loader:El,loaderBlock:Al,messageCurtain:Il},data:function(){return{instancesLoading:0}},computed:{loading:function(){return this.instancesLoading>0}},watch:{loading:function(t){this.$emit("loading",t)}},methods:{startLoading:function(){this.instancesLoading+=1},finishLoading:function(){this.instancesLoading>0&&(this.instancesLoading-=1)},handleErrorResponse:function(t){return uu.handleErrorResponse(t)}}},undefined,undefined,!1,null,null,null).exports;const du=Tl(Vue.extend({data:function(){return{urlParams:[],storageKey:"biigle.settings",defaults:{},data:{}}},methods:{set:function(t,e){e===this.defaults[t]?this.delete(t):this.has(t)?this.data[t]=e:Vue.set(this.data,t,e),eu(this.persist,100,this.storageKey)},delete:function(t){Vue.delete(this.data,t),this.persist()},get:function(t){return this.has(t)?this.data[t]:this.defaults[t]},has:function(t){return this.data.hasOwnProperty(t)},persist:function(){Object.keys(this.data).length>0?window.localStorage.setItem(this.storageKey,JSON.stringify(this.data)):window.localStorage.removeItem(this.storageKey)},restoreFromLocalStorage:function(){var t=JSON.parse(window.localStorage.getItem(this.storageKey));t&&Vue.set(this,"data",t)},restoreFromUrlParams:function(t){var e=this,i=iu.params;(t=t||Object.keys(i)).forEach((function(t){i.hasOwnProperty(t)&&Vue.set(e.data,t,i[t])}))},watch:function(t,e){return this.$watch("data.".concat(t),e)}},created:function(){this.restoreFromLocalStorage(),this.urlParams.length>0&&this.restoreFromUrlParams(this.urlParams)}}),undefined,undefined,!1,null,null,null).exports;function fu(t){return"function"==typeof t}function pu(t){return"string"==typeof t}var gu="mouseenter",mu="mouseleave",vu="focus",yu="blur",_u="click",bu="click",wu="hover",xu="focus",Su="hover-focus",Cu="outside-click",Tu="top",Eu="right",Iu="bottom",Au="left";function Pu(t,e,i){t.addEventListener(e,i)}function ku(t,e,i){t.removeEventListener(e,i)}function Ru(t){return t&&t.nodeType===Node.ELEMENT_NODE}function Lu(t){Ru(t)&&Ru(t.parentNode)&&t.parentNode.removeChild(t)}function Fu(t,e){if(Ru(t))if(t.className){var i=t.className.split(" ");i.indexOf(e)<0&&(i.push(e),t.className=i.join(" "))}else t.className=e}function Mu(t,e){if(Ru(t)&&t.className){for(var i=t.className.split(" "),n=[],r=0,o=i.length;r<o;r++)i[r]!==e&&n.push(i[r]);t.className=n.join(" ")}}function Ou(t,e,i){var n=t.getBoundingClientRect(),r=e.getBoundingClientRect(),o={width:Math.max(document.documentElement.clientWidth,window.innerWidth)||0,height:Math.max(document.documentElement.clientHeight,window.innerHeight)||0},s=!0,a=!0,l=!0,u=!0;switch(i){case Tu:s=n.top>=r.height,u=n.left+n.width/2>=r.width/2,a=n.right-n.width/2+r.width/2<=o.width;break;case Iu:l=n.bottom+r.height<=o.height,u=n.left+n.width/2>=r.width/2,a=n.right-n.width/2+r.width/2<=o.width;break;case Eu:a=n.right+r.width<=o.width,s=n.top+n.height/2>=r.height/2,l=n.bottom-n.height/2+r.height/2<=o.height;break;case Au:u=n.left>=r.width,s=n.top+n.height/2>=r.height/2,l=n.bottom-n.height/2+r.height/2<=o.height}return s&&a&&l&&u}function $u(){return document.querySelectorAll(".modal-backdrop").length}function Du(t){return pu(t)?document.querySelector(t):Ru(t)?t:Ru(t.$el)?t.$el:null}var ju="in";const Nu={mixins:[{props:{value:{type:Boolean,default:!1},tag:{type:String,default:"span"},placement:{type:String,default:Tu},autoPlacement:{type:Boolean,default:!0},appendTo:{type:null,default:"body"},positionBy:{type:null,default:null},transition:{type:Number,default:150},hideDelay:{type:Number,default:0},showDelay:{type:Number,default:0},enable:{type:Boolean,default:!0},enterable:{type:Boolean,default:!0},target:null,viewport:null,customClass:String},data:function(){return{triggerEl:null,hideTimeoutId:0,showTimeoutId:0,transitionTimeoutId:0,autoTimeoutId:0}},watch:{value:function(t){t?this.show():this.hide()},trigger:function(){this.clearListeners(),this.initListeners()},target:function(t){this.clearListeners(),this.initTriggerElByTarget(t),this.initListeners()},allContent:function(t){var e=this;this.isNotEmpty()?this.$nextTick((function(){e.isShown()&&e.resetPosition()})):this.hide()},enable:function(t){t||this.hide()}},mounted:function(){var t=this;Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),i=e.length;--i>=0&&e.item(i)!==this;);return i>-1}),Lu(this.$refs.popup),this.$nextTick((function(){t.initTriggerElByTarget(t.target),t.initListeners(),t.value&&t.show()}))},beforeDestroy:function(){this.clearListeners(),Lu(this.$refs.popup)},methods:{initTriggerElByTarget:function(t){if(t)this.triggerEl=Du(t);else{var e=this.$el.querySelector('[data-role="trigger"]');if(e)this.triggerEl=e;else{var i=this.$el.firstChild;this.triggerEl=i===this.$refs.popup?null:i}}},initListeners:function(){this.triggerEl&&(this.trigger===wu?(Pu(this.triggerEl,gu,this.show),Pu(this.triggerEl,mu,this.hide)):this.trigger===xu?(Pu(this.triggerEl,vu,this.show),Pu(this.triggerEl,yu,this.hide)):this.trigger===Su?(Pu(this.triggerEl,gu,this.handleAuto),Pu(this.triggerEl,mu,this.handleAuto),Pu(this.triggerEl,vu,this.handleAuto),Pu(this.triggerEl,yu,this.handleAuto)):this.trigger!==bu&&this.trigger!==Cu||Pu(this.triggerEl,_u,this.toggle)),Pu(window,_u,this.windowClicked)},clearListeners:function(){this.triggerEl&&(ku(this.triggerEl,vu,this.show),ku(this.triggerEl,yu,this.hide),ku(this.triggerEl,gu,this.show),ku(this.triggerEl,mu,this.hide),ku(this.triggerEl,_u,this.toggle),ku(this.triggerEl,gu,this.handleAuto),ku(this.triggerEl,mu,this.handleAuto),ku(this.triggerEl,vu,this.handleAuto),ku(this.triggerEl,yu,this.handleAuto)),ku(window,_u,this.windowClicked),this.clearTimeouts()},clearTimeouts:function(){this.hideTimeoutId&&(clearTimeout(this.hideTimeoutId),this.hideTimeoutId=0),this.showTimeoutId&&(clearTimeout(this.showTimeoutId),this.showTimeoutId=0),this.transitionTimeoutId&&(clearTimeout(this.transitionTimeoutId),this.transitionTimeoutId=0),this.autoTimeoutId&&(clearTimeout(this.autoTimeoutId),this.autoTimeoutId=0)},resetPosition:function(){var t=this.$refs.popup;t&&(!function(t,e,i,n,r,o,s){if(Ru(t)&&Ru(e)){var a,l,u=t&&t.className&&t.className.indexOf("popover")>=0;if(null==r||"body"===r||"body"===o){var h=document.documentElement;l=(window.pageXOffset||h.scrollLeft)-(h.clientLeft||0),a=(window.pageYOffset||h.scrollTop)-(h.clientTop||0)}else{var c=Du(o||r);l=c.scrollLeft,a=c.scrollTop}if(n){var d=[Eu,Iu,Au,Tu],f=function(e){d.forEach((function(e){Mu(t,e)})),Fu(t,e)};if(!Ou(e,t,i)){for(var p=0,g=d.length;p<g;p++)if(f(d[p]),Ou(e,t,d[p])){i=d[p];break}f(i)}}var m,v,y,_=e.getBoundingClientRect(),b=t.getBoundingClientRect();if(i===Iu?(m=a+_.top+_.height,v=l+_.left+_.width/2-b.width/2):i===Au?(m=a+_.top+_.height/2-b.height/2,v=l+_.left-b.width):i===Eu?(m=a+_.top+_.height/2-b.height/2,v=l+_.left+_.width+1):(m=a+_.top-b.height,v=l+_.left+_.width/2-b.width/2),pu(s)?y=document.querySelector(s):fu(s)&&(y=s(e)),Ru(y)){var w=u?11:0,x=y.getBoundingClientRect(),S=a+x.top,C=l+x.left,T=S+x.height,E=C+x.width;m<S?m=S:m+b.height>T&&(m=T-b.height),v<C?v=C:v+b.width>E&&(v=E-b.width),i===Iu?m-=w:i===Au?v+=w:i===Eu?v-=w:m+=w}t.style.top=m+"px",t.style.left=v+"px"}}(t,this.triggerEl,this.placement,this.autoPlacement,this.appendTo,this.positionBy,this.viewport),t.offsetHeight)},hideOnLeave:function(){(this.trigger===wu||this.trigger===Su&&!this.triggerEl.matches(":focus"))&&this.$hide()},toggle:function(){this.isShown()?this.hide():this.show()},show:function(){var t=this;if(this.enable&&this.triggerEl&&this.isNotEmpty()&&!this.isShown()){var e=this.hideTimeoutId>0;e&&(clearTimeout(this.hideTimeoutId),this.hideTimeoutId=0),this.transitionTimeoutId>0&&(clearTimeout(this.transitionTimeoutId),this.transitionTimeoutId=0),clearTimeout(this.showTimeoutId),this.showTimeoutId=setTimeout((function(){t.showTimeoutId=0;var i=t.$refs.popup;if(i){var n=$u();if(n>1){var r="popover"===t.name?1060:1070,o=20*(n-1);i.style.zIndex=""+(r+o)}if(!e)i.className=t.name+" "+t.placement+" "+(t.customClass?t.customClass:"")+" fade",Du(t.appendTo).appendChild(i),t.resetPosition();Fu(i,ju),t.$emit("input",!0),t.$emit("show")}}),this.showDelay)}},hide:function(){var t=this;this.showTimeoutId>0&&(clearTimeout(this.showTimeoutId),this.showTimeoutId=0),this.isShown()&&(!this.enterable||this.trigger!==wu&&this.trigger!==Su?this.$hide():(clearTimeout(this.hideTimeoutId),this.hideTimeoutId=setTimeout((function(){t.hideTimeoutId=0;var e=t.$refs.popup;e&&!e.matches(":hover")&&t.$hide()}),100)))},$hide:function(){var t=this;this.isShown()&&(clearTimeout(this.hideTimeoutId),this.hideTimeoutId=setTimeout((function(){t.hideTimeoutId=0,Mu(t.$refs.popup,ju),t.transitionTimeoutId=setTimeout((function(){t.transitionTimeoutId=0,Lu(t.$refs.popup),t.$emit("input",!1),t.$emit("hide")}),t.transition)}),this.hideDelay))},isShown:function(){return function(t,e){if(!Ru(t))return!1;for(var i=t.className.split(" "),n=0,r=i.length;n<r;n++)if(i[n]===e)return!0;return!1}(this.$refs.popup,ju)},windowClicked:function(t){!this.triggerEl||!fu(this.triggerEl.contains)||this.triggerEl.contains(t.target)||this.trigger!==Cu||this.$refs.popup&&this.$refs.popup.contains(t.target)||!this.isShown()||this.hide()},handleAuto:function(){var t=this;clearTimeout(this.autoTimeoutId),this.autoTimeoutId=setTimeout((function(){t.autoTimeoutId=0,t.triggerEl.matches(":hover, :focus")?t.show():t.hide()}),20)}}}],data:function(){return{name:"popover"}},render:function(t){return t(this.tag,[this.$slots.default,t("div",{style:{display:"block"},ref:"popup",on:{mouseleave:this.hideOnLeave}},[t("div",{class:"arrow"}),t("h3",{class:"popover-title",directives:[{name:"show",value:this.title}]},this.title),t("div",{class:"popover-content"},[this.content||this.$slots.popover])])])},props:{title:{type:String,default:""},content:{type:String,default:""},trigger:{type:String,default:Cu}},computed:{allContent:function(){return this.title+this.content}},methods:{isNotEmpty:function(){return this.title||this.content||this.$slots.popover}}};function Bu(t){return t&&t.nodeType===Node.ELEMENT_NODE}function Uu(t,e){if(Bu(t))if(t.className){var i=t.className.split(" ");i.indexOf(e)<0&&(i.push(e),t.className=i.join(" "))}else t.className=e}function zu(t,e){if(Bu(t)&&t.className){for(var i=t.className.split(" "),n=[],r=0,o=i.length;r<o;r++)i[r]!==e&&n.push(i[r]);t.className=n.join(" ")}}function Vu(t){return(Vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gu(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var qu="undefined"!=typeof window;function Wu(t,e){return e.reduce((function(e,i){return t.hasOwnProperty(i)&&(e[i]=t[i]),e}),{})}var Ku={},Xu={},Yu={},Hu=new(ya.extend({data:function(){return{transports:Ku,targets:Xu,sources:Yu,trackInstances:qu}},methods:{open:function(t){if(qu){var e=t.to,i=t.from,n=t.passengers,r=t.order,o=void 0===r?1/0:r;if(e&&i&&n){var s,a={to:e,from:i,passengers:(s=n,Array.isArray(s)||"object"===Vu(s)?Object.freeze(s):s),order:o};-1===Object.keys(this.transports).indexOf(e)&&ya.set(this.transports,e,[]);var l,u=this.$_getTransportIndex(a),h=this.transports[e].slice(0);-1===u?h.push(a):h[u]=a,this.transports[e]=(l=function(t,e){return t.order-e.order},h.map((function(t,e){return[e,t]})).sort((function(t,e){return l(t[1],e[1])||t[0]-e[0]})).map((function(t){return t[1]})))}}},close:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t.to,n=t.from;if(i&&(n||!1!==e)&&this.transports[i])if(e)this.transports[i]=[];else{var r=this.$_getTransportIndex(t);if(r>=0){var o=this.transports[i].slice(0);o.splice(r,1),this.transports[i]=o}}},registerTarget:function(t,e,i){qu&&(this.trackInstances&&!i&&this.targets[t]&&console.warn("[portal-vue]: Target ".concat(t," already exists")),this.$set(this.targets,t,Object.freeze([e])))},unregisterTarget:function(t){this.$delete(this.targets,t)},registerSource:function(t,e,i){qu&&(this.trackInstances&&!i&&this.sources[t]&&console.warn("[portal-vue]: source ".concat(t," already exists")),this.$set(this.sources,t,Object.freeze([e])))},unregisterSource:function(t){this.$delete(this.sources,t)},hasTarget:function(t){return!(!this.targets[t]||!this.targets[t][0])},hasSource:function(t){return!(!this.sources[t]||!this.sources[t][0])},hasContentFor:function(t){return!!this.transports[t]&&!!this.transports[t].length},$_getTransportIndex:function(t){var e=t.to,i=t.from;for(var n in this.transports[e])if(this.transports[e][n].from===i)return+n;return-1}}}))(Ku),Zu=1,Ju=ya.extend({name:"portal",props:{disabled:{type:Boolean},name:{type:String,default:function(){return String(Zu++)}},order:{type:Number,default:0},slim:{type:Boolean},slotProps:{type:Object,default:function(){return{}}},tag:{type:String,default:"DIV"},to:{type:String,default:function(){return String(Math.round(1e7*Math.random()))}}},created:function(){var t=this;this.$nextTick((function(){Hu.registerSource(t.name,t)}))},mounted:function(){this.disabled||this.sendUpdate()},updated:function(){this.disabled?this.clear():this.sendUpdate()},beforeDestroy:function(){Hu.unregisterSource(this.name),this.clear()},watch:{to:function(t,e){e&&e!==t&&this.clear(e),this.sendUpdate()}},methods:{clear:function(t){var e={from:this.name,to:t||this.to};Hu.close(e)},normalizeSlots:function(){return this.$scopedSlots.default?[this.$scopedSlots.default]:this.$slots.default},normalizeOwnChildren:function(t){return"function"==typeof t?t(this.slotProps):t},sendUpdate:function(){var t=this.normalizeSlots();if(t){var e={from:this.name,to:this.to,passengers:Gu(t),order:this.order};Hu.open(e)}else this.clear()}},render:function(t){var e=this.$slots.default||this.$scopedSlots.default||[],i=this.tag;return e&&this.disabled?e.length<=1&&this.slim?this.normalizeOwnChildren(e)[0]:t(i,[this.normalizeOwnChildren(e)]):this.slim?t():t(i,{class:{"v-portal":!0},style:{display:"none"},key:"v-portal-placeholder"})}}),Qu=ya.extend({name:"portalTarget",props:{multiple:{type:Boolean,default:!1},name:{type:String,required:!0},slim:{type:Boolean,default:!1},slotProps:{type:Object,default:function(){return{}}},tag:{type:String,default:"div"},transition:{type:[String,Object,Function]}},data:function(){return{transports:Hu.transports,firstRender:!0}},created:function(){var t=this;this.$nextTick((function(){Hu.registerTarget(t.name,t)}))},watch:{ownTransports:function(){this.$emit("change",this.children().length>0)},name:function(t,e){Hu.unregisterTarget(e),Hu.registerTarget(t,this)}},mounted:function(){var t=this;this.transition&&this.$nextTick((function(){t.firstRender=!1}))},beforeDestroy:function(){Hu.unregisterTarget(this.name)},computed:{ownTransports:function(){var t=this.transports[this.name]||[];return this.multiple?t:0===t.length?[]:[t[t.length-1]]},passengers:function(){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.reduce((function(t,i){var n=i.passengers[0],r="function"==typeof n?n(e):i.passengers;return t.concat(r)}),[])}(this.ownTransports,this.slotProps)}},methods:{children:function(){return 0!==this.passengers.length?this.passengers:this.$scopedSlots.default?this.$scopedSlots.default(this.slotProps):this.$slots.default||[]},noWrapper:function(){var t=this.slim&&!this.transition;return t&&this.children().length>1&&console.warn("[portal-vue]: PortalTarget with `slim` option received more than one child element."),t}},render:function(t){var e=this.noWrapper(),i=this.children(),n=this.transition||this.tag;return e?i[0]:this.slim&&!n?t():t(n,{props:{tag:this.transition&&this.tag?this.tag:void 0},class:{"vue-portal-target":!0}},i)}}),th=0,eh=["disabled","name","order","slim","slotProps","tag","to"],ih=["multiple","transition"];ya.extend({name:"MountingPortal",inheritAttrs:!1,props:{append:{type:[Boolean,String]},bail:{type:Boolean},mountTo:{type:String,required:!0},disabled:{type:Boolean},name:{type:String,default:function(){return"mounted_"+String(th++)}},order:{type:Number,default:0},slim:{type:Boolean},slotProps:{type:Object,default:function(){return{}}},tag:{type:String,default:"DIV"},to:{type:String,default:function(){return String(Math.round(1e7*Math.random()))}},multiple:{type:Boolean,default:!1},targetSlim:{type:Boolean},targetSlotProps:{type:Object,default:function(){return{}}},targetTag:{type:String,default:"div"},transition:{type:[String,Object,Function]}},created:function(){if("undefined"!=typeof document){var t=document.querySelector(this.mountTo);if(t){var e=this.$props;if(Hu.targets[e.name])e.bail?console.warn("[portal-vue]: Target ".concat(e.name," is already mounted.\n        Aborting because 'bail: true' is set")):this.portalTarget=Hu.targets[e.name];else{var i=e.append;if(i){var n="string"==typeof i?i:"DIV",r=document.createElement(n);t.appendChild(r),t=r}var o=Wu(this.$props,ih);o.slim=this.targetSlim,o.tag=this.targetTag,o.slotProps=this.targetSlotProps,o.name=this.to,this.portalTarget=new Qu({el:t,parent:this.$parent||this,propsData:o})}}else console.error("[portal-vue]: Mount Point '".concat(this.mountTo,"' not found in document"))}},beforeDestroy:function(){var t=this.portalTarget;if(this.append){var e=t.$el;e.parentNode.removeChild(e)}t.$destroy()},render:function(t){if(!this.portalTarget)return console.warn("[portal-vue] Target wasn't mounted"),t();if(!this.$scopedSlots.manual){var e=Wu(this.$props,eh);return t(Ju,{props:e,attrs:this.$attrs,on:this.$listeners,scopedSlots:this.$scopedSlots},this.$slots.default)}var i=this.$scopedSlots.manual({to:this.to});return Array.isArray(i)&&(i=i[0]),i||t()}});var nh="active",rh="in";function oh(t,e,i,n,r,o,s,a,l,u){"boolean"!=typeof s&&(l=a,a=s,s=!1);var h,c="function"==typeof i?i.options:i;if(t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,r&&(c.functional=!0)),n&&(c._scopeId=n),o?(h=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},c._ssrRegister=h):e&&(h=s?function(t){e.call(this,u(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,a(t))}),h)if(c.functional){var d=c.render;c.render=function(t,e){return h.call(e),d(t,e)}}else{var f=c.beforeCreate;c.beforeCreate=f?[].concat(f,h):[h]}return i}var sh={components:{Portal:Ju},props:{title:{type:String,default:"Tab Title"},disabled:{type:Boolean,default:!1},tabClasses:{type:Object,default:function(){return{}}},group:String,pullRight:{type:Boolean,default:!1},hidden:{type:Boolean,default:!1}},data:function(){return{active:!0,transition:150}},watch:{active:function(t){var e=this;t?setTimeout((function(){Uu(e.$el,nh),e.$el.offsetHeight,Uu(e.$el,rh);try{e.$parent.$emit("changed",e.$parent.activeIndex)}catch(t){throw new Error("<tab> parent must be <tabs>.")}}),this.transition):(zu(this.$el,rh),setTimeout((function(){zu(e.$el,nh)}),this.transition))}},created:function(){try{this.$parent.tabs.push(this)}catch(t){throw new Error("<tab> parent must be <tabs>.")}},beforeDestroy:function(){!function(t,e){if(Array.isArray(t)){var i=t.indexOf(e);i>=0&&t.splice(i,1)}}(this.$parent&&this.$parent.tabs,this)},methods:{show:function(){var t=this;this.$nextTick((function(){Uu(t.$el,nh),Uu(t.$el,rh)}))}}},ah=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tab-pane",class:{fade:t.transition>0},attrs:{role:"tabpanel"}},[t._t("default"),t._v(" "),i("portal",{attrs:{to:t._uid.toString()}},[t._t("title")],2)],2)};ah._withStripped=!0;const lh=oh({render:ah,staticRenderFns:[]},undefined,sh,undefined,false,undefined,!1,void 0,void 0,void 0);function uh(t,e){var i=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1;r<arguments.length;r++){var o=i[r];if(null!=o)for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])}return n}function hh(t){return null!=t}function ch(t){return"number"==typeof t}function dh(t){return"string"==typeof t}var fh="click",ph="keydown",gh="touchend";function mh(t,e,i){t.addEventListener(e,i)}function vh(t,e,i){t.removeEventListener(e,i)}function yh(t){(function(t){return t&&t.nodeType===Node.ELEMENT_NODE})(t)&&(!t.getAttribute("tabindex")&&t.setAttribute("tabindex","-1"),t.focus())}var _h={render:function(t){return t(this.tag,{class:{"btn-group":"div"===this.tag,dropdown:!this.dropup,dropup:this.dropup,open:this.show}},[this.$slots.default,t("ul",{class:{"dropdown-menu":!0,"dropdown-menu-right":this.menuRight},ref:"dropdown"},[this.$slots.dropdown])])},props:{tag:{type:String,default:"div"},appendToBody:{type:Boolean,default:!1},value:Boolean,dropup:{type:Boolean,default:!1},menuRight:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},notCloseElements:Array,positionElement:null},data:function(){return{show:!1,triggerEl:void 0}},watch:{value:function(t){this.toggle(t)}},mounted:function(){this.initTrigger(),this.triggerEl&&(mh(this.triggerEl,fh,this.toggle),mh(this.triggerEl,ph,this.onKeyPress)),mh(this.$refs.dropdown,ph,this.onKeyPress),mh(window,fh,this.windowClicked),mh(window,gh,this.windowClicked),this.value&&this.toggle(!0)},beforeDestroy:function(){this.removeDropdownFromBody(),this.triggerEl&&(vh(this.triggerEl,fh,this.toggle),vh(this.triggerEl,ph,this.onKeyPress)),vh(this.$refs.dropdown,ph,this.onKeyPress),vh(window,fh,this.windowClicked),vh(window,gh,this.windowClicked)},methods:{getFocusItem:function(){return this.$refs.dropdown.querySelector("li > a:focus")},onKeyPress:function(t){if(this.show){var e=this.$refs.dropdown,i=t.keyCode;if(27===i)this.toggle(!1),this.triggerEl&&this.triggerEl.focus();else if(13===i){var n=this.getFocusItem();n&&n.click()}else if(38===i||40===i){t.preventDefault(),t.stopPropagation();var r=this.getFocusItem(),o=e.querySelectorAll("li:not(.disabled) > a");if(r){for(var s=0;s<o.length;s++)if(r===o[s]){38===i&&s<o.length>0?yh(o[s-1]):40===i&&s<o.length-1&&yh(o[s+1]);break}}else yh(o[0])}}},initTrigger:function(){var t=this.$el.querySelector('[data-role="trigger"]')||this.$el.querySelector(".dropdown-toggle")||this.$el.firstChild;this.triggerEl=t&&t!==this.$refs.dropdown?t:null},toggle:function(t){var e;this.disabled||(e=t,this.show="boolean"==typeof e?t:!this.show,this.appendToBody&&(this.show?this.appendDropdownToBody():this.removeDropdownFromBody()),this.$emit("input",this.show))},windowClicked:function(t){var e=t.target;if(this.show&&e){var i=!1;if(this.notCloseElements)for(var n=0,r=this.notCloseElements.length;n<r;n++){var o=this.notCloseElements[n].contains(e),s=o;if(this.appendToBody){var a=this.$refs.dropdown.contains(e),l=this.notCloseElements.indexOf(this.$el)>=0;s=o||a&&l}if(s){i=!0;break}}var u=this.$refs.dropdown.contains(e),h=this.$el.contains(e)&&!u,c=u&&"touchend"===t.type;h||i||c||this.toggle(!1)}},appendDropdownToBody:function(){try{var t=this.$refs.dropdown;t.style.display="block",document.body.appendChild(t),function(t,e,i){void 0===i&&(i={});var n=document.documentElement,r=(window.pageXOffset||n.scrollLeft)-(n.clientLeft||0),o=(window.pageYOffset||n.scrollTop)-(n.clientTop||0),s=e.getBoundingClientRect(),a=t.getBoundingClientRect();t.style.right="auto",t.style.bottom="auto",i.menuRight?t.style.left=r+s.left+s.width-a.width+"px":t.style.left=r+s.left+"px",i.dropup?t.style.top=o+s.top-a.height-4+"px":t.style.top=o+s.top+s.height+"px"}(t,this.positionElement||this.$el,this)}catch(t){}},removeDropdownFromBody:function(){try{var t=this.$refs.dropdown;t.removeAttribute("style"),this.$el.appendChild(t)}catch(t){}}}};function bh(t){return(bh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wh(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var xh="undefined"!=typeof window;function Sh(t,e){return e.reduce((function(e,i){return t.hasOwnProperty(i)&&(e[i]=t[i]),e}),{})}var Ch={},Th={},Eh={},Ih=new(ya.extend({data:function(){return{transports:Ch,targets:Th,sources:Eh,trackInstances:xh}},methods:{open:function(t){if(xh){var e=t.to,i=t.from,n=t.passengers,r=t.order,o=void 0===r?1/0:r;if(e&&i&&n){var s,a={to:e,from:i,passengers:(s=n,Array.isArray(s)||"object"===bh(s)?Object.freeze(s):s),order:o};-1===Object.keys(this.transports).indexOf(e)&&ya.set(this.transports,e,[]);var l,u=this.$_getTransportIndex(a),h=this.transports[e].slice(0);-1===u?h.push(a):h[u]=a,this.transports[e]=(l=function(t,e){return t.order-e.order},h.map((function(t,e){return[e,t]})).sort((function(t,e){return l(t[1],e[1])||t[0]-e[0]})).map((function(t){return t[1]})))}}},close:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t.to,n=t.from;if(i&&(n||!1!==e)&&this.transports[i])if(e)this.transports[i]=[];else{var r=this.$_getTransportIndex(t);if(r>=0){var o=this.transports[i].slice(0);o.splice(r,1),this.transports[i]=o}}},registerTarget:function(t,e,i){xh&&(this.trackInstances&&!i&&this.targets[t]&&console.warn("[portal-vue]: Target ".concat(t," already exists")),this.$set(this.targets,t,Object.freeze([e])))},unregisterTarget:function(t){this.$delete(this.targets,t)},registerSource:function(t,e,i){xh&&(this.trackInstances&&!i&&this.sources[t]&&console.warn("[portal-vue]: source ".concat(t," already exists")),this.$set(this.sources,t,Object.freeze([e])))},unregisterSource:function(t){this.$delete(this.sources,t)},hasTarget:function(t){return!(!this.targets[t]||!this.targets[t][0])},hasSource:function(t){return!(!this.sources[t]||!this.sources[t][0])},hasContentFor:function(t){return!!this.transports[t]&&!!this.transports[t].length},$_getTransportIndex:function(t){var e=t.to,i=t.from;for(var n in this.transports[e])if(this.transports[e][n].from===i)return+n;return-1}}}))(Ch),Ah=1,Ph=ya.extend({name:"portal",props:{disabled:{type:Boolean},name:{type:String,default:function(){return String(Ah++)}},order:{type:Number,default:0},slim:{type:Boolean},slotProps:{type:Object,default:function(){return{}}},tag:{type:String,default:"DIV"},to:{type:String,default:function(){return String(Math.round(1e7*Math.random()))}}},created:function(){var t=this;this.$nextTick((function(){Ih.registerSource(t.name,t)}))},mounted:function(){this.disabled||this.sendUpdate()},updated:function(){this.disabled?this.clear():this.sendUpdate()},beforeDestroy:function(){Ih.unregisterSource(this.name),this.clear()},watch:{to:function(t,e){e&&e!==t&&this.clear(e),this.sendUpdate()}},methods:{clear:function(t){var e={from:this.name,to:t||this.to};Ih.close(e)},normalizeSlots:function(){return this.$scopedSlots.default?[this.$scopedSlots.default]:this.$slots.default},normalizeOwnChildren:function(t){return"function"==typeof t?t(this.slotProps):t},sendUpdate:function(){var t=this.normalizeSlots();if(t){var e={from:this.name,to:this.to,passengers:wh(t),order:this.order};Ih.open(e)}else this.clear()}},render:function(t){var e=this.$slots.default||this.$scopedSlots.default||[],i=this.tag;return e&&this.disabled?e.length<=1&&this.slim?this.normalizeOwnChildren(e)[0]:t(i,[this.normalizeOwnChildren(e)]):this.slim?t():t(i,{class:{"v-portal":!0},style:{display:"none"},key:"v-portal-placeholder"})}}),kh=ya.extend({name:"portalTarget",props:{multiple:{type:Boolean,default:!1},name:{type:String,required:!0},slim:{type:Boolean,default:!1},slotProps:{type:Object,default:function(){return{}}},tag:{type:String,default:"div"},transition:{type:[String,Object,Function]}},data:function(){return{transports:Ih.transports,firstRender:!0}},created:function(){var t=this;this.$nextTick((function(){Ih.registerTarget(t.name,t)}))},watch:{ownTransports:function(){this.$emit("change",this.children().length>0)},name:function(t,e){Ih.unregisterTarget(e),Ih.registerTarget(t,this)}},mounted:function(){var t=this;this.transition&&this.$nextTick((function(){t.firstRender=!1}))},beforeDestroy:function(){Ih.unregisterTarget(this.name)},computed:{ownTransports:function(){var t=this.transports[this.name]||[];return this.multiple?t:0===t.length?[]:[t[t.length-1]]},passengers:function(){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.reduce((function(t,i){var n=i.passengers[0],r="function"==typeof n?n(e):i.passengers;return t.concat(r)}),[])}(this.ownTransports,this.slotProps)}},methods:{children:function(){return 0!==this.passengers.length?this.passengers:this.$scopedSlots.default?this.$scopedSlots.default(this.slotProps):this.$slots.default||[]},noWrapper:function(){var t=this.slim&&!this.transition;return t&&this.children().length>1&&console.warn("[portal-vue]: PortalTarget with `slim` option received more than one child element."),t}},render:function(t){var e=this.noWrapper(),i=this.children(),n=this.transition||this.tag;return e?i[0]:this.slim&&!n?t():t(n,{props:{tag:this.transition&&this.tag?this.tag:void 0},class:{"vue-portal-target":!0}},i)}}),Rh=0,Lh=["disabled","name","order","slim","slotProps","tag","to"],Fh=["multiple","transition"];ya.extend({name:"MountingPortal",inheritAttrs:!1,props:{append:{type:[Boolean,String]},bail:{type:Boolean},mountTo:{type:String,required:!0},disabled:{type:Boolean},name:{type:String,default:function(){return"mounted_"+String(Rh++)}},order:{type:Number,default:0},slim:{type:Boolean},slotProps:{type:Object,default:function(){return{}}},tag:{type:String,default:"DIV"},to:{type:String,default:function(){return String(Math.round(1e7*Math.random()))}},multiple:{type:Boolean,default:!1},targetSlim:{type:Boolean},targetSlotProps:{type:Object,default:function(){return{}}},targetTag:{type:String,default:"div"},transition:{type:[String,Object,Function]}},created:function(){if("undefined"!=typeof document){var t=document.querySelector(this.mountTo);if(t){var e=this.$props;if(Ih.targets[e.name])e.bail?console.warn("[portal-vue]: Target ".concat(e.name," is already mounted.\n        Aborting because 'bail: true' is set")):this.portalTarget=Ih.targets[e.name];else{var i=e.append;if(i){var n="string"==typeof i?i:"DIV",r=document.createElement(n);t.appendChild(r),t=r}var o=Sh(this.$props,Fh);o.slim=this.targetSlim,o.tag=this.targetTag,o.slotProps=this.targetSlotProps,o.name=this.to,this.portalTarget=new kh({el:t,parent:this.$parent||this,propsData:o})}}else console.error("[portal-vue]: Mount Point '".concat(this.mountTo,"' not found in document"))}},beforeDestroy:function(){var t=this.portalTarget;if(this.append){var e=t.$el;e.parentNode.removeChild(e)}t.$destroy()},render:function(t){if(!this.portalTarget)return console.warn("[portal-vue] Target wasn't mounted"),t();if(!this.$scopedSlots.manual){var e=Sh(this.$props,Lh);return t(Ph,{props:e,attrs:this.$attrs,on:this.$listeners,scopedSlots:this.$scopedSlots},this.$slots.default)}var i=this.$scopedSlots.manual({to:this.to});return Array.isArray(i)&&(i=i[0]),i||t()}});var Mh="before-change";function Oh(t,e,i,n,r,o,s,a,l,u){"boolean"!=typeof s&&(l=a,a=s,s=!1);var h,c="function"==typeof i?i.options:i;if(t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,r&&(c.functional=!0)),n&&(c._scopeId=n),o?(h=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},c._ssrRegister=h):e&&(h=s?function(t){e.call(this,u(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,a(t))}),h)if(c.functional){var d=c.render;c.render=function(t,e){return h.call(e),d(t,e)}}else{var f=c.beforeCreate;c.beforeCreate=f?[].concat(f,h):[h]}return i}var $h={components:{Dropdown:_h,PortalTarget:kh},props:{value:{type:Number,validator:function(t){return t>=0}},transition:{type:Number,default:150},justified:Boolean,pills:Boolean,stacked:Boolean,customNavClass:null,customContentClass:null},data:function(){return{tabs:[],activeIndex:0}},watch:{value:{immediate:!0,handler:function(t){ch(t)&&(this.activeIndex=t,this.selectCurrent())}},tabs:function(t){var e=this;t.forEach((function(t,i){t.transition=e.transition,i===e.activeIndex&&t.show()})),this.selectCurrent()}},computed:{navClasses:function(){var t,e={nav:!0,"nav-justified":this.justified,"nav-tabs":!this.pills,"nav-pills":this.pills,"nav-stacked":this.stacked&&this.pills},i=this.customNavClass;return hh(i)?dh(i)?uh({},e,((t={})[i]=!0,t)):uh({},e,i):e},contentClasses:function(){var t,e={"tab-content":!0},i=this.customContentClass;return hh(i)?dh(i)?uh({},e,((t={})[i]=!0,t)):uh({},e,i):e},groupedTabs:function(){var t=[],e={};return this.tabs.forEach((function(i){var n,r;i.group?(n=e,r=i.group,Object.prototype.hasOwnProperty.call(n,r)?t[e[i.group]].tabs.push(i):(t.push({tabs:[i],group:i.group}),e[i.group]=t.length-1),i.active&&(t[e[i.group]].active=!0),i.pullRight&&(t[e[i.group]].pullRight=!0)):t.push(i)})),t=t.map((function(t){return Array.isArray(t.tabs)&&(t.hidden=t.tabs.filter((function(t){return t.hidden})).length===t.tabs.length),t}))}},methods:{getTabClasses:function(t,e){return void 0===e&&(e=!1),uh({active:t.active,disabled:t.disabled,"pull-right":t.pullRight&&!e},t.tabClasses)},selectCurrent:function(){var t=this,e=!1;this.tabs.forEach((function(i,n){n===t.activeIndex?(e=!i.active,i.active=!0):i.active=!1})),e&&this.$emit("change",this.activeIndex)},selectValidate:function(t){var e=this;"function"==typeof this.$listeners["before-change"]?this.$emit(Mh,this.activeIndex,t,(function(i){hh(i)||e.$select(t)})):this.$select(t)},select:function(t){this.tabs[t].disabled||t===this.activeIndex||this.selectValidate(t)},$select:function(t){ch(this.value)?this.$emit("input",t):(this.activeIndex=t,this.selectCurrent())}}},Dh=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",[i("ul",{class:t.navClasses,attrs:{role:"tablist"}},[t._l(t.groupedTabs,(function(e,n){return[e.tabs?i("dropdown",{directives:[{name:"show",rawName:"v-show",value:!e.hidden,expression:"!tab.hidden"}],class:t.getTabClasses(e),attrs:{role:"presentation",tag:"li"}},[i("a",{staticClass:"dropdown-toggle",attrs:{role:"tab",href:"#"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(e.group)+" "),i("span",{staticClass:"caret"})]),t._v(" "),i("template",{slot:"dropdown"},t._l(e.tabs,(function(e){return i("li",{directives:[{name:"show",rawName:"v-show",value:!e.hidden,expression:"!subTab.hidden"}],class:t.getTabClasses(e,!0)},[i("a",{attrs:{href:"#"},on:{click:function(i){i.preventDefault(),t.select(t.tabs.indexOf(e))}}},[t._v(t._s(e.title))])])})),0)],2):i("li",{directives:[{name:"show",rawName:"v-show",value:!e.hidden,expression:"!tab.hidden"}],class:t.getTabClasses(e),attrs:{role:"presentation"}},[e.$slots.title?i("portal-target",{attrs:{name:e._uid.toString(),tag:"a",role:"tab",href:"#"},nativeOn:{click:function(i){i.preventDefault(),t.select(t.tabs.indexOf(e))}}}):i("a",{attrs:{role:"tab",href:"#"},domProps:{textContent:t._s(e.title)},on:{click:function(i){i.preventDefault(),t.select(t.tabs.indexOf(e))}}})],1)]})),t._v(" "),!t.justified&&t.$slots["nav-right"]?i("li",{staticClass:"pull-right"},[t._t("nav-right")],2):t._e()],2),t._v(" "),i("div",{class:t.contentClasses},[t._t("default")],2)])};Dh._withStripped=!0;const jh=Oh({render:Dh,staticRenderFns:[]},undefined,$h,undefined,false,undefined,!1,void 0,void 0,void 0);window.biigle={},window.biigle.$mount=fl,window.biigle.$declare=function(t,e){var i=(t=t.split(".")).pop();return pl(t)[i]=e,e},window.biigle.$require=pl,biigle.$declare("api.annotations",gl),biigle.$declare("api.images",ml),biigle.$declare("api.labels",vl),biigle.$declare("api.labelSource",yl),biigle.$declare("api.labelTree",_l),biigle.$declare("api.labelTreeVersion",bl),biigle.$declare("api.notifications",wl),biigle.$declare("api.projects",xl),biigle.$declare("api.users",Sl),biigle.$declare("api.volumes",Cl),biigle.$declare("core.components.loader",El),biigle.$declare("core.components.loaderBlock",Al),biigle.$declare("core.components.powerToggle",Pl),biigle.$declare("core.components.sidebar",Fl),biigle.$declare("core.components.sidebarTab",Ml),biigle.$declare("core.components.typeahead",Ql),biigle.$declare("messages",uu),biigle.$declare("messages.store",uu),window.$biiglePostMessage=uu.post,biigle.$declare("core.mixins.editor",hu),biigle.$declare("core.mixins.loader",cu),biigle.$declare("core.models.Settings",du),biigle.$declare("utils.debounce",eu),biigle.$declare("utils.urlParams",iu),biigle.$declare("urlParams",iu),biigle.$declare("utils.throttle",ou),biigle.$declare("events",Rl),biigle.$declare("keyboard",Ll),biigle.$declare("core.keyboard",Ll),biigle.$declare("uiv.popover",Nu),biigle.$declare("uiv.tab",lh),biigle.$declare("uiv.tabs",jh);const Nh=Tl({components:{message:{props:{id:{type:Number,required:!0},text:{type:String,required:!0},type:{type:String,default:"info"}},computed:{typeClass:function(){return"alert-".concat(this.type)}},methods:{close:function(){uu.close(this.id)},cancelTimeout:function(){this.closeTimeoutId&&(window.clearTimeout(this.closeTimeoutId),this.closeTimeoutId=null)}},mounted:function(){"danger"!==this.type&&(this.closeTimeoutId=window.setTimeout(this.close,15e3))}}},data:function(){return{messages:uu.all}},mounted:function(){var t=biigle.$require("staticMessage");t.text&&t.type&&this.$nextTick((function(){uu.post(t.type,t.text)}))}},undefined,undefined,!1,null,null,null).exports;const Bh=Tl(new Vue({data:{all:[],initialized:!1},computed:{unread:function(){return this.all.filter((function(t){return null===t.read_at}))},count:function(){return this.all.length},countUnread:function(){return this.unread.length}},methods:{remove:function(t){for(var e=this.all.length-1;e>=0;e--)this.all[e].id===t&&this.all.splice(e,1)},initialize:function(){if(!this.initialized){var t=biigle.$require("initialNotifications");this.all=t||[],this.initialized=!0}}}}),undefined,undefined,!1,null,null,null).exports;const Uh=Tl({components:{notification:{props:["item","removeItem"],data:function(){return{isLoading:!1}},computed:{classObject:function(){return this.item.data.type?"panel-".concat(this.item.data.type):"panel-default"},isUnread:function(){return null===this.item.read_at}},methods:{markRead:function(){var t=this;return this.isLoading=!0,wl.markRead({id:this.item.id},{}).then((function(){t.item.read_at=new Date,t.removeItem&&Bh.remove(t.item.id)})).catch(uu.handleErrorResponse).finally((function(){t.isLoading=!1}))},markReadAndOpenLink:function(){var t=this.item.data.actionLink;this.item.read_at?window.location=t:this.markRead().finally((function(){window.location=t}))}}}},data:function(){return{notifications:[]}},computed:{hasNotifications:function(){return Bh.count>0},hasUnreadNotifications:function(){return Bh.countUnread>0}},created:function(){Bh.initialize(),this.notifications=Bh.all}},undefined,undefined,!1,null,null,null).exports;const zh=Tl({computed:{unread:function(){return Bh.initialized?Bh.countUnread:parseInt(this.$el.attributes.unread.value)},hasUnread:function(){return this.unread>0},unreadText:function(){return this.hasUnread?this.unread:"no"},title:function(){return"You have ".concat(this.unreadText," unread notification(s)")}}},undefined,undefined,!1,null,null,null).exports;const Vh=Tl({computed:{count:function(){return Bh.countUnread}}},undefined,undefined,!1,null,null,null).exports;const Gh=Tl({data:function(){return{body:""}},beforeMount:function(){var t=document.getElementById("system-messages-edit-form").querySelector('textarea[name="body"]');t&&(this.body=t.value)}},undefined,undefined,!1,null,null,null).exports;var qh="click",Wh="keydown",Kh="touchend";function Xh(t,e,i){t.addEventListener(e,i)}function Yh(t,e,i){t.removeEventListener(e,i)}function Hh(t){(function(t){return t&&t.nodeType===Node.ELEMENT_NODE})(t)&&(!t.getAttribute("tabindex")&&t.setAttribute("tabindex","-1"),t.focus())}const Zh={render:function(t){return t(this.tag,{class:{"btn-group":"div"===this.tag,dropdown:!this.dropup,dropup:this.dropup,open:this.show}},[this.$slots.default,t("ul",{class:{"dropdown-menu":!0,"dropdown-menu-right":this.menuRight},ref:"dropdown"},[this.$slots.dropdown])])},props:{tag:{type:String,default:"div"},appendToBody:{type:Boolean,default:!1},value:Boolean,dropup:{type:Boolean,default:!1},menuRight:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},notCloseElements:Array,positionElement:null},data:function(){return{show:!1,triggerEl:void 0}},watch:{value:function(t){this.toggle(t)}},mounted:function(){this.initTrigger(),this.triggerEl&&(Xh(this.triggerEl,qh,this.toggle),Xh(this.triggerEl,Wh,this.onKeyPress)),Xh(this.$refs.dropdown,Wh,this.onKeyPress),Xh(window,qh,this.windowClicked),Xh(window,Kh,this.windowClicked),this.value&&this.toggle(!0)},beforeDestroy:function(){this.removeDropdownFromBody(),this.triggerEl&&(Yh(this.triggerEl,qh,this.toggle),Yh(this.triggerEl,Wh,this.onKeyPress)),Yh(this.$refs.dropdown,Wh,this.onKeyPress),Yh(window,qh,this.windowClicked),Yh(window,Kh,this.windowClicked)},methods:{getFocusItem:function(){return this.$refs.dropdown.querySelector("li > a:focus")},onKeyPress:function(t){if(this.show){var e=this.$refs.dropdown,i=t.keyCode;if(27===i)this.toggle(!1),this.triggerEl&&this.triggerEl.focus();else if(13===i){var n=this.getFocusItem();n&&n.click()}else if(38===i||40===i){t.preventDefault(),t.stopPropagation();var r=this.getFocusItem(),o=e.querySelectorAll("li:not(.disabled) > a");if(r){for(var s=0;s<o.length;s++)if(r===o[s]){38===i&&s<o.length>0?Hh(o[s-1]):40===i&&s<o.length-1&&Hh(o[s+1]);break}}else Hh(o[0])}}},initTrigger:function(){var t=this.$el.querySelector('[data-role="trigger"]')||this.$el.querySelector(".dropdown-toggle")||this.$el.firstChild;this.triggerEl=t&&t!==this.$refs.dropdown?t:null},toggle:function(t){var e;this.disabled||(e=t,this.show="boolean"==typeof e?t:!this.show,this.appendToBody&&(this.show?this.appendDropdownToBody():this.removeDropdownFromBody()),this.$emit("input",this.show))},windowClicked:function(t){var e=t.target;if(this.show&&e){var i=!1;if(this.notCloseElements)for(var n=0,r=this.notCloseElements.length;n<r;n++){var o=this.notCloseElements[n].contains(e),s=o;if(this.appendToBody){var a=this.$refs.dropdown.contains(e),l=this.notCloseElements.indexOf(this.$el)>=0;s=o||a&&l}if(s){i=!0;break}}var u=this.$refs.dropdown.contains(e),h=this.$el.contains(e)&&!u,c=u&&"touchend"===t.type;h||i||c||this.toggle(!1)}},appendDropdownToBody:function(){try{var t=this.$refs.dropdown;t.style.display="block",document.body.appendChild(t),function(t,e,i){void 0===i&&(i={});var n=document.documentElement,r=(window.pageXOffset||n.scrollLeft)-(n.clientLeft||0),o=(window.pageYOffset||n.scrollTop)-(n.clientTop||0),s=e.getBoundingClientRect(),a=t.getBoundingClientRect();t.style.right="auto",t.style.bottom="auto",i.menuRight?t.style.left=r+s.left+s.width-a.width+"px":t.style.left=r+s.left+"px",i.dropup?t.style.top=o+s.top-a.height-4+"px":t.style.top=o+s.top+s.height+"px"}(t,this.positionElement||this.$el,this)}catch(t){}},removeDropdownFromBody:function(){try{var t=this.$refs.dropdown;t.removeAttribute("style"),this.$el.appendChild(t)}catch(t){}}}};fl("top-menu",Tl(new Vue({components:{dropdown:Zh}}),undefined,undefined,!1,null,null,null).exports),fl("messages-display",Nh),fl("notifications-list",Uh),fl("notifications-navbar-indicator",zh),fl("notifications-unread-count",Vh),fl("system-messages-edit-form",Gh);i(755);var Jh=Tl({name:"label-tree-label",data:function(){return{hover:!1,editing:!1,oldName:"",oldColor:"",newName:"",newColor:"",internalLabel:null}},props:{label:{type:Object,required:!0},showFavourites:{type:Boolean,required:!1},editable:{type:Boolean,default:!1},flat:{type:Boolean,default:!1}},computed:{showColor:function(){return!this.expandable||!this.hover},showChevronUp:function(){return!this.showColor&&this.label.open},showChevronDown:function(){return!this.showColor&&!this.label.open},classObject:function(){return{"label-tree-label--selected":this.label.selected,"label-tree-label--expandable":this.expandable,"label-tree-label--editing":this.editing}},colorStyle:function(){return{"background-color":"#"+this.label.color}},chevronStyle:function(){return{color:"#"+this.label.color}},favouriteClass:function(){return{selected:this.label.favourite}},favouriteTitle:function(){return(this.label.favourite?"Remove":"Add")+" as favourite"},editTitle:function(){return"Edit label "+this.label.name},deleteTitle:function(){return"Remove label "+this.label.name},expandable:function(){return!this.flat&&!!this.label.children},showEditButton:function(){return this.editable&&this.hover&&!this.editing}},methods:{toggleSelect:function(t){this.editing||(t.preventDefault(),this.label.selected?this.$emit("deselect",this.label,t):this.$emit("select",this.label,t))},editThis:function(){this.editing=!0,this.oldName=this.label.name,this.oldColor=this.label.color,this.newName=this.label.name,this.newColor="#"+this.label.color},saveThis:function(){var t=this;this.internalLabel.name=this.newName,this.internalLabel.color=this.newColor.substr(1),this.editing=!1,this.oldName===this.label.name&&this.oldColor===this.label.color||this.emitSave(this.label,(function(){return t.editing=!0}))},revertThis:function(){this.editing=!1,this.internalLabel.name=this.oldName,this.internalLabel.color=this.oldColor},deleteThis:function(){this.emitDelete(this.label)},toggleOpen:function(t){this.editing||(this.expandable?this.internalLabel.open=!this.label.open:this.toggleSelect(t))},toggleFavourite:function(){this.label.favourite?this.emitRemoveFavourite(this.label):this.emitAddFavourite(this.label)},emitSelect:function(t,e){this.$emit("select",t,e)},emitDeselect:function(t,e){this.$emit("deselect",t,e)},emitDelete:function(t){this.$emit("delete",t)},emitSave:function(t,e){this.$emit("save",t,e)},emitAddFavourite:function(t){this.$emit("add-favourite",t)},emitRemoveFavourite:function(t){this.$emit("remove-favourite",t)},doHover:function(){this.hover=!0},dontHover:function(){this.hover=!1}},created:function(){this.internalLabel=this.label}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"label-tree-label",class:t.classObject},[i("div",{staticClass:"label-tree-label__name",on:{click:t.toggleOpen,mouseover:t.doHover,mouseleave:t.dontHover}},[t.editing?i("span",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.newColor,expression:"newColor"}],staticClass:"form-control input-sm label-tree-color-input",attrs:{type:"color"},domProps:{value:t.newColor},on:{input:function(e){e.target.composing||(t.newColor=e.target.value)}}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.newName,expression:"newName"}],staticClass:"form-control input-sm label-tree-label__name-input",attrs:{type:"text"},domProps:{value:t.newName},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.saveThis(e)},input:function(e){e.target.composing||(t.newName=e.target.value)}}})]):i("span",[i("span",{directives:[{name:"show",rawName:"v-show",value:t.showColor,expression:"showColor"}],staticClass:"label-tree-label__color",style:t.colorStyle}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.showChevronDown,expression:"showChevronDown"}],staticClass:"label-tree-label__chevron label-tree-label__chevron--down",style:t.chevronStyle}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.showChevronUp,expression:"showChevronUp"}],staticClass:"label-tree-label__chevron label-tree-label__chevron--up",style:t.chevronStyle}),t._v(" "),i("span",{domProps:{textContent:t._s(t.label.name)},on:{click:function(e){return e.stopPropagation(),t.toggleSelect(e)},mouseenter:t.dontHover}})]),t._v(" "),i("span",{staticClass:"label-tree-label__buttons"},[t.showFavourites?i("button",{staticClass:"label-tree-label__favourite",class:t.favouriteClass,attrs:{type:"button",title:t.favouriteTitle},on:{click:function(e){return e.stopPropagation(),t.toggleFavourite(e)}}},[i("span",{staticClass:"fa fa-star",attrs:{"aria-hidden":"true",title:""}})]):t._e(),t._v(" "),i("span",{attrs:{if:"editable"}},[i("button",{directives:[{name:"show",rawName:"v-show",value:t.showEditButton,expression:"showEditButton"}],staticClass:"btn btn-default btn-xs",attrs:{title:t.editTitle},on:{click:function(e){return e.stopPropagation(),t.editThis(e)}}},[i("span",{staticClass:"fa fa-pencil-alt",attrs:{"aria-hidden":"true"}})]),t._v(" "),i("button",{directives:[{name:"show",rawName:"v-show",value:t.editing,expression:"editing"}],staticClass:"btn btn-danger btn-sm",attrs:{title:t.deleteTitle},on:{click:function(e){return e.stopPropagation(),t.deleteThis(e)}}},[i("span",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true"}})]),t._v(" "),i("button",{directives:[{name:"show",rawName:"v-show",value:t.editing,expression:"editing"}],staticClass:"btn btn-success btn-sm",attrs:{title:"Save changes"},on:{click:function(e){return e.stopPropagation(),t.saveThis(e)}}},[i("span",{staticClass:"fa fa-check",attrs:{"aria-hidden":"true"}})]),t._v(" "),i("button",{directives:[{name:"show",rawName:"v-show",value:t.editing,expression:"editing"}],staticClass:"btn btn-default btn-sm",attrs:{title:"Revert changes"},on:{click:function(e){return e.stopPropagation(),t.revertThis(e)}}},[i("span",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])])])]),t._v(" "),t.expandable&&t.label.open?i("ul",{staticClass:"label-tree__list"},t._l(t.label.children,(function(e){return i("label-tree-label",{key:e.id,attrs:{label:e,editable:t.editable,"show-favourites":t.showFavourites},on:{select:t.emitSelect,deselect:t.emitDeselect,save:t.emitSave,delete:t.emitDelete,"add-favourite":t.emitAddFavourite,"remove-favourite":t.emitRemoveFavourite}})})),1):t._e()])}),[],!1,null,null,null);const Qh=Tl({data:function(){return{collapsed:!1}},components:{labelTreeLabel:Jh.exports},props:{name:{type:String,required:!0},labels:{type:Array,required:!0},showTitle:{type:Boolean,default:!0},standalone:{type:Boolean,default:!1},collapsible:{type:Boolean,default:!0},multiselect:{type:Boolean,default:!1},allowSelectSiblings:{type:Boolean,default:!1},allowSelectChildren:{type:Boolean,default:!1},editable:{type:Boolean,default:!1},showFavourites:{type:Boolean,default:!1},flat:{type:Boolean,default:!1}},computed:{labelMap:function(){for(var t={},e=this.labels.length-1;e>=0;e--)t[this.labels[e].id]=this.labels[e];return t},compiledLabels:function(){var t={null:[]};return this.flat?this.labels.forEach((function(e){t.null.push(e)})):(this.labels.forEach((function(e){t.hasOwnProperty(e.parent_id)?t[e.parent_id].push(e):t[e.parent_id]=[e]})),this.labels.forEach((function(e){t.hasOwnProperty(e.id)?Vue.set(e,"children",t[e.id]):(Vue.set(e,"children",void 0),e.open=!1)}))),t},rootLabels:function(){return this.compiledLabels.null},collapseTitle:function(){return this.collapsed?"Expand":"Collapse"},hasNoLabels:function(){return 0===this.rootLabels.length}},methods:{hasLabel:function(t){return this.labelMap.hasOwnProperty(t)},getLabel:function(t){return this.labelMap[t]},getParents:function(t){for(var e=[];null!==t.parent_id;)t=this.getLabel(t.parent_id),e.unshift(t.id);return e},getSiblings:function(t){return null===t.parent_id?this.rootLabels:this.getLabel(t.parent_id).children},selectSiblings:function(t){this.getSiblings(t).forEach((function(t){t.selected=!0}))},deselectSiblings:function(t){this.getSiblings(t).forEach((function(t){t.selected=!1}))},selectChildren:function(t){var e=this;t.children&&t.children.forEach((function(t){t.selected=!0,e.selectChildren(t)}))},deselectChildren:function(t){var e=this;t.children&&t.children.forEach((function(t){t.selected=!1,e.deselectChildren(t)}))},emitSelect:function(t,e){this.$emit("select",t,e)},emitDeselect:function(t,e){this.$emit("deselect",t,e)},emitSave:function(t,e){this.$emit("save",t,e)},emitDelete:function(t){this.$emit("delete",t)},conditionSelectSiblings:function(t){return this.allowSelectSiblings&&t.altKey},conditionSelectChildren:function(t){return this.allowSelectChildren&&t.ctrlKey},selectLabel:function(t,e){var i=this;this.multiselect||this.clearSelectedLabels(),t&&this.hasLabel(t.id)&&(t.selected=!0,this.collapsed=!1,this.flat||(this.getParents(t).forEach((function(t){i.getLabel(t).open=!0})),this.multiselect&&(this.conditionSelectSiblings(e)&&this.selectSiblings(t),this.conditionSelectChildren(e)&&(this.selectChildren(t),this.conditionSelectSiblings(e)&&this.getSiblings(t).forEach(this.selectChildren)))))},deselectLabel:function(t,e){this.hasLabel(t.id)&&(t.selected=!1,this.conditionSelectSiblings(e)&&this.deselectSiblings(t),this.conditionSelectChildren(e)&&(this.deselectChildren(t),this.conditionSelectSiblings(e)&&this.getSiblings(t).forEach(this.deselectChildren)))},clearSelectedLabels:function(){this.labels.forEach((function(t){t.selected=!1}))},collapse:function(){if(this.collapsed)this.collapsed=!1;else{var t=!1;this.labels.forEach((function(e){t|=e.open,e.open=!1})),this.collapsed=!t}},emitAddFavourite:function(t){this.$emit("add-favourite",t)},emitRemoveFavourite:function(t){this.$emit("remove-favourite",t)},addFavouriteLabel:function(t){this.hasLabel(t.id)&&(t.favourite=!0)},removeFavouriteLabel:function(t){this.hasLabel(t.id)&&(t.favourite=!1)}},created:function(){this.labels.forEach((function(t){t.hasOwnProperty("open")||Vue.set(t,"open",!1),t.hasOwnProperty("selected")||Vue.set(t,"selected",!1),t.hasOwnProperty("favourite")||Vue.set(t,"favourite",!1)})),this.standalone?(this.$on("select",this.selectLabel),this.$on("deselect",this.deselectLabel)):(this.$parent.$on("select",this.selectLabel),this.$parent.$on("deselect",this.deselectLabel),this.$parent.$on("clear",this.clearSelectedLabels),this.$parent.$on("add-favourite",this.addFavouriteLabel),this.$parent.$on("remove-favourite",this.removeFavouriteLabel))}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"label-tree"},[t.showTitle?i("h4",{staticClass:"label-tree__title"},[t.collapsible?i("button",{staticClass:"btn btn-default btn-xs pull-right",attrs:{title:t.collapseTitle,type:"button"},on:{click:function(e){return e.stopPropagation(),t.collapse(e)}}},[t.collapsed?i("span",{staticClass:"fa fa-chevron-down",attrs:{"aria-hidden":"true"}}):i("span",{staticClass:"fa fa-chevron-up",attrs:{"aria-hidden":"true"}})]):t._e(),t._v("\n        "+t._s(t.name)+"\n    ")]):t._e(),t._v(" "),t.collapsed?t._e():i("ul",{staticClass:"label-tree__list"},[t._l(t.rootLabels,(function(e){return i("label-tree-label",{key:e.id,attrs:{label:e,editable:t.editable,"show-favourites":t.showFavourites,flat:t.flat},on:{select:t.emitSelect,deselect:t.emitDeselect,save:t.emitSave,delete:t.emitDelete,"add-favourite":t.emitAddFavourite,"remove-favourite":t.emitRemoveFavourite}})})),t._v(" "),t.hasNoLabels?i("li",{staticClass:"text-muted"},[t._v("No labels")]):t._e()],2)])}),[],!1,null,null,null).exports;const tc=Tl({mixins:[Ql],props:{template:{default:'<span class="label-typeahead-item"><span v-if="item.color" :style="{\'background-color\': \'#\' + item.color}" class="label-color"></span><span v-text="item.name"></span></span>'}}},undefined,undefined,!1,null,null,null).exports;const ec=Tl({components:{typeahead:tc,labelTree:Qh},data:function(){return{favourites:[]}},props:{trees:{type:Array,required:!0},id:{type:String},typeahead:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},multiselect:{type:Boolean,default:!1},allowSelectSiblings:{type:Boolean,default:!1},allowSelectChildren:{type:Boolean,default:!1},showFavourites:{type:Boolean,default:!1},collapsible:{type:Boolean,default:!0},listenerSet:{type:String,default:"default"}},computed:{localeCompareSupportsLocales:function(){try{"foo".localeCompare("bar","i")}catch(t){return"RangeError"===t.name}return!1},labels:function(){var t=[];if(this.trees.forEach((function(e){Array.prototype.push.apply(t,e.labels)})),this.localeCompareSupportsLocales){var e=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});t.sort((function(t,i){return e.compare(t.name,i.name)}))}else t.sort((function(t,e){return t.name<e.name?-1:1}));return t},favouriteIds:function(){return this.favourites.map((function(t){return t.id}))},canHaveMoreFavourites:function(){return this.favourites.length<10},hasFavourites:function(){return this.favourites.length>0},ownId:function(){if(this.id)return this.id;var t=[];for(var e in this.trees)this.trees.hasOwnProperty(e)&&t.push(this.trees[e].id);return t.join("-")},favouriteStorageKey:function(){return"biigle.label-trees.".concat(this.ownId,".favourites")}},methods:{handleSelect:function(t,e){t&&this.$emit("select",t,e)},handleDeselect:function(t,e){this.$emit("deselect",t,e)},clear:function(){this.$emit("clear")},handleAddFavourite:function(t){this.canHaveMoreFavourites&&(this.$emit("add-favourite",t),this.favourites.push(t),this.updateFavouriteStorage())},handleRemoveFavourite:function(t){this.$emit("remove-favourite",t);var e=this.favourites.indexOf(t);-1!==e&&this.favourites.splice(e,1),this.updateFavouriteStorage()},updateFavouriteStorage:function(){this.hasFavourites?localStorage.setItem(this.favouriteStorageKey,JSON.stringify(this.favouriteIds)):localStorage.removeItem(this.favouriteStorageKey)},selectFavourite:function(t){this.favourites[t]&&this.handleSelect(this.favourites[t])}},watch:{trees:{immediate:!0,handler:function(t){t.forEach((function(t){t.version?t.versionedName=t.name+" @ "+t.version.name:t.versionedName=t.name,t.labels.forEach((function(e){e.tree=t}))}))}}},mounted:function(){var t=this;if(this.showFavourites){var e=JSON.parse(localStorage.getItem(this.favouriteStorageKey));if(e){var i=[];this.labels.forEach((function(t){var n=e.indexOf(t.id);-1!==n&&(i[n]=t)})),i.filter(Boolean).forEach((function(e){t.handleAddFavourite(e)}))}for(var n=function(e,i){Ll.on(e,(function(){t.selectFavourite(i)}),0,t.listenerSet)},r=1;r<=9;r++)n(r.toString(),r-1);n("0",9)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"label-trees"},[t.typeahead||t.clearable?i("div",{staticClass:"label-trees__head"},[t.clearable?i("button",{staticClass:"btn btn-default",attrs:{title:"Clear selected labels",type:"button"},on:{click:t.clear}},[i("span",{staticClass:"fa fa-times fa-fw",attrs:{"aria-hidden":"true"}})]):t._e(),t._v(" "),t.typeahead?i("typeahead",{attrs:{items:t.labels,"more-info":"tree.versionedName",placeholder:"Find label"},on:{select:t.handleSelect}}):t._e()],1):t._e(),t._v(" "),i("div",{staticClass:"label-trees__body"},[t.hasFavourites?i("label-tree",{attrs:{name:"Favourites",labels:t.favourites,"show-favourites":t.showFavourites,flat:!0,collapsible:t.collapsible},on:{select:t.handleSelect,deselect:t.handleDeselect,"remove-favourite":t.handleRemoveFavourite}}):t._e(),t._v(" "),t._l(t.trees,(function(e){return i("label-tree",{key:e.id,attrs:{name:e.versionedName,labels:e.labels,multiselect:t.multiselect,"allow-select-siblings":t.allowSelectSiblings,"allow-select-children":t.allowSelectChildren,"show-favourites":t.showFavourites,collapsible:t.collapsible},on:{select:t.handleSelect,deselect:t.handleDeselect,"add-favourite":t.handleAddFavourite,"remove-favourite":t.handleRemoveFavourite}})}))],2)])}),[],!1,null,null,null).exports;biigle.$declare("labelTrees.components.labelTrees",ec),biigle.$declare("labelTrees.components.labelTypeahead",tc);const ic=Tl({mixins:[cu],data:function(){return{labelTree:null,ownProjects:[],authorizedProjects:[],authorizedOwnProjects:[],privateId:null}},components:{typeahead:Ql},computed:{isPrivate:function(){return this.labelTree.visibility_id===this.privateId},authorizableProjects:function(){var t=this;return this.ownProjects.filter((function(e){for(var i=t.authorizedProjects.length-1;i>=0;i--)if(t.authorizedProjects[i].id===e.id)return!1;return!0}))},hasAuthorizedProjects:function(){return this.authorizedProjects.length>0}},methods:{fetchOwnProjects:function(){var t=this;xl.query().then((function(e){Vue.set(t,"ownProjects",e.body)}),lu)},addAuthorizedProject:function(t){var e=this;t&&!this.loading&&(this.startLoading(),_l.addAuthorizedProject({id:this.labelTree.id},{id:t.id}).then((function(){return e.authorizedProjectAdded(t)}),lu).finally(this.finishLoading))},authorizedProjectAdded:function(t){this.authorizedProjects.push(t),this.authorizedOwnProjects.push(t.id)},removeAuthorizedProject:function(t){var e=this;this.startLoading(),_l.removeAuthorizedProject({id:this.labelTree.id,project_id:t.id}).then((function(){return e.authorizedProjectRemoved(t)}),lu).finally(this.finishLoading)},authorizedProjectRemoved:function(t){var e;for(e=this.authorizedProjects.length-1;e>=0;e--)this.authorizedProjects[e].id===t.id&&this.authorizedProjects.splice(e,1);-1!==(e=this.authorizedOwnProjects.indexOf(t.id))&&this.authorizedOwnProjects.splice(e,1)},isOwnProject:function(t){return-1!==this.authorizedOwnProjects.indexOf(t.id)}},created:function(){this.privateId=biigle.$require("labelTrees.privateVisibilityId"),this.labelTree=biigle.$require("labelTrees.labelTree"),this.authorizedProjects=biigle.$require("labelTrees.authorizedProjects"),this.authorizedOwnProjects=biigle.$require("labelTrees.authorizedOwnProjects"),this.fetchOwnProjects()}},undefined,undefined,!1,null,null,null).exports;var nc=[0,.5,.9],rc=[360,1,1],oc=[0,2,2],sc=function(){for(var t,e,i=[0,0,0],n=i.length-1;n>=0;n--)t=10*oc[n],i[n]=(rc[n]-nc[n])*Math.random()+nc[n],i[n]=0!==t?Math.round(i[n]*t)/t:Math.round(i[n]);return"#"+(e=function(t){var e,i=t[0]/60,n=Math.floor(i),r=i-n,o=[t[2]*(1-t[1]),t[2]*(1-t[1]*r),t[2]*(1-t[1]*(1-r))];switch(n){case 1:e=[o[1],t[2],o[0]];break;case 2:e=[o[0],t[2],o[2]];break;case 3:e=[o[0],o[1],t[2]];break;case 4:e=[o[2],o[0],t[2]];break;case 5:e=[t[2],o[0],o[1]];break;default:e=[t[2],o[2],o[0]]}return e.map((function(t){return Math.round(255*t)}))}(i),e.map((function(t){return 1===(t=t.toString(16)).length?"0"+t:t}))).join("")};const ac=Tl({props:{labels:{type:Array,required:!0},color:{type:String,default:""},parent:{type:Object,default:null},name:{type:String,default:""}},components:{typeahead:tc},computed:{selectedColor:{get:function(){return this.color},set:function(t){this.$emit("color",t)}},selectedName:{get:function(){return this.name},set:function(t){this.$emit("name",t)}},selectedParent:function(){return this.parent?this.parent.name:""},hasNoLabels:function(){return 0===this.labels.length},hasNoParent:function(){return!this.parent},hasNoName:function(){return!this.name}},methods:{refreshColor:function(){this.selectedColor=sc()},resetParent:function(){this.$emit("parent",null)},selectLabel:function(t){this.$emit("parent",t)}}},undefined,undefined,!1,null,null,null).exports;const lc=Tl({mixins:[ac],methods:{submit:function(){var t={name:this.selectedName,color:this.selectedColor};this.parent&&(t.parent_id=this.parent.id),this.$emit("submit",t)}}},undefined,undefined,!1,null,null,null).exports;var uc=Tl({props:{item:{type:Object,required:!0},recursive:{type:Boolean,required:!0},labels:{type:Array,required:!0},parent:{type:Object,default:null}},computed:{classification:function(){return this.item.parents.join(" > ")},buttonTitle:function(){return this.recursive?"Add ".concat(this.item.name," and all WoRMS parents as new labels"):this.parent?"Add ".concat(this.item.name," as a child of ").concat(this.parent.name):"Add ".concat(this.item.name," as a root label")},classObject:function(){return{"list-group-item-success":this.selected}},selected:function(){var t=this;return this.labels.some((function(e){return e.source_id==t.item.aphia_id}))}},methods:{select:function(){this.selected||this.$emit("select",this.item)}}},undefined,undefined,!1,null,null,null);var hc=Tl({mixins:[ac],components:{wormsResultItem:uc.exports},data:function(){return{results:[],recursive:!1,hasSearched:!1,unaccepted:!1,worms:null}},computed:{hasResults:function(){return this.results.length>0},recursiveButtonClass:function(){return{active:this.recursive,"btn-info":this.recursive}},unacceptedButtonClass:function(){return{active:this.unaccepted,"btn-info":this.unaccepted}}},methods:{findName:function(){var t=this;this.$emit("load-start");var e={id:this.worms.id,query:this.selectedName};this.unaccepted&&(e.unaccepted="true"),yl.query(e).then(this.updateResults,lu).finally((function(){t.hasSearched=!0,t.$emit("load-finish")}))},updateResults:function(t){this.results=t.data},importItem:function(t){var e={name:t.name,color:this.selectedColor,source_id:t.aphia_id,label_source_id:this.worms.id};this.recursive?e.recursive="true":this.parent&&(e.parent_id=this.parent.id),this.$emit("submit",e)},toggleRecursive:function(){this.recursive=!this.recursive},toggleUnaccepted:function(){this.unaccepted=!this.unaccepted}},created:function(){this.worms=biigle.$require("labelTrees.wormsLabelSource")}},undefined,undefined,!1,null,null,null);const cc=Tl({mixins:[cu],data:function(){return{labelTree:null,labels:[],selectedColor:sc(),selectedLabel:null,selectedName:"",canEdit:!1}},components:{tabs:jh,tab:lh,labelTree:Qh,manualLabelForm:lc,wormsLabelForm:hc.exports},computed:{editable:function(){return!this.loading&&this.canEdit}},methods:{saveLabel:function(t,e){this.startLoading(),vl.update({id:t.id},{name:t.name,color:t.color}).catch((function(t){e(),lu(t)})).finally(this.finishLoading)},deleteLabel:function(t){var e=this;this.startLoading(),vl.delete({id:t.id}).then((function(){e.labelDeleted(t)}),lu).finally(this.finishLoading)},labelDeleted:function(t){this.selectedLabel&&this.selectedLabel.id===t.id&&this.deselectLabel(t);for(var e=this.labels.length-1;e>=0;e--)if(this.labels[e].id===t.id){this.labels.splice(e,1);break}},selectLabel:function(t){this.selectedLabel=t,t?(this.selectedColor="#"+t.color,this.$emit("select",t),Rl.$emit("selectLabel",t)):(this.$emit("clear"),Rl.$emit("selectLabel",null))},deselectLabel:function(t){this.selectedLabel=null,this.$emit("deselect",t),Rl.$emit("selectLabel",null)},selectColor:function(t){this.selectedColor=t},selectName:function(t){this.selectedName=t},insertLabel:function(t){Vue.set(t,"open",!1),Vue.set(t,"selected",!1);for(var e=t.name.toLowerCase(),i=0,n=this.labels.length;i<n;i++)if(this.labels[i].name.toLowerCase()>=e)return void this.labels.splice(i,0,t);this.labels.push(t)},createLabel:function(t){this.loading||(this.startLoading(),vl.save({label_tree_id:this.labelTree.id},t).then(this.labelCreated,lu).finally(this.finishLoading))},labelCreated:function(t){t.data.forEach(this.insertLabel),this.selectedColor=sc(),this.selectedName=""}},watch:{labels:function(t){Rl.$emit("label-trees.labels.count",t.length)}},created:function(){this.labelTree=biigle.$require("labelTrees.labelTree"),this.labels=biigle.$require("labelTrees.labels"),this.canEdit=biigle.$require("labelTrees.canEdit")}},undefined,undefined,!1,null,null,null).exports;const dc=Tl({methods:{updateCount:function(t){this.$el.textContent=t}},created:function(){Rl.$on("label-trees.labels.count",this.updateCount)}},undefined,undefined,!1,null,null,null).exports;const fc=Tl({mixins:[cu],props:{members:{type:Array,required:!0},roles:{type:Array,required:!0},defaultRole:{type:Object},disabled:{type:Boolean,default:!1}},components:{typeahead:Ql},data:function(){return{selectedMember:null,selectedRole:null,usersLoaded:!1,users:[]}},computed:{memberIds:function(){return this.members.map((function(t){return t.id}))},availableUsers:function(){var t=this;return this.users.filter((function(e){return!t.memberIds.includes(e.id)}))},canAttachMember:function(){return!this.disabled&&this.selectedMember&&this.selectedRole},selectedMemberName:function(){return this.selectedMember?this.selectedMember.name:""}},methods:{selectMember:function(t){this.selectedMember=t},attachMember:function(){var t={id:this.selectedMember.id,role_id:this.selectedRole,firstname:this.selectedMember.firstname,lastname:this.selectedMember.lastname,affiliation:this.selectedMember.affiliation};this.$emit("attach",t),this.selectedMember=null},loadUsers:function(){this.usersLoaded||(this.usersLoaded=!0,this.startLoading(),Sl.query().then(this.loadedUsers,lu).finally(this.finishLoading))},loadedUsers:function(t){this.users=t.data.map((function(t){return t.name=t.firstname+" "+t.lastname,t}))}},created:function(){this.defaultRole?this.selectedRole=this.defaultRole.id:this.selectedRole=this.roles[0].id}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("form",{staticClass:"form-inline",on:{submit:function(e){return e.preventDefault(),t.attachMember(e)}}},[i("loader",{attrs:{active:t.loading}}),t._v(" "),i("typeahead",{attrs:{disabled:t.disabled,items:t.availableUsers,placeholder:"User name",value:t.selectedMemberName,"more-info":"affiliation"},on:{select:t.selectMember,focus:t.loadUsers}}),t._v(" "),i("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedRole,expression:"selectedRole"}],staticClass:"form-control",attrs:{disabled:t.disabled,title:"Role of the new user"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.selectedRole=e.target.multiple?i:i[0]}}},t._l(t.roles,(function(e){return i("option",{domProps:{value:e.id,textContent:t._s(e.name)}})})),0),t._v(" "),i("button",{staticClass:"btn btn-default",attrs:{type:"submit",disabled:!t.canAttachMember}},[t._v("Add member")])],1)}),[],!1,null,null,null).exports;const pc=Tl({props:{member:{type:Object,required:!0},ownId:{type:Number,required:!0},editable:{type:Boolean,required:!0},editing:{type:Boolean,default:!1},roles:{type:Array,required:!0}},data:function(){return{roleId:null}},computed:{isOwnUser:function(){return this.member.id===this.ownId},isEditing:function(){return this.editing&&!this.isOwnUser},name:function(){return this.member.firstname+" "+this.member.lastname},role:function(){var t=this;return this.roles.find((function(e){return t.member.role_id===e.id}))},labelClass:function(){switch(this.role.name){case"admin":return"label-danger";case"expert":return"label-warning";case"editor":return"label-primary";default:return"label-default"}}},methods:{removeMember:function(){this.$emit("remove",this.member)},changeRole:function(){this.$emit("update",this.member,{role_id:this.roleId})},emitEnter:function(){this.$emit("enter",this.member)}},created:function(){this.roleId=this.member.role_id}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"list-group-item clearfix",on:{mouseenter:t.emitEnter}},[i("h4",{staticClass:"list-group-item-heading"},[t.editable?i("span",{directives:[{name:"show",rawName:"v-show",value:t.isEditing,expression:"isEditing"}],staticClass:"pull-right"},[i("form",{staticClass:"form-inline"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.roleId,expression:"roleId"}],staticClass:"form-control input-sm",attrs:{disabled:t.isOwnUser,title:"Change the role of "+t.name},on:{change:[function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.roleId=e.target.multiple?i:i[0]},t.changeRole]}},t._l(t.roles,(function(e){return i("option",{domProps:{value:e.id,textContent:t._s(e.name)}})})),0),t._v(" "),i("button",{staticClass:"btn btn-default btn-sm",attrs:{disabled:t.isOwnUser,type:"button",title:"Remove "+t.name},on:{click:t.removeMember}},[i("i",{staticClass:"fa fa-trash"})])])]):t._e(),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:!t.isEditing,expression:"!isEditing"}],staticClass:"pull-right label",class:t.labelClass,domProps:{textContent:t._s(t.role.name)}}),t._v(" "),i("span",{domProps:{textContent:t._s(t.name)}}),t._v(" "),t.isOwnUser?i("span",{staticClass:"text-muted"},[t._v("(you)")]):t._e()]),t._v(" "),t.member.affiliation?i("p",{staticClass:"list-group-item-text text-muted",domProps:{textContent:t._s(t.member.affiliation)}}):t._e()])}),[],!1,null,null,null).exports;const gc=Tl({props:{members:{type:Array,required:!0},ownId:{type:Number,required:!0},editable:{type:Boolean,required:!0},roles:{type:Array,required:!0}},components:{memberListItem:pc},data:function(){return{editingMemberId:null}},computed:{sortedMembers:function(){var t=this,e=this.members.slice();return e.sort((function(e,i){return e.id===t.ownId?-1:i.id===t.ownId?1:0})),e}},methods:{emitRemove:function(t){this.$emit("remove",t)},emitUpdate:function(t,e){this.$emit("update",t,e)},handleEnter:function(t){this.editable&&(this.editingMemberId=t.id)},handleLeave:function(t){null!==t.relatedTarget&&(this.editingMemberId=null)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"list-group",on:{mouseleave:t.handleLeave}},t._l(t.sortedMembers,(function(e){return i("member-list-item",{key:e.id,attrs:{member:e,"own-id":t.ownId,editable:t.editable,editing:t.editingMemberId===e.id,roles:t.roles},on:{remove:t.emitRemove,update:t.emitUpdate,enter:t.handleEnter}})})),1)}),[],!1,null,null,null).exports;const mc=Tl({mixins:[cu],data:function(){return{labelTree:null,members:[],roles:[],defaultRole:null,userId:null}},components:{memberList:gc,addMemberForm:fc},computed:{hasMembers:function(){return 0!==this.members.length}},methods:{attachMember:function(t){var e=this;this.startLoading(),_l.addUser({id:this.labelTree.id},{id:t.id,role_id:t.role_id}).then((function(){return e.memberAttached(t)}),lu).finally(this.finishLoading)},memberAttached:function(t){this.members.push(t)},updateMember:function(t,e){var i=this;this.startLoading(),_l.updateUser({id:this.labelTree.id,user_id:t.id},{role_id:e.role_id}).then((function(){return i.memberUpdated(t,e)}),lu).finally(this.finishLoading)},memberUpdated:function(t,e){t.role_id=e.role_id},removeMember:function(t){var e=this;this.startLoading(),_l.removeUser({id:this.labelTree.id,user_id:t.id}).then((function(){return e.memberRemoved(t)}),lu).finally(this.finishLoading)},memberRemoved:function(t){for(var e=this.members.length-1;e>=0;e--)this.members[e].id===t.id&&this.members.splice(e,1)}},watch:{members:function(t){Rl.$emit("label-trees.members.count",t.length)}},created:function(){this.labelTree=biigle.$require("labelTrees.labelTree"),this.members=biigle.$require("labelTrees.members"),this.roles=biigle.$require("labelTrees.roles"),this.defaultRole=biigle.$require("labelTrees.defaultRole"),this.userId=biigle.$require("labelTrees.userId")}},undefined,undefined,!1,null,null,null).exports;const vc=Tl({methods:{updateCount:function(t){this.$el.textContent=t}},created:function(){Rl.$on("label-trees.members.count",this.updateCount)}},undefined,undefined,!1,null,null,null).exports;var yc=Tl({props:{item:{type:Object,required:!0},disabled:{type:Boolean,required:!1}},computed:{leftLabel:function(){return this.item.left},rightLabel:function(){return this.item.right},hasLeft:function(){return null!==this.leftLabel},hasRight:function(){return null!==this.rightLabel},labelToAdd:function(){return!this.hasLeft&&this.hasRight},labelToRemove:function(){return this.hasLeft&&!this.hasRight},labelsSame:function(){return this.hasLeft&&this.hasRight},leftColorStyle:function(){return{"background-color":"#"+this.leftLabel.color}},rightColorStyle:function(){return{"background-color":"#"+this.rightLabel.color}},classObject:function(){return{success:this.labelToAdd&&!this.accepted,"label-tree-diff-row--added":this.labelToAdd&&this.accepted,danger:this.labelToRemove&&!this.accepted,"label-tree-diff-row--removed":this.labelToRemove&&this.accepted}},labelStyle:function(){return{"padding-left":22*this.item.level+"px"}},addButtonClass:function(){return{"btn-success":this.accepted}},removeButtonClass:function(){return{"btn-danger":this.accepted}},accepted:function(){return this.item.accepted},acceptable:function(){return this.item.acceptable},labelAdded:function(){return this.labelToAdd&&this.accepted},removeTitle:function(){return this.acceptable?"Accept the deletion":"This label cannot be deleted because it or one of its child labels is used"}},methods:{emitResolved:function(){this.$emit("accepted",this.item)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",{staticClass:"label-tree-diff-row",class:t.classObject},[i("td",{staticClass:"label-tree-diff-row__button"},[t.labelToAdd?i("button",{staticClass:"btn btn-sm btn-default",class:t.addButtonClass,attrs:{disabled:t.disabled,title:"Accept the addition"},on:{click:t.emitResolved}},[i("i",{staticClass:"fa fa-plus"})]):t._e(),t._v(" "),t.labelToRemove?i("button",{staticClass:"btn btn-sm btn-default",class:t.removeButtonClass,attrs:{title:t.removeTitle,disabled:!t.acceptable||t.disabled},on:{click:t.emitResolved}},[i("i",{staticClass:"fa fa-minus"})]):t._e()]),t._v(" "),i("td",{staticClass:"label-tree-diff-row__left"},[t.hasLeft?i("div",{staticClass:"label-tree-label",style:t.labelStyle},[i("div",{staticClass:"label-tree-label__name"},[i("span",{staticClass:"label-tree-label__color",style:t.leftColorStyle}),t._v(" "),i("span",{domProps:{textContent:t._s(t.leftLabel.name)}})])]):t._e(),t._v(" "),t.labelAdded?i("div",{staticClass:"label-tree-label",style:t.labelStyle},[i("div",{staticClass:"label-tree-label__name"},[i("span",{staticClass:"label-tree-label__color",style:t.rightColorStyle}),t._v(" "),i("span",{domProps:{textContent:t._s(t.rightLabel.name)}})])]):t._e()]),t._v(" "),i("td",{staticClass:"label-tree-diff-row__right"},[i("div",{staticClass:"label-tree-label",style:t.labelStyle},[t.hasRight?i("div",{staticClass:"label-tree-label__name"},[i("span",{staticClass:"label-tree-label__color",style:t.rightColorStyle}),t._v(" "),i("span",{domProps:{textContent:t._s(t.rightLabel.name)}})]):t._e()])])])}),[],!1,null,null,null);const _c=Tl({components:{labelTreeDiffRow:yc.exports},data:function(){return{diff:[]}},props:{leftLabels:{type:Array,required:!0},leftName:{type:String,default:""},rightLabels:{type:Array,required:!0},rightName:{type:String,default:""},usedLabels:{type:Array,default:function(){return[]}},disabled:{type:Boolean,default:!1}},computed:{leftLabelsById:function(){var t={};return this.leftLabels.forEach((function(e){t[e.id]=e})),t},leftLabelsAsTree:function(){var t=this.generateChildMap(this.leftLabels);return this.generateLabelsAsTree(t.null,t)},rightLabelsAsTree:function(){var t=this.generateChildMap(this.rightLabels);return this.generateLabelsAsTree(t.null,t)},usedLabelMap:function(){var t=this,e={};return this.usedLabels.forEach((function(i){do{e[i]=null,i=t.leftLabelsById[i].parent_id}while(null!==i)})),e},cannotResolveAll:function(){return this.disabled||this.diff.reduce((function(t,e){return e.acceptable?t&&e.accepted:t}),!0)},cannotResolveNone:function(){return this.disabled||this.diff.reduce((function(t,e){return e.acceptable?t&&!e.accepted:t}),!0)},hasDiff:function(){return this.diff.length>0}},methods:{generateChildMap:function(t){var e={};return t.forEach((function(t){e.hasOwnProperty(t.parent_id)?e[t.parent_id].push(t):e[t.parent_id]=[t]})),e},generateLabelsAsTree:function(t,e){var i=this;return t.map((function(t){return e.hasOwnProperty(t.id)?t.children=i.generateLabelsAsTree(e[t.id],e):t.children=[],t})).sort((function(t,e){return t.name+"-"+t.color<=e.name+"-"+e.color?-1:1}))},generateTreeDiff:function(t,e,i,n){var r=this;for(t=t.slice(),e=e.slice(),i=i||[],n=n||0;t.length>0&&e.length>0;){var o=t[0],s=e[0];o.name===s.name?(t.shift(),e.shift(),i.push({id:o.id,level:n,left:o,right:s}),this.generateTreeDiff(o.children,s.children,i,n+1)):o.name<s.name?(t.shift(),i.push({id:o.id,level:n,accepted:!1,acceptable:!this.usedLabelMap.hasOwnProperty(o.id),left:o,right:null}),this.generateTreeDiff(o.children,[],i,n+1)):(e.shift(),i.push({id:s.id,level:n,accepted:!1,acceptable:!0,left:null,right:s}),this.generateTreeDiff([],s.children,i,n+1))}return t.length>0&&t.forEach((function(t){i.push({id:t.id,level:n,accepted:!1,acceptable:!r.usedLabelMap.hasOwnProperty(t.id),left:t,right:null}),r.generateTreeDiff(t.children,[],i,n+1)})),e.length>0&&e.forEach((function(t){i.push({id:t.id,level:n,accepted:!1,acceptable:!0,left:null,right:t}),r.generateTreeDiff([],t.children,i,n+1)})),i},filterRelevantItems:function(t){var e=[];return t.forEach((function(t,i){null!==t.left&&null!==t.right||e.push(i)})),e.forEach((function(e){t[e].relevant=!0;for(var i=t[e].level,n=e;n>=0&&i>0;)t[n].level<i&&(t[n].relevant=!0,i=t[n].level),n-=1})),t.filter((function(t){return t.relevant}))},handleResolved:function(t){t.acceptable&&(t.accepted?(this.cancelResolved(t),null===t.left?this.acceptCancelAddAllChildren(t):null===t.right&&this.acceptCancelDeleteAllParents(t)):(this.setResolved(t),null===t.left?this.acceptAddAllParents(t):null===t.right&&this.acceptDeleteAllChildren(t)))},cancelResolved:function(t){null===t.left?this.$emit("cancel-add",t.right):null===t.right&&this.$emit("cancel-remove",t.left),t.accepted=!1},setResolved:function(t){null===t.left?this.$emit("add",t.right):null===t.right&&this.$emit("remove",t.left),t.accepted=!0},acceptAll:function(){var t=this;this.diff.forEach((function(e){e.accepted||t.handleResolved(e)}))},acceptNone:function(){var t=this;this.diff.forEach((function(e){e.accepted&&t.handleResolved(e)}))},doForAllChildren:function(t,e){for(var i=t.level+1,n=this.diff.indexOf(t)+1;this.diff[n]&&this.diff[n].level>=i;)e.call(this,this.diff[n]),n+=1},doForAllParents:function(t,e){for(var i=t.level,n=this.diff.indexOf(t)-1;i>0&&n>=0;)this.diff[n].level<i&&(i=this.diff[n].level,e.call(this,this.diff[n])),n-=1},acceptDeleteAllChildren:function(t){this.doForAllChildren(t,(function(t){null===t.right&&this.setResolved(t)}))},acceptCancelAddAllChildren:function(t){this.doForAllChildren(t,(function(t){null===t.left&&this.cancelResolved(t)}))},acceptAddAllParents:function(t){this.doForAllParents(t,(function(t){null===t.left&&this.setResolved(t)}))},acceptCancelDeleteAllParents:function(t){this.doForAllParents(t,(function(t){null===t.right&&this.cancelResolved(t)}))},setLeftParentIds:function(t){var e={};return t.forEach((function(t){t.right&&t.left&&(e[t.right.id]=t.left.id)})),t.forEach((function(t){t.right&&t.right.parent_id&&(t.right.left_parent_id=e[t.right.parent_id])})),t}},created:function(){var t=this.generateTreeDiff(this.leftLabelsAsTree,this.rightLabelsAsTree);t=this.filterRelevantItems(t),t=this.setLeftParentIds(t),this.diff=t}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"label-tree-diff"},[t.hasDiff?i("div",[i("button",{staticClass:"btn btn-default",attrs:{title:"Accept all merge items",disabled:t.cannotResolveAll},on:{click:t.acceptAll}},[t._v("\n                Accept all\n        ")]),t._v(" "),i("button",{staticClass:"btn btn-default",attrs:{title:"Set all merge items as not accepted",disabled:t.cannotResolveNone},on:{click:t.acceptNone}},[t._v("\n                Accept none\n        ")])]):t._e(),t._v(" "),t.hasDiff?i("table",{staticClass:"table table-hover"},[i("thead",[i("tr",[i("th"),t._v(" "),i("th",{domProps:{textContent:t._s(t.leftName)}}),t._v(" "),i("th",{domProps:{textContent:t._s(t.rightName)}})])]),t._v(" "),i("tbody",t._l(t.diff,(function(e){return i("label-tree-diff-row",{key:e.id,attrs:{item:e,disabled:t.disabled},on:{accepted:t.handleResolved}})})),1)]):i("div",{staticClass:"text-center lead"},[t._v("\n        The label trees are identical.\n    ")])])}),[],!1,null,null,null).exports,bc=Vue.resource("api/v1/label-trees{/id}/merge-labels");const wc=Tl({mixins:[cu],components:{labelTreeDiff:_c},data:function(){return{baseTree:null,mergeTree:null,usedLabels:[],toAdd:[],toRemove:[],merged:!1}},computed:{baseTreeLabels:function(){return this.baseTree.labels},mergeTreeLabels:function(){return this.mergeTree.labels},cannotMerge:function(){return this.loading||0===this.toAdd.length&&0===this.toRemove.length},disableDiff:function(){return this.loading||this.merged}},methods:{handleAdd:function(t){-1===this.toAdd.indexOf(t)&&this.toAdd.push(t)},handleRemove:function(t){-1===this.toRemove.indexOf(t)&&this.toRemove.push(t)},handleCancelAdd:function(t){var e=this.toAdd.indexOf(t);-1!==e&&this.toAdd.splice(e,1)},handleCancelRemove:function(t){var e=this.toRemove.indexOf(t);-1!==e&&this.toRemove.splice(e,1)},bundleToAdd:function(t){var e={};t.forEach((function(t){e[t.id]={name:t.name,color:t.color,parent_id:t.parent_id,left_parent_id:t.left_parent_id}}));var i=[];return Object.keys(e).forEach((function(t){var n=e[t];n.parent_id&&e.hasOwnProperty(n.parent_id)?(e[n.parent_id].children?e[n.parent_id].children.push(n):e[n.parent_id].children=[n],delete n.parent_id,delete n.left_parent_id):(delete n.parent_id,n.left_parent_id&&(n.parent_id=n.left_parent_id),delete n.left_parent_id,i.push(n))})),i},bundleToRemove:function(t){return t.map((function(t){return t.id}))},submitMerge:function(){this.startLoading();var t=this.bundleToAdd(this.toAdd),e=this.bundleToRemove(this.toRemove);bc.save({id:this.baseTree.id},{create:t,remove:e}).then(this.handleMergeSuccess,this.handleMergeError)},handleMergeError:function(t){this.finishLoading(),lu(t)},handleMergeSuccess:function(){this.merged=!0}},created:function(){this.baseTree=biigle.$require("labelTrees.baseTree"),this.mergeTree=biigle.$require("labelTrees.mergeTree"),this.usedLabels=biigle.$require("labelTrees.usedLabels")}},undefined,undefined,!1,null,null,null).exports;const xc=Tl({components:{typeahead:Ql},data:function(){return{mergeUrlTemplate:null,mergeCandidates:[],chosenCandidate:null}},computed:{cannotContinue:function(){return null===this.chosenCandidate},continueUrl:function(){return this.chosenCandidate?this.mergeUrlTemplate.replace(":id",this.chosenCandidate.id):""}},methods:{parseLabelTreeVersionedName:function(t){return t.version&&(t.name=t.name+" @ "+t.version.name),t},chooseCandidate:function(t){this.chosenCandidate=t}},created:function(){this.mergeUrlTemplate=biigle.$require("labelTrees.mergeUrlTemplate"),this.mergeCandidates=biigle.$require("labelTrees.mergeCandidates").map(this.parseLabelTreeVersionedName)}},undefined,undefined,!1,null,null,null).exports;const Sc=Tl({mixins:[cu,hu],components:{dropdown:Zh},data:function(){return{labelTree:null,name:null,description:null,visibility_id:null,userId:null,redirectUrl:null,privateVisibilityId:null}},computed:{isPrivate:function(){return this.labelTree.visibility_id===this.privateVisibilityId},hasDescription:function(){return!!this.description},isChanged:function(){return this.name!==this.labelTree.name||this.description!==this.labelTree.description||parseInt(this.visibility_id)!==this.labelTree.visibility_id},disabledClass:function(){return this.loading?"disabled":""}},methods:{discardChanges:function(){this.finishEditing(),this.name=this.labelTree.name,this.description=this.labelTree.description,this.visibility_id=this.labelTree.visibility_id},leaveTree:function(){confirm("Do you really want to revoke your membership of label tree '".concat(this.labelTree.name,"'?"))&&(this.startLoading(),_l.removeUser({id:this.labelTree.id,user_id:this.userId}).then(this.treeLeft,lu).finally(this.finishLoading))},treeLeft:function(){var t=this;this.isPrivate?(uu.success("You left the label tree. Redirecting..."),setTimeout((function(){return location.href=t.redirectUrl}),2e3)):location.reload()},deleteTree:function(){confirm("Do you really want to delete the label tree '".concat(this.labelTree.name,"'?"))&&(this.startLoading(),_l.delete({id:this.labelTree.id}).then(this.treeDeleted,lu).finally(this.finishLoading))},treeDeleted:function(){var t=this;uu.success("The label tree was deleted. Redirecting..."),setTimeout((function(){return location.href=t.redirectUrl}),2e3)},saveChanges:function(){this.startLoading(),_l.update({id:this.labelTree.id},{name:this.name,description:this.description,visibility_id:this.visibility_id}).then(this.changesSaved,lu).finally(this.finishLoading)},changesSaved:function(){this.labelTree.name=this.name,this.labelTree.description=this.description,this.labelTree.visibility_id=parseInt(this.visibility_id),this.finishEditing()}},created:function(){this.privateVisibilityId=biigle.$require("labelTrees.privateVisibilityId"),this.labelTree=biigle.$require("labelTrees.labelTree"),this.userId=biigle.$require("labelTrees.userId"),this.redirectUrl=biigle.$require("labelTrees.redirectUrl"),this.name=this.labelTree.name,this.description=this.labelTree.description,this.visibility_id=this.labelTree.visibility_id}},undefined,undefined,!1,null,null,null).exports;const Cc=Tl({mixins:[cu],data:function(){return{doi:"",doiSaved:!1,version:null}},computed:{doiUrl:function(){return"https://doi.org/"+this.doi},doiTitle:function(){return"DOI: "+this.doi}},methods:{cleanDoi:function(t){return t.replace(/^https?:\/\/doi\.org\//,"")},saveDoi:function(){this.doi=this.cleanDoi(this.doi),bl.update({id:this.version.id},{doi:this.doi}).then(this.handleDoiSaved,lu)},handleDoiSaved:function(){this.doiSaved=!0}},created:function(){this.version=biigle.$require("labelTrees.version")}},undefined,undefined,!1,null,null,null).exports;const Tc=Tl({mixins:[cu],components:{dropdown:Zh},data:function(){return{version:null,redirectUrl:null}},computed:{disabledClass:function(){return this.loading?"disabled":""}},methods:{deleteVersion:function(){this.startLoading(),bl.delete({id:this.version.id}).then(this.deleteSuccess,lu)},deleteSuccess:function(){var t=this;uu.success("The label tree version was deleted. Redirecting..."),setTimeout((function(){return location.href=t.redirectUrl}),2e3)}},created:function(){this.version=biigle.$require("labelTrees.version"),this.redirectUrl=biigle.$require("labelTrees.redirectUrl")}},undefined,undefined,!1,null,null,null).exports;biigle.$mount("label-tree-version-doi",Cc),biigle.$mount("label-tree-version-title",Tc),biigle.$mount("label-trees-authorized-projects",ic),biigle.$mount("label-trees-labels",cc),biigle.$mount("label-trees-labels-count",dc),biigle.$mount("label-trees-members",mc),biigle.$mount("label-trees-members-count",vc),biigle.$mount("label-trees-title",Sc),biigle.$mount("merge-label-trees-container",wc),biigle.$mount("merge-label-trees-index-container",xc);const Ec=Tl({props:{id:{type:Number,required:!0},thumbUris:{required:!0},removable:{type:Boolean,default:!1},removeTitle:{type:String,default:"Remove this volume"},icon:{type:String}},data:function(){return{index:0,uris:[],loaded:[],touched:!1,hovered:!1}},computed:{progress:function(){return 100*this.index/(this.uris.length-1)+"%"},showFallback:function(){return!1===this.uris[this.index]},showPreview:function(){return this.touched&&this.someLoaded},someLoaded:function(){return this.loaded.some((function(t){return t}))},iconClass:function(){return this.icon?"fa-"+this.icon:""},showIcon:function(){return this.removable?!this.hovered&&this.icon:this.icon},showRemove:function(){return this.removable&&this.hovered}},methods:{thumbShown:function(t){return this.index===t&&this.loaded[t]},updateIndex:function(t){var e=this.$el.getBoundingClientRect();this.index=Math.max(0,Math.floor(this.uris.length*(t.clientX-e.left)/e.width))},remove:function(){this.$emit("remove",this.id)},uriLoaded:function(t){this.loaded.splice(t,1,!0)},setHovered:function(){this.hovered=!0,this.touched=!0},unsetHovered:function(){this.hovered=!1},emitClick:function(t){this.$emit("click",t)}},created:function(){Array.isArray(this.thumbUris)?this.uris=this.thumbUris.slice():this.uris=this.thumbUris.split(","),this.loaded=this.uris.map((function(){return!1}))}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("figure",{staticClass:"preview-thumbnail",on:{mousemove:function(e){return t.updateIndex(e)},mouseenter:t.setHovered,mouseleave:t.unsetHovered,click:t.emitClick}},[t.showIcon?i("i",{staticClass:"preview-thumbnail__icon fas fa-lg",class:t.iconClass}):t._e(),t._v(" "),t.showRemove?i("button",{staticClass:"btn btn-default btn-sm preview-thumbnail__icon",attrs:{title:t.removeTitle},on:{click:function(e){return e.preventDefault(),t.remove(e)}}},[i("i",{staticClass:"fas fa-trash"})]):t._e(),t._v(" "),t.touched?i("div",{directives:[{name:"show",rawName:"v-show",value:t.showPreview,expression:"showPreview"}],staticClass:"preview-thumbnail__images"},t._l(t.uris,(function(e,n){return i("img",{directives:[{name:"show",rawName:"v-show",value:t.thumbShown(n),expression:"thumbShown(i)"}],attrs:{src:e},on:{load:function(e){return t.uriLoaded(n)}}})})),0):t._e(),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.showPreview,expression:"!showPreview"}],staticClass:"preview-thumbnail__fallback"},[t._t("default")],2),t._v(" "),t._t("caption"),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.someLoaded,expression:"someLoaded"}],staticClass:"preview-thumbnail__progress",style:{width:t.progress}})],2)}),[],!1,null,null,null).exports;const Ic=Tl({components:{previewThumbnail:Ec}},undefined,undefined,!1,null,null,null).exports;const Ac=Tl({props:{tree:{type:Object,required:!0},baseUri:{type:String,required:!0},editable:{type:Boolean,required:!0},editing:{type:Boolean,default:!1}},computed:{url:function(){return this.baseUri+"/"+this.tree.id}},methods:{emitRemove:function(){this.$emit("remove",this.tree)},emitEnter:function(){this.$emit("enter",this.tree)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"list-group-item",on:{mouseenter:t.emitEnter}},[i("h4",{staticClass:"list-group-item-heading"},[t.editable?i("button",{directives:[{name:"show",rawName:"v-show",value:t.editing,expression:"editing"}],staticClass:"btn btn-default btn-sm pull-right",attrs:{type:"button",title:"Detach this label tree"},on:{click:t.emitRemove}},[i("i",{staticClass:"fa fa-trash"})]):t._e(),t._v(" "),i("a",{attrs:{href:t.url},domProps:{textContent:t._s(t.tree.name)}})]),t._v(" "),t.tree.description?i("p",{staticClass:"list-group-item-text",domProps:{textContent:t._s(t.tree.description)}}):t._e()])}),[],!1,null,null,null).exports;var Pc=Tl({props:{labelTrees:{type:Array,required:!0},baseUri:{type:String,required:!0},editable:{type:Boolean,required:!0}},components:{listItem:Ac},data:function(){return{editingTreeId:null}},methods:{emitRemove:function(t){this.$emit("remove",t)},handleEnter:function(t){this.editable&&(this.editingTreeId=t.id)},handleLeave:function(t){null!==t.relatedTarget&&(this.editingTreeId=null)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"list-group",on:{mouseleave:t.handleLeave}},t._l(t.labelTrees,(function(e){return i("list-item",{key:e.id,attrs:{tree:e,editable:t.editable,"base-uri":t.baseUri,editing:t.editingTreeId===e.id},on:{remove:t.emitRemove,enter:t.handleEnter}})})),1)}),[],!1,null,null,null);const kc=Tl({mixins:[cu],components:{typeahead:Ql,labelTreeList:Pc.exports},data:function(){return{project:null,canEdit:!1,labelTrees:[],fetchedAvailableLabelTrees:!1,availableLabelTrees:[]}},computed:{hasLabelTrees:function(){return this.labelTrees.length>0},labelTreeIds:function(){return this.labelTrees.map((function(t){return t.id}))},attachableLabelTrees:function(){var t=this;return this.availableLabelTrees.filter((function(e){return-1===t.labelTreeIds.indexOf(e.id)}))}},methods:{fetchAvailableLabelTrees:function(){this.fetchedAvailableLabelTrees||(this.fetchedAvailableLabelTrees=!0,this.startLoading(),xl.queryAvailableLabelTrees({id:this.project.id}).then(this.availableLabelTreesFetched,lu).finally(this.finishLoading))},availableLabelTreesFetched:function(t){this.availableLabelTrees=t.data.map(this.parseLabelTreeVersionedName)},attachTree:function(t){var e=this;t&&(this.startLoading(),xl.attachLabelTree({id:this.project.id},{id:t.id}).then((function(){return e.treeAttached(t)}),lu).finally(this.finishLoading))},treeAttached:function(t){for(var e=this.availableLabelTrees.length-1;e>=0;e--)this.availableLabelTrees[e].id===t.id&&this.availableLabelTrees.splice(e,1);this.labelTrees.push(t)},removeTree:function(t){var e=this;this.startLoading(),xl.detachLabelTree({id:this.project.id,label_tree_id:t.id}).then((function(){return e.treeRemoved(t)}),lu).finally(this.finishLoading)},treeRemoved:function(t){for(var e=this.labelTrees.length-1;e>=0;e--)this.labelTrees[e].id===t.id&&this.labelTrees.splice(e,1);this.availableLabelTrees.push(t)},parseLabelTreeVersionedName:function(t){return t.version&&(t.name=t.name+" @ "+t.version.name),t}},watch:{labelTrees:function(t){Rl.$emit("project.label-trees.count",t.length)}},created:function(){this.canEdit=biigle.$require("projects.canEdit"),this.labelTrees=biigle.$require("projects.labelTrees").map(this.parseLabelTreeVersionedName),this.project=biigle.$require("projects.project")}},undefined,undefined,!1,null,null,null).exports;const Rc=Tl({methods:{updateCount:function(t){this.$el.textContent=t}},created:function(){Rl.$on("project.label-trees.count",this.updateCount)}},undefined,undefined,!1,null,null,null).exports;const Lc=Tl({mixins:[cu],data:function(){return{project:null,canEdit:!1,members:[],roles:{},defaultRole:null,userId:null}},components:{memberList:gc,addMemberForm:fc},methods:{attachMember:function(t){var e=this;this.startLoading(),xl.addUser({id:this.project.id,user_id:t.id},{project_role_id:t.role_id}).then((function(){return e.memberAttached(t)}),lu).finally(this.finishLoading)},memberAttached:function(t){this.members.push(t)},updateMember:function(t,e){var i=this;this.startLoading(),xl.updateUser({id:this.project.id,user_id:t.id},{project_role_id:e.role_id}).then((function(){return i.memberUpdated(t,e)}),lu).finally(this.finishLoading)},memberUpdated:function(t,e){t.role_id=e.role_id},removeMember:function(t){var e=this;this.startLoading(),xl.removeUser({id:this.project.id,user_id:t.id}).then((function(){return e.memberRemoved(t)}),lu).finally(this.finishLoading)},memberRemoved:function(t){for(var e=this.members.length-1;e>=0;e--)this.members[e].id===t.id&&this.members.splice(e,1)}},watch:{members:function(t){Rl.$emit("project.members.count",t.length)}},created:function(){this.project=biigle.$require("projects.project"),this.canEdit=biigle.$require("projects.canEdit"),this.roles=biigle.$require("projects.roles"),this.defaultRole=biigle.$require("projects.defaultRole"),this.members=biigle.$require("projects.members"),this.userId=biigle.$require("projects.userId")}},undefined,undefined,!1,null,null,null).exports;const Fc=Tl({methods:{updateCount:function(t){this.$el.textContent=t}},created:function(){Rl.$on("project.members.count",this.updateCount)}},undefined,undefined,!1,null,null,null).exports;const Mc=Tl({mixins:[cu,hu],components:{dropdown:Zh},data:function(){return{project:null,name:null,description:null,userId:null,redirectUrl:null}},computed:{hasDescription:function(){return!!this.description.length},isChanged:function(){return this.name!==this.project.name||this.description!==this.project.description},disabledClass:function(){return this.loading?"disabled":""}},methods:{discardChanges:function(){this.name=this.project.name,this.description=this.project.description,this.finishEditing()},leaveProject:function(){confirm('Do you really want to revoke your membership of project "'.concat(this.project.name,'"?'))&&(this.startLoading(),xl.removeUser({id:this.project.id,user_id:this.userId}).then(this.projectLeft,lu).finally(this.finishLoading))},projectLeft:function(){var t=this;uu.success("You left the project. Redirecting..."),setTimeout((function(){return location.href=t.redirectUrl}),2e3)},deleteProject:function(){confirm("Do you really want to delete the project ".concat(this.project.name,"?"))&&(this.startLoading(),xl.delete({id:this.project.id}).then(this.projectDeleted,this.maybeForceDeleteProject).finally(this.finishLoading))},maybeForceDeleteProject:function(t){400===t.status?confirm("Deleting this project will delete one or more volumes with all annotations! Do you want to continue?")&&(this.startLoading(),xl.delete({id:this.project.id},{force:!0}).then(this.projectDeleted,lu).finally(this.finishLoading)):lu(t)},projectDeleted:function(){var t=this;uu.success("The project was deleted. Redirecting..."),setTimeout((function(){return location.href=t.redirectUrl}),2e3)},saveChanges:function(){this.startLoading(),xl.update({id:this.project.id},{name:this.name,description:this.description}).then(this.changesSaved,lu).finally(this.finishLoading)},changesSaved:function(){this.project.name=this.name,this.project.description=this.description,this.finishEditing()}},created:function(){this.project=biigle.$require("projects.project"),this.name=this.project.name,this.description=this.project.description,this.userId=biigle.$require("projects.userId"),this.redirectUrl=biigle.$require("projects.redirectUrl")}},undefined,undefined,!1,null,null,null).exports,Oc=Vue.resource("api/v1/projects{/id}/attachable-volumes");const $c=Tl({mixins:[cu],data:function(){return{project:null,volumes:[],fetchedAttachableVolumes:!1,attachableVolumes:[],filterString:"",showImageVolumes:!0,showVideoVolumes:!0}},components:{previewThumbnail:Ec,typeahead:Ql},computed:{filteredVolumes:function(){var t=this.volumes;if(this.showImageVolumes||(t=t.filter((function(t){return"image"!==t.media_type.name}))),this.showVideoVolumes||(t=t.filter((function(t){return"video"!==t.media_type.name}))),this.hasFiltering){var e=this.filterString.toLowerCase();t=t.filter((function(t){return t.name.toLowerCase().includes(e)}))}return t},hasFiltering:function(){return this.filterString.length>0},filterInputClass:function(){return this.hasFiltering?"volume-filter--active":""},hasVolumes:function(){return this.volumes.length>0},hasNoMatchingVolumes:function(){return this.hasVolumes&&0===this.filteredVolumes.length},hasMixedMediaTypes:function(){return this.volumes.some((function(t){return"image"===t.media_type.name}))&&this.volumes.some((function(t){return"video"===t.media_type.name}))},toggleImageVolumesClass:function(){return this.showVideoVolumes?"btn-default":"btn-info active"},toggleVideoVolumesClass:function(){return this.showImageVolumes?"btn-default":"btn-info active"}},methods:{removeVolume:function(t){var e=this;this.startLoading(),xl.detachVolume({id:this.project.id,volume_id:t}).then((function(){return e.volumeRemoved(t)}),(function(i){400===i.status?confirm("The volume you are about to remove belongs only to this project and will be deleted. Are you sure you want to delete this volume?")&&e.forceRemoveVolume(t):lu(i)})).finally(this.finishLoading)},forceRemoveVolume:function(t){var e=this;this.startLoading(),xl.detachVolume({id:this.project.id,volume_id:t},{force:!0}).then((function(){return e.volumeRemoved(t)}),lu).finally(this.finishLoading)},volumeRemoved:function(t){for(var e=this.volumes.length-1;e>=0;e--)this.volumes[e].id===t&&(this.attachableVolumes.unshift(this.volumes[e]),this.volumes.splice(e,1))},hasVolume:function(t){for(var e=this.volumes.length-1;e>=0;e--)if(this.volumes[e].id===t)return!0;return!1},attachVolume:function(t){var e=this;t&&!this.hasVolume(t.id)&&(this.startLoading(),xl.attachVolume({id:this.project.id,volume_id:t.id},{}).then((function(){return e.volumeAttached(t)}),lu).finally(this.finishLoading))},volumeAttached:function(t){this.volumes.unshift(t);for(var e=this.attachableVolumes.length-1;e>=0;e--)this.attachableVolumes[e].id===t.id&&this.attachableVolumes.splice(e,1)},fetchAttachableVolumes:function(){this.fetchedAttachableVolumes||(this.fetchedAttachableVolumes=!0,this.startLoading(),Oc.get({id:this.project.id}).then(this.attachableVolumesFetched,lu).finally(this.finishLoading))},attachableVolumesFetched:function(t){this.attachableVolumes=t.data.map(this.processVolumes)},clearFiltering:function(t){t.preventDefault(),this.filterString=""},toggleImageVolumes:function(){this.showVideoVolumes=!this.showVideoVolumes,this.showImageVolumes||this.showVideoVolumes||(this.showImageVolumes=!0)},toggleVideoVolumes:function(){this.showImageVolumes=!this.showImageVolumes,this.showVideoVolumes||this.showImageVolumes||(this.showVideoVolumes=!0)},processVolumes:function(t){return t.icon="image"===t.media_type.name?"image":"film",t}},watch:{volumes:function(t){Rl.$emit("project.volumes.count",t.length)}},created:function(){this.project=biigle.$require("projects.project"),this.volumes=biigle.$require("projects.volumes").map(this.processVolumes)}},undefined,undefined,!1,null,null,null).exports;const Dc=Tl({methods:{updateCount:function(t){this.$el.textContent=t}},created:function(){Rl.$on("project.volumes.count",this.updateCount)}},undefined,undefined,!1,null,null,null).exports;biigle.$mount("project-label-trees-count",Rc),biigle.$mount("project-members-count",Fc),biigle.$mount("project-volumes-count",Dc),biigle.$mount("projects-dashboard-main",Ic),biigle.$mount("projects-show-label-trees",kc),biigle.$mount("projects-show-members",Lc),biigle.$mount("projects-show-volumes",$c),biigle.$mount("projects-title",Mc);const jc=Tl({props:{rule:{type:Object,required:!0}},data:function(){return{name:this.rule.id}},computed:{dataName:function(){return this.rule.data?this.rule.data.name:""}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",[i("strong",[t._v("with"),t.rule.negate?i("span",[t._v("out")]):t._e()]),t._v(" "),i("span",{domProps:{textContent:t._s(t.name)}}),t._v(" "),t.dataName?i("strong",{domProps:{textContent:t._s(t.dataName)}}):t._e()])}),[],!1,null,null,null).exports;const Nc=Tl({components:{typeahead:Ql},props:{volumeId:{type:Number,required:!0}},data:function(){return{items:[],placeholder:"",selectedItem:null,typeaheadMoreInfo:""}},computed:{value:function(){return this.selectedItem?this.selectedItem.name:""}},methods:{select:function(t){this.selectedItem=t},gotItems:function(t){this.items=t.data},parseUsernames:function(t){return t.data=t.data.map((function(t){return t.name=t.firstname+" "+t.lastname,t})),t},submit:function(){this.$emit("select",this.selectedItem)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"filter-select"},[i("typeahead",{attrs:{items:t.items,value:t.value,placeholder:t.placeholder,"more-info":t.typeaheadMoreInfo},on:{select:t.select}}),t._v(" "),i("button",{staticClass:"btn btn-default",attrs:{type:"submit",disabled:!t.selectedItem},on:{click:t.submit}},[t._v("Add rule")])],1)}),[],!1,null,null,null).exports,Bc=Vue.resource("api/v1/volumes{/id}",{},{queryFilesWithFileLabels:{method:"GET",url:"api/v1/volumes{/id}/files/filter/labels"},queryFilesWithLabel:{method:"GET",url:"api/v1/volumes{/id}/files/filter/labels{/label_id}"},queryFilesWithLabelFromUser:{method:"GET",url:"api/v1/volumes{/id}/files/filter/labels/users{/user_id}"},queryFilesWithFilename:{method:"GET",url:"api/v1/volumes{/id}/files/filter/filename{/pattern}"},queryUsedFileLabels:{method:"GET",url:"api/v1/volumes{/id}/file-labels"},queryFilenames:{method:"GET",url:"api/v1/volumes{/id}/filenames"},queryFileLabels:{method:"GET",url:"api/v1/volumes{/id}/files/labels"},queryUsers:{method:"GET",url:"api/v1/volumes{/id}/users"},queryFiles:{method:"GET",url:"api/v1/volumes{/id}/files"},saveFiles:{method:"POST",url:"api/v1/volumes{/id}/files"},queryFilesWithAnnotations:{method:"GET",url:"api/v1/volumes{/id}/files/filter/annotations"},queryFilesWithAnnotationLabel:{method:"GET",url:"api/v1/volumes{/id}/files/filter/annotation-label{/label_id}"},queryFilesWithAnnotationFromUser:{method:"GET",url:"api/v1/volumes{/id}/files/filter/annotation-user{/user_id}"},queryAnnotationLabels:{method:"GET",url:"api/v1/volumes{/id}/annotation-labels"}});const Uc=[{id:"fileLabels",types:["image"],label:"image labels",help:"All images that (don't) have image labels attached.",listComponent:{mixins:[jc],data:function(){return{name:"image labels"}}},getSequence:function(t){return Bc.queryFilesWithFileLabels({id:t})}},{id:"fileLabels",types:["video"],label:"video labels",help:"All videos that (don't) have video labels attached.",listComponent:{mixins:[jc],data:function(){return{name:"video labels"}}},getSequence:function(t){return Bc.queryFilesWithFileLabels({id:t})}},{id:"imageLabel",types:["image"],label:"image label",help:"All images that (don't) have the given image label attached.",listComponent:{mixins:[jc],data:function(){return{name:"image label"}}},selectComponent:{mixins:[Nc],components:{typeahead:tc},data:function(){return{placeholder:"Label name"}},created:function(){Bc.queryUsedFileLabels({id:this.volumeId}).then(this.gotItems,lu)}},getSequence:function(t,e){return Bc.queryFilesWithLabel({id:t,label_id:e.id})}},{id:"videoLabel",types:["video"],label:"video label",help:"All videos that (don't) have the given video label attached.",listComponent:{mixins:[jc],data:function(){return{name:"video label"}}},selectComponent:{mixins:[Nc],components:{typeahead:tc},data:function(){return{placeholder:"Label name"}},created:function(){Bc.queryUsedFileLabels({id:this.volumeId}).then(this.gotItems,lu)}},getSequence:function(t,e){return Bc.queryFilesWithLabel({id:t,label_id:e.id})}},{id:"imageLabelUser",types:["image"],label:"image label from user",help:"All images that (don't) have one or more image labels attached by the given user.",listComponent:{mixins:[jc],data:function(){return{name:"image label from user"}}},selectComponent:{mixins:[Nc],data:function(){return{placeholder:"User name",typeaheadMoreInfo:"affiliation"}},created:function(){Bc.queryUsers({id:this.volumeId}).then(this.parseUsernames,lu).then(this.gotItems)}},getSequence:function(t,e){return Bc.queryFilesWithLabelFromUser({id:t,user_id:e.id})}},{id:"videoLabelUser",types:["video"],label:"video label from user",help:"All videos that (don't) have one or more video labels attached by the given user.",listComponent:{mixins:[jc],data:function(){return{name:"video label from user"}}},selectComponent:{mixins:[Nc],data:function(){return{placeholder:"User name",typeaheadMoreInfo:"affiliation"}},created:function(){Bc.queryUsers({id:this.volumeId}).then(this.parseUsernames,lu).then(this.gotItems)}},getSequence:function(t,e){return Bc.queryFilesWithLabelFromUser({id:t,user_id:e.id})}},{id:"filename",types:["image","video"],label:"filename",help:"All :types that (don't) have a filename matching the given pattern. A pattern may contain the wildcard character * that matches any string of zero or more characters.",listComponent:{mixins:[jc],computed:{dataName:function(){return this.rule.data}}},selectComponent:{template:'<div class="filter-select">\n            <div class="typeahead">\n                <input class="form-control" type="text" v-model="selectedItem" placeholder="Filename pattern">\n            </div>\n            <button type="submit" class="btn btn-default" @click="submit" :disabled="!selectedItem">Add rule</button>\n        </div>',data:function(){return{selectedItem:null}},methods:{submit:function(){this.$emit("select",this.selectedItem)}}},getSequence:function(t,e){return Bc.queryFilesWithFilename({id:t,pattern:e})}},{id:"annotations",types:["image","video"],label:"annotations",help:"All :types that (don't) contain annotations.",listComponent:jc,getSequence:function(t){return Bc.queryFilesWithAnnotations({id:t})}},{id:"annotationLabels",types:["image","video"],label:"annotation with label",help:"All :types that (don't) contain one or more annotations with the given label.",listComponent:{mixins:[jc],data:function(){return{name:"annotation with label"}}},selectComponent:{mixins:[Nc],components:{typeahead:tc},data:function(){return{placeholder:"Label name"}},created:function(){Bc.queryAnnotationLabels({id:this.volumeId}).then(this.gotItems,lu)}},getSequence:function(t,e){return Bc.queryFilesWithAnnotationLabel({id:t,label_id:e.id})}},{id:"annotationUser",types:["image","video"],label:"annotations from user",help:"All :types that (don't) contain one or more annotations from the given user.",listComponent:{mixins:[jc],data:function(){return{name:"annotations from user"}}},selectComponent:{mixins:[Nc],data:function(){return{placeholder:"User name",typeaheadMoreInfo:"affiliation"}},created:function(){Bc.queryUsers({id:this.volumeId}).then(this.parseUsernames,lu).then(this.gotItems)}},getSequence:function(t,e){return Bc.queryFilesWithAnnotationFromUser({id:t,user_id:e.id})}}];const zc=Tl({data:function(){return{thumbnailUrl:null,timeout:null}},props:{image:{type:Object,required:!0},emptyUrl:{type:String,required:!0},selectable:{type:Boolean,required:!1},selectedIcon:{type:String,default:"check"},selectedFade:{type:Boolean,default:!0},smallIcon:{type:Boolean,default:!1}},computed:{classObject:function(){return{"image-grid__image--selected":this.selected,"image-grid__image--selectable":this.selectable,"image-grid__image--fade":this.selectedFade,"image-grid__image--small-icon":this.smallIcon}},selected:function(){return!1},iconClass:function(){return"fa-"+this.selectedIcon},showIcon:function(){return this.selectable||this.selected},srcUrl:function(){return Array.isArray(this.thumbnailUrl)?this.thumbnailUrl[0]:this.thumbnailUrl?this.thumbnailUrl:this.emptyUrl}},methods:{toggleSelect:function(t){this.selectable&&this.$emit("select",this.image,t)},gotBlob:function(t){var e=window.URL||window.webkitURL;this.thumbnailUrl=e.createObjectURL(t.body),this.image.blob=this.thumbnailUrl},showEmptyImage:function(){this.thumbnailUrl=null}},created:function(){var t=this;this.image.thumbnailUrl?this.thumbnailUrl=this.image.thumbnailUrl:this.image.blob?this.thumbnailUrl=this.image.blob:this.getThumbnailUrl?this.thumbnailUrl=this.getThumbnailUrl():this.getBlob&&(this.timeout=setTimeout((function(){return t.getBlob().then(t.gotBlob)}),50))},beforeDestroy:function(){clearTimeout(this.timeout)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("figure",{staticClass:"image-grid__image",class:t.classObject},[t.showIcon?i("div",{staticClass:"image-icon"},[i("i",{staticClass:"fas",class:t.iconClass})]):t._e(),t._v(" "),i("img",{attrs:{src:t.srcUrl},on:{click:t.toggleSelect,error:t.showEmptyImage}})])}),[],!1,null,null,null).exports;var Vc=Tl({data:function(){return{scrolling:!1}},props:{progress:{type:Number,required:!0}},computed:{isAtTop:function(){return 0===this.progress},isAtBottom:function(){return 1===this.progress},progressHeight:function(){return 100*this.progress+"%"}},methods:{top:function(){this.$emit("top")},prevPage:function(){this.$emit("prev-page")},prevRow:function(){this.$emit("prev-row")},beginScrolling:function(){this.scrolling=!0},stopScrolling:function(){this.scrolling=!1},scroll:function(t){this.scrolling&&this.jump(t)},jump:function(t){var e=t.target.getBoundingClientRect();this.$emit("jump",(t.clientY-e.top)/e.height)},nextRow:function(){this.$emit("next-row")},nextPage:function(){this.$emit("next-page")},bottom:function(){this.$emit("bottom")}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"image-grid-progress"},[i("div",{staticClass:"btn-group-vertical"},[i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Go to top 𝗛𝗼𝗺𝗲",disabled:t.isAtTop},on:{click:t.top}},[i("span",{staticClass:"fa fa-fast-backward fa-rotate-90"})]),t._v(" "),i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Previous page 𝗣𝗮𝗴𝗲 𝘂𝗽/𝗔𝗿𝗿𝗼𝘄 𝗹𝗲𝗳𝘁",disabled:t.isAtTop},on:{click:t.prevPage}},[i("span",{staticClass:"fa fa-step-backward fa-rotate-90"})]),t._v(" "),i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Previous row 𝗔𝗿𝗿𝗼𝘄 𝘂𝗽",disabled:t.isAtTop},on:{click:t.prevRow}},[i("span",{staticClass:"fa fa-chevron-up"})])]),t._v(" "),i("div",{staticClass:"image-grid-progress__bar",on:{mousedown:t.beginScrolling,mouseup:t.stopScrolling,mouseleave:t.stopScrolling,mousemove:function(e){return e.preventDefault(),t.scroll(e)},click:t.jump}},[i("div",{staticClass:"image-grid-progress__wrapper"},[i("div",{staticClass:"image-grid-progress__inner",style:{height:t.progressHeight}})])]),t._v(" "),i("div",{staticClass:"btn-group-vertical"},[i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Next row 𝗔𝗿𝗿𝗼𝘄 𝗱𝗼𝘄𝗻",disabled:t.isAtBottom},on:{click:t.nextRow}},[i("span",{staticClass:"fa fa-chevron-down"})]),t._v(" "),i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Next page 𝗣𝗮𝗴𝗲 𝗱𝗼𝘄𝗻/𝗔𝗿𝗿𝗼𝘄 𝗿𝗶𝗴𝗵𝘁",disabled:t.isAtBottom},on:{click:t.nextPage}},[i("span",{staticClass:"fa fa-step-forward fa-rotate-90"})]),t._v(" "),i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Go to bottom 𝗘𝗻𝗱",disabled:t.isAtBottom},on:{click:t.bottom}},[i("span",{staticClass:"fa fa-fast-forward fa-rotate-90"})])])])}),[],!1,null,null,null);const Gc=Tl({data:function(){return{clientWidth:0,clientHeight:0,offset:0,imagesOffset:0,imagesOffsetTimeout:null}},components:{imageGridImage:zc,imageGridProgress:Vc.exports},props:{images:{type:Array,required:!0},emptyUrl:{type:String,required:!0},width:{type:Number,default:135},height:{type:Number,default:180},margin:{type:Number,default:8},initialOffset:{type:Number,default:0},selectable:{type:Boolean,default:!1},selectedIcon:{type:String,default:"check"},listenerSet:{type:String,default:"default"}},computed:{columns:function(){return Math.max(1,Math.floor(this.clientWidth/(this.width+this.margin)))},rows:function(){return Math.max(1,Math.floor(this.clientHeight/(this.height+this.margin)))},imagesOffsetEnd:function(){return this.imagesOffset+this.columns*this.rows},displayedImages:function(){return this.images.slice(this.imagesOffset,this.imagesOffsetEnd)},progress:function(){return this.offset/(this.columns*this.lastRow)},lastRow:function(){return Math.max(0,Math.ceil(this.images.length/this.columns)-this.rows)},lastOffset:function(){return this.lastRow*this.columns},canScroll:function(){return this.lastRow>0}},methods:{updateDimensions:function(){this.$refs.images&&(this.clientHeight=this.$refs.images.clientHeight,this.clientWidth=this.$refs.images.clientWidth)},scrollRows:function(t,e){this.setOffset(this.offset+this.columns*t,e)},scroll:function(t){this.scrollRows(t.deltaY>=0?1:-1,!0)},advanceRow:function(){this.scrollRows(1)},advancePage:function(){this.scrollRows(this.rows)},reverseRow:function(){this.scrollRows(-1)},reversePage:function(){this.scrollRows(-this.rows)},jumpToPercent:function(t){this.setOffset(this.columns*Math.round(this.lastRow*t))},jumpToStart:function(){this.jumpToPercent(0)},jumpToEnd:function(){this.jumpToPercent(1)},emitSelect:function(t,e){this.$emit("select",t,e)},setOffset:function(t,e){var i=this;this.offset=Math.max(0,Math.min(this.lastOffset,t)),clearTimeout(this.imagesOffsetTimeout),e?this.imagesOffsetTimeout=setTimeout((function(){i.imagesOffset=i.offset}),25):this.imagesOffset=this.offset}},watch:{lastOffset:function(){this.setOffset(this.offset)},offset:function(){this.$emit("scroll",this.offset)}},created:function(){Ll.on("ArrowUp",this.reverseRow,0,this.listenerSet),Ll.on("w",this.reverseRow,0,this.listenerSet),Ll.on("ArrowDown",this.advanceRow,0,this.listenerSet),Ll.on("s",this.advanceRow,0,this.listenerSet),Ll.on("ArrowLeft",this.reversePage,0,this.listenerSet),Ll.on("a",this.reversePage,0,this.listenerSet),Ll.on("ArrowRight",this.advancePage,0,this.listenerSet),Ll.on("d",this.advancePage,0,this.listenerSet),Ll.on("PageUp",this.reversePage,0,this.listenerSet),Ll.on("PageDown",this.advancePage,0,this.listenerSet),Ll.on("Home",this.jumpToStart,0,this.listenerSet),Ll.on("End",this.jumpToEnd,0,this.listenerSet),this.setOffset(this.initialOffset)},mounted:function(){window.addEventListener("resize",this.updateDimensions),this.$on("resize",this.updateDimensions),this.$nextTick(this.updateDimensions),this.$watch("canScroll",this.updateDimensions)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"image-grid",on:{wheel:function(e){return e.preventDefault(),t.scroll(e)}}},[i("div",{ref:"images",staticClass:"image-grid__images"},t._l(t.displayedImages,(function(e){return i("image-grid-image",{key:e.id,attrs:{image:e,"empty-url":t.emptyUrl,selectable:t.selectable,"selected-icon":t.selectedIcon},on:{select:t.emitSelect}})})),1),t._v(" "),t.canScroll?i("image-grid-progress",{attrs:{progress:t.progress},on:{top:t.jumpToStart,"prev-page":t.reversePage,"prev-row":t.reverseRow,jump:t.jumpToPercent,"next-row":t.advanceRow,"next-page":t.advancePage,bottom:t.jumpToEnd}}):t._e()],1)}),[],!1,null,null,null).exports;const qc=Tl({props:{activeSorter:{type:String,default:""}},computed:{active:function(){return this.activeSorter===this.id},classObject:function(){return{active:this.active}}},methods:{getSequence:function(){return new Vue.Promise.resolve([])},handleClick:function(){this.active||this.$emit("select",this)}}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("button",{staticClass:"list-group-item",class:t.classObject,attrs:{title:t.title},domProps:{textContent:t._s(t.text)},on:{click:t.handleClick}})}),[],!1,null,null,null).exports;const Wc=[{id:"filename",types:["image","video"],component:{mixins:[qc],data:function(){return{fileIds:[],title:"Sort images by filename",text:"Filename",id:"filename"}},methods:{getSequence:function(){return new Vue.Promise.resolve(this.fileIds)}},created:function(){this.fileIds=biigle.$require("volumes.fileIds")}}},{id:"id",types:["image","video"],component:{mixins:[qc],data:function(){return{fileIds:[],title:"Sort images by ID",text:"ID",id:"id"}},computed:{ids:function(){return this.fileIds.slice().sort(this.compare)}},methods:{getSequence:function(){return new Vue.Promise.resolve(this.ids)},compare:function(t,e){return t-e}},created:function(){this.fileIds=biigle.$require("volumes.fileIds")}}},{id:"random",types:["image","video"],component:{mixins:[qc],data:function(){return{fileIds:[],title:"Sort images randomly",text:"Random",id:"random"}},methods:{shuffle:function(t){var e,i,n;for(e=t.length-1;e>0;e--)i=Math.floor(Math.random()*(e+1)),n=t[e],t[e]=t[i],t[i]=n;return t},getSequence:function(){var t=this.shuffle(this.fileIds.slice());return new Vue.Promise.resolve(t)},handleClick:function(){this.$emit("select",this)}},created:function(){this.fileIds=biigle.$require("volumes.fileIds")}}}];biigle.$declare("annotations.api.volumes",Bc),biigle.$declare("volumes.components.filterListComponent",jc),biigle.$declare("volumes.components.imageGrid",Gc),biigle.$declare("volumes.components.imageGridImage",zc),biigle.$declare("volumes.mixins.sortComponent",qc),biigle.$declare("volumes.stores.filters",Uc),biigle.$declare("volumes.stores.sorters",Wc);const Kc=Tl({props:["session","editing","editId"],computed:{title:function(){return this.editing?"Edit this annotation session":this.session.name},active:function(){var t=new Date;return this.session.starts_at_iso8601<t&&this.session.ends_at_iso8601>=t},currentlyEdited:function(){return this.session.id===this.editId},classObject:function(){return{"session--active":this.active,"list-group-item-info":this.currentlyEdited}}},methods:{edit:function(){this.editing&&!this.currentlyEdited&&this.$emit("edit",this.session)}}},undefined,undefined,!1,null,null,null).exports,Xc=Vue.resource("api/v1/annotation-sessions{/id}",{},{query:{method:"GET",url:"api/v1/volumes{/volume_id}/annotation-sessions"},save:{method:"POST",url:"api/v1/volumes{/volume_id}/annotation-sessions"}});const Yc=Tl({props:["user"],computed:{name:function(){return this.user.firstname+" "+this.user.lastname},title:function(){return"Remove "+this.name}},methods:{remove:function(){this.$emit("remove",this.user)}}},undefined,undefined,!1,null,null,null).exports;function Hc(t,e){var i=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1;r<arguments.length;r++){var o=i[r];if(null!=o)for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])}return n}function Zc(t){return null!=t}function Jc(t){return"function"==typeof t}function Qc(t){return"number"==typeof t}var td={uiv:{datePicker:{clear:"Clear",today:"Today",month:"Month",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",year:"Year",week1:"Mon",week2:"Tue",week3:"Wed",week4:"Thu",week5:"Fri",week6:"Sat",week7:"Sun"},timePicker:{am:"AM",pm:"PM"},modal:{cancel:"Cancel",ok:"OK"},multiSelect:{placeholder:"Select...",filterPlaceholder:"Search..."}}},ed=function(){var t=Object.getPrototypeOf(this).$t;if(Jc(t))try{return t.apply(this,arguments)}catch(t){return this.$t.apply(this,arguments)}},id=function(t,e){var i;e=e||{};try{if(Zc(i=ed.apply(this,arguments))&&!e.$$locale)return i}catch(t){}for(var n=t.split("."),r=e.$$locale||td,o=0,s=n.length;o<s;o++){var a=n[o];if(i=r[a],o===s-1)return i;if(!i)return"";r=i}return""},nd={methods:{t:function(){for(var t=arguments,e=[],i=0;i<arguments.length;++i)e.push(t[i]);return e[1]=Hc({},{$$locale:this.locale},e[1]),id.apply(this,e)}},props:{locale:Object}},rd=function(){return(rd=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},od=/-(\w)/g,sd=/:(.*)/,ad=/;(?![^(]*\))/g;function ld(t,e){return e?e.toUpperCase():""}function ud(t){for(var e,i={},n=0,r=t.split(ad);n<r.length;n++){var o=r[n].split(sd),s=o[0],a=o[1];(s=s.trim())&&("string"==typeof a&&(a=a.trim()),i[(e=s,e.replace(od,ld))]=a)}return i}function hd(){for(var t,e,i=arguments,n={},r=arguments.length;r--;)for(var o=0,s=Object.keys(arguments[r]);o<s.length;o++)switch(t=s[o]){case"class":case"style":case"directives":if(Array.isArray(n[t])||(n[t]=[]),"style"===t){var a=void 0;a=Array.isArray(i[r].style)?i[r].style:[i[r].style];for(var l=0;l<a.length;l++){var u=a[l];"string"==typeof u&&(a[l]=ud(u))}i[r].style=a}n[t]=n[t].concat(i[r][t]);break;case"staticClass":if(!i[r][t])break;void 0===n[t]&&(n[t]=""),n[t]&&(n[t]+=" "),n[t]+=i[r][t].trim();break;case"on":case"nativeOn":n[t]||(n[t]={});for(var h=0,c=Object.keys(arguments[r][t]||{});h<c.length;h++)e=c[h],n[t][e]?n[t][e]=[].concat(n[t][e],i[r][t][e]):n[t][e]=i[r][t][e];break;case"attrs":case"props":case"domProps":case"scopedSlots":case"staticStyle":case"hook":case"transition":n[t]||(n[t]={}),n[t]=rd({},i[r][t],n[t]);break;case"slot":case"key":case"ref":case"tag":case"show":case"keepAlive":default:n[t]||(n[t]=i[r][t])}return n}var cd={props:{href:String,target:String,to:null,replace:{type:Boolean,default:!1},append:{type:Boolean,default:!1},exact:{type:Boolean,default:!1}}},dd={functional:!0,render:function(t,e){var i,n=e.props,r=e.children;return t("div",hd(e.data,{class:(i={"btn-group":!n.vertical,"btn-group-vertical":n.vertical,"btn-group-justified":n.justified},i["btn-group-"+n.size]=n.size,i),attrs:{role:"group","data-toggle":"buttons"}}),r)},props:{size:String,vertical:{type:Boolean,default:!1},justified:{type:Boolean,default:!1}}},fd="checkbox",pd={functional:!0,mixins:[cd],render:function(t,e){var i=e.children,n=e.props,r=e.data,o=r.on||{},s=n.inputType===fd?n.value.indexOf(n.inputValue)>=0:n.value===n.inputValue,a={btn:!0,active:n.inputType?s:n.active,disabled:n.disabled,"btn-block":n.block};a["btn-"+n.type]=Boolean(n.type),a["btn-"+n.size]=Boolean(n.size);var l,u,h,c={click:function(t){n.disabled&&t instanceof Event&&(t.preventDefault(),t.stopPropagation())}};return n.href?(l="a",h=i,u=hd(r,{on:c,class:a,attrs:{role:"button",href:n.href,target:n.target}})):n.to?(l="router-link",h=i,u=hd(r,{nativeOn:c,class:a,props:{event:n.disabled?"":"click",to:n.to,replace:n.replace,append:n.append,exact:n.exact},attrs:{role:"button"}})):n.inputType?(l="label",u=hd(r,{on:c,class:a}),h=[t("input",{attrs:{autocomplete:"off",type:n.inputType,checked:s?"checked":null,disabled:n.disabled},domProps:{checked:s},on:{input:function(t){t.stopPropagation()},change:function(){if(n.inputType===fd){var t=n.value.slice();s?t.splice(t.indexOf(n.inputValue),1):t.push(n.inputValue),o.input(t)}else o.input(n.inputValue)}}}),i]):n.justified?(l=dd,u={},h=[t("button",hd(r,{on:c,class:a,attrs:{type:n.nativeType,disabled:n.disabled}}),i)]):(l="button",h=i,u=hd(r,{on:c,class:a,attrs:{type:n.nativeType,disabled:n.disabled}})),t(l,u,h)},props:{justified:{type:Boolean,default:!1},type:{type:String,default:"default"},nativeType:{type:String,default:"button"},size:String,block:{type:Boolean,default:!1},active:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},value:null,inputValue:null,inputType:{type:String,validator:function(t){return t===fd||"radio"===t}}}};function gd(t,e){for(var i=e-(t+="").length;i>0;i--)t="0"+t;return t}var md=["January","February","March","April","May","June","July","August","September","October","November","December"];function vd(t){return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds())}function yd(t,e,i,n,r,o,s,a,l,u){"boolean"!=typeof s&&(l=a,a=s,s=!1);var h,c="function"==typeof i?i.options:i;if(t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,r&&(c.functional=!0)),n&&(c._scopeId=n),o?(h=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},c._ssrRegister=h):e&&(h=s?function(t){e.call(this,u(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,a(t))}),h)if(c.functional){var d=c.render;c.render=function(t,e){return h.call(e),d(t,e)}}else{var f=c.beforeCreate;c.beforeCreate=f?[].concat(f,h):[h]}return i}var _d={mixins:[nd],props:{month:Number,year:Number,date:Date,today:Date,limit:Object,weekStartsWith:Number,iconControlLeft:String,iconControlRight:String,dateClass:Function,yearMonthFormatter:Function,weekNumbers:Boolean},components:{Btn:pd},computed:{weekDays:function(){for(var t=[],e=this.weekStartsWith;t.length<7;)t.push(e++),e>6&&(e=0);return t},yearMonthStr:function(){return this.yearMonthFormatter?this.yearMonthFormatter(this.year,this.month):Zc(this.month)?this.year+" "+this.t("uiv.datePicker.month"+(this.month+1)):this.year},monthDayRows:function(){var t,e,i=[],n=new Date(this.year,this.month,1),r=new Date(this.year,this.month,0).getDate(),o=n.getDay(),s=(t=this.month,e=this.year,new Date(e,t+1,0).getDate()),a=0;a=this.weekStartsWith>o?7-this.weekStartsWith:0-this.weekStartsWith;for(var l=0;l<6;l++){i.push([]);for(var u=0-a;u<7-a;u++){var h=7*l+u,c={year:this.year,disabled:!1};h<o?(c.date=r-o+h+1,this.month>0?c.month=this.month-1:(c.month=11,c.year--)):h<o+s?(c.date=h-o+1,c.month=this.month):(c.date=h-o-s+1,this.month<11?c.month=this.month+1:(c.month=0,c.year++));var d=new Date(c.year,c.month,c.date),f=!0,p=!0;this.limit&&this.limit.from&&(f=d>=this.limit.from),this.limit&&this.limit.to&&(p=d<this.limit.to),c.disabled=!f||!p,Jc(this.dateClass)?c.classes=this.dateClass(d,{currentMonth:this.month,currentYear:this.year}):c.classes="",i[l].push(c)}}return i}},methods:{getWeekNumber:function(t){var e=new Date(Date.UTC(t.year,t.month,t.date));e.setUTCDate(e.getUTCDate()+4-(e.getUTCDay()||7));var i=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e-i)/864e5+1)/7)},tWeekName:function(t){return this.t("uiv.datePicker.week"+t)},getBtnType:function(t){return this.date&&t.date===this.date.getDate()&&t.month===this.date.getMonth()&&t.year===this.date.getFullYear()?"primary":t.date===this.today.getDate()&&t.month===this.today.getMonth()&&t.year===this.today.getFullYear()?"info":"default"},select:function(t){this.$emit("date-change",t)},goPrevMonth:function(){var t=this.month,e=this.year;this.month>0?t--:(t=11,e--,this.$emit("year-change",e)),this.$emit("month-change",t)},goNextMonth:function(){var t=this.month,e=this.year;this.month<11?t++:(t=0,e++,this.$emit("year-change",e)),this.$emit("month-change",t)},changeView:function(){this.$emit("view-change","m")}}},bd=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("table",{staticStyle:{width:"100%"},attrs:{role:"grid"}},[i("thead",[i("tr",[i("td",[i("btn",{staticClass:"uiv-datepicker-pager-prev",staticStyle:{border:"none"},attrs:{block:"",size:"sm"},on:{click:t.goPrevMonth}},[i("i",{class:t.iconControlLeft})])],1),t._v(" "),i("td",{attrs:{colspan:t.weekNumbers?6:5}},[i("btn",{staticClass:"uiv-datepicker-title",staticStyle:{border:"none"},attrs:{block:"",size:"sm"},on:{click:t.changeView}},[i("b",[t._v(t._s(t.yearMonthStr))])])],1),t._v(" "),i("td",[i("btn",{staticClass:"uiv-datepicker-pager-next",staticStyle:{border:"none"},attrs:{block:"",size:"sm"},on:{click:t.goNextMonth}},[i("i",{class:t.iconControlRight})])],1)]),t._v(" "),i("tr",{attrs:{align:"center"}},[t.weekNumbers?i("td"):t._e(),t._v(" "),t._l(t.weekDays,(function(e){return i("td",{attrs:{width:"14.2857142857%"}},[i("small",{staticClass:"uiv-datepicker-week"},[t._v(t._s(t.tWeekName(0===e?7:e)))])])}))],2)]),t._v(" "),i("tbody",t._l(t.monthDayRows,(function(e){return i("tr",[t.weekNumbers?i("td",{staticClass:"text-center",staticStyle:{"border-right":"1px solid #eee"}},[i("small",{staticClass:"text-muted"},[t._v(t._s(t.getWeekNumber(e[t.weekStartsWith])))])]):t._e(),t._v(" "),t._l(e,(function(e){return i("td",[i("btn",{class:e.classes,staticStyle:{border:"none"},attrs:{block:"",size:"sm","data-action":"select",type:t.getBtnType(e),disabled:e.disabled},on:{click:function(i){return t.select(e)}}},[i("span",{class:{"text-muted":t.month!==e.month},attrs:{"data-action":"select"}},[t._v(t._s(e.date))])])],1)}))],2)})),0)])};bd._withStripped=!0;var wd=yd({render:bd,staticRenderFns:[]},undefined,_d,undefined,false,undefined,!1,void 0,void 0,void 0),xd={components:{Btn:pd},mixins:[nd],props:{month:Number,year:Number,iconControlLeft:String,iconControlRight:String},data:function(){return{rows:[]}},mounted:function(){for(var t=0;t<4;t++){this.rows.push([]);for(var e=0;e<3;e++)this.rows[t].push(3*t+e+1)}},methods:{tCell:function(t){return this.t("uiv.datePicker.month"+t)},getBtnClass:function(t){return t===this.month?"primary":"default"},goPrevYear:function(){this.$emit("year-change",this.year-1)},goNextYear:function(){this.$emit("year-change",this.year+1)},changeView:function(t){Zc(t)?(this.$emit("month-change",t),this.$emit("view-change","d")):this.$emit("view-change","y")}}},Sd=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("table",{staticStyle:{width:"100%"},attrs:{role:"grid"}},[i("thead",[i("tr",[i("td",[i("btn",{staticClass:"uiv-datepicker-pager-prev",staticStyle:{border:"none"},attrs:{block:"",size:"sm"},on:{click:t.goPrevYear}},[i("i",{class:t.iconControlLeft})])],1),t._v(" "),i("td",{attrs:{colspan:"4"}},[i("btn",{staticClass:"uiv-datepicker-title",staticStyle:{border:"none"},attrs:{block:"",size:"sm"},on:{click:function(e){return t.changeView()}}},[i("b",[t._v(t._s(t.year))])])],1),t._v(" "),i("td",[i("btn",{staticClass:"uiv-datepicker-pager-next",staticStyle:{border:"none"},attrs:{block:"",size:"sm"},on:{click:t.goNextYear}},[i("i",{class:t.iconControlRight})])],1)])]),t._v(" "),i("tbody",t._l(t.rows,(function(e,n){return i("tr",t._l(e,(function(e,r){return i("td",{attrs:{colspan:"2",width:"33.333333%"}},[i("btn",{staticStyle:{border:"none"},attrs:{block:"",size:"sm",type:t.getBtnClass(3*n+r)},on:{click:function(e){return t.changeView(3*n+r)}}},[i("span",[t._v(t._s(t.tCell(e)))])])],1)})),0)})),0)])};Sd._withStripped=!0;var Cd=yd({render:Sd,staticRenderFns:[]},undefined,xd,undefined,false,undefined,!1,void 0,void 0,void 0),Td={components:{Btn:pd},props:{year:Number,iconControlLeft:String,iconControlRight:String},computed:{rows:function(){for(var t=[],e=this.year-this.year%20,i=0;i<4;i++){t.push([]);for(var n=0;n<5;n++)t[i].push(e+5*i+n)}return t},yearStr:function(){var t=this.year-this.year%20;return t+" ~ "+(t+19)}},methods:{getBtnClass:function(t){return t===this.year?"primary":"default"},goPrevYear:function(){this.$emit("year-change",this.year-20)},goNextYear:function(){this.$emit("year-change",this.year+20)},changeView:function(t){this.$emit("year-change",t),this.$emit("view-change","m")}}},Ed=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("table",{staticStyle:{width:"100%"},attrs:{role:"grid"}},[i("thead",[i("tr",[i("td",[i("btn",{staticClass:"uiv-datepicker-pager-prev",staticStyle:{border:"none"},attrs:{block:"",size:"sm"},on:{click:t.goPrevYear}},[i("i",{class:t.iconControlLeft})])],1),t._v(" "),i("td",{attrs:{colspan:"3"}},[i("btn",{staticClass:"uiv-datepicker-title",staticStyle:{border:"none"},attrs:{block:"",size:"sm"}},[i("b",[t._v(t._s(t.yearStr))])])],1),t._v(" "),i("td",[i("btn",{staticClass:"uiv-datepicker-pager-next",staticStyle:{border:"none"},attrs:{block:"",size:"sm"},on:{click:t.goNextYear}},[i("i",{class:t.iconControlRight})])],1)])]),t._v(" "),i("tbody",t._l(t.rows,(function(e){return i("tr",t._l(e,(function(e){return i("td",{attrs:{width:"20%"}},[i("btn",{staticStyle:{border:"none"},attrs:{block:"",size:"sm",type:t.getBtnClass(e)},on:{click:function(i){return t.changeView(e)}}},[i("span",[t._v(t._s(e))])])],1)})),0)})),0)])};Ed._withStripped=!0;var Id={mixins:[nd],components:{DateView:wd,MonthView:Cd,YearView:yd({render:Ed,staticRenderFns:[]},undefined,Td,undefined,false,undefined,!1,void 0,void 0,void 0),Btn:pd},props:{value:null,width:{type:Number,default:270},todayBtn:{type:Boolean,default:!0},clearBtn:{type:Boolean,default:!0},closeOnSelected:{type:Boolean,default:!0},limitFrom:null,limitTo:null,format:{type:String,default:"yyyy-MM-dd"},initialView:{type:String,default:"d"},dateParser:{type:Function,default:Date.parse},dateClass:Function,yearMonthFormatter:Function,weekStartsWith:{type:Number,default:0,validator:function(t){return t>=0&&t<=6}},weekNumbers:Boolean,iconControlLeft:{type:String,default:"glyphicon glyphicon-chevron-left"},iconControlRight:{type:String,default:"glyphicon glyphicon-chevron-right"}},data:function(){return{show:!1,now:new Date,currentMonth:0,currentYear:0,view:"d"}},computed:{valueDateObj:function(){var t=this.dateParser(this.value);if(isNaN(t))return null;var e=new Date(t);return 0!==e.getHours()&&(e=new Date(t+60*e.getTimezoneOffset()*1e3)),e},pickerStyle:function(){return{width:this.width+"px"}},pickerClass:function(){return{"uiv-datepicker":!0,"uiv-datepicker-date":"d"===this.view,"uiv-datepicker-month":"m"===this.view,"uiv-datepicker-year":"y"===this.view}},limit:function(){var t={};if(this.limitFrom){var e=this.dateParser(this.limitFrom);isNaN(e)||((e=vd(new Date(e))).setHours(0,0,0,0),t.from=e)}if(this.limitTo){var i=this.dateParser(this.limitTo);isNaN(i)||((i=vd(new Date(i))).setHours(0,0,0,0),t.to=i)}return t}},mounted:function(){this.value?this.setMonthAndYearByValue(this.value):(this.currentMonth=this.now.getMonth(),this.currentYear=this.now.getFullYear(),this.view=this.initialView)},watch:{value:function(t,e){this.setMonthAndYearByValue(t,e)}},methods:{setMonthAndYearByValue:function(t,e){var i=this.dateParser(t);if(!isNaN(i)){var n=new Date(i);0!==n.getHours()&&(n=new Date(i+60*n.getTimezoneOffset()*1e3)),this.limit&&(this.limit.from&&n<this.limit.from||this.limit.to&&n>=this.limit.to)?this.$emit("input",e||""):(this.currentMonth=n.getMonth(),this.currentYear=n.getFullYear())}},onMonthChange:function(t){this.currentMonth=t},onYearChange:function(t){this.currentYear=t,this.currentMonth=void 0},onDateChange:function(t){if(t&&Qc(t.date)&&Qc(t.month)&&Qc(t.year)){var e=new Date(t.year,t.month,t.date);this.$emit("input",this.format?function(t,e){try{var i=t.getFullYear(),n=t.getMonth()+1,r=t.getDate(),o=md[n-1];return e.replace(/yyyy/g,i).replace(/MMMM/g,o).replace(/MMM/g,o.substring(0,3)).replace(/MM/g,gd(n,2)).replace(/dd/g,gd(r,2)).replace(/yy/g,i).replace(/M(?!a)/g,n).replace(/d/g,r)}catch(t){return""}}(e,this.format):e),this.currentMonth=t.month,this.currentYear=t.year}else this.$emit("input","")},onViewChange:function(t){this.view=t},selectToday:function(){this.view="d",this.onDateChange({date:this.now.getDate(),month:this.now.getMonth(),year:this.now.getFullYear()})},clearSelect:function(){this.currentMonth=this.now.getMonth(),this.currentYear=this.now.getFullYear(),this.view=this.initialView,this.onDateChange()},onPickerClick:function(t){"select"===t.target.getAttribute("data-action")&&this.closeOnSelected||t.stopPropagation()}}},Ad=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.pickerClass,style:t.pickerStyle,attrs:{"data-role":"date-picker"},on:{click:t.onPickerClick}},[i("date-view",{directives:[{name:"show",rawName:"v-show",value:"d"===t.view,expression:"view==='d'"}],attrs:{month:t.currentMonth,year:t.currentYear,date:t.valueDateObj,today:t.now,limit:t.limit,"week-starts-with":t.weekStartsWith,"icon-control-left":t.iconControlLeft,"icon-control-right":t.iconControlRight,"date-class":t.dateClass,"year-month-formatter":t.yearMonthFormatter,"week-numbers":t.weekNumbers,locale:t.locale},on:{"month-change":t.onMonthChange,"year-change":t.onYearChange,"date-change":t.onDateChange,"view-change":t.onViewChange}}),t._v(" "),i("month-view",{directives:[{name:"show",rawName:"v-show",value:"m"===t.view,expression:"view==='m'"}],attrs:{month:t.currentMonth,year:t.currentYear,"icon-control-left":t.iconControlLeft,"icon-control-right":t.iconControlRight,locale:t.locale},on:{"month-change":t.onMonthChange,"year-change":t.onYearChange,"view-change":t.onViewChange}}),t._v(" "),i("year-view",{directives:[{name:"show",rawName:"v-show",value:"y"===t.view,expression:"view==='y'"}],attrs:{year:t.currentYear,"icon-control-left":t.iconControlLeft,"icon-control-right":t.iconControlRight},on:{"year-change":t.onYearChange,"view-change":t.onViewChange}}),t._v(" "),t.todayBtn||t.clearBtn?i("div",[i("br"),t._v(" "),i("div",{staticClass:"text-center"},[t.todayBtn?i("btn",{attrs:{"data-action":"select",type:"info",size:"sm"},domProps:{textContent:t._s(t.t("uiv.datePicker.today"))},on:{click:t.selectToday}}):t._e(),t._v(" "),t.clearBtn?i("btn",{attrs:{"data-action":"select",size:"sm"},domProps:{textContent:t._s(t.t("uiv.datePicker.clear"))},on:{click:t.clearSelect}}):t._e()],1)]):t._e()],1)};Ad._withStripped=!0;const Pd=Tl({props:{placeholder:{type:String,default:""},value:{type:String,default:""}},components:{dropdown:Zh,datePicker:yd({render:Ad,staticRenderFns:[]},undefined,Id,undefined,false,undefined,!1,void 0,void 0,void 0)},data:function(){return{internalValue:""}},watch:{internalValue:function(t){this.$emit("input",t)},value:function(t){this.internalValue=t}},created:function(){this.internalValue=this.value}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("dropdown",[i("div",{staticClass:"input-group"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.internalValue,expression:"internalValue"}],staticClass:"form-control",attrs:{type:"text",placeholder:t.placeholder},domProps:{value:t.internalValue},on:{input:function(e){e.target.composing||(t.internalValue=e.target.value)}}}),t._v(" "),i("div",{staticClass:"input-group-btn"},[i("button",{staticClass:"btn btn-default dropdown-toggle",attrs:{type:"button"}},[i("i",{staticClass:"fa fa-calendar"})])])]),t._v(" "),i("template",{slot:"dropdown"},[i("li",[i("date-picker",{attrs:{"icon-control-left":"fa fa-chevron-left","icon-control-right":"fa fa-chevron-right"},model:{value:t.internalValue,callback:function(e){t.internalValue=e},expression:"internalValue"}})],1)])],2)}),[],!1,null,null,null).exports;const kd=Tl({mixins:[cu,hu],data:function(){return{volumeId:null,sessions:null,editedSession:{name:null,description:null,starts_at_iso8601:null,starts_at:null,ends_at_iso8601:null,ends_at:null,hide_other_users_annotations:!1,hide_own_annotations:!1,users:[]},users:[],errors:{}}},components:{typeahead:Ql,listItem:Kc,userTag:Yc,datepickerDropdown:Pd},computed:{classObject:function(){return{"panel-warning panel--editing":this.editing}},hasSessions:function(){return this.sessions.length>0},hasNewSession:function(){return void 0===this.editedSession.id},availableUsers:function(){var t=this.editedSession.users.map((function(t){return t.id}));return this.users.filter((function(e){return-1===t.indexOf(e.id)}))},orderedSessions:function(){return this.sessions.slice().sort((function(t,e){return e.starts_at_iso8601.getTime()-t.starts_at_iso8601.getTime()}))}},methods:{clone:function(t){return JSON.parse(JSON.stringify(t))},submit:function(t){var e=this;if(!this.loading){this.startLoading();var i=this.editedSession;if(this.hasNewSession)Xc.save({volume_id:this.volumeId},this.packSession(i)).then(this.sessionSaved).catch(this.handleErrorResponse).finally(this.finishLoading);else{var n={id:i.id};!0===t&&(n.force=1),Xc.update(n,this.packSession(i)).then((function(){return e.sessionUpdated(i)})).catch(this.handleConfirm("Use the Force and update the annotation session?",this.submit)).finally(this.finishLoading)}}},sessionUpdated:function(t){for(var e=this.sessions.length-1;e>=0;e--)this.sessions[e].id===t.id&&(this.sessions.splice(e,1,t),this.clearEditedSession())},sessionSaved:function(t){this.sessions.push(this.parseSession(t.data)),this.clearEditedSession()},packSession:function(t){return(t=this.clone(t)).users=t.users.map((function(t){return t.id})),t.starts_at=t.starts_at_iso8601,t.ends_at=t.ends_at_iso8601,delete t.starts_at_iso8601,delete t.ends_at_iso8601,t},handleConfirm:function(t,e){var i=this;return function(n){400===n.status?(i.finishLoading(),confirm(n.data.message+" "+t)&&e(!0)):i.handleErrorResponse(n)}},handleErrorResponse:function(t){422===t.status?this.errors=t.data.errors:lu(t)},hasError:function(t){return this.errors.hasOwnProperty(t)},getError:function(t){return this.errors[t].join(" ")},editSession:function(t){this.editedSession=this.clone(t)},deleteSession:function(t){var e=this;if(!this.loading&&!this.hasNewSession&&(!0===t||confirm("Are you sure you want to delete the annotation session '".concat(this.editedSession.name,"'?")))){this.startLoading();var i=this.editedSession.id,n={id:i};!0===t&&(n.force=1),Xc.delete(n).then((function(){return e.sessionDeleted(i)})).catch(this.handleConfirm("Use the Force and delete the annotation session?",this.deleteSession)).finally(this.finishLoading)}},sessionDeleted:function(t){for(var e=this.sessions.length-1;e>=0;e--)if(this.sessions[e].id===t)return this.sessions.splice(e,1),void this.clearEditedSession()},clearEditedSession:function(){this.editedSession={name:null,description:null,starts_at_iso8601:null,starts_at:null,ends_at_iso8601:null,ends_at:null,hide_other_users_annotations:!1,hide_own_annotations:!1,users:[]}},loadUsers:function(){Bc.queryUsers({id:this.volumeId}).then(this.usersLoaded,lu)},usersLoaded:function(t){t.data.forEach((function(t){t.name=t.firstname+" "+t.lastname})),Vue.set(this,"users",t.data)},selectUser:function(t){this.editedSession.users.push(t)},removeUser:function(t){for(var e=this.editedSession.users.length-1;e>=0;e--)this.editedSession.users[e].id===t.id&&this.editedSession.users.splice(e,1)},stringifyDate:function(t){var e=t.getMonth()+1;return e=e<10?"0"+e:e,t.getFullYear()+"-"+e+"-"+t.getDate()},parseDate:function(t){if(t)return t=t.split("-"),new Date(t[0],t[1]-1,t[2])},parseSession:function(t){var e=new Date(t.starts_at_iso8601);return t.starts_at_iso8601=e,t.starts_at=this.stringifyDate(e),e=new Date(t.ends_at_iso8601),t.ends_at_iso8601=e,t.ends_at=this.stringifyDate(e),t}},watch:{editedSession:function(){this.errors={}},loading:function(t){t&&(this.errors={})},"editedSession.starts_at":function(t){this.editedSession.starts_at_iso8601=this.parseDate(t)},"editedSession.ends_at":function(t){this.editedSession.ends_at_iso8601=this.parseDate(t)}},created:function(){this.volumeId=biigle.$require("volumes.id"),this.sessions=biigle.$require("volumes.annotationSessions").map(this.parseSession),this.$once("editing.start",this.loadUsers)}},undefined,undefined,!1,null,null,null).exports,Rd=Vue.resource("api/v1/volumes/browser/directories{/disk}",{},{getImages:{method:"GET",url:"api/v1/volumes/browser/images{/disk}"},getVideos:{method:"GET",url:"api/v1/volumes/browser/videos{/disk}"}});const Ld=Tl({mixins:[cu],data:function(){return{disks:[],url:null,mediaType:"",filenames:null,browsing:!1,storageDisk:null,breadCrumbs:[],currentDirectories:[],loadingBrowser:!1,directoryCache:{},fileCache:{}}},computed:{showFilenameWarning:function(){return this.filenames.includes(".tif")},hasDirectories:function(){return this.currentDirectories.length>0},buttonClass:function(){return{"btn-info":this.browsing}},canGoBack:function(){return this.breadCrumbs.length>0||this.disks.length>1},hasCurrentDirectory:function(){return this.breadCrumbs.length>0},currentDirectory:function(){return this.hasCurrentDirectory?this.breadCrumbs[this.breadCrumbs.length-1]:null},isImageMediaType:function(){return"image"===this.mediaType},isVideoMediaType:function(){return"video"===this.mediaType},isRemoteImageVolume:function(){return this.isImageMediaType&&-1!==this.url.search(/^https?:\/\//)}},methods:{toggleBrowse:function(){this.browsing=!this.browsing},fetchDirectories:function(t,e){var i=this,n=t+"://"+e;if(!this.directoryCache.hasOwnProperty(n)){this.loadingBrowser=!0;var r=Rd.get({disk:t,path:e});r.finally((function(){return i.loadingBrowser=!1})),this.directoryCache[n]=r}return this.directoryCache[n]},showDirectories:function(t){this.currentDirectories=t.body},openDirectory:function(t){this.breadCrumbs.push(t)},goBack:function(){this.breadCrumbs.length>0?this.breadCrumbs.pop():this.disks.length>1&&(this.storageDisk=null)},goTo:function(t){t>=-1&&t<this.breadCrumbs.length&&(this.breadCrumbs=this.breadCrumbs.slice(0,t+1))},fetchFiles:function(t,e){var i=this,n=t+"://"+e;if(!this.fileCache.hasOwnProperty(n)){this.loadingBrowser=!0;var r=Rd.getImages({disk:t,path:e});r.finally((function(){return i.loadingBrowser=!1})),this.fileCache[n]=r}return this.fileCache[n]},setFiles:function(t){this.filenames=t.body.join(", ")},selectDirectory:function(t){var e=this,i=this.breadCrumbs.slice();t&&i.push(t),this.fetchFiles(this.storageDisk,i.join("/")).then(this.setFiles).then((function(){return e.url=e.storageDisk+"://"+i.join("/")})).catch(lu)},selectImageMediaType:function(){this.mediaType="image"},selectVideoMediaType:function(){this.mediaType="video"}},watch:{storageDisk:function(t){t&&this.fetchDirectories(t,"").then(this.showDirectories,lu)},breadCrumbs:function(t){this.fetchDirectories(this.storageDisk,t.join("/")).then(this.showDirectories).catch((function(e){t.pop(),lu(e)}))}},created:function(){this.disks=biigle.$require("volumes.disks"),this.url=biigle.$require("volumes.url"),this.mediaType=biigle.$require("volumes.mediaType"),this.filenames=biigle.$require("volumes.filenames"),1===this.disks.length&&(this.storageDisk=this.disks[0])},mounted:function(){this.$refs.nameInput.focus()}},undefined,undefined,!1,null,null,null).exports;const Fd=Tl(new Vue({data:{count:0}}),undefined,undefined,!1,null,null,null).exports;const Md=Tl({data:function(){return{fileIds:[]}},computed:{count:function(){return Fd.count},text:function(){return this.count===this.fileIds.length?this.count:this.count+" of "+this.fileIds.length}},created:function(){this.fileIds=biigle.$require("volumes.fileIds")}},undefined,undefined,!1,null,null,null).exports;const Od=Tl({props:["file","type"],computed:{classObject:function(){return{"list-group-item-success":this.file.isNew}},title:function(){return"Delete ".concat(this.type," #").concat(this.file.id)}},methods:{remove:function(){this.$emit("remove",this.file)}}},undefined,undefined,!1,null,null,null).exports,$d=Vue.resource("api/v1/videos{/id}",{},{save:{method:"POST",url:"api/v1/projects{/id}/videos"}});const Dd=Tl({mixins:[cu,hu],data:function(){return{volumeId:null,filenames:"",files:[],errors:{},type:""}},components:{fileItem:Od},computed:{classObject:function(){return{"panel-warning panel--editing":this.editing}},orderedFiles:function(){return this.files.slice().sort((function(t,e){return t.filename<e.filename?-1:1}))},hasNoFiles:function(){return!this.loading&&0===this.files.length},fileApi:function(){return"image"===this.type?ml:$d}},methods:{submit:function(){this.loading||(this.startLoading(),Bc.saveFiles({id:this.volumeId},{files:this.filenames}).then(this.filesSaved).catch(this.handleErrorResponse).finally(this.finishLoading))},filesSaved:function(t){for(var e=t.data.length-1;e>=0;e--)t.data[e].isNew=!0,this.files.push(t.data[e]);this.filenames=""},handleRemove:function(t){var e=this;!this.loading&&confirm("Are you sure that you want to delete the ".concat(this.type," #").concat(t.id," (").concat(t.filename,")?"))&&(this.startLoading(),this.fileApi.delete({id:t.id}).then((function(){return e.fileRemoved(t.id)})).catch((function(i){if(422!==i.status)throw i;if(confirm("The ".concat(e.type," contains annotations. Proceed to delete the ").concat(e.type,"?")))return e.fileApi.delete({id:t.id},{force:!0}).then((function(){return e.fileRemoved(t.id)}))})).catch(lu).finally(this.finishLoading))},fileRemoved:function(t){for(var e=this.files,i=e.length-1;i>=0;i--)if(e[i].id===t)return void e.splice(i,1)},handleErrorResponse:function(t){422===t.status?this.errors=t.data.errors:lu(t)},hasError:function(t){return this.errors.hasOwnProperty(t)},getError:function(t){return this.errors[t].join("\n")},setFiles:function(t){for(var e in t.body)t.body.hasOwnProperty(e),this.files.push({id:e,filename:t.body[e]})}},watch:{loading:function(t){t&&(this.errors={})}},created:function(){this.volumeId=biigle.$require("volumes.id"),this.type=biigle.$require("volumes.type"),this.startLoading(),Bc.queryFilenames({id:this.volumeId}).then(this.setFiles,lu).finally(this.finishLoading)}},undefined,undefined,!1,null,null,null).exports,jd=Vue.resource("api/v1/volumes{/id}/images/metadata");const Nd=Tl({mixins:[cu],data:function(){return{volumeId:null,csv:void 0,error:!1,success:!1,message:void 0}},methods:{handleSuccess:function(){this.error=!1,this.success=!0},handleError:function(t){this.success=!1,t.data.file?Array.isArray(t.data.file)?this.error=t.data.file[0]:this.error=t.data.file:lu(t)},submit:function(){if(this.csv){this.startLoading();var t=new FormData;t.append("file",this.csv),jd.save({id:this.volumeId},t).bind(this).then(this.handleSuccess,this.handleError).finally(this.finishLoading)}},setCsv:function(t){this.csv=t.target.files[0]}},created:function(){this.volumeId=biigle.$require("volumes.id")}},undefined,undefined,!1,null,null,null).exports;const Bd=Tl(new Vue({components:{dropdown:Zh}}),undefined,undefined,!1,null,null,null).exports;const Ud=Tl({components:{previewThumbnail:Ec}},undefined,undefined,!1,null,null,null).exports;function zd(t){return(zd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}const Vd=Tl({mixins:[cu],components:{powerToggle:Pl},props:{volumeId:{type:Number,required:!0},type:{type:String,required:!0},fileIds:{type:Array,required:!0},showFilenames:{type:Boolean,default:!1},loadingFilenames:{type:Boolean,default:!1}},data:function(){return{rules:[],selectedFilterId:null,negate:!1,mode:"filter",operator:"and"}},computed:{filters:function(){var t=this;return Uc.filter((function(e){return e.types&&e.types.includes(t.type)}))},selectedFilter:function(){return this.getFilter(this.selectedFilterId)},hasSelectComponent:function(){return this.selectedFilter&&this.selectedFilter.selectComponent},selectComponent:function(){return this.selectedFilter.selectComponent},hasRules:function(){return this.rules.length>0},sequence:function(){if(!this.hasRules)return this.fileIds;var t={},e={},i=0,n=0;return this.rules.forEach((function(r){r.negate?(i++,r.sequence.forEach((function(t){e[t]=e[t]+1||1}))):(n++,r.sequence.forEach((function(e){t[e]=t[e]+1||1})))})),"and"===this.operator?n>0?this.fileIds.filter((function(i){return t[i]===n&&!e.hasOwnProperty(i)})):this.fileIds.filter((function(t){return!e.hasOwnProperty(t)})):i>0?this.fileIds.filter((function(n){return t.hasOwnProperty(n)||e[n]!==i})):this.fileIds.filter((function(e){return t.hasOwnProperty(e)}))},inFilterMode:function(){return"filter"===this.mode},inFlagMode:function(){return"flag"===this.mode},usesAndOperator:function(){return"and"===this.operator},usesOrOperator:function(){return"or"===this.operator},helpText:function(){return this.selectedFilter?this.selectedFilter.help.replace(":type",this.type):null},rulesStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".filter2.rules")},modeStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".filter2.mode")},operatorStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".filter2.operator")},typeText:function(){return su(this.type)+"s"}},methods:{filterValid:function(t){return"string"==typeof t.id&&"string"==typeof t.label&&"object"===zd(t.listComponent)&&"function"==typeof t.getSequence},getFilter:function(t){for(var e=this.filters.length-1;e>=0;e--)if(this.filters[e].id===t)return this.filters[e];return null},hasRule:function(t){return-1!==this.rules.findIndex((function(e){return e.id===t.id&&e.negate===t.negate&&e.data===t.data}))},addRule:function(t){var e=this;if(this.selectedFilter){var i={id:this.selectedFilter.id,data:t,negate:this.negate};this.hasRule(i)||(this.startLoading(),this.selectedFilter.getSequence(this.volumeId,t).catch(lu).then((function(t){return e.ruleAdded(i,t)})).finally(this.finishLoading))}},refreshRule:function(t){var e=this.getFilter(t.id);e&&(this.startLoading(),e.getSequence(this.volumeId,t.data).catch(lu).then((function(e){return t.sequence=e.data})).finally(this.finishLoading))},ruleAdded:function(t,e){t.sequence=e.data,this.rules.push(t)},removeRule:function(t){this.rules.splice(t,1)},reset:function(){this.rules=[],this.selectedFilterId=null,this.negate=!1,this.mode="filter",this.operator="and"},activateFilterMode:function(){this.mode="filter"},activateFlagMode:function(){this.mode="flag"},activateAndOperator:function(){this.operator="and"},activateOrOperator:function(){this.operator="or"},emitUpdate:function(){this.$emit("update",this.sequence,this.mode,this.hasRules)},getListComponent:function(t){for(var e=this.filters.length-1;e>=0;e--)if(this.filters[e].id===t.id)return this.filters[e].listComponent},enableFilenames:function(){this.$emit("enable-filenames")},disableFilenames:function(){this.$emit("disable-filenames")}},watch:{sequence:function(){this.emitUpdate()},mode:function(){this.emitUpdate(),"filter"!==this.mode?localStorage.setItem(this.modeStorageKey,this.mode):localStorage.removeItem(this.modeStorageKey)},operator:function(){this.emitUpdate(),"and"!==this.operator?localStorage.setItem(this.operatorStorageKey,this.operator):localStorage.removeItem(this.operatorStorageKey)},rules:{handler:function(){this.rules.length>0?localStorage.setItem(this.rulesStorageKey,JSON.stringify(this.rules)):localStorage.removeItem(this.rulesStorageKey)},deep:!0}},created:function(){for(var t,e=0;e<this.filters.length;e++)t=this.filters[e],this.filterValid(t)||(console.error("Filter ".concat(t.id," invalid. Ignoring...")),this.filters.splice(e,1));var i=JSON.parse(localStorage.getItem(this.rulesStorageKey));i&&(this.rules=i);var n=localStorage.getItem(this.modeStorageKey);n&&(this.mode=n);var r=localStorage.getItem(this.operatorStorageKey);r&&(this.operator=r)}},undefined,undefined,!1,null,null,null).exports;const Gd=Vue.resource("api/v1/image-labels{/id}",{},{query:{method:"GET",url:"api/v1/images{/image_id}/labels"},save:{method:"POST",url:"api/v1/images{/image_id}/labels"}}),qd=Vue.resource("api/v1/video-labels{/id}",{},{query:{method:"GET",url:"api/v1/videos{/video_id}/labels"},save:{method:"POST",url:"api/v1/videos{/video_id}/labels"}});var Wd=Tl({props:{item:{type:Object,required:!0},deletable:{type:Boolean,default:!1},type:{type:String,default:"image"}},data:function(){return{deleting:!1}},computed:{label:function(){return this.item.label},colorStyle:function(){return{"background-color":"#"+this.label.color}},deleteTitle:function(){return"Detach label "+this.label.name},title:function(){return"Attached by ".concat(this.item.user.firstname," ").concat(this.item.user.lastname)},classObject:function(){return{"image-label--deleting":this.deleting}},labelsApi:function(){return"image"===this.type?Gd:qd}},methods:{deleteThis:function(){var t=this;this.deleting||(this.deleting=!0,this.labelsApi.delete({id:this.item.id}).then(this.deleted,lu).finally((function(){return t.deleting=!1})))},deleted:function(){this.$emit("deleted",this.item)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"file-label",class:t.classObject},[i("span",{staticClass:"file-label__color",style:t.colorStyle}),t._v(" "),i("span",{attrs:{title:t.title},domProps:{textContent:t._s(t.label.name)}}),t._v(" "),!t.deleting&&t.deletable?i("button",{staticClass:"close file-label__delete",attrs:{title:t.deleteTitle},on:{click:function(e){return e.stopPropagation(),t.deleteThis(e)}}},[i("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])]):t._e()])}),[],!1,null,null,null);const Kd=Tl({components:{listItem:Wd.exports},props:{fileLabels:{type:Array,required:!0},userId:{type:Number,required:!0},isAdmin:{type:Boolean,default:!1},type:{type:String,default:"image"}},computed:{hasImageLabels:function(){return this.fileLabels.length>0}},methods:{canDelete:function(t){return!0===this.isAdmin||this.userId===t.user.id},emitDeleted:function(t){this.$emit("deleted",t)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"file-label-list"},[t._l(t.fileLabels,(function(e){return i("list-item",{key:e.id,attrs:{item:e,deletable:t.canDelete(e),type:t.type},on:{deleted:t.emitDeleted}})})),t._v(" "),t.hasImageLabels?t._e():i("li",{staticClass:"text-muted"},[t._v("No "+t._s(t.type)+" labels")])],2)}),[],!1,null,null,null).exports;var Xd=Tl({mixins:[zc,cu],components:{fileLabelList:Kd,previewThumbnail:Ec},data:function(){return{userId:null,isAdmin:!1,attachingSuccess:null,timeout:null,saving:!1,showAnnotationRoute:null}},props:{selectedLabel:{type:Object,default:null},showFilename:{type:Boolean,default:!1},showLabels:{type:Boolean,default:!1},type:{type:String,default:"image"}},computed:{alreadyHasSelectedLabel:function(){var t=this.selectedLabel;return this.image.labels.reduce((function(e,i){return e||t.id===i.label_id}),!1)},showAnnotationLink:function(){return this.showAnnotationRoute?this.showAnnotationRoute+this.image.id:""},selected:function(){return this.image.flagged},canBeSelected:function(){return this.selectable&&this.selectedLabel&&!this.alreadyHasSelectedLabel&&!this.saving},classObject:function(){return{"image-grid__image--selected":this.selected,"image-grid__image--selectable":this.canBeSelected,"image-grid__image--saving":this.selectable&&this.saving,"image-grid__image--success":!0===this.attachingSuccess,"image-grid__image--error":!1===this.attachingSuccess}},title:function(){return this.canBeSelected?"Attach "+this.selectedLabel.name:""},linkTitle:function(){return"Annotate this ".concat(this.type)}},methods:{handleClick:function(){var t=this;this.canBeSelected&&(this.saving=!0,("image"===this.type?Gd.save({image_id:this.image.id},{label_id:this.selectedLabel.id}):qd.save({video_id:this.image.id},{label_id:this.selectedLabel.id})).then(this.labelAttached,this.attachingFailed).finally(this.resetSuccess).finally((function(){return t.saving=!1})))},labelAttached:function(t){this.attachingSuccess=!0,this.image.labels.push(t.data)},attachingFailed:function(t){this.attachingSuccess=!1,lu(t)},resetSuccess:function(){var t=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){return t.attachingSuccess=null}),3e3)},removeImageLabel:function(t){var e=this.image.labels.indexOf(t);-1!==e&&this.image.labels.splice(e,1)}},created:function(){this.userId=biigle.$require("volumes.userId"),this.isAdmin=biigle.$require("volumes.isAdmin"),this.showAnnotationRoute=biigle.$require("largo.showAnnotationRoute")}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"image-grid__image image-grid__image--volume",class:t.classObject,attrs:{title:t.title}},[!t.selectable&&t.image.annotateUrl?i("a",{staticClass:"image-link",attrs:{href:t.image.annotateUrl,title:t.linkTitle}},[i("preview-thumbnail",{attrs:{id:t.image.id,"thumb-uris":t.image.thumbnailUrl}},[i("img",{attrs:{src:t.srcUrl},on:{error:t.showEmptyImage}})])],1):i("preview-thumbnail",{attrs:{id:t.image.id,"thumb-uris":t.image.thumbnailUrl},on:{click:t.handleClick}},[i("img",{attrs:{src:t.srcUrl},on:{error:t.showEmptyImage}})]),t._v(" "),t.showFilename?i("span",{staticClass:"image-filename",attrs:{title:t.image.filename},domProps:{textContent:t._s(t.image.filename)}}):t._e(),t._v(" "),i("div",{staticClass:"image-buttons"},[t.image.infoUrl?i("a",{staticClass:"image-button",attrs:{href:t.image.infoUrl,title:"View image information"}},[i("span",{staticClass:"fa fa-info-circle",attrs:{"aria-hidden":"true"}})]):t._e()]),t._v(" "),t.showLabels?i("div",{staticClass:"image-labels",on:{wheel:function(t){t.stopPropagation()}}},[i("file-label-list",{attrs:{"file-labels":t.image.labels,"user-id":t.userId,"is-admin":t.isAdmin,type:t.type},on:{deleted:t.removeImageLabel}})],1):t._e()],1)}),[],!1,null,null,null);const Yd=Tl({mixins:[Gc],components:{imageGridImage:Xd.exports},props:{selectedLabel:{type:Object,default:null},showFilenames:{type:Boolean,default:!1},showLabels:{type:Boolean,default:!1},type:{type:String,default:"image"}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"image-grid",on:{wheel:function(e){return e.preventDefault(),t.scroll(e)}}},[i("div",{ref:"images",staticClass:"image-grid__images"},t._l(t.displayedImages,(function(e){return i("image-grid-image",{key:e.id,attrs:{image:e,"empty-url":t.emptyUrl,"selected-label":t.selectedLabel,selectable:t.selectable,"selected-fade":!1,"show-filename":t.showFilenames,"show-labels":t.showLabels,type:t.type},on:{select:t.emitSelect}})})),1),t._v(" "),t.canScroll?i("image-grid-progress",{attrs:{progress:t.progress},on:{top:t.jumpToStart,"prev-page":t.reversePage,"prev-row":t.reverseRow,jump:t.jumpToPercent,"next-row":t.advanceRow,"next-page":t.advancePage,bottom:t.jumpToEnd}}):t._e()],1)}),[],!1,null,null,null).exports;const Hd=Tl({mixins:[cu],components:{labelTrees:ec,powerToggle:Pl},props:{volumeId:{type:Number,required:!0},showLabels:{type:Boolean,default:!1},loadingLabels:{type:Boolean,default:!1}},data:function(){return{labelTrees:[]}},methods:{handleSelectedLabel:function(t){this.$emit("select",t)},handleDeselectedLabel:function(t){this.$emit("deselect",t)},enableLabels:function(){this.$emit("enable-labels")},disableLabels:function(){this.$emit("disable-labels")}},created:function(){this.labelTrees=biigle.$require("volumes.labelTrees")}},undefined,undefined,!1,null,null,null).exports;const Zd=Tl({mixins:[cu],props:{volumeId:{type:Number,required:!0},type:{type:String,required:!0},fileIds:{type:Array,required:!0}},data:function(){return{direction:!0,activeSorter:null,privateSequence:[]}},computed:{sorters:function(){var t=this;return Wc.filter((function(e){return e.types&&e.types.includes(t.type)}))},defaultSorter:function(){return this.sorters[0]},isActive:function(){return this.activeSorter!==this.defaultSorter.id||!this.direction},isSortedAscending:function(){return this.direction},isSortedDescending:function(){return!this.direction},sorterStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".sorting2.sorter")},directionStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".sorting2.direction")},sequence:function(){return this.direction?this.privateSequence:this.privateSequence.slice().reverse()}},methods:{reset:function(){this.direction=!0,this.activeSorter=this.defaultSorter.id,this.privateSequence=biigle.$require("volumes.fileIds")},sortAscending:function(){this.direction=!0},sortDescending:function(){this.direction=!1},handleSelect:function(t){var e=this;this.loading||(this.startLoading(),t.getSequence().then((function(i){e.activeSorter=t.id,e.privateSequence=i})).catch(lu).finally(this.finishLoading))},isValidSequence:function(t){for(var e={},i=this.fileIds,n=t.length-1;n>=0;n--)e[t[n]]=!0;for(var r=i.length-1;r>=0;r--)if(!e.hasOwnProperty(i[r]))return!1;return!0}},watch:{sequence:function(){this.$emit("update",this.sequence,this.isActive)},privateSequence:function(){this.activeSorter===this.defaultSorter.id?localStorage.removeItem(this.sorterStorageKey):localStorage.setItem(this.sorterStorageKey,JSON.stringify({id:this.activeSorter,sequence:this.privateSequence}))},direction:function(){this.direction?localStorage.removeItem(this.directionStorageKey):localStorage.setItem(this.directionStorageKey,this.direction)}},created:function(){this.privateSequence=biigle.$require("volumes.fileIds");var t=JSON.parse(localStorage.getItem(this.sorterStorageKey));t&&this.isValidSequence(t.sequence)?(this.activeSorter=t.id,this.privateSequence=t.sequence):(this.activeSorter=this.defaultSorter.id,localStorage.removeItem(this.sorterStorageKey));var e=JSON.parse(localStorage.getItem(this.directionStorageKey));null!==e&&(this.direction=e)}},undefined,undefined,!1,null,null,null).exports;var Jd=function(t){return t[0]+t[1]+"/"+t[2]+t[3]+"/"+t};const Qd=Tl({mixins:[cu],components:{sidebar:Fl,sidebarTab:Ml,imageGrid:Yd,filterTab:Vd,sortingTab:Zd,labelsTab:Hd},data:function(){return{fileIds:[],files:[],filterSequence:[],filterMode:null,filterActive:!1,sortingSequence:[],sortingActive:!1,volumeId:null,imageLabelMode:!1,selectedLabel:null,loadingFilenames:!1,showFilenames:!1,filenamesPromise:null,loadingLabels:!1,showLabels:!1,labelsPromise:null,settings:null,type:null}},computed:{sortingMap:function(){var t={};return this.sortingSequence.forEach((function(e,i){t[e]=i})),t},sortedFiles:function(){var t=this.sortingMap,e=[];return this.files.forEach((function(i){e[t[i.id]]=i})),e},filterMap:function(){var t={};return this.filterSequence.forEach((function(e){t[e]=null})),t},filesToShow:function(){var t=this.filterMap;return"flag"===this.filterMode?this.sortedFiles.map((function(e){return e.flagged=t.hasOwnProperty(e.id),e})):this.sortedFiles.filter((function(e){return e.flagged=!1,t.hasOwnProperty(e.id)}))},fileIdsToShow:function(){return this.filesToShow.map((function(t){return t.id}))},filesStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".files")},offsetStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".offset")},initialOffset:function(){return parseInt(iu.get("offset"))||parseInt(localStorage.getItem(this.offsetStorageKey))||0},filterEmpty:function(){return this.filterActive&&"flag"!==this.filterMode&&0===this.filterSequence.length},noContent:function(){return!this.loading&&0===this.files.length}},methods:{handleSidebarToggle:function(){var t=this;this.$nextTick((function(){return t.$refs.imageGrid.$emit("resize")}))},handleSidebarOpen:function(t){this.imageLabelMode="labels"===t},handleSidebarClose:function(){this.imageLabelMode=!1},toggleLoading:function(t){t?this.startLoading():this.finishLoading()},updateFilterSequence:function(t,e,i){this.filterSequence=t,this.filterMode=e,this.filterActive=i},handleScroll:function(t){t>0?(iu.set({offset:t}),localStorage.setItem(this.offsetStorageKey,t)):(iu.unset("offset"),localStorage.removeItem(this.offsetStorageKey))},handleSelectedLabel:function(t){this.selectedLabel=t},handleDeselectedLabel:function(){this.selectedLabel=null},updateSortingSequence:function(t,e){this.sortingSequence=t,this.sortingActive=e},enableFilenames:function(){var t=this;this.filenamesPromise||(this.loadingFilenames=!0,this.filenamesPromise=Bc.queryFilenames({id:this.volumeId}).then(this.setFilenames).finally((function(){return t.loadingFilenames=!1}))),this.filenamesPromise.then((function(){return t.showFilenames=!0}))},disableFilenames:function(){this.showFilenames=!1},setFilenames:function(t){this.files.forEach((function(e){e.filename=t.body[e.id]}))},enableLabels:function(){var t=this;this.labelsPromise||(this.loadingLabels=!0,this.labelsPromise=Bc.queryFileLabels({id:this.volumeId}).then(this.setLabels).finally((function(){return t.loadingLabels=!1}))),this.labelsPromise.then((function(){return t.showLabels=!0}))},disableLabels:function(){this.showLabels=!1},setLabels:function(t){this.files.forEach((function(e){e.labels=t.body[e.id]}))},restoreSettings:function(){!0===this.settings.get("showFilenames")&&this.enableFilenames(),!0===this.settings.get("showLabels")&&this.enableLabels()}},watch:{fileIdsToShow:function(t){var e=this.fileIds,i=t.length===e.length;if(i)for(var n=t.length-1;n>=0;n--)if(t[n]!==e[n]){i=!1;break}i?localStorage.removeItem(this.filesStorageKey):localStorage.setItem(this.filesStorageKey,JSON.stringify(t)),Fd.count=t.length},showFilenames:function(t){this.settings.set("showFilenames",t)},showLabels:function(t){this.settings.set("showLabels",t)}},created:function(){this.type=biigle.$require("volumes.type"),this.fileIds=biigle.$require("volumes.fileIds"),this.filterSequence=this.fileIds,this.sortingSequence=this.fileIds,this.volumeId=biigle.$require("volumes.volumeId"),this.settings=new du({data:{storageKey:"biigle.volumes.settings",defaults:{showFilenames:!1,showLabels:!1}}});var t=biigle.$require("volumes.fileUuids"),e=biigle.$require("volumes.thumbUri"),i=biigle.$require("volumes.thumbCount"),n=biigle.$require("volumes.annotateUri"),r=biigle.$require("volumes.infoUri");this.files=this.fileIds.map((function(o){var s;return s=i>1?Array.from(Array(i).keys()).map((function(i){return e.replace(":uuid",Jd(t[o])+"/"+i)})):e.replace(":uuid",Jd(t[o])),{id:o,thumbnailUrl:s,annotateUrl:n.replace(":id",o),infoUrl:r?r.replace(":id",o):void 0,flagged:!1,filename:null,labels:[]}})),this.restoreSettings()}},undefined,undefined,!1,null,null,null).exports;biigle.$mount("annotation-session-panel",kd),biigle.$mount("create-volume-form",Ld),biigle.$mount("file-panel",Dd),biigle.$mount("projects-breadcrumb",Bd),biigle.$mount("search-results",Ud),biigle.$mount("volume-container",Qd),biigle.$mount("volume-file-count",Md),biigle.$mount("volume-metadata-upload",Nd);const tf="postrender",ef="movestart",nf="moveend";function rf(){return function(){throw new Error("Unimplemented abstract method.")}()}var of=0;function sf(t){return t.ol_uid||(t.ol_uid=String(++of))}var af="5.3.1";const lf="propertychange";var uf="function"==typeof Object.assign?Object.assign:function(t,e){var i=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1,o=arguments.length;r<o;++r){var s=i[r];if(null!=s)for(var a in s)s.hasOwnProperty(a)&&(n[a]=s[a])}return n};function hf(t){for(var e in t)delete t[e]}function cf(t){var e=[];for(var i in t)e.push(t[i]);return e}function df(t){var e;for(e in t)return!1;return!e}function ff(t,e,i,n){for(var r,o=0,s=t.length;o<s;++o)if((r=t[o]).listener===e&&r.bindTo===i)return n&&(r.deleteIndex=o),r}function pf(t,e){var i=gf(t);return i?i[e]:void 0}function gf(t,e){var i=t.ol_lm;return!i&&e&&(i=t.ol_lm={}),i}function mf(t,e){var i=pf(t,e);if(i){for(var n=0,r=i.length;n<r;++n)t.removeEventListener(e,i[n].boundListener),hf(i[n]);i.length=0;var o=gf(t);o&&(delete o[e],0===Object.keys(o).length&&function(t){delete t.ol_lm}(t))}}function vf(t,e,i,n,r){var o=gf(t,!0),s=o[e];s||(s=o[e]=[]);var a=ff(s,i,n,!1);return a?r||(a.callOnce=!1):(a={bindTo:n,callOnce:!!r,listener:i,target:t,type:e},t.addEventListener(e,function(t){var e=function(e){var i=t.listener,n=t.bindTo||t.target;return t.callOnce&&bf(t),i.call(n,e)};return t.boundListener=e,e}(a)),s.push(a)),a}function yf(t,e,i,n){return vf(t,e,i,n,!0)}function _f(t,e,i,n){var r=pf(t,e);if(r){var o=ff(r,i,n,!0);o&&bf(o)}}function bf(t){if(t&&t.target){t.target.removeEventListener(t.type,t.boundListener);var e=pf(t.target,t.type);if(e){var i="deleteIndex"in t?t.deleteIndex:e.indexOf(t);-1!==i&&e.splice(i,1),0===e.length&&mf(t.target,t.type)}hf(t)}}var wf=function(){this.disposed_=!1};wf.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},wf.prototype.disposeInternal=function(){};const xf=wf;function Sf(){return!0}function Cf(){return!1}function Tf(){}var Ef=function(t){this.propagationStopped,this.type=t,this.target=null};function If(t){t.stopPropagation()}Ef.prototype.preventDefault=function(){this.propagationStopped=!0},Ef.prototype.stopPropagation=function(){this.propagationStopped=!0};const Af=Ef;const Pf=function(t){function e(){t.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addEventListener=function(t,e){var i=this.listeners_[t];i||(i=this.listeners_[t]=[]),-1===i.indexOf(e)&&i.push(e)},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new Af(t):t,i=e.type;e.target=this;var n,r=this.listeners_[i];if(r){i in this.dispatching_||(this.dispatching_[i]=0,this.pendingRemovals_[i]=0),++this.dispatching_[i];for(var o=0,s=r.length;o<s;++o)if(!1===r[o].call(this,e)||e.propagationStopped){n=!1;break}if(--this.dispatching_[i],0===this.dispatching_[i]){var a=this.pendingRemovals_[i];for(delete this.pendingRemovals_[i];a--;)this.removeEventListener(i,Tf);delete this.dispatching_[i]}return n}},e.prototype.disposeInternal=function(){!function(t){var e=gf(t);if(e)for(var i in e)mf(t,i)}(this)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var i=this.listeners_[t];if(i){var n=i.indexOf(e);t in this.pendingRemovals_?(i[n]=Tf,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t])}},e}(xf),kf="change",Rf="clear",Lf="contextmenu",Ff="click",Mf="dblclick",Of="error",$f="keydown",Df="keypress",jf="load",Nf="mousedown",Bf="mousewheel",Uf="MSPointerDown",zf="resize",Vf="touchstart",Gf="wheel";const qf=function(t){function e(){t.call(this),this.revision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){++this.revision_,this.dispatchEvent(kf)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=vf(this,t[r],e);return n}return vf(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=yf(this,t[r],e);return n}return yf(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var i=0,n=t.length;i<n;++i)_f(this,t[i],e);else _f(this,t,e)},e}(Pf);var Wf=function(t){function e(e,i,n){t.call(this,e),this.key=i,this.oldValue=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Af),Kf={};function Xf(t){return Kf.hasOwnProperty(t)?Kf[t]:Kf[t]="change:"+t}const Yf=function(t){function e(e){t.call(this),sf(this),this.values_={},void 0!==e&&this.setProperties(e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return Object.keys(this.values_)},e.prototype.getProperties=function(){return uf({},this.values_)},e.prototype.notify=function(t,e){var i;i=Xf(t),this.dispatchEvent(new Wf(i,t,e)),i=lf,this.dispatchEvent(new Wf(i,t,e))},e.prototype.set=function(t,e,i){if(i)this.values_[t]=e;else{var n=this.values_[t];this.values_[t]=e,n!==e&&this.notify(t,n)}},e.prototype.setProperties=function(t,e){for(var i in t)this.set(i,t[i],e)},e.prototype.unset=function(t,e){if(t in this.values_){var i=this.values_[t];delete this.values_[t],e||this.notify(t,i)}},e}(qf),Hf="bottom-left",Zf="bottom-center",Jf="bottom-right",Qf="center-left",tp="center-center",ep="center-right",ip="top-left",np="top-center",rp="top-right";var op="ol-hidden",sp="ol-unselectable",ap="ol-control",lp="ol-collapsed",up=function(){var t,e={};return function(i){if(t||(t=document.createElement("div").style),!(i in e)){t.font=i;var n=t.fontFamily;if(t.font="",!n)return null;e[i]=n.split(/,\s?/)}return e[i]}}();function hp(t,e){var i=document.createElement("canvas");return t&&(i.width=t),e&&(i.height=e),i.getContext("2d")}function cp(t){var e=t.offsetWidth,i=getComputedStyle(t);return e+=parseInt(i.marginLeft,10)+parseInt(i.marginRight,10)}function dp(t){var e=t.offsetHeight,i=getComputedStyle(t);return e+=parseInt(i.marginTop,10)+parseInt(i.marginBottom,10)}function fp(t,e){var i=e.parentNode;i&&i.replaceChild(t,e)}function pp(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function gp(t){for(;t.lastChild;)t.removeChild(t.lastChild)}const mp=function(t){function e(e){var i="Assertion failed. See https://openlayers.org/en/"+("v"+af.split("-")[0])+"/doc/errors/#"+e+" for details.";t.call(this,i),this.code=e,this.name="AssertionError",this.message=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error);function vp(t,e){if(!t)throw new mp(e)}const yp="bottom-left",_p="bottom-right",bp="top-left",wp="top-right",xp=0,Sp=1,Cp=2,Tp=4,Ep=8,Ip=16;function Ap(t){for(var e=$p(),i=0,n=t.length;i<n;++i)Vp(e,t[i]);return e}function Pp(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function kp(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function Rp(t,e,i){var n,r;return(n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*n+(r=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0)*r}function Lp(t,e){return Mp(t,e[0],e[1])}function Fp(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function Mp(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function Op(t,e){var i=t[0],n=t[1],r=t[2],o=t[3],s=e[0],a=e[1],l=xp;return s<i?l|=Ip:s>r&&(l|=Tp),a<n?l|=Ep:a>o&&(l|=Cp),l===xp&&(l=Sp),l}function $p(){return[1/0,1/0,-1/0,-1/0]}function Dp(t,e,i,n,r){return r?(r[0]=t,r[1]=e,r[2]=i,r[3]=n,r):[t,e,i,n]}function jp(t){return Dp(1/0,1/0,-1/0,-1/0,t)}function Np(t,e){var i=t[0],n=t[1];return Dp(i,n,i,n,e)}function Bp(t,e,i,n,r){return qp(jp(r),t,e,i,n)}function Up(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function zp(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function Vp(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Gp(t,e){for(var i=0,n=e.length;i<n;++i)Vp(t,e[i]);return t}function qp(t,e,i,n,r){for(;i<n;i+=r)Wp(t,e[i],e[i+1]);return t}function Wp(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function Kp(t,e,i){var n;return(n=e.call(i,Yp(t)))||(n=e.call(i,Hp(t)))||(n=e.call(i,ng(t)))?n:(n=e.call(i,ig(t)))||!1}function Xp(t){var e=0;return sg(t)||(e=rg(t)*tg(t)),e}function Yp(t){return[t[0],t[1]]}function Hp(t){return[t[2],t[1]]}function Zp(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function Jp(t,e){var i;return e===yp?i=Yp(t):e===_p?i=Hp(t):e===bp?i=ig(t):e===wp?i=ng(t):vp(!1,13),i}function Qp(t,e,i,n,r){var o=e*n[0]/2,s=e*n[1]/2,a=Math.cos(i),l=Math.sin(i),u=o*a,h=o*l,c=s*a,d=s*l,f=t[0],p=t[1],g=f-u+d,m=f-u-d,v=f+u-d,y=f+u+d,_=p-h-c,b=p-h+c,w=p+h+c,x=p+h-c;return Dp(Math.min(g,m,v,y),Math.min(_,b,w,x),Math.max(g,m,v,y),Math.max(_,b,w,x),r)}function tg(t){return t[3]-t[1]}function eg(t,e,i){var n=i||[1/0,1/0,-1/0,-1/0];return og(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):jp(n),n}function ig(t){return[t[0],t[3]]}function ng(t){return[t[2],t[3]]}function rg(t){return t[2]-t[0]}function og(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function sg(t){return t[2]<t[0]||t[3]<t[1]}var ag="element",lg="map",ug="offset",hg="position",cg="positioning";const dg=function(t){function e(e){t.call(this),this.options=e,this.id=e.id,this.insertFirst=void 0===e.insertFirst||e.insertFirst,this.stopEvent=void 0===e.stopEvent||e.stopEvent,this.element=document.createElement("div"),this.element.className=void 0!==e.className?e.className:"ol-overlay-container ol-selectable",this.element.style.position="absolute",this.autoPan=void 0!==e.autoPan&&e.autoPan,this.autoPanAnimation=e.autoPanAnimation||{},this.autoPanMargin=void 0!==e.autoPanMargin?e.autoPanMargin:20,this.rendered={bottom_:"",left_:"",right_:"",top_:"",visible:!0},this.mapPostrenderListenerKey=null,vf(this,Xf(ag),this.handleElementChanged,this),vf(this,Xf(lg),this.handleMapChanged,this),vf(this,Xf(ug),this.handleOffsetChanged,this),vf(this,Xf(hg),this.handlePositionChanged,this),vf(this,Xf(cg),this.handlePositioningChanged,this),void 0!==e.element&&this.setElement(e.element),this.setOffset(void 0!==e.offset?e.offset:[0,0]),this.setPositioning(void 0!==e.positioning?e.positioning:ip),void 0!==e.position&&this.setPosition(e.position)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getElement=function(){return this.get(ag)},e.prototype.getId=function(){return this.id},e.prototype.getMap=function(){return this.get(lg)},e.prototype.getOffset=function(){return this.get(ug)},e.prototype.getPosition=function(){return this.get(hg)},e.prototype.getPositioning=function(){return this.get(cg)},e.prototype.handleElementChanged=function(){gp(this.element);var t=this.getElement();t&&this.element.appendChild(t)},e.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(pp(this.element),bf(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=vf(t,tf,this.render,this),this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element)}},e.prototype.render=function(){this.updatePixelPosition()},e.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},e.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.get(hg)&&this.autoPan&&this.panIntoView()},e.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},e.prototype.setElement=function(t){this.set(ag,t)},e.prototype.setMap=function(t){this.set(lg,t)},e.prototype.setOffset=function(t){this.set(ug,t)},e.prototype.setPosition=function(t){this.set(hg,t)},e.prototype.panIntoView=function(){var t=this.getMap();if(t&&t.getTargetElement()){var e=this.getRect(t.getTargetElement(),t.getSize()),i=this.getElement(),n=this.getRect(i,[cp(i),dp(i)]),r=this.autoPanMargin;if(!Fp(e,n)){var o=n[0]-e[0],s=e[2]-n[2],a=n[1]-e[1],l=e[3]-n[3],u=[0,0];if(o<0?u[0]=o-r:s<0&&(u[0]=Math.abs(s)+r),a<0?u[1]=a-r:l<0&&(u[1]=Math.abs(l)+r),0!==u[0]||0!==u[1]){var h=t.getView().getCenter(),c=t.getPixelFromCoordinate(h),d=[c[0]+u[0],c[1]+u[1]];t.getView().animate({center:t.getCoordinateFromPixel(d),duration:this.autoPanAnimation.duration,easing:this.autoPanAnimation.easing})}}}},e.prototype.getRect=function(t,e){var i=t.getBoundingClientRect(),n=i.left+window.pageXOffset,r=i.top+window.pageYOffset;return[n,r,n+e[0],r+e[1]]},e.prototype.setPositioning=function(t){this.set(cg,t)},e.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},e.prototype.updatePixelPosition=function(){var t=this.getMap(),e=this.getPosition();if(t&&t.isRendered()&&e){var i=t.getPixelFromCoordinate(e),n=t.getSize();this.updateRenderedPosition(i,n)}else this.setVisible(!1)},e.prototype.updateRenderedPosition=function(t,e){var i=this.element.style,n=this.getOffset(),r=this.getPositioning();this.setVisible(!0);var o=n[0],s=n[1];if(r==Jf||r==ep||r==rp){""!==this.rendered.left_&&(this.rendered.left_=i.left="");var a=Math.round(e[0]-t[0]-o)+"px";this.rendered.right_!=a&&(this.rendered.right_=i.right=a)}else{""!==this.rendered.right_&&(this.rendered.right_=i.right=""),r!=Zf&&r!=tp&&r!=np||(o-=this.element.offsetWidth/2);var l=Math.round(t[0]+o)+"px";this.rendered.left_!=l&&(this.rendered.left_=i.left=l)}if(r==Hf||r==Zf||r==Jf){""!==this.rendered.top_&&(this.rendered.top_=i.top="");var u=Math.round(e[1]-t[1]-s)+"px";this.rendered.bottom_!=u&&(this.rendered.bottom_=i.bottom=u)}else{""!==this.rendered.bottom_&&(this.rendered.bottom_=i.bottom=""),r!=Qf&&r!=tp&&r!=ep||(s-=this.element.offsetHeight/2);var h=Math.round(t[1]+s)+"px";this.rendered.top_!=h&&(this.rendered.top_=i.top=h)}},e.prototype.getOptions=function(){return this.options},e}(Yf);const fg=Tl({props:{watch:{required:!0,type:String},position:{required:!0,type:Array},show:{required:!0,type:Boolean},positioning:{type:String,default:"top-left"}},data:function(){return{annotations:[]}},computed:{hasAnnotations:function(){return this.annotations.length>0},showThis:function(){return this.show&&this.hasAnnotations}},methods:{updateAnnotations:function(t){this.annotations=t.map((function(t){return t.get("annotation")}))}},watch:{show:{immediate:!0,handler:function(t){t?this.$parent.$on(this.watch,this.updateAnnotations):this.$parent.$off(this.watch,this.updateAnnotations)}},position:function(t){this.overlay.setPosition(t)},showThis:function(t){t?this.$parent.map.addOverlay(this.overlay):this.$parent.map.removeOverlay(this.overlay)}},mounted:function(){this.overlay=new dg({element:this.$el,offset:[15,0],positioning:this.positioning})},beforeDestroy:function(){this.$parent.map.removeOverlay(this.overlay)}},undefined,undefined,!1,null,null,null).exports;const pg=Tl({mixins:[fg],computed:{annotationLabels:function(){return this.annotations.map((function(t){return t.labels.map((function(t){return t.label.name}))}))}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"annotation-tooltip"},[i("ul",{staticClass:"annotation-tooltip__annotations"},t._l(t.annotationLabels,(function(e){return i("li",[i("ul",{staticClass:"annotation-tooltip__labels"},t._l(e,(function(e){return i("li",{domProps:{textContent:t._s(e)}})})),0)])})),0)])}),[],!1,null,null,null).exports;const gg=Tl({props:{image:{required:!0},areas:{required:!0}},data:function(){return{unitMultipliers:[1e3,1,.01,.001,1e-6,1e-9],unitNames:["km","m","cm","mm","µm","nm"]}},computed:{area:function(){return this.areas&&this.image&&this.areas[this.image.id]||-1},hasArea:function(){return-1!==this.area},pxWidthInMeter:function(){return Math.sqrt(this.area/(this.image.width*this.image.height))}},methods:{powerOfTen:function(t){return Math.pow(10,Math.floor(Math.log10(t)))}}},undefined,undefined,!1,null,null,null).exports;function mg(t,e){return t>e?1:t<e?-1:0}function vg(t,e){return t.indexOf(e)>=0}function yg(t,e,i){var n,r=t.length;if(t[0]<=e)return 0;if(e<=t[r-1])return r-1;if(i>0){for(n=1;n<r;++n)if(t[n]<e)return n-1}else if(i<0){for(n=1;n<r;++n)if(t[n]<=e)return n}else for(n=1;n<r;++n){if(t[n]==e)return n;if(t[n]<e)return t[n-1]-e<e-t[n]?n-1:n}return r-1}function _g(t,e,i){for(;e<i;){var n=t[e];t[e]=t[i],t[i]=n,++e,--i}}function bg(t,e){for(var i=Array.isArray(e)?e:[e],n=i.length,r=0;r<n;r++)t[t.length]=i[r]}function wg(t,e){var i=t.length;if(i!==e.length)return!1;for(var n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}const xg="XY",Sg="XYZ",Cg="XYM",Tg="XYZM",Eg="Point",Ig="LineString",Ag="LinearRing",Pg="Polygon",kg="MultiPoint",Rg="MultiLineString",Lg="MultiPolygon",Fg="GeometryCollection",Mg="Circle",Og="Rectangle",$g="Ellipse";function Dg(t,e,i,n,r,o){for(var s=o||[],a=0,l=e;l<i;l+=n){var u=t[l],h=t[l+1];s[a++]=r[0]*u+r[2]*h+r[4],s[a++]=r[1]*u+r[3]*h+r[5]}return o&&s.length!=a&&(s.length=a),s}function jg(t,e,i){return Math.min(Math.max(t,e),i)}var Ng="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};function Bg(t,e,i,n,r,o){var s=r-i,a=o-n;if(0!==s||0!==a){var l=((t-i)*s+(e-n)*a)/(s*s+a*a);l>1?(i=r,n=o):l>0&&(i+=s*l,n+=a*l)}return Ug(t,e,i,n)}function Ug(t,e,i,n){var r=i-t,o=n-e;return r*r+o*o}function zg(t){return t*Math.PI/180}function Vg(t,e){var i=t%e;return i*e<0?i+e:i}function Gg(t,e,i){return t+i*(e-t)}var qg=6371008.8;function Wg(t,e,i){var n=i||qg,r=zg(t[1]),o=zg(e[1]),s=(o-r)/2,a=zg(e[0]-t[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(o);return 2*n*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}var Kg={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},Xg={};Xg[Kg.DEGREES]=2*Math.PI*6370997/360,Xg[Kg.FEET]=.3048,Xg[Kg.METERS]=1,Xg[Kg.USFEET]=1200/3937;const Yg=Kg;var Hg=function(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit};Hg.prototype.canWrapX=function(){return this.canWrapX_},Hg.prototype.getCode=function(){return this.code_},Hg.prototype.getExtent=function(){return this.extent_},Hg.prototype.getUnits=function(){return this.units_},Hg.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||Xg[this.units_]},Hg.prototype.getWorldExtent=function(){return this.worldExtent_},Hg.prototype.getAxisOrientation=function(){return this.axisOrientation_},Hg.prototype.isGlobal=function(){return this.global_},Hg.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},Hg.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},Hg.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},Hg.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},Hg.prototype.setWorldExtent=function(t){this.worldExtent_=t},Hg.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},Hg.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};const Zg=Hg;var Jg=6378137,Qg=Math.PI*Jg,tm=[-Qg,-Qg,Qg,Qg],em=[-180,-85,180,85],im=function(t){function e(e){t.call(this,{code:e,units:Yg.METERS,extent:tm,global:!0,worldExtent:em,getPointResolution:function(t,e){return t/Ng(e[1]/Jg)}})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Zg),nm=[new im("EPSG:3857"),new im("EPSG:102100"),new im("EPSG:102113"),new im("EPSG:900913"),new im("urn:ogc:def:crs:EPSG:6.18:3:3857"),new im("urn:ogc:def:crs:EPSG::3857"),new im("http://www.opengis.net/gml/srs/epsg.xml#3857")];function rm(t,e,i){var n=t.length,r=i>1?i:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(n));for(var s=Qg,a=0;a<n;a+=r){o[a]=s*t[a]/180;var l=Jg*Math.log(Math.tan(Math.PI*(t[a+1]+90)/360));l>s?l=s:l<-s&&(l=-s),o[a+1]=l}return o}function om(t,e,i){var n=t.length,r=i>1?i:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(n));for(var s=0;s<n;s+=r)o[s]=180*t[s]/Qg,o[s+1]=360*Math.atan(Math.exp(t[s+1]/Jg))/Math.PI-90;return o}var sm=[-180,-90,180,90],am=6378137*Math.PI/180,lm=function(t){function e(e,i){t.call(this,{code:e,units:Yg.DEGREES,extent:sm,axisOrientation:i,global:!0,metersPerUnit:am,worldExtent:sm})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Zg),um=[new lm("CRS:84"),new lm("EPSG:4326","neu"),new lm("urn:ogc:def:crs:EPSG::4326","neu"),new lm("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new lm("urn:ogc:def:crs:OGC:1.3:CRS84"),new lm("urn:ogc:def:crs:OGC:2:84"),new lm("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new lm("urn:x-ogc:def:crs:EPSG:4326","neu")],hm={};var cm,dm,fm,pm={};function gm(t,e,i){var n=t.getCode(),r=e.getCode();n in pm||(pm[n]={}),pm[n][r]=i}function mm(t,e,i){var n;if(void 0!==e){for(var r=0,o=t.length;r<o;++r)e[r]=t[r];n=e}else n=t.slice();return n}function vm(t,e,i){if(void 0!==e&&t!==e){for(var n=0,r=t.length;n<r;++n)e[n]=t[n];t=e}return t}function ym(t){!function(t,e){hm[t]=e}(t.getCode(),t),gm(t,t,mm)}function _m(t){return"string"==typeof t?hm[t]||null:t||null}function bm(t,e,i,n){var r,o=(t=_m(t)).getPointResolutionFunc();if(o)r=o(e,i);else if(t.getUnits()==Yg.DEGREES&&!n||n==Yg.DEGREES)r=e;else{var s=Cm(t,_m("EPSG:4326")),a=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];r=(Wg((a=s(a,a,2)).slice(0,2),a.slice(2,4))+Wg(a.slice(4,6),a.slice(6,8)))/2;var l=n?Xg[n]:t.getMetersPerUnit();void 0!==l&&(r/=l)}return r}function wm(t){!function(t){t.forEach(ym)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&gm(e,t,mm)}))}))}function xm(t,e){return t?"string"==typeof t?_m(t):t:_m(e)}function Sm(t,e){if(t===e)return!0;var i=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||Cm(t,e)===mm)&&i}function Cm(t,e){var i=function(t,e){var i;return t in pm&&e in pm[t]&&(i=pm[t][e]),i}(t.getCode(),e.getCode());return i||(i=vm),i}function Tm(t,e){return Cm(_m(t),_m(e))}function Em(t,e,i){return Tm(e,i)(t,void 0,t.length)}wm(nm),wm(um),cm=nm,dm=rm,fm=om,um.forEach((function(t){cm.forEach((function(e){gm(t,e,dm),gm(e,t,fm)}))}));var Im=new Array(6);function Am(t){return km(t,1,0,0,1,0,0)}function Pm(t,e){var i=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=e[0],u=e[1],h=e[2],c=e[3],d=e[4],f=e[5];return t[0]=i*l+r*u,t[1]=n*l+o*u,t[2]=i*h+r*c,t[3]=n*h+o*c,t[4]=i*d+r*f+s,t[5]=n*d+o*f+a,t}function km(t,e,i,n,r,o,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=o,t[5]=s,t}function Rm(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Lm(t,e){var i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function Fm(t,e,i){return Pm(t,km(Im,e,0,0,i,0,0))}function Mm(t,e,i){return Pm(t,km(Im,1,0,0,1,e,i))}function Om(t,e,i,n,r,o,s,a){var l=Math.sin(o),u=Math.cos(o);return t[0]=n*u,t[1]=r*l,t[2]=-n*l,t[3]=r*u,t[4]=s*n*u-a*n*l+e,t[5]=s*r*l+a*r*u+i,t}var $m=[1,0,0,1,0,0];function Dm(t){var e;return t==xg?e=2:t==Sg||t==Cg?e=3:t==Tg&&(e=4),e}const jm=function(t){function e(){t.call(this),this.layout=xg,this.stride=2,this.flatCoordinates=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeExtent=function(t){return Bp(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return rf()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&(hf(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=t.toString();if(this.simplifiedGeometryCache.hasOwnProperty(e))return this.simplifiedGeometryCache[e];var i=this.getSimplifiedGeometryInternal(t);return i.getFlatCoordinates().length<this.flatCoordinates.length?(this.simplifiedGeometryCache[e]=i,i):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=Dm(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){rf()},e.prototype.setLayout=function(t,e,i){var n;if(t)n=Dm(t);else{for(var r=0;r<i;++r){if(0===e.length)return this.layout=xg,void(this.stride=2);e=e[0]}t=function(t){var e;2==t?e=xg:3==t?e=Sg:4==t&&(e=Tg);return e}(n=e.length)}this.layout=t,this.stride=n},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();!function(t,e,i,n,r,o,s){for(var a=s||[],l=Math.cos(r),u=Math.sin(r),h=o[0],c=o[1],d=0,f=e;f<i;f+=n){var p=t[f]-h,g=t[f+1]-c;a[d++]=h+p*l-g*u,a[d++]=c+p*u+g*l;for(var m=f+2;m<f+n;++m)a[d++]=t[m]}s&&a.length!=d&&(a.length=d)}(i,0,i.length,n,t,e,i),this.changed()}},e.prototype.scale=function(t,e,i){var n=e;void 0===n&&(n=t);var r=i;r||(r=Zp(this.getExtent()));var o=this.getFlatCoordinates();if(o){var s=this.getStride();!function(t,e,i,n,r,o,s,a){for(var l=a||[],u=s[0],h=s[1],c=0,d=e;d<i;d+=n){var f=t[d]-u,p=t[d+1]-h;l[c++]=u+r*f,l[c++]=h+o*p;for(var g=d+2;g<d+n;++g)l[c++]=t[g]}a&&l.length!=c&&(l.length=c)}(o,0,o.length,s,t,n,r,o),this.changed()}},e.prototype.translate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();!function(t,e,i,n,r,o,s){for(var a=s||[],l=0,u=e;u<i;u+=n){a[l++]=t[u]+r,a[l++]=t[u+1]+o;for(var h=u+2;h<u+n;++h)a[l++]=t[h]}s&&a.length!=l&&(a.length=l)}(i,0,i.length,n,t,e,i),this.changed()}},e}(function(t){function e(){t.call(this),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryCache={},this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return rf()},e.prototype.closestPointXY=function(t,e,i,n){return rf()},e.prototype.containsXY=function(t,e){return!1},e.prototype.getClosestPoint=function(t,e){var i=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return rf()},e.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)},e.prototype.rotate=function(t,e){rf()},e.prototype.scale=function(t,e,i){rf()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return rf()},e.prototype.getType=function(){return rf()},e.prototype.applyTransform=function(t){rf()},e.prototype.intersectsExtent=function(t){return rf()},e.prototype.translate=function(t,e){rf()},e.prototype.transform=function(t,e){var i=_m(t),n=i.getUnits()==Yg.TILE_PIXELS?function(t,n,r){var o=i.getExtent(),s=i.getWorldExtent(),a=tg(s)/tg(o);return Om($m,s[0],s[3],a,-a,0,0,0),Dg(t,0,t.length,r,$m,n),Tm(i,e)(t,n,r)}:Tm(i,e);return this.applyTransform(n),this},e}(Yf));function Nm(t,e,i,n){for(var r=0,o=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],l=t[e+1];r+=s*a-o*l,o=a,s=l}return r/2}function Bm(t,e,i,n){for(var r=0,o=0,s=i.length;o<s;++o){var a=i[o];r+=Nm(t,e,a,n),e=a}return r}function Um(t,e,i,n,r,o,s){var a,l=t[e],u=t[e+1],h=t[i]-l,c=t[i+1]-u;if(0===h&&0===c)a=e;else{var d=((r-l)*h+(o-u)*c)/(h*h+c*c);if(d>1)a=i;else{if(d>0){for(var f=0;f<n;++f)s[f]=Gg(t[e+f],t[i+f],d);return void(s.length=n)}a=e}}for(var p=0;p<n;++p)s[p]=t[a+p];s.length=n}function zm(t,e,i,n,r){var o=t[e],s=t[e+1];for(e+=n;e<i;e+=n){var a=t[e],l=t[e+1],u=Ug(o,s,a,l);u>r&&(r=u),o=a,s=l}return r}function Vm(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];r=zm(t,e,a,n,r),e=a}return r}function Gm(t,e,i,n,r,o,s,a,l,u,h){if(e==i)return u;var c,d;if(0===r){if((d=Ug(s,a,t[e],t[e+1]))<u){for(c=0;c<n;++c)l[c]=t[e+c];return l.length=n,d}return u}for(var f=h||[NaN,NaN],p=e+n;p<i;)if(Um(t,p-n,p,n,s,a,f),(d=Ug(s,a,f[0],f[1]))<u){for(u=d,c=0;c<n;++c)l[c]=f[c];l.length=n,p+=n}else p+=n*Math.max((Math.sqrt(d)-Math.sqrt(u))/r|0,1);if(o&&(Um(t,i-n,e,n,s,a,f),(d=Ug(s,a,f[0],f[1]))<u)){for(u=d,c=0;c<n;++c)l[c]=f[c];l.length=n}return u}function qm(t,e,i,n,r,o,s,a,l,u,h){for(var c=h||[NaN,NaN],d=0,f=i.length;d<f;++d){var p=i[d];u=Gm(t,e,p,n,r,o,s,a,l,u,c),e=p}return u}function Wm(t,e,i,n){for(var r=0,o=i.length;r<o;++r)t[e++]=i[r];return e}function Km(t,e,i,n){for(var r=0,o=i.length;r<o;++r)for(var s=i[r],a=0;a<n;++a)t[e++]=s[a];return e}function Xm(t,e,i,n,r){for(var o=r||[],s=0,a=0,l=i.length;a<l;++a){var u=Km(t,e,i[a],n);o[s++]=u,e=u}return o.length=s,o}function Ym(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=e;a<i;a+=n)o[s++]=t.slice(a,a+n);return o.length=s,o}function Hm(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=0,l=i.length;a<l;++a){var u=i[a];o[s++]=Ym(t,e,u,n,o[s]),e=u}return o.length=s,o}function Zm(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=0,l=i.length;a<l;++a){var u=i[a];o[s++]=Hm(t,e,u,n,o[s]),e=u[u.length-1]}return o.length=s,o}function Jm(t,e,i,n,r,o,s){var a=(i-e)/n;if(a<3){for(;e<i;e+=n)o[s++]=t[e],o[s++]=t[e+1];return s}var l=new Array(a);l[0]=1,l[a-1]=1;for(var u=[e,i-n],h=0;u.length>0;){for(var c=u.pop(),d=u.pop(),f=0,p=t[d],g=t[d+1],m=t[c],v=t[c+1],y=d+n;y<c;y+=n){var _=Bg(t[y],t[y+1],p,g,m,v);_>f&&(h=y,f=_)}f>r&&(l[(h-e)/n]=1,d+n<h&&u.push(d,h),h+n<c&&u.push(h,c))}for(var b=0;b<a;++b)l[b]&&(o[s++]=t[e+b*n],o[s++]=t[e+b*n+1]);return s}function Qm(t,e,i,n,r,o,s,a){for(var l=0,u=i.length;l<u;++l){var h=i[l];s=Jm(t,e,h,n,r,o,s),a.push(s),e=h}return s}function tv(t,e){return e*Math.round(t/e)}function ev(t,e,i,n,r,o,s){if(e==i)return s;var a,l,u=tv(t[e],r),h=tv(t[e+1],r);e+=n,o[s++]=u,o[s++]=h;do{if(a=tv(t[e],r),l=tv(t[e+1],r),(e+=n)==i)return o[s++]=a,o[s++]=l,s}while(a==u&&l==h);for(;e<i;){var c=tv(t[e],r),d=tv(t[e+1],r);if(e+=n,c!=a||d!=l){var f=a-u,p=l-h,g=c-u,m=d-h;f*m==p*g&&(f<0&&g<f||f==g||f>0&&g>f)&&(p<0&&m<p||p==m||p>0&&m>p)?(a=c,l=d):(o[s++]=a,o[s++]=l,u=a,h=l,a=c,l=d)}}return o[s++]=a,o[s++]=l,s}function iv(t,e,i,n,r,o,s,a){for(var l=0,u=i.length;l<u;++l){var h=i[l];s=ev(t,e,h,n,r,o,s),a.push(s),e=h}return s}function nv(t,e){return e=e?Math.pow(10,e):1e3,t.map((function(t){return t.map((function(t){return t.map((function(t){return Math.round(t*e)/e}))}))}))}const rv=function(t){function e(e,i){t.call(this),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?this.setCoordinates(e,i):this.setFlatCoordinates(i,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<Rp(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(zm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Gm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.getArea=function(){return Nm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return Ym(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=Jm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,xg)},e.prototype.getType=function(){return Ag},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Km(this.flatCoordinates,0,t,this.stride),this.changed()},e}(jm);const ov=function(t){function e(e,i){t.call(this),this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){var r=this.flatCoordinates,o=Ug(t,e,r[0],r[1]);if(o<n){for(var s=this.stride,a=0;a<s;++a)i[a]=r[a];return i.length=s,o}return n},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return Np(this.flatCoordinates,t)},e.prototype.getType=function(){return Eg},e.prototype.intersectsExtent=function(t){return Mp(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Wm(this.flatCoordinates,0,t,this.stride),this.changed()},e}(jm);function sv(t,e,i,n,r){return!Kp(r,(function(r){return!av(t,e,i,n,r[0],r[1])}))}function av(t,e,i,n,r,o){for(var s=0,a=t[i-n],l=t[i-n+1];e<i;e+=n){var u=t[e],h=t[e+1];l<=o?h>o&&(u-a)*(o-l)-(r-a)*(h-l)>0&&s++:h<=o&&(u-a)*(o-l)-(r-a)*(h-l)<0&&s--,a=u,l=h}return 0!==s}function lv(t,e,i,n,r,o){if(0===i.length)return!1;if(!av(t,e,i[0],n,r,o))return!1;for(var s=1,a=i.length;s<a;++s)if(av(t,i[s-1],i[s],n,r,o))return!1;return!0}function uv(t,e,i,n,r,o,s){for(var a,l,u,h,c,d,f,p=r[o+1],g=[],m=0,v=i.length;m<v;++m){var y=i[m];for(h=t[y-n],d=t[y-n+1],a=e;a<y;a+=n)c=t[a],f=t[a+1],(p<=d&&f<=p||d<=p&&p<=f)&&(u=(p-d)/(f-d)*(c-h)+h,g.push(u)),h=c,d=f}var _=NaN,b=-1/0;for(g.sort(mg),h=g[0],a=1,l=g.length;a<l;++a){c=g[a];var w=Math.abs(c-h);w>b&&lv(t,e,i,n,u=(h+c)/2,p)&&(_=u,b=w),h=c}return isNaN(_)&&(_=r[o]),s?(s.push(_,p,b),s):[_,p,b]}function hv(t,e,i,n,r,o){for(var s,a=[t[e],t[e+1]],l=[];e+n<i;e+=n){if(l[0]=t[e+n],l[1]=t[e+n+1],s=r.call(o,a,l))return s;a[0]=l[0],a[1]=l[1]}return!1}function cv(t,e,i,n,r){var o=qp([1/0,1/0,-1/0,-1/0],t,e,i,n);return!!og(r,o)&&(!!Fp(r,o)||(o[0]>=r[0]&&o[2]<=r[2]||(o[1]>=r[1]&&o[3]<=r[3]||hv(t,e,i,n,(function(t,e){return function(t,e,i){var n=!1,r=Op(t,e),o=Op(t,i);if(r===Sp||o===Sp)n=!0;else{var s,a,l=t[0],u=t[1],h=t[2],c=t[3],d=e[0],f=e[1],p=i[0],g=i[1],m=(g-f)/(p-d);o&Cp&&!(r&Cp)&&(n=(s=p-(g-c)/m)>=l&&s<=h),n||!(o&Tp)||r&Tp||(n=(a=g-(p-h)*m)>=u&&a<=c),n||!(o&Ep)||r&Ep||(n=(s=p-(g-u)/m)>=l&&s<=h),n||!(o&Ip)||r&Ip||(n=(a=g-(p-l)*m)>=u&&a<=c)}return n}(r,t,e)})))))}function dv(t,e,i,n,r){if(!function(t,e,i,n,r){return!!(cv(t,e,i,n,r)||av(t,e,i,n,r[0],r[1])||av(t,e,i,n,r[0],r[3])||av(t,e,i,n,r[2],r[1])||av(t,e,i,n,r[2],r[3]))}(t,e,i[0],n,r))return!1;if(1===i.length)return!0;for(var o=1,s=i.length;o<s;++o)if(sv(t,i[o-1],i[o],n,r)&&!cv(t,i[o-1],i[o],n,r))return!1;return!0}function fv(t,e,i,n){for(;e<i-n;){for(var r=0;r<n;++r){var o=t[e+r];t[e+r]=t[i-n+r],t[i-n+r]=o}e+=n,i-=n}}function pv(t,e,i,n){for(var r=0,o=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],l=t[e+1];r+=(a-o)*(l+s),o=a,s=l}return r>0}function gv(t,e,i,n,r){for(var o=void 0!==r&&r,s=0,a=i.length;s<a;++s){var l=i[s],u=pv(t,e,l,n);if(0===s){if(o&&u||!o&&!u)return!1}else if(o&&!u||!o&&u)return!1;e=l}return!0}function mv(t,e,i,n,r){for(var o=void 0!==r&&r,s=0,a=i.length;s<a;++s){var l=i[s],u=pv(t,e,l,n);(0===s?o&&u||!o&&!u:o&&!u||!o&&u)&&fv(t,e,l,n),e=l}return e}function vv(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o)e=mv(t,e,i[o],n,r);return e}var yv=function(t){function e(e,i,n){t.call(this),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==i&&n?(this.setFlatCoordinates(i,e),this.ends_=n):this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendLinearRing=function(t){this.flatCoordinates?bg(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,n){return n<Rp(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Vm(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),qm(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return lv(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return Bm(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?mv(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,Hm(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Zp(this.getExtent());this.flatInteriorPoint_=uv(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new ov(this.getFlatInteriorPoint(),Cg)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new rv(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[],r=0,o=0,s=i.length;o<s;++o){var a=i[o],l=new rv(e.slice(r,a),t);n.push(l),r=a}return n},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;gv(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=mv(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=iv(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),i,0,n),new e(i,xg,n)},e.prototype.getType=function(){return Pg},e.prototype.intersectsExtent=function(t){return dv(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=Xm(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(jm);const _v=yv;function bv(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=[e,i,e,r,n,r,n,i,e,i];return new yv(o,xg,[o.length])}function wv(t,e,i){for(var n=e||32,r=t.getStride(),o=t.getLayout(),s=t.getCenter(),a=r*(n+1),l=new Array(a),u=0;u<a;u+=r){l[u]=0,l[u+1]=0;for(var h=2;h<r;h++)l[u+h]=s[h]}var c=[l.length],d=new yv(l,o,c);return function(t,e,i,n){for(var r=t.getFlatCoordinates(),o=t.getStride(),s=r.length/o-1,a=n||0,l=0;l<=s;++l){var u=l*o,h=a+2*Vg(l,s)*Math.PI/s;r[u]=e[0]+i*Math.cos(h),r[u+1]=e[1]+i*Math.sin(h)}t.changed()}(d,s,t.getRadius(),i),d}var xv=function(t){function e(e,i,n){if(t.call(this),void 0!==n&&void 0===i)this.setFlatCoordinates(n,e);else{var r=i||0;this.setCenterAndRadius(e,r,n)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),void 0,this.layout)},e.prototype.closestPointXY=function(t,e,i,n){var r=this.flatCoordinates,o=t-r[0],s=e-r[1],a=o*o+s*s;if(a<n){if(0===a)for(var l=0;l<this.stride;++l)i[l]=r[l];else{var u=this.getRadius()/Math.sqrt(a);i[0]=r[0]+u*o,i[1]=r[1]+u*s;for(var h=2;h<this.stride;++h)i[h]=r[h]}return i.length=this.stride,a}return n},e.prototype.containsXY=function(t,e){var i=this.flatCoordinates,n=t-i[0],r=e-i[1];return n*n+r*r<=this.getRadiusSquared_()},e.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.computeExtent=function(t){var e=this.flatCoordinates,i=e[this.stride]-e[0];return Dp(e[0]-i,e[1]-i,e[0]+i,e[1]+i,t)},e.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},e.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},e.prototype.getType=function(){return Mg},e.prototype.intersectsExtent=function(t){if(og(t,this.getExtent())){var e=this.getCenter();return t[0]<=e[0]&&t[2]>=e[0]||(t[1]<=e[1]&&t[3]>=e[1]||Kp(t,this.intersectsCoordinate,this))}return!1},e.prototype.setCenter=function(t){var e=this.stride,i=this.flatCoordinates[e]-this.flatCoordinates[0],n=t.slice();n[e]=n[0]+i;for(var r=1;r<e;++r)n[e+r]=t[r];this.setFlatCoordinates(this.layout,n),this.changed()},e.prototype.setCenterAndRadius=function(t,e,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var n=this.flatCoordinates,r=Wm(n,0,t,this.stride);n[r++]=n[0]+e;for(var o=1,s=this.stride;o<s;++o)n[r++]=n[o];n.length=r,this.changed()},e.prototype.getCoordinates=function(){return null},e.prototype.setCoordinates=function(t,e){},e.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},e}(jm);xv.prototype.transform;const Sv=xv;function Cv(t,e,i,n,r,o){var s=NaN,a=NaN,l=(i-e)/n;if(1===l)s=t[e],a=t[e+1];else if(2==l)s=(1-r)*t[e]+r*t[e+n],a=(1-r)*t[e+1]+r*t[e+n+1];else if(0!==l){for(var u=t[e],h=t[e+1],c=0,d=[0],f=e+n;f<i;f+=n){var p=t[f],g=t[f+1];c+=Math.sqrt((p-u)*(p-u)+(g-h)*(g-h)),d.push(c),u=p,h=g}var m=r*c,v=function(t,e,i){for(var n,r,o=i||mg,s=0,a=t.length,l=!1;s<a;)(r=+o(t[n=s+(a-s>>1)],e))<0?s=n+1:(a=n,l=!r);return l?s:~s}(d,m);if(v<0){var y=(m-d[-v-2])/(d[-v-1]-d[-v-2]),_=e+(-v-2)*n;s=Gg(t[_],t[_+n],y),a=Gg(t[_+1],t[_+n+1],y)}else s=t[e+v*n],a=t[e+v*n+1]}return o?(o[0]=s,o[1]=a,o):[s,a]}function Tv(t,e,i,n,r,o){if(i==e)return null;var s;if(r<t[e+n-1])return o?((s=t.slice(e,e+n))[n-1]=r,s):null;if(t[i-1]<r)return o?((s=t.slice(i-n,i))[n-1]=r,s):null;if(r==t[e+n-1])return t.slice(e,e+n);for(var a=e/n,l=i/n;a<l;){var u=a+l>>1;r<t[(u+1)*n-1]?l=u:a=u+1}var h=t[a*n-1];if(r==h)return t.slice((a-1)*n,(a-1)*n+n);var c=(r-h)/(t[(a+1)*n-1]-h);s=[];for(var d=0;d<n-1;++d)s.push(Gg(t[(a-1)*n+d],t[a*n+d],c));return s.push(r),s}function Ev(t,e,i,n){for(var r=t[e],o=t[e+1],s=0,a=e+n;a<i;a+=n){var l=t[a],u=t[a+1];s+=Math.sqrt((l-r)*(l-r)+(u-o)*(u-o)),r=l,o=u}return s}const Iv=function(t){function e(e,i){t.call(this),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?this.setCoordinates(e,i):this.setFlatCoordinates(i,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendCoordinate=function(t){this.flatCoordinates?bg(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<Rp(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(zm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Gm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))},e.prototype.forEachSegment=function(t){return hv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,e){if(this.layout!=Cg&&this.layout!=Tg)return null;var i=void 0!==e&&e;return Tv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},e.prototype.getCoordinates=function(){return Ym(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,e){return Cv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e)},e.prototype.getLength=function(){return Ev(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=Jm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,xg)},e.prototype.getType=function(){return Ig},e.prototype.intersectsExtent=function(t){return cv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Km(this.flatCoordinates,0,t,this.stride),this.changed()},e}(jm);var Av=Tl({mixins:[fg,gg],data:function(){return{measuredGeometries:[]}},computed:{areaUnitMultipliers:function(){return this.unitMultipliers.map((function(t){return Math.pow(t,2)}))}},methods:{updateGeometries:function(t){var e=this;this.measuredGeometries=t.map((function(t){return t.getGeometry()})).filter((function(t){return e.isAeraGeometry(t)||e.isLengthGeometry(t)})).map((function(t){return e.measure(t)}))},measure:function(t){return t.getArea?this.formatArea(t.getArea()):t.getLength?this.formatLength(t.getLength()):t.getRadius?this.formatArea(Math.pow(t.getRadius(),2)*Math.PI):""},isAeraGeometry:function(t){return t instanceof _v||t instanceof Sv},isLengthGeometry:function(t){return t instanceof Iv},formatArea:function(t){var e="px²";if(this.hasArea){t*=Math.pow(this.pxWidthInMeter,2);var i=this.unitNearest(t,this.areaUnitMultipliers,.001);e=this.unitNames[i]+"²",t/=this.areaUnitMultipliers[i]}return this.formatMeasurement(t,e,3)},formatLength:function(t){var e="px";if(this.hasArea){t*=this.pxWidthInMeter;var i=this.unitNearest(t,this.unitMultipliers);e=this.unitNames[i],t/=this.unitMultipliers[i]}return this.formatMeasurement(t,e)},formatMeasurement:function(t,e,i){return i=Math.pow(10,i||1),Math.round(t*i)/i+" "+e},unitNearest:function(t,e,i){if(0===t)return e.length-1;var n,r;for(i=i||1,r=e.length-1;r>=0&&!((n=t/e[r])>=i&&n<1e3);r--);return r}},watch:{show:function(t){t?this.$parent.$on(this.watch,this.updateGeometries):this.$parent.$off(this.watch,this.updateGeometries)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"annotation-tooltip"},[i("ul",{staticClass:"annotation-tooltip__annotations"},t._l(t.measuredGeometries,(function(e){return i("li",{domProps:{textContent:t._s(e)}})})),0)])}),[],!1,null,null,null);const Pv=Tl({components:{labelTooltip:pg,measureTooltip:Av.exports},props:{showLabelTooltip:{type:Boolean,default:!1},showMeasureTooltip:{type:Boolean,default:!1}},computed:{showAnnotationTooltip:function(){return this.isDefaultInteractionMode&&(this.showLabelTooltip||this.showMeasureTooltip)}},data:function(){return{hoveredFeaturesHash:""}},methods:{annotationLayerFilter:function(t){return"annotations"===t.get("name")},updateHoveredAnnotations:function(t){var e=this.map.getFeaturesAtPixel(t.pixel,{layerFilter:this.annotationLayerFilter})||[],i=e.map((function(t){return t.getId()})).join("-");this.hoveredFeaturesHash!==i&&(this.hoveredFeaturesHash=i,this.$emit("hoverFeatures",e))},resetHoveredAnnotations:function(){this.hoveredFeaturesHash="",this.$emit("hoverFeatures",[])}},watch:{showAnnotationTooltip:function(t){t?this.map.on("pointermove",this.updateHoveredAnnotations):(this.map.un("pointermove",this.updateHoveredAnnotations),this.resetHoveredAnnotations())}}},undefined,undefined,!1,null,null,null).exports,kv={SINGLECLICK:"singleclick",CLICK:Ff,DBLCLICK:Mf,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};function Rv(t){return Math.pow(t,3)}function Lv(t){return 1-Rv(1-t)}function Fv(t){return 3*t*t-2*t*t*t}function Mv(t){return t}const Ov="active";function $v(t,e,i,n){e=t.constrainRotation(e,0),Dv(t,e,i,n)}function Dv(t,e,i,n){if(void 0!==e){var r=t.getRotation(),o=t.getCenter();void 0!==r&&o&&n>0?t.animate({rotation:e,anchor:i,duration:n,easing:Lv}):t.rotate(e,i)}}function jv(t,e,i,n){var r=t.getResolution(),o=t.constrainResolution(r,e,0);if(void 0!==o){var s=t.getResolutions();o=jg(o,t.getMinResolution()||s[s.length-1],t.getMaxResolution()||s[0])}if(i&&void 0!==o&&o!==r){var a=t.getCenter(),l=t.calculateCenterZoom(o,i);l=t.constrainCenter(l),i=[(o*a[0]-r*l[0])/(o-r),(o*a[1]-r*l[1])/(o-r)]}Nv(t,o,i,n)}function Nv(t,e,i,n){if(e){var r=t.getResolution(),o=t.getCenter();if(void 0!==r&&o&&e!==r&&n)t.animate({resolution:e,anchor:i,duration:n,easing:Lv});else{if(i){var s=t.calculateCenterZoom(e,i);t.setCenter(s)}t.setResolution(e)}}}const Bv=function(t){function e(e){t.call(this),e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getActive=function(){return this.get(Ov)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(Ov,t)},e.prototype.setMap=function(t){this.map_=t},e}(Yf);function Uv(t){for(var e=t.length,i=0,n=0,r=0;r<e;r++)i+=t[r].clientX,n+=t[r].clientY;return[i/e,n/e]}const zv=function(t){function e(e){var i=e||{};t.call(this,i),i.handleDownEvent&&(this.handleDownEvent=i.handleDownEvent),i.handleDragEvent&&(this.handleDragEvent=i.handleDragEvent),i.handleMoveEvent&&(this.handleMoveEvent=i.handleMoveEvent),i.handleUpEvent&&(this.handleUpEvent=i.handleUpEvent),i.stopDown&&(this.stopDown=i.stopDown),this.handlingDownUpSequence=!1,this.trackedPointers_={},this.targetPointers=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.pointerEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==kv.POINTERDRAG)this.handleDragEvent(t);else if(t.type==kv.POINTERUP){var i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==kv.POINTERDOWN){var n=this.handleDownEvent(t);n&&t.preventDefault(),this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==kv.POINTERMOVE&&this.handleMoveEvent(t);return!e},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){if(function(t){var e=t.type;return e===kv.POINTERDOWN||e===kv.POINTERDRAG||e===kv.POINTERUP}(t)){var e=t.pointerEvent,i=e.pointerId.toString();t.type==kv.POINTERUP?delete this.trackedPointers_[i]:(t.type==kv.POINTERDOWN||i in this.trackedPointers_)&&(this.trackedPointers_[i]=e),this.targetPointers=cf(this.trackedPointers_)}},e}(Bv);function Vv(t){return(Vv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gv(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function qv(t,e){return(qv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Wv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Xv(t);if(e){var r=Xv(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Kv(this,i)}}function Kv(t,e){return!e||"object"!==Vv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xv(t){return(Xv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}const Yv=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qv(t,e)}(o,t);var e,i,n,r=Wv(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,t)).on("change:active",e.toggleActive),e.features=void 0!==t.features?t.features:null,e.currentFeature=void 0,e.map=t.map,e}return e=o,(i=[{key:"toggleActive",value:function(t){if(t.oldValue){var e=this.map.getTargetElement();e&&(e.style.cursor="")}}},{key:"handleDownEvent",value:function(t){return this.currentFeature=this.featuresAtPixel(t.pixel,t.map),!!this.currentFeature}},{key:"handleUpEvent",value:function(){this.currentFeature&&this.currentFeature.get("annotation")&&this.dispatchEvent({type:"attach",feature:this.currentFeature}),this.currentFeature=void 0}},{key:"handleMoveEvent",value:function(t){var e=t.map.getTargetElement(),i=this.featuresAtPixel(t.pixel,t.map);e.style.cursor=i?"pointer":""}},{key:"featuresAtPixel",value:function(t,e){var i=null,n=e.forEachFeatureAtPixel(t,(function(t){return t}),this);return this.handlesFeature(n)&&(i=n),i}},{key:"handlesFeature",value:function(t){return!!this.features&&-1!==this.features.getArray().indexOf(t)}}])&&Gv(e.prototype,i),n&&Gv(e,n),o}(zv);var Hv,Zv;const Jv=Tl({computed:{isAttaching:function(){return"attach"===this.interactionMode},isSwapping:function(){return"swap"===this.interactionMode}},methods:{toggleAttaching:function(){this.isAttaching?this.resetInteractionMode():this.interactionMode="attach"},toggleSwapping:function(){this.isSwapping?this.resetInteractionMode():this.interactionMode="swap"},handleAttachLabel:function(t){this.$emit("attach",t.feature.get("annotation"),this.selectedLabel)},handleSwapLabel:function(t){this.$emit("swap",t.feature.get("annotation"),this.selectedLabel)}},watch:{isAttaching:function(t){this.canAdd&&(t&&!this.hasSelectedLabel?this.requireSelectedLabel():Hv.setActive(t))},isSwapping:function(t){this.canAdd&&(t&&!this.hasSelectedLabel?this.requireSelectedLabel():Zv.setActive(t))},selectedLabel:function(t){t||!this.isAttaching&&!this.isSwapping||this.resetInteractionMode()}},mounted:function(){this.canAdd&&((Hv=new Yv({features:this.annotationFeatures,map:this.map})).setActive(!1),Hv.on("attach",this.handleAttachLabel),this.map.addInteraction(Hv),(Zv=new Yv({features:this.annotationFeatures,map:this.map})).setActive(!1),Zv.on("attach",this.handleSwapLabel),this.map.addInteraction(Zv),Ll.on("l",this.toggleAttaching,0,this.listenerSet),Ll.on("Shift+l",this.toggleSwapping,0,this.listenerSet))}},undefined,undefined,!1,null,null,null).exports;const Qv=0,ty=1,ey=2,iy=3;const ny=function(t){function e(e,i,n,r){t.call(this),this.extent=e,this.pixelRatio_=n,this.resolution=i,this.state=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){this.dispatchEvent(kf)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return rf()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){rf()},e}(Pf);function ry(t,e,i,n){var r=Em(i,e,t),o=bm(e,n,i),s=e.getMetersPerUnit();void 0!==s&&(o*=s);var a=t.getMetersPerUnit();void 0!==a&&(o/=a);var l=t.getExtent();if(!l||Lp(l,r)){var u=bm(t,o,r)/o;isFinite(u)&&u>0&&(o/=u)}return o}function oy(t,e,i,n){var r=i-t,o=n-e,s=Math.sqrt(r*r+o*o);return[Math.round(i+r/s),Math.round(n+o/s)]}function sy(t,e,i,n,r,o,s,a,l,u,h){var c=hp(Math.round(i*t),Math.round(i*e));if(0===l.length)return c.canvas;c.scale(i,i);var d=[1/0,1/0,-1/0,-1/0];l.forEach((function(t,e,i){zp(d,t.extent)}));var f=rg(d),p=tg(d),g=hp(Math.round(i*f/n),Math.round(i*p/n)),m=i/n;l.forEach((function(t,e,i){var n=t.extent[0]-d[0],r=-(t.extent[3]-d[3]),o=rg(t.extent),s=tg(t.extent);g.drawImage(t.image,u,u,t.image.width-2*u,t.image.height-2*u,n*m,r*m,o*m,s*m)}));var v=ig(s);return a.getTriangles().forEach((function(t,e,r){var s=t.source,a=t.target,l=s[0][0],u=s[0][1],h=s[1][0],f=s[1][1],p=s[2][0],m=s[2][1],y=(a[0][0]-v[0])/o,_=-(a[0][1]-v[1])/o,b=(a[1][0]-v[0])/o,w=-(a[1][1]-v[1])/o,x=(a[2][0]-v[0])/o,S=-(a[2][1]-v[1])/o,C=l,T=u;l=0,u=0;var E=function(t){for(var e=t.length,i=0;i<e;i++){for(var n=i,r=Math.abs(t[i][i]),o=i+1;o<e;o++){var s=Math.abs(t[o][i]);s>r&&(r=s,n=o)}if(0===r)return null;var a=t[n];t[n]=t[i],t[i]=a;for(var l=i+1;l<e;l++)for(var u=-t[l][i]/t[i][i],h=i;h<e+1;h++)i==h?t[l][h]=0:t[l][h]+=u*t[i][h]}for(var c=new Array(e),d=e-1;d>=0;d--){c[d]=t[d][e]/t[d][d];for(var f=d-1;f>=0;f--)t[f][e]-=t[f][d]*c[d]}return c}([[h-=C,f-=T,0,0,b-y],[p-=C,m-=T,0,0,x-y],[0,0,h,f,w-_],[0,0,p,m,S-_]]);if(E){c.save(),c.beginPath();var I=(y+b+x)/3,A=(_+w+S)/3,P=oy(I,A,y,_),k=oy(I,A,b,w),R=oy(I,A,x,S);c.moveTo(k[0],k[1]),c.lineTo(P[0],P[1]),c.lineTo(R[0],R[1]),c.clip(),c.transform(E[0],E[2],E[1],E[3],y,_),c.translate(d[0]-C,d[3]-T),c.scale(n/i,-n/i),c.drawImage(g.canvas,0,0),c.restore()}})),h&&(c.save(),c.strokeStyle="black",c.lineWidth=1,a.getTriangles().forEach((function(t,e,i){var n=t.target,r=(n[0][0]-v[0])/o,s=-(n[0][1]-v[1])/o,a=(n[1][0]-v[0])/o,l=-(n[1][1]-v[1])/o,u=(n[2][0]-v[0])/o,h=-(n[2][1]-v[1])/o;c.beginPath(),c.moveTo(a,l),c.lineTo(r,s),c.lineTo(u,h),c.closePath(),c.stroke()})),c.restore()),c.canvas}var ay=function(t,e,i,n,r){this.sourceProj_=t,this.targetProj_=e;var o={},s=Tm(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return o[e]||(o[e]=s(t)),o[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&rg(n)==rg(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?rg(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?rg(this.targetProj_.getExtent()):null;var a=ig(i),l=ng(i),u=Hp(i),h=Yp(i),c=this.transformInv_(a),d=this.transformInv_(l),f=this.transformInv_(u),p=this.transformInv_(h);if(this.addQuad_(a,l,u,h,c,d,f,p,10),this.wrapsXInSource_){var g=1/0;this.triangles_.forEach((function(t,e,i){g=Math.min(g,t.source[0][0],t.source[1][0],t.source[2][0])})),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-g>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-g>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-g>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-g>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var i=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-i<this.sourceWorldWidth_/2&&(t.source=e)}}.bind(this))}o={}};ay.prototype.addTriangle_=function(t,e,i,n,r,o){this.triangles_.push({source:[n,r,o],target:[t,e,i]})},ay.prototype.addQuad_=function(t,e,i,n,r,o,s,a,l){var u=Ap([r,o,s,a]),h=this.sourceWorldWidth_?rg(u)/this.sourceWorldWidth_:null,c=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&h>.5&&h<1,f=!1;if(l>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_)f=rg(Ap([t,e,i,n]))/this.targetWorldWidth_>.25||f;!d&&this.sourceProj_.isGlobal()&&h&&(f=h>.25||f)}if(f||!this.maxSourceExtent_||og(u,this.maxSourceExtent_)){if(!(f||isFinite(r[0])&&isFinite(r[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1]))){if(!(l>0))return;f=!0}if(l>0){if(!f){var p,g=[(t[0]+i[0])/2,(t[1]+i[1])/2],m=this.transformInv_(g);if(d)p=(Vg(r[0],c)+Vg(s[0],c))/2-Vg(m[0],c);else p=(r[0]+s[0])/2-m[0];var v=(r[1]+s[1])/2-m[1];f=p*p+v*v>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){var y=[(e[0]+i[0])/2,(e[1]+i[1])/2],_=this.transformInv_(y),b=[(n[0]+t[0])/2,(n[1]+t[1])/2],w=this.transformInv_(b);this.addQuad_(t,e,y,b,r,o,_,w,l-1),this.addQuad_(b,y,i,n,w,_,s,a,l-1)}else{var x=[(t[0]+e[0])/2,(t[1]+e[1])/2],S=this.transformInv_(x),C=[(i[0]+n[0])/2,(i[1]+n[1])/2],T=this.transformInv_(C);this.addQuad_(t,x,C,n,r,S,T,a,l-1),this.addQuad_(x,e,i,C,S,o,s,T,l-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(t,i,n,r,s,a),this.addTriangle_(t,e,i,r,o,s)}},ay.prototype.calculateSourceExtent=function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,i,n){var r=e.source;Vp(t,r[0]),Vp(t,r[1]),Vp(t,r[2])})),t},ay.prototype.getTriangles=function(){return this.triangles_};const ly=ay;const uy=function(t){function e(e,i,n,r,o,s){var a=e.getExtent(),l=i.getExtent(),u=l?eg(n,l):n,h=ry(e,i,Zp(u),r),c=new ly(e,i,u,a,.5*h),d=s(c.calculateSourceExtent(),h,o),f=ey;d&&(f=Qv);var p=d?d.getPixelRatio():1;t.call(this,n,r,p,f),this.targetProj_=i,this.maxSourceExtent_=a,this.triangulation_=c,this.targetResolution_=r,this.targetExtent_=n,this.sourceImage_=d,this.sourcePixelRatio_=p,this.canvas_=null,this.sourceListenerKey_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==ty&&this.unlistenSource_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.getProjection=function(){return this.targetProj_},e.prototype.reproject_=function(){var t=this.sourceImage_.getState();if(t==ey){var e=rg(this.targetExtent_)/this.targetResolution_,i=tg(this.targetExtent_)/this.targetResolution_;this.canvas_=sy(e,i,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=t,this.changed()},e.prototype.load=function(){if(this.state==Qv){this.state=ty,this.changed();var t=this.sourceImage_.getState();t==ey||t==iy?this.reproject_():(this.sourceListenerKey_=vf(this.sourceImage_,kf,(function(t){var e=this.sourceImage_.getState();e!=ey&&e!=iy||(this.unlistenSource_(),this.reproject_())}),this),this.sourceImage_.load())}},e.prototype.unlistenSource_=function(){bf(this.sourceListenerKey_),this.sourceListenerKey_=null},e}(ny),hy="undefined",cy="ready";function dy(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}const fy=function(t){function e(e){t.call(this),this.projection_=_m(e.projection),this.attributions_=dy(e.attributions),this.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,this.loading=!1,this.state_=void 0!==e.state?e.state:cy,this.wrapX_=void 0!==e.wrapX&&e.wrapX}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolutions=function(){return rf()},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=dy(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(Yf);var py="imageloadstart",gy="imageloadend",my="imageloaderror",vy=function(t){function e(e,i){t.call(this,e),this.image=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Af);const yy=function(t){function e(e){t.call(this,{attributions:e.attributions,projection:e.projection,state:e.state}),this.resolutions_=void 0!==e.resolutions?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.findNearestResolution=function(t){if(this.resolutions_){var e=yg(this.resolutions_,t,0);t=this.resolutions_[e]}return t},e.prototype.getImage=function(t,e,i,n){var r=this.getProjection();if(r&&n&&!Sm(r,n)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Sm(this.reprojectedImage_.getProjection(),n)&&this.reprojectedImage_.getResolution()==e&&Up(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new uy(r,n,t,e,i,function(t,e,i){return this.getImageInternal(t,e,i,r)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return r&&(n=r),this.getImageInternal(t,e,i,n)},e.prototype.getImageInternal=function(t,e,i,n){return rf()},e.prototype.handleImageChange=function(t){var e=t.target;switch(e.getState()){case ty:this.loading=!0,this.dispatchEvent(new vy(py,e));break;case ey:this.loading=!1,this.dispatchEvent(new vy(gy,e));break;case iy:this.loading=!1,this.dispatchEvent(new vy(my,e))}},e}(fy);const _y=function(t){function e(e,i,n,r,o){var s=void 0!==o?Qv:ey;void 0===i&&(i=tg(e)/r.height),t.call(this,e,i,n,s),this.loader_=void 0!==o?o:null,this.canvas_=r,this.error_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getError=function(){return this.error_},e.prototype.handleLoad_=function(t){t?(this.error_=t,this.state=iy):this.state=ey,this.changed()},e.prototype.load=function(){this.state==Qv&&(this.state=ty,this.changed(),this.loader_(this.handleLoad_.bind(this)))},e.prototype.getImage=function(){return this.canvas_},e}(ny);const by=function(t){function e(e){t.call(this,{attributions:e.attributions,projection:e.projection,resolutions:e.resolutions,state:e.state}),this.canvas_=new _y(e.canvasExtent,void 0,1,e.canvas),this.canvasSize_=e.canvasSize?e.canvasSize:null,vf(this.canvas_,kf,this.handleImageChange,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getImageInternal=function(t,e,i,n){return og(t,this.canvas_.getExtent())?this.canvas_:null},e}(yy),wy="add",xy="remove";var Sy="length",Cy=function(t){function e(e,i){t.call(this,e),this.element=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Af);const Ty=function(t){function e(e,i){t.call(this);var n=i||{};if(this.unique_=!!n.unique,this.array_=e||[],this.unique_)for(var r=0,o=this.array_.length;r<o;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,i=t.length;e<i;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)t(e[i],i,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(Sy)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Cy(wy,e))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Cy(xy,e)),e},e.prototype.setAt=function(t,e){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Cy(xy,n)),this.dispatchEvent(new Cy(wy,e))}else{for(var r=i;r<t;++r)this.insertAt(r,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(Sy,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new mp(58)},e}(Yf);const Ey=Tl({props:{title:{type:String,default:""},icon:{type:String,required:!0},active:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},hover:{type:Boolean,default:!0},open:{type:Boolean,default:!1}},data:function(){return{mouseOver:!1,timeout:null,activeSubControls:0}},computed:{classObject:function(){return{active:this.active,"control-button--open":this.showSubControls}},iconClass:function(){return this.icon.startsWith("fa-")?"fa fa-fw "+this.icon:"icon icon-white "+this.icon},hasSubControls:function(){return this.$slots.hasOwnProperty("default")},showSubControls:function(){return this.mouseOver||this.hasActiveSubControl||this.open},hasActiveSubControl:function(){return this.activeSubControls>0}},methods:{handleClick:function(){this.disabled||this.$emit("click")},handleMouseEnter:function(){!this.disabled&&this.hover&&(this.mouseOver=!0),window.clearTimeout(this.timeout)},handleMouseLeave:function(){var t=this;window.clearTimeout(this.timeout),this.timeout=window.setTimeout((function(){t.mouseOver=!1}),200)},updateActiveSubControls:function(t){t?this.activeSubControls+=1:this.activeSubControls=Math.max(0,this.activeSubControls-1)}},watch:{active:function(t){this.$parent.$emit("control-button-active",t)}},created:function(){this.$on("control-button-active",this.updateActiveSubControls)},mounted:function(){this.active&&this.$parent.$emit("control-button-active",!0)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"control-button btn",class:t.classObject,attrs:{title:t.title,disabled:t.disabled},on:{click:t.handleClick,mouseenter:t.handleMouseEnter,mouseleave:t.handleMouseLeave}},[i("i",{class:t.iconClass,attrs:{"aria-hidden":"true"}}),t._v(" "),t.hasSubControls?i("span",{staticClass:"control-button__sub-controls btn-group",on:{click:function(t){t.stopPropagation()}}},[t._t("default")],2):t._e()])}),[],!1,null,null,null).exports;const Iy=function(t){function e(e){if(t.call(this),this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,vf(this,Xf(this.geometryName_),this.handleGeometryChanged_,this),e)if("function"==typeof e.getSimplifiedGeometry){var i=e;this.setGeometry(i)}else{var n=e;this.setProperties(n)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e(this.getProperties());t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var n=this.getStyle();return n&&t.setStyle(n),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(bf(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=vf(t,kf,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;var e;Array.isArray(t)?e=t:(vp("function"==typeof t.getZIndex,41),e=[t]);return function(){return e}}(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){_f(this,Xf(this.geometryName_),this.handleGeometryChanged_,this),this.geometryName_=t,vf(this,Xf(this.geometryName_),this.handleGeometryChanged_,this),this.handleGeometryChanged_()},e}(Yf);const Ay=function(t){function e(e,i,n){t.call(this,e),this.map=i,this.frameState=void 0!==n?n:null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Af);const Py=function(t){function e(e,i,n,r,o){t.call(this,e,i,o),this.originalEvent=n,this.pixel=i.getEventPixel(n),this.coordinate=i.getCoordinateFromPixel(this.pixel),this.dragging=void 0!==r&&r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},e}(Ay);const ky=function(t){function e(e,i,n,r,o){t.call(this,e,i,n.originalEvent,r,o),this.pointerEvent=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Py);function Ry(t,e){return t[0]+=e[0],t[1]+=e[1],t}function Ly(t,e){var i,n,r=t[0],o=t[1],s=e[0],a=e[1],l=s[0],u=s[1],h=a[0],c=a[1],d=h-l,f=c-u,p=0===d&&0===f?0:(d*(r-l)+f*(o-u))/(d*d+f*f||0);return p<=0?(i=l,n=u):p>=1?(i=h,n=c):(i=l+p*d,n=u+p*f),[i,n]}function Fy(t,e){for(var i=!0,n=t.length-1;n>=0;--n)if(t[n]!=e[n]){i=!1;break}return i}function My(t,e){var i=Math.cos(e),n=Math.sin(e),r=t[0]*i-t[1]*n,o=t[1]*i+t[0]*n;return t[0]=r,t[1]=o,t}function Oy(t,e){return t[0]*=e,t[1]*=e,t}function $y(t,e){var i=t[0]-e[0],n=t[1]-e[1];return i*i+n*n}function Dy(t,e){return Math.sqrt($y(t,e))}var jy="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",Ny=-1!==jy.indexOf("firefox"),By=-1!==jy.indexOf("safari")&&-1==jy.indexOf("chrom"),Uy=-1!==jy.indexOf("webkit")&&-1==jy.indexOf("edge"),zy=-1!==jy.indexOf("macintosh"),Vy=window.devicePixelRatio||1,Gy=function(){var t=!1;try{t=!!document.createElement("canvas").getContext("2d").setLineDash}catch(t){}return t}(),qy=(navigator,"ontouchstart"in window),Wy="PointerEvent"in window,Ky=!!navigator.msPointerEnabled,Xy=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Yy=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Hy=function(t){return t.target.getTargetElement()===document.activeElement},Zy=Sf,Jy=function(t){return t.type==kv.CLICK},Qy=function(t){var e=t.originalEvent;return 0==e.button&&!(Uy&&zy&&e.ctrlKey)},t_=Cf,e_=function(t){return t.type==kv.SINGLECLICK},i_=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},n_=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},r_=function(t){var e=t.originalEvent.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e},o_=function(t){var e=t.pointerEvent;return vp(void 0!==e,56),"mouse"==e.pointerType},s_=function(t){var e=t.pointerEvent;return vp(void 0!==e,56),e.isPrimary&&0===e.button};const a_=function(t){function e(e,i,n){if(t.call(this),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,i);else if(void 0!==i&&n)this.setFlatCoordinates(i,e),this.ends_=n;else{for(var r=this.getLayout(),o=e,s=[],a=[],l=0,u=o.length;l<u;++l){var h=o[l];0===l&&(r=h.getLayout()),bg(s,h.getFlatCoordinates()),a.push(s.length)}this.setFlatCoordinates(r,s),this.ends_=a}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendLineString=function(t){this.flatCoordinates?bg(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,n){return n<Rp(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Vm(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),qm(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))},e.prototype.getCoordinateAtM=function(t,e,i){if(this.layout!=Cg&&this.layout!=Tg||0===this.flatCoordinates.length)return null;var n=void 0!==e&&e,r=void 0!==i&&i;return function(t,e,i,n,r,o,s){if(s)return Tv(t,e,i[i.length-1],n,r,o);var a;if(r<t[n-1])return o?((a=t.slice(0,n))[n-1]=r,a):null;if(t[t.length-1]<r)return o?((a=t.slice(t.length-n))[n-1]=r,a):null;for(var l=0,u=i.length;l<u;++l){var h=i[l];if(e!=h){if(r<t[e+n-1])return null;if(r<=t[h-1])return Tv(t,e,h,n,r,!1);e=h}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,n,r)},e.prototype.getCoordinates=function(){return Hm(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new Iv(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[],r=0,o=0,s=e.length;o<s;++o){var a=e[o],l=new Iv(t.slice(r,a),i);n.push(l),r=a}return n},e.prototype.getFlatMidpoints=function(){for(var t=[],e=this.flatCoordinates,i=0,n=this.ends_,r=this.stride,o=0,s=n.length;o<s;++o){var a=n[o];bg(t,Cv(e,i,a,r,.5)),i=a}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=Qm(this.flatCoordinates,0,this.ends_,this.stride,t,i,0,n),new e(i,xg,n)},e.prototype.getType=function(){return Rg},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){if(cv(t,e,i[o],n,r))return!0;e=i[o]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=Xm(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(jm);const l_=function(t){function e(e,i){t.call(this),i&&!Array.isArray(e[0])?this.setFlatCoordinates(i,e):this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendPoint=function(t){this.flatCoordinates?bg(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){if(n<Rp(this.getExtent(),t,e))return n;for(var r=this.flatCoordinates,o=this.stride,s=0,a=r.length;s<a;s+=o){var l=Ug(t,e,r[s],r[s+1]);if(l<n){n=l;for(var u=0;u<o;++u)i[u]=r[s+u];i.length=o}}return n},e.prototype.getCoordinates=function(){return Ym(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getPoint=function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new ov(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},e.prototype.getPoints=function(){for(var t=this.flatCoordinates,e=this.layout,i=this.stride,n=[],r=0,o=t.length;r<o;r+=i){var s=new ov(t.slice(r,r+i),e);n.push(s)}return n},e.prototype.getType=function(){return kg},e.prototype.intersectsExtent=function(t){for(var e=this.flatCoordinates,i=this.stride,n=0,r=e.length;n<r;n+=i){if(Mp(t,e[n],e[n+1]))return!0}return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Km(this.flatCoordinates,0,t,this.stride),this.changed()},e}(jm);const u_=function(t){function e(e,i,n){if(t.call(this),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!n&&!Array.isArray(e[0])){for(var r=this.getLayout(),o=e,s=[],a=[],l=0,u=o.length;l<u;++l){var h=o[l];0===l&&(r=h.getLayout());for(var c=s.length,d=h.getEnds(),f=0,p=d.length;f<p;++f)d[f]+=c;bg(s,h.getFlatCoordinates()),a.push(d)}i=r,e=s,n=a}void 0!==i&&n?(this.setFlatCoordinates(i,e),this.endss_=n):this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendPolygon=function(t){var e;if(this.flatCoordinates){var i=this.flatCoordinates.length;bg(this.flatCoordinates,t.getFlatCoordinates());for(var n=0,r=(e=t.getEnds().slice()).length;n<r;++n)e[n]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()},e.prototype.clone=function(){for(var t=this.endss_.length,i=new Array(t),n=0;n<t;++n)i[n]=this.endss_[n].slice();return new e(this.flatCoordinates.slice(),this.layout,i)},e.prototype.closestPointXY=function(t,e,i,n){return n<Rp(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];r=Vm(t,e,a,n,r),e=a[a.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,i,n,r,o,s,a,l,u,h){for(var c=h||[NaN,NaN],d=0,f=i.length;d<f;++d){var p=i[d];u=qm(t,e,p,n,r,o,s,a,l,u,c),e=p[p.length-1]}return u}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return function(t,e,i,n,r,o){if(0===i.length)return!1;for(var s=0,a=i.length;s<a;++s){var l=i[s];if(lv(t,e,l,n,r,o))return!0;e=l[l.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},e.prototype.getArea=function(){return function(t,e,i,n){for(var r=0,o=0,s=i.length;o<s;++o){var a=i[o];r+=Bm(t,e,a,n),e=a[a.length-1]}return r}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?vv(e=this.getOrientedFlatCoordinates().slice(),0,this.endss_,this.stride,t):e=this.flatCoordinates,Zm(e,0,this.endss_,this.stride)},e.prototype.getEndss=function(){return this.endss_},e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=function(t,e,i,n){for(var r=[],o=[1/0,1/0,-1/0,-1/0],s=0,a=i.length;s<a;++s){var l=i[s];o=Bp(t,e,l[0],n),r.push((o[0]+o[2])/2,(o[1]+o[3])/2),e=l[l.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=function(t,e,i,n,r){for(var o=[],s=0,a=i.length;s<a;++s){var l=i[s];o=uv(t,e,l,n,r,2*s,o),e=l[l.length-1]}return o}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},e.prototype.getInteriorPoints=function(){return new l_(this.getFlatInteriorPoints().slice(),Cg)},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o)if(!gv(t,e,i[o],n,r))return!1;return!0}(t,0,this.endss_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=vv(this.orientedFlatCoordinates_,0,this.endss_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=function(t,e,i,n,r,o,s,a){for(var l=0,u=i.length;l<u;++l){var h=i[l],c=[];s=iv(t,e,h,n,r,o,s,c),a.push(c),e=h[h.length-1]}return s}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),i,0,n),new e(i,xg,n)},e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var i=this.endss_[t-1];e=i[i.length-1]}var n=this.endss_[t].slice(),r=n[n.length-1];if(0!==e)for(var o=0,s=n.length;o<s;++o)n[o]-=e;return new _v(this.flatCoordinates.slice(e,r),this.layout,n)},e.prototype.getPolygons=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[],r=0,o=0,s=i.length;o<s;++o){var a=i[o].slice(),l=a[a.length-1];if(0!==r)for(var u=0,h=a.length;u<h;++u)a[u]-=r;var c=new _v(e.slice(r,l),t,a);n.push(c),r=l}return n},e.prototype.getType=function(){return Lg},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];if(dv(t,e,a,n,r))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=function(t,e,i,n,r){for(var o=r||[],s=0,a=0,l=i.length;a<l;++a){var u=Xm(t,e,i[a],n,o[s]);o[s++]=u,e=u[u.length-1]}return o.length=s,o}(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{var n=i[i.length-1];this.flatCoordinates.length=0===n.length?0:n[n.length-1]}this.changed()},e}(jm);var h_=function(t,e){this.dispatcher=t,this.mapping_=e};h_.prototype.getEvents=function(){return Object.keys(this.mapping_)},h_.prototype.getHandlerForEvent=function(t){return this.mapping_[t]};const c_=h_;var d_="mouse";function f_(t){if(!this.isEventSimulatedFromTouch_(t)){1..toString()in this.pointerMap&&this.cancel(t);var e=y_(t,this.dispatcher);this.pointerMap[1..toString()]=t,this.dispatcher.down(e,t)}}function p_(t){if(!this.isEventSimulatedFromTouch_(t)){var e=y_(t,this.dispatcher);this.dispatcher.move(e,t)}}function g_(t){if(!this.isEventSimulatedFromTouch_(t)){var e=this.pointerMap[1..toString()];if(e&&e.button===t.button){var i=y_(t,this.dispatcher);this.dispatcher.up(i,t),this.cleanupMouse()}}}function m_(t){if(!this.isEventSimulatedFromTouch_(t)){var e=y_(t,this.dispatcher);this.dispatcher.enterOver(e,t)}}function v_(t){if(!this.isEventSimulatedFromTouch_(t)){var e=y_(t,this.dispatcher);this.dispatcher.leaveOut(e,t)}}function y_(t,e){var i=e.cloneEvent(t,t),n=i.preventDefault;return i.preventDefault=function(){t.preventDefault(),n()},i.pointerId=1,i.isPrimary=!0,i.pointerType=d_,i}const __=function(t){function e(e){var i={mousedown:f_,mousemove:p_,mouseup:g_,mouseover:m_,mouseout:v_};t.call(this,e,i),this.pointerMap=e.pointerMap,this.lastTouches=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isEventSimulatedFromTouch_=function(t){for(var e=this.lastTouches,i=t.clientX,n=t.clientY,r=0,o=e.length,s=void 0;r<o&&(s=e[r]);r++){var a=Math.abs(i-s[0]),l=Math.abs(n-s[1]);if(a<=25&&l<=25)return!0}return!1},e.prototype.cancel=function(t){var e=y_(t,this.dispatcher);this.dispatcher.cancel(e,t),this.cleanupMouse()},e.prototype.cleanupMouse=function(){delete this.pointerMap[1..toString()]},e}(c_),b_="IMAGE",w_="TILE",x_="VECTOR_TILE",S_="VECTOR",C_="opacity",T_="visible",E_="extent",I_="zIndex",A_="maxResolution",P_="minResolution",k_="source";const R_=function(t){function e(e){t.call(this);var i=uf({},e);i[C_]=void 0!==e.opacity?e.opacity:1,i[T_]=void 0===e.visible||e.visible,i[I_]=e.zIndex,i[A_]=void 0!==e.maxResolution?e.maxResolution:1/0,i[P_]=void 0!==e.minResolution?e.minResolution:0,this.setProperties(i),this.state_=null,this.type}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return this.type},e.prototype.getLayerState=function(){var t=this.state_||{layer:this,managed:!0};return t.opacity=jg(this.getOpacity(),0,1),t.sourceState=this.getSourceState(),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=this.getZIndex()||0,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),this.state_=t,t},e.prototype.getLayersArray=function(t){return rf()},e.prototype.getLayerStatesArray=function(t){return rf()},e.prototype.getExtent=function(){return this.get(E_)},e.prototype.getMaxResolution=function(){return this.get(A_)},e.prototype.getMinResolution=function(){return this.get(P_)},e.prototype.getOpacity=function(){return this.get(C_)},e.prototype.getSourceState=function(){return rf()},e.prototype.getVisible=function(){return this.get(T_)},e.prototype.getZIndex=function(){return this.get(I_)},e.prototype.setExtent=function(t){this.set(E_,t)},e.prototype.setMaxResolution=function(t){this.set(A_,t)},e.prototype.setMinResolution=function(t){this.set(P_,t)},e.prototype.setOpacity=function(t){this.set(C_,t)},e.prototype.setVisible=function(t){this.set(T_,t)},e.prototype.setZIndex=function(t){this.set(I_,t)},e}(Yf),L_="postcompose",F_="precompose",M_="render",O_="rendercomplete";function $_(t,e){return t.visible&&e>=t.minResolution&&e<t.maxResolution}const D_=function(t){function e(e){var i=uf({},e);delete i.source,t.call(this,i),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,e.map&&this.setMap(e.map),vf(this,Xf(k_),this.handleSourcePropertyChange_,this);var n=e.source?e.source:null;this.setSource(n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(k_)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():hy},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(bf(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=vf(t,kf,this.handleSourceChange_,this)),this.changed()},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(bf(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(bf(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=vf(t,F_,(function(t){var e=t,i=this.getLayerState();i.managed=!1,void 0===this.getZIndex()&&(i.zIndex=1/0),e.frameState.layerStatesArray.push(i),e.frameState.layerStates[sf(this)]=i}),this),this.mapRenderKey_=vf(this,kf,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(k_,t)},e}(R_),j_="image",N_="vector";var B_=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,U_=/^([a-z]*)$/i;function z_(t){return"string"==typeof t?t:G_(t)}!function(){var t={},e=0}();function V_(t){return t[0]=jg(t[0]+.5|0,0,255),t[1]=jg(t[1]+.5|0,0,255),t[2]=jg(t[2]+.5|0,0,255),t[3]=jg(t[3],0,1),t}function G_(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var i=t[1];i!=(0|i)&&(i=i+.5|0);var n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:t[3])+")"}function q_(t){return Array.isArray(t)?G_(t):t}const W_=function(t){function e(e){t.call(this),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},e.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(Rf)},e.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},e.prototype.forEach=function(t,e){for(var i=this.oldest_;i;)t.call(e,i.value_,i.key_,this),i=i.newer},e.prototype.get=function(t){var e=this.entries_[t];return vp(void 0!==e,15),e===this.newest_||(e===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(e.newer.older=e.older,e.older.newer=e.newer),e.newer=null,e.older=this.newest_,this.newest_.newer=e,this.newest_=e),e.value_},e.prototype.remove=function(t){var e=this.entries_[t];return vp(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},e.prototype.getCount=function(){return this.count_},e.prototype.getKeys=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.key_;return e},e.prototype.getValues=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.value_;return e},e.prototype.peekLast=function(){return this.oldest_.value_},e.prototype.peekLastKey=function(){return this.oldest_.key_},e.prototype.peekFirstKey=function(){return this.newest_.key_},e.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},e.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},e.prototype.set=function(t,e){vp(!(t in this.entries_),16);var i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_},e.prototype.setSize=function(t){this.highWaterMark=t},e.prototype.prune=function(){for(;this.canExpireCache();)this.pop()},e}(Pf);var K_="10px sans-serif",X_=[0,0,0,1],Y_="round",H_=[],Z_="round",J_=[0,0,0,1],Q_="center",tb="middle",eb=[0,0,0,0],ib=new W_,nb={},rb=null,ob={},sb=function(){var t,e,i=nb,n="32px ",r=["monospace","serif"],o=r.length,s="wmytzilWMYTZIL@#/&?$%10";function a(t){for(var i=ab(),a=100;a<=700;a+=300){for(var l=a+" ",u=!0,h=0;h<o;++h){var c=r[h];if(i.font=l+n+c,e=i.measureText(s).width,t!=c){i.font=l+n+t+","+c;var d=i.measureText(s).width;u=u&&d!=e}}if(u)return!0}return!1}function l(){var e=!0;for(var n in i)i[n]<60&&(a(n)?(i[n]=60,hf(ob),rb=null,ib.clear()):(++i[n],e=!1));e&&(clearInterval(t),t=void 0)}return function(e){var n=up(e);if(n)for(var r=0,o=n.length;r<o;++r){var s=n[r];s in i||(i[s]=60,a(s)||(i[s]=0,void 0===t&&(t=setInterval(l,32))))}}}();function ab(){return rb||(rb=hp(1,1)),rb}var lb,ub,hb=(ub=ob,function(t){var e=ub[t];return null==e&&(lb||((lb=document.createElement("span")).textContent="M",lb.style.margin=lb.style.padding="0 !important",lb.style.position="absolute !important",lb.style.left="-99999px !important"),lb.style.font=t,document.body.appendChild(lb),e=ub[t]=lb.offsetHeight,document.body.removeChild(lb)),e});function cb(t,e){var i=ab();return t!=i.font&&(i.font=t),i.measureText(e).width}function db(t,e,i,n){0!==e&&(t.translate(i,n),t.rotate(e),t.translate(-i,-n))}var fb=[1,0,0,1,0,0];function pb(t,e,i,n,r,o,s,a,l,u,h){var c;1!=i&&(c=t.globalAlpha,t.globalAlpha=c*i),e&&t.setTransform.apply(t,e),t.drawImage(n,r,o,s,a,l,u,s*h,a*h),c&&(t.globalAlpha=c),e&&t.setTransform.apply(t,fb)}var gb=function(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale};gb.prototype.clone=function(){return new gb({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},gb.prototype.getOpacity=function(){return this.opacity_},gb.prototype.getRotateWithView=function(){return this.rotateWithView_},gb.prototype.getRotation=function(){return this.rotation_},gb.prototype.getScale=function(){return this.scale_},gb.prototype.getSnapToPixel=function(){return!1},gb.prototype.getAnchor=function(){return rf()},gb.prototype.getImage=function(t){return rf()},gb.prototype.getHitDetectionImage=function(t){return rf()},gb.prototype.getImageState=function(){return rf()},gb.prototype.getImageSize=function(){return rf()},gb.prototype.getHitDetectionImageSize=function(){return rf()},gb.prototype.getOrigin=function(){return rf()},gb.prototype.getSize=function(){return rf()},gb.prototype.setOpacity=function(t){this.opacity_=t},gb.prototype.setRotateWithView=function(t){this.rotateWithView_=t},gb.prototype.setRotation=function(t){this.rotation_=t},gb.prototype.setScale=function(t){this.scale_=t},gb.prototype.setSnapToPixel=function(t){},gb.prototype.listenImageChange=function(t,e){return rf()},gb.prototype.load=function(){rf()},gb.prototype.unlistenImageChange=function(t,e){rf()};const mb=function(t){function e(e){var i=void 0!==e.rotateWithView&&e.rotateWithView;t.call(this,{opacity:1,rotateWithView:i,rotation:void 0!==e.rotation?e.rotation:0,scale:1}),this.checksums_=null,this.canvas_=null,this.hitDetectionCanvas_=null,this.fill_=void 0!==e.fill?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius_=void 0!==e.radius?e.radius:e.radius1,this.radius2_=e.radius2,this.angle_=void 0!==e.angle?e.angle:0,this.stroke_=void 0!==e.stroke?e.stroke:null,this.anchor_=null,this.size_=null,this.imageSize_=null,this.hitDetectionImageSize_=null,this.atlasManager_=e.atlasManager,this.render_(this.atlasManager_)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},e.prototype.getImage=function(t){return this.canvas_},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return ey},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t,e){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t,e){},e.prototype.render_=function(t){var e,i,n="",r="",o=0,s=null,a=0,l=0;this.stroke_&&(null===(i=this.stroke_.getColor())&&(i=J_),i=q_(i),void 0===(l=this.stroke_.getWidth())&&(l=1),s=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset(),Gy||(s=null,a=0),void 0===(r=this.stroke_.getLineJoin())&&(r=Z_),void 0===(n=this.stroke_.getLineCap())&&(n=Y_),void 0===(o=this.stroke_.getMiterLimit())&&(o=10));var u=2*(this.radius_+l)+1,h={strokeStyle:i,strokeWidth:l,size:u,lineCap:n,lineDash:s,lineDashOffset:a,lineJoin:r,miterLimit:o};if(void 0===t){var c=hp(u,u);this.canvas_=c.canvas,e=u=this.canvas_.width,this.draw_(h,c,0,0),this.createHitDetectionCanvas_(h)}else{u=Math.round(u);var d,f=!this.fill_;f&&(d=this.drawHitDetectionCanvas_.bind(this,h));var p=this.getChecksum(),g=t.add(p,u,u,this.draw_.bind(this,h),d);this.canvas_=g.image,this.origin_=[g.offsetX,g.offsetY],e=g.image.width,f?(this.hitDetectionCanvas_=g.hitImage,this.hitDetectionImageSize_=[g.hitImage.width,g.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[e,e])}this.anchor_=[u/2,u/2],this.size_=[u,u],this.imageSize_=[e,e]},e.prototype.draw_=function(t,e,i,n){var r,o,s;e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var a=this.points_;if(a===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var l=void 0!==this.radius2_?this.radius2_:this.radius_;for(l!==this.radius_&&(a*=2),r=0;r<=a;r++)o=2*r*Math.PI/a-Math.PI/2+this.angle_,s=r%2==0?this.radius_:l,e.lineTo(t.size/2+s*Math.cos(o),t.size/2+s*Math.sin(o))}if(this.fill_){var u=this.fill_.getColor();null===u&&(u=X_),e.fillStyle=q_(u),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.fill_)this.hitDetectionCanvas_=this.canvas_;else{var e=hp(t.size,t.size);this.hitDetectionCanvas_=e.canvas,this.drawHitDetectionCanvas_(t,e,0,0)}},e.prototype.drawHitDetectionCanvas_=function(t,e,i,n){e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var r=this.points_;if(r===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var o,s,a,l=void 0!==this.radius2_?this.radius2_:this.radius_;for(l!==this.radius_&&(r*=2),o=0;o<=r;o++)a=2*o*Math.PI/r-Math.PI/2+this.angle_,s=o%2==0?this.radius_:l,e.lineTo(t.size/2+s*Math.cos(a),t.size/2+s*Math.sin(a))}e.fillStyle=z_(X_),e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e.prototype.getChecksum=function(){var t=this.stroke_?this.stroke_.getChecksum():"-",e=this.fill_?this.fill_.getChecksum():"-";if(!this.checksums_||t!=this.checksums_[1]||e!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6]){var i="r"+t+e+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[i,t,e,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]},e}(gb);const vb=function(t){function e(e){var i=e||{};t.call(this,{points:1/0,fill:i.fill,radius:i.radius,stroke:i.stroke,atlasManager:i.atlasManager})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render_(this.atlasManager_)},e}(mb);var yb=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.checksum_=void 0};yb.prototype.clone=function(){var t=this.getColor();return new yb({color:Array.isArray(t)?t.slice():t||void 0})},yb.prototype.getColor=function(){return this.color_},yb.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},yb.prototype.getChecksum=function(){if(void 0===this.checksum_){var t=this.color_;t?Array.isArray(t)||"string"==typeof t?this.checksum_="f"+z_(t):this.checksum_=sf(this.color_):this.checksum_="f-"}return this.checksum_};const _b=yb;var bb=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width,this.checksum_=void 0};bb.prototype.clone=function(){var t=this.getColor();return new bb({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},bb.prototype.getColor=function(){return this.color_},bb.prototype.getLineCap=function(){return this.lineCap_},bb.prototype.getLineDash=function(){return this.lineDash_},bb.prototype.getLineDashOffset=function(){return this.lineDashOffset_},bb.prototype.getLineJoin=function(){return this.lineJoin_},bb.prototype.getMiterLimit=function(){return this.miterLimit_},bb.prototype.getWidth=function(){return this.width_},bb.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},bb.prototype.setLineCap=function(t){this.lineCap_=t,this.checksum_=void 0},bb.prototype.setLineDash=function(t){this.lineDash_=t,this.checksum_=void 0},bb.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t,this.checksum_=void 0},bb.prototype.setLineJoin=function(t){this.lineJoin_=t,this.checksum_=void 0},bb.prototype.setMiterLimit=function(t){this.miterLimit_=t,this.checksum_=void 0},bb.prototype.setWidth=function(t){this.width_=t,this.checksum_=void 0},bb.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.color_?"string"==typeof this.color_?this.checksum_+=this.color_:this.checksum_+=sf(this.color_):this.checksum_+="-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_};const wb=bb;var xb=function(t){var e=t||{};this.geometry_=null,this.geometryFunction_=Eb,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex};xb.prototype.clone=function(){var t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new xb({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},xb.prototype.getRenderer=function(){return this.renderer_},xb.prototype.setRenderer=function(t){this.renderer_=t},xb.prototype.getGeometry=function(){return this.geometry_},xb.prototype.getGeometryFunction=function(){return this.geometryFunction_},xb.prototype.getFill=function(){return this.fill_},xb.prototype.setFill=function(t){this.fill_=t},xb.prototype.getImage=function(){return this.image_},xb.prototype.setImage=function(t){this.image_=t},xb.prototype.getStroke=function(){return this.stroke_},xb.prototype.setStroke=function(t){this.stroke_=t},xb.prototype.getText=function(){return this.text_},xb.prototype.setText=function(t){this.text_=t},xb.prototype.getZIndex=function(){return this.zIndex_},xb.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Eb,this.geometry_=t},xb.prototype.setZIndex=function(t){this.zIndex_=t};var Sb=null;function Cb(t,e){if(!Sb){var i=new _b({color:"rgba(255,255,255,0.4)"}),n=new wb({color:"#3399CC",width:1.25});Sb=[new xb({image:new vb({fill:i,stroke:n,radius:5}),fill:i,stroke:n})]}return Sb}function Tb(){var t={},e=[255,255,255,1],i=[0,153,255,1];return t[Pg]=[new xb({fill:new _b({color:[255,255,255,.5]})})],t[Lg]=t[Pg],t[Ig]=[new xb({stroke:new wb({color:e,width:5})}),new xb({stroke:new wb({color:i,width:3})})],t[Rg]=t[Ig],t[Mg]=t[Pg].concat(t[Ig]),t[Eg]=[new xb({image:new vb({radius:6,fill:new _b({color:i}),stroke:new wb({color:e,width:1.5})}),zIndex:1/0})],t[kg]=t[Eg],t[Fg]=t[Pg].concat(t[Ig],t[Eg]),t}function Eb(t){return t.getGeometry()}const Ib=xb;var Ab="renderOrder",Pb=function(t){function e(e){var i=e||{},n=uf({},i);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,t.call(this,n),this.declutter_=void 0!==i.declutter&&i.declutter,this.renderBuffer_=void 0!==i.renderBuffer?i.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(i.style),this.updateWhileAnimating_=void 0!==i.updateWhileAnimating&&i.updateWhileAnimating,this.updateWhileInteracting_=void 0!==i.updateWhileInteracting&&i.updateWhileInteracting,this.renderMode_=i.renderMode||N_,this.type=S_}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.setDeclutter=function(t){this.declutter_=t},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(Ab)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(Ab,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:Cb,this.styleFunction_=null===t?void 0:function(t){var e;if("function"==typeof t)e=t;else{var i;Array.isArray(t)?i=t:(vp("function"==typeof t.getZIndex,41),i=[t]),e=function(){return i}}return e}(this.style_),this.changed()},e.prototype.getRenderMode=function(){return this.renderMode_},e}(D_);Pb.prototype.getSource;const kb=Pb,Rb="arraybuffer",Lb="json",Fb="text",Mb="xml";function Ob(t,e){return function(t,e,i,n){return function(r,o,s){var a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(r,o,s):t,!0),e.getType()==Rb&&(a.responseType="arraybuffer"),a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){var r,o=e.getType();o==Lb||o==Fb?r=a.responseText:o==Mb?(r=a.responseXML)||(r=(new DOMParser).parseFromString(a.responseText,"application/xml")):o==Rb&&(r=a.response),r?i.call(this,e.readFeatures(r,{featureProjection:s}),e.readProjection(r),e.getLastExtent()):n.call(this)}else n.call(this)}.bind(this),a.onerror=function(){n.call(this)}.bind(this),a.send()}}(t,e,(function(t,e){"function"==typeof this.addFeatures&&this.addFeatures(t)}),Tf)}function $b(t,e){return[[-1/0,-1/0,1/0,1/0]]}const Db="addfeature",jb="changefeature",Nb="clear",Bb="removefeature";var Ub=i(510),zb=i.n(Ub),Vb=function(t){this.rbush_=zb()(t,void 0),this.items_={}};Vb.prototype.insert=function(t,e){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[sf(e)]=i},Vb.prototype.load=function(t,e){for(var i=new Array(e.length),n=0,r=e.length;n<r;n++){var o=t[n],s=e[n],a={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};i[n]=a,this.items_[sf(s)]=a}this.rbush_.load(i)},Vb.prototype.remove=function(t){var e=sf(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)},Vb.prototype.update=function(t,e){var i=this.items_[sf(e)];Up([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))},Vb.prototype.getAll=function(){return this.rbush_.all().map((function(t){return t.value}))},Vb.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))},Vb.prototype.forEach=function(t,e){return this.forEach_(this.getAll(),t,e)},Vb.prototype.forEachInExtent=function(t,e,i){return this.forEach_(this.getInExtent(t),e,i)},Vb.prototype.forEach_=function(t,e,i){for(var n,r=0,o=t.length;r<o;r++)if(n=e.call(i,t[r]))return n;return n},Vb.prototype.isEmpty=function(){return df(this.items_)},Vb.prototype.clear=function(){this.rbush_.clear(),this.items_={}},Vb.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return Dp(e.minX,e.minY,e.maxX,e.maxY,t)},Vb.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]};const Gb=Vb;var qb=function(t){function e(e,i){t.call(this,e),this.feature=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Af);const Wb=function(t){function e(e){var i=e||{};t.call(this,{attributions:i.attributions,projection:void 0,state:cy,wrapX:void 0===i.wrapX||i.wrapX}),this.loader_=Tf,this.format_=i.format,this.overlaps_=null==i.overlaps||i.overlaps,this.url_=i.url,void 0!==i.loader?this.loader_=i.loader:void 0!==this.url_&&(vp(this.format_,7),this.loader_=Ob(this.url_,this.format_)),this.strategy_=void 0!==i.strategy?i.strategy:$b;var n,r,o=void 0===i.useSpatialIndex||i.useSpatialIndex;this.featuresRtree_=o?new Gb:null,this.loadedExtentsRtree_=new Gb,this.nullGeometryFeatures_={},this.idIndex_={},this.undefIdIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(i.features)?r=i.features:i.features&&(r=(n=i.features).getArray()),o||void 0!==n||(n=new Ty(r)),void 0!==r&&this.addFeaturesInternal(r),void 0!==n&&this.bindFeaturesCollection_(n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var e=sf(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var i=t.getGeometry();if(i){var n=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new qb(Db,t))}},e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[vf(e,kf,this.handleFeatureChange_,this),vf(e,lf,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,e){var i=!0,n=e.getId();return void 0!==n?n.toString()in this.idIndex_?i=!1:this.idIndex_[n.toString()]=e:(vp(!(t in this.undefIdIndex_),30),this.undefIdIndex_[t]=e),i},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var e=[],i=[],n=[],r=0,o=t.length;r<o;r++){var s=t[r],a=sf(s);this.addToIndex_(a,s)&&i.push(s)}for(var l=0,u=i.length;l<u;l++){var h=i[l],c=sf(h);this.setupChangeEvents_(c,h);var d=h.getGeometry();if(d){var f=d.getExtent();e.push(f),n.push(h)}else this.nullGeometryFeatures_[c]=h}this.featuresRtree_&&this.featuresRtree_.load(e,n);for(var p=0,g=i.length;p<g;p++)this.dispatchEvent(new qb(Db,i[p]))},e.prototype.bindFeaturesCollection_=function(t){var e=!1;vf(this,Db,(function(i){e||(e=!0,t.push(i.feature),e=!1)})),vf(this,Bb,(function(i){e||(e=!0,t.remove(i.feature),e=!1)})),vf(t,wy,(function(t){e||(e=!0,this.addFeature(t.element),e=!1)}),this),vf(t,xy,(function(t){e||(e=!0,this.removeFeature(t.element),e=!1)}),this),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_){this.featureChangeKeys_[e].forEach(bf)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_)for(var i in this.featuresRtree_.forEach(this.removeFeatureInternal,this),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.loadedExtentsRtree_.clear(),this.nullGeometryFeatures_={};var n=new qb(Nb);this.dispatchEvent(n),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){return i.getGeometry().intersectsCoordinate(t)?e(i):void 0}))},e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,(function(i){if(i.getGeometry().intersectsExtent(t)){var n=e(i);if(n)return n}}))},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),df(this.nullGeometryFeatures_)||bg(t,cf(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_.getInExtent(t)},e.prototype.getClosestFeatureToCoordinate=function(t,e){var i=t[0],n=t[1],r=null,o=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],l=e||Sf;return this.featuresRtree_.forEachInExtent(a,(function(t){if(l(t)){var e=t.getGeometry(),u=s;if((s=e.closestPointXY(i,n,o,s))<u){r=t;var h=Math.sqrt(s);a[0]=i-h,a[1]=n-h,a[2]=i+h,a[3]=n+h}}})),r},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var e=t.target,i=sf(e),n=e.getGeometry();if(n){var r=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(r,e)):this.featuresRtree_&&this.featuresRtree_.update(r,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);var o=e.getId();if(void 0!==o){var s=o.toString();i in this.undefIdIndex_?(delete this.undefIdIndex_[i],this.idIndex_[s]=e):this.idIndex_[s]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[s]=e)}else i in this.undefIdIndex_||(this.removeFromIdIndex_(e),this.undefIdIndex_[i]=e);this.changed(),this.dispatchEvent(new qb(jb,e))},e.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:sf(t)in this.undefIdIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&df(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,e,i){var n=this,r=this.loadedExtentsRtree_,o=this.strategy_(t,e);this.loading=!1;for(var s=function(t,s){var a=o[t];r.forEachInExtent(a,(function(t){return Fp(t.extent,a)}))||(n.loader_.call(n,a,e,i),r.insert(a,{extent:a.slice()}),n.loading=n.loader_!==Tf)},a=0,l=o.length;a<l;++a)s(a)},e.prototype.removeLoadedExtent=function(t){var e,i=this.loadedExtentsRtree_;i.forEachInExtent(t,(function(i){if(Up(i.extent,t))return e=i,!0})),e&&i.remove(e)},e.prototype.removeFeature=function(t){var e=sf(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},e.prototype.removeFeatureInternal=function(t){var e=sf(t);this.featureChangeKeys_[e].forEach(bf),delete this.featureChangeKeys_[e];var i=t.getId();void 0!==i?delete this.idIndex_[i.toString()]:delete this.undefIdIndex_[e],this.dispatchEvent(new qb(Bb,t))},e.prototype.removeFromIdIndex_=function(t){var e=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e},e.prototype.setLoader=function(t){this.loader_=t},e}(fy);const Kb=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return Og},e.prototype.closestPointXY=function(t,e,i,n){var r,o,s,a=this.flatCoordinates,l=n;i[0]=a[0],i[1]=a[1];for(var u=0,h=a.length;u<h;u+=2)(r=(o=t-a[u])*o+(s=e-a[u+1])*s)<l&&(l=r,i[0]=a[u],i[1]=a[u+1]);return l},e}(_v);const Xb=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return $g},e.prototype.closestPointXY=function(t,e,i,n){var r,o,s,a=this.flatCoordinates,l=n;i[0]=a[0],i[1]=a[1];for(var u=0,h=a.length;u<h;u+=2)(r=(o=t-a[u])*o+(s=e-a[u+1])*s)<l&&(l=r,i[0]=a[u],i[1]=a[u+1]);return l},e.prototype.getArea=function(){var t=this.flatCoordinates,e=Math.sqrt(Math.pow(t[0]-t[4],2)+Math.pow(t[1]-t[5],2)),i=Math.sqrt(Math.pow(t[2]-t[6],2)+Math.pow(t[3]-t[7],2));return Math.PI*e*i*.25},e}(_v);var Yb="Point",Hb="LineString",Zb="Polygon",Jb="Circle",Qb="Ellipse",tw="drawstart",ew="drawend",iw=function(t){function e(e,i){t.call(this,e),this.feature=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Af);function nw(){var t=Tb();return function(e,i){return t[e.getGeometry().getType()]}}const rw=function(t){function e(e){var i=e;i.stopDown||(i.stopDown=Cf),t.call(this,i),this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=function(t){var e;t===Eg||t===kg?e=Yb:t===Ig||t===Rg||t===Og?e=Hb:t===Pg||t===Lg?e=Zb:t===Mg?e=Jb:t===$g&&(e=Qb);return e}(this.type_),this.stopClick_=!!e.stopClick,this.minPoints_=e.minPoints?e.minPoints:this.mode_===Zb?3:2,this.maxPoints_=e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:Sf;var n=e.geometryFunction;if(!n)if(this.type_===Mg)n=function(t,e){var i=e||new Sv([NaN,NaN]),n=$y(t[0],t[1]);return i.setCenterAndRadius(t[0],Math.sqrt(n)),i};else if(this.type_===Og)this.minPoints_=3,this.maxPoints_=3,n=function(t,e){if(t.length>2){var i=t[0],n=t[1],r=t[2],o=[n[0]-i[0],n[1]-i[1]];if(0===o[1])t=[[i,i,i,i]];else{var s=[-1*o[1],o[0]],a=o[0]/o[1],l=(r[0]+a*(n[1]-r[1])-n[0])/(s[0]-s[1]*a),u=[l*s[0],l*s[1]];t=[[[i[0]-u[0],i[1]-u[1]],[n[0]-u[0],n[1]-u[1]],[n[0]+u[0],n[1]+u[1]],[i[0]+u[0],i[1]+u[1]]]]}}else t=[t];var h=e;return h?h.setCoordinates(t):h=new Kb(t),h};else if(this.type_===$g)this.minPoints_=3,this.maxPoints_=3,n=function(t,e){if(t.length>2){var i=t[0],n=t[1],r=t[2],o=[n[0]-i[0],n[1]-i[1]],s=[i[0]+.5*o[0],i[1]+.5*o[1]];if(0===o[1])t=[[i,i,i,i]];else{var a=[-1*o[1],o[0]],l=o[0]/o[1],u=(r[0]+l*(n[1]-r[1])-n[0])/(a[0]-a[1]*l),h=[u*a[0],u*a[1]];t=[[[i[0],i[1]],[s[0]-h[0],s[1]-h[1]],[n[0],n[1]],[s[0]+h[0],s[1]+h[1]]]]}}else t=[t];var c=e;return c?c.setCoordinates(t):c=new Xb(t),c};else{var r,o=this.mode_;o===Yb?r=ov:o===Hb?r=Iv:o===Zb&&(r=_v),n=function(t,e){var i=e;return i?o===Zb?t[0].length?i.setCoordinates([t[0].concat([t[0][0]])]):i.setCoordinates([]):i.setCoordinates(t):i=new r(t),i}}this.geometryFunction_=n,this.dragVertexDelay_=void 0!==e.dragVertexDelay?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new kb({source:new Wb({useSpatialIndex:!1,wrapX:!!e.wrapX&&e.wrapX}),style:e.style?e.style:nw(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:i_,this.freehandCondition_,e.freehand?this.freehandCondition_=Zy:this.freehandCondition_=e.freehandCondition?e.freehandCondition:n_,vf(this,Xf(Ov),this.updateState_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMap=function(e){t.prototype.setMap.call(this,e),this.updateState_()},e.prototype.getOverlay=function(){return this.overlay_},e.prototype.handleEvent=function(e){e.originalEvent.type===Lf&&e.preventDefault(),this.freehand_=this.mode_!==Yb&&this.freehandCondition_(e);var i=e.type===kv.POINTERMOVE,n=!0;!this.freehand_&&this.lastDragTime_&&e.type===kv.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,i=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0));return this.freehand_&&e.type===kv.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(e),n=!1):this.freehand_&&e.type===kv.POINTERDOWN?n=!1:i?(n=e.type===kv.POINTERMOVE)&&this.freehand_?n=this.handlePointerMove_(e):(e.pointerEvent.pointerType==d_||e.type===kv.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(e):e.type===kv.DBLCLICK&&(n=!1),t.prototype.handleEvent.call(this,e)&&n},e.prototype.handleDownEvent=function(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t),!0):!!this.condition_(t)&&(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new ky(kv.POINTERMOVE,t.map,t.pointerEvent,!1,t.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=t.pixel,!0)},e.prototype.handleUpEvent=function(t){var e=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);var i=this.mode_===Jb;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||i?this.finishDrawing():this.atFinish_(t)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t):(this.startDrawing_(t),this.mode_===Yb&&this.finishDrawing()),e=!1):this.freehand_&&(this.finishCoordinate_=null,this.abortDrawing_()),!e&&this.stopClick_&&t.stopPropagation(),e},e.prototype.handlePointerMove_=function(t){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var e=this.downPx_,i=t.pixel,n=e[0]-i[0],r=e[1]-i[1],o=n*n+r*r;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(t):this.createOrUpdateSketchPoint_(t),!0},e.prototype.atFinish_=function(t){var e=!1;if(this.sketchFeature_){var i=!1,n=[this.finishCoordinate_];if(this.mode_===Hb)i=this.sketchCoords_.length>this.minPoints_;else if(this.mode_===Zb){var r=this.sketchCoords_;i=r[0].length>this.minPoints_,n=[r[0][0],r[0][r[0].length-2]]}if(i)for(var o=t.map,s=0,a=n.length;s<a;s++){var l=n[s],u=o.getPixelFromCoordinate(l),h=t.pixel,c=h[0]-u[0],d=h[1]-u[1],f=this.freehand_?1:this.snapTolerance_;if(e=Math.sqrt(c*c+d*d)<=f){this.finishCoordinate_=l;break}}}return e},e.prototype.createOrUpdateSketchPoint_=function(t){var e=t.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new Iy(new ov(e)),this.updateSketchFeatures_())},e.prototype.startDrawing_=function(t){var e=t.coordinate;this.finishCoordinate_=e,this.mode_===Yb?this.sketchCoords_=e.slice():this.mode_===Zb?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new Iy(new Iv(this.sketchLineCoords_)));var i=this.geometryFunction_(this.sketchCoords_);this.sketchFeature_=new Iy,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new iw(tw,this.sketchFeature_))},e.prototype.modifyDrawing_=function(t){var e,i,n,r=t.coordinate,o=this.sketchFeature_.getGeometry();(this.mode_===Yb?i=this.sketchCoords_:this.mode_===Zb?(i=(e=this.sketchCoords_[0])[e.length-1],this.atFinish_(t)&&(r=this.finishCoordinate_.slice())):i=(e=this.sketchCoords_)[e.length-1],i[0]=r[0],i[1]=r[1],this.geometryFunction_(this.sketchCoords_,o),this.sketchPoint_)&&this.sketchPoint_.getGeometry().setCoordinates(r);if(this.mode_===Qb)if(this.sketchLine_||(this.sketchLine_=new Iy(new Iv([0,0]))),n=this.sketchLine_.getGeometry(),this.sketchCoords_.length<3)n.setCoordinates(this.sketchCoords_);else{var s=[((e=o.getCoordinates()[0])[0][0]+e[2][0])/2,(e[0][1]+e[2][1])/2];n.setCoordinates([e[0],s,e[3]])}else if(o.getType()==Pg&&this.mode_!==Zb){this.sketchLine_||(this.sketchLine_=new Iy);var a=o.getLinearRing(0);(n=this.sketchLine_.getGeometry())?(n.setFlatCoordinates(a.getLayout(),a.getFlatCoordinates()),n.changed()):(n=new Iv(a.getFlatCoordinates(),a.getLayout()),this.sketchLine_.setGeometry(n))}else this.sketchLineCoords_&&(n=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()},e.prototype.addToDrawing_=function(t){var e,i,n=t.coordinate,r=this.sketchFeature_.getGeometry();this.mode_===Hb||this.mode_===Qb?(this.finishCoordinate_=n.slice(),(i=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(n.slice()),this.geometryFunction_(i,r)):this.mode_===Zb&&((i=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(n.slice()),e&&(this.finishCoordinate_=i[0]),this.geometryFunction_(this.sketchCoords_,r)),this.updateSketchFeatures_(),e&&this.finishDrawing()},e.prototype.removeLastPoint=function(){if(this.sketchFeature_){var t,e=this.sketchFeature_.getGeometry();this.mode_===Hb?((t=this.sketchCoords_).splice(-2,1),this.geometryFunction_(t,e),t.length>=2&&(this.finishCoordinate_=t[t.length-2].slice())):this.mode_===Zb&&((t=this.sketchCoords_[0]).splice(-2,1),this.sketchLine_.getGeometry().setCoordinates(t),this.geometryFunction_(this.sketchCoords_,e)),0===t.length&&(this.finishCoordinate_=null),this.updateSketchFeatures_()}},e.prototype.finishDrawing=function(){var t=this.abortDrawing_();if(t){var e=this.sketchCoords_,i=t.getGeometry();this.mode_===Hb?(e.pop(),this.geometryFunction_(e,i)):this.mode_===Zb&&(e[0].pop(),this.geometryFunction_(e,i),e=i.getCoordinates()),this.type_===kg?t.setGeometry(new l_([e])):this.type_===Rg?t.setGeometry(new a_([e])):this.type_===Lg&&t.setGeometry(new u_([e])),this.dispatchEvent(new iw(ew,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)}},e.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var t=this.sketchFeature_;return t&&(this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0)),t},e.prototype.extend=function(t){var e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();var i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new iw(tw,this.sketchFeature_))},e.prototype.updateSketchFeatures_=function(){var t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);var e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)},e.prototype.updateState_=function(){var t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing_(),this.overlay_.setMap(e?t:null)},e}(zv);var ow={white:[255,255,255,1],blue:[0,153,255,1],orange:"#ff5e00"},sw={},aw=new wb({color:ow.white,width:5}),lw=new wb({color:ow.white,width:6}),uw=new wb({color:ow.blue,width:3}),hw=new wb({color:ow.orange,width:3}),cw=new _b({color:ow.blue}),dw=new _b({color:ow.orange}),fw=new wb({color:ow.white,width:2}),pw=new wb({color:ow.white,width:3}),gw=new wb({color:ow.white,width:2,lineDash:[3]}),mw=new wb({color:ow.blue,width:3,lineDash:[5]});const vw={colors:ow,features:function(t){var e=t.get("color");return e=e?"#"+e:ow.blue,sw.hasOwnProperty(e)||(sw[e]=[new Ib({stroke:aw,image:new vb({radius:6,fill:new _b({color:e}),stroke:fw}),fill:new _b({color:"transparent"})}),new Ib({stroke:new wb({color:e,width:3})})]),sw[e]},highlight:[new Ib({stroke:lw,image:new vb({radius:6,fill:dw,stroke:pw}),zIndex:200}),new Ib({stroke:hw,zIndex:200})],editing:[new Ib({stroke:aw,image:new vb({radius:6,fill:cw,stroke:gw})}),new Ib({stroke:mw})],viewport:[new Ib({stroke:uw}),new Ib({stroke:new wb({color:ow.white,width:1})})],cross:[new Ib({image:new mb({stroke:lw,points:4,radius1:6,radius2:0,angle:Math.PI/4})}),new Ib({image:new mb({stroke:hw,points:4,radius1:6,radius2:0,angle:Math.PI/4})})]};var yw,_w=function(t){var e=t.pointerEvent;return!(!e||"pen"!==e.pointerType)||n_(t)};const bw=Tl({computed:{isDrawing:function(){return this.interactionMode.startsWith("draw")},isDrawingPoint:function(){return"drawPoint"===this.interactionMode},isDrawingRectangle:function(){return"drawRectangle"===this.interactionMode},isDrawingCircle:function(){return"drawCircle"===this.interactionMode},isDrawingLineString:function(){return"drawLineString"===this.interactionMode},isDrawingPolygon:function(){return"drawPolygon"===this.interactionMode},isDrawingEllipse:function(){return"drawEllipse"===this.interactionMode}},methods:{draw:function(t){this["isDrawing"+t]?this.resetInteractionMode():this.hasSelectedLabel?this.canAdd&&(this.interactionMode="draw"+t):this.requireSelectedLabel()},drawPoint:function(){this.draw("Point")},drawRectangle:function(){this.draw("Rectangle")},drawCircle:function(){this.draw("Circle")},drawLineString:function(){this.draw("LineString")},drawPolygon:function(){this.draw("Polygon")},drawEllipse:function(){this.draw("Ellipse")},maybeUpdateDrawInteractionMode:function(t){yw&&(this.map.removeInteraction(yw),yw=void 0),this.isDrawing&&((yw=new rw({source:this.annotationSource,type:t.slice(4),style:vw.editing,freehandCondition:_w})).on("drawend",this.handleNewFeature),this.map.addInteraction(yw))}},watch:{selectedLabel:function(t){this.isDrawing&&!t&&this.resetInteractionMode()}},created:function(){this.canAdd&&(Ll.on("a",this.drawPoint,0,this.listenerSet),Ll.on("s",this.drawRectangle,0,this.listenerSet),Ll.on("d",this.drawCircle,0,this.listenerSet),Ll.on("Shift+d",this.drawEllipse,0,this.listenerSet),Ll.on("f",this.drawLineString,0,this.listenerSet),Ll.on("g",this.drawPolygon,0,this.listenerSet),this.$watch("interactionMode",this.maybeUpdateDrawInteractionMode))}},undefined,undefined,!1,null,null,null).exports;var ww=function(t){function e(e){var i=e||{};t.call(this,i),this.type=b_}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(D_);ww.prototype.getSource;const xw=ww;const Sw=Tl({props:{label:{required:!0}}},undefined,undefined,!1,null,null,null).exports;const Cw=Tl({data:function(){return{imageSection:[0,0],imageSectionCenter:[0,0]}},computed:{imageSectionSteps:function(){return[Math.ceil(this.image.width/(this.viewExtent[2]-this.viewExtent[0])),Math.ceil(this.image.height/(this.viewExtent[3]-this.viewExtent[1]))]},imageSectionStepSize:function(){var t,e=[this.viewExtent[2]-this.viewExtent[0],this.viewExtent[3]-this.viewExtent[1]];return this.imageSectionSteps[0]>1?(t=e[0]*this.imageSectionSteps[0]-this.image.width,e[0]-=t/(this.imageSectionSteps[0]-1)):e[0]=this.viewExtent[2],this.imageSectionSteps[1]>1?(t=e[1]*this.imageSectionSteps[1]-this.image.height,e[1]-=t/(this.imageSectionSteps[1]-1)):e[1]=this.viewExtent[3],e},imageSectionStartCenter:function(){var t=[(this.viewExtent[2]-this.viewExtent[0])/2,(this.viewExtent[3]-this.viewExtent[1])/2];return this.imageSectionSteps[0]<=1&&(t[0]=this.extent[2]/2),this.imageSectionSteps[1]<=1&&(t[1]=this.extent[3]/2),t},isLawnmowerAnnotationMode:function(){return"lawnmower"===this.annotationMode}},methods:{getImageSectionCenter:function(t){return[t[0]*this.imageSectionStepSize[0]+this.imageSectionStartCenter[0],t[1]*this.imageSectionStepSize[1]+this.imageSectionStartCenter[1]]},showImageSection:function(t){return t[0]<this.imageSectionSteps[0]&&t[1]<this.imageSectionSteps[1]&&t[0]>=0&&t[1]>=0&&(this.imageSection=t,this.imageSectionCenter=this.getImageSectionCenter(t),this.map.getView().setCenter(this.imageSectionCenter),!0)},showLastImageSection:function(){this.showImageSection([this.imageSectionSteps[0]-1,this.imageSectionSteps[1]-1])},showFirstImageSection:function(){this.showImageSection([0,0])},showPreviousImageSection:function(){var t=this.imageSection[0]-1;return t>=0?this.showImageSection([t,this.imageSection[1]]):this.showImageSection([this.imageSectionSteps[0]-1,this.imageSection[1]-1])},showNextImageSection:function(){var t=this.imageSection[0]+1;return t<this.imageSectionSteps[0]?this.showImageSection([t,this.imageSection[1]]):this.showImageSection([0,this.imageSection[1]+1])}},watch:{viewExtent:function(){if(this.isLawnmowerAnnotationMode&&Number.isInteger(this.imageSectionSteps[0])&&Number.isInteger(this.imageSectionSteps[1])){for(var t,e,i=1/0,n=0,r=[0,0],o=0;o<this.imageSectionSteps[1];o++)for(var s=0;s<this.imageSectionSteps[0];s++)t=this.imageSectionCenter,e=this.getImageSectionCenter([s,o]),(n=Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)))<i&&(r[0]=s,r[1]=o,i=n);this.showImageSection(r)}}}},undefined,undefined,!1,null,null,null).exports;var Tw=i(252),Ew=i.n(Tw);function Iw(t){return(Iw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Aw(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Pw(t,e){return(Pw=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function kw(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Lw(t);if(e){var r=Lw(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Rw(this,i)}}function Rw(t,e){return!e||"object"!==Iw(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lw(t){return(Lw=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}const Fw=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pw(t,e)}(o,t);var e,i,n,r=kw(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,t)).on("change:active",e.toggleActive),e.layer=t.layer,e.colorThreshold=void 0===t.colorThreshold?15:t.colorThreshold,e.currentThreshold=e.colorThreshold,e.blurRadius=void 0===t.blurRadius?5:t.blurRadius,e.simplifyTolerant=void 0===t.simplifyTolerant?0:t.simplifyTolerant,e.simplifyCount=void 0===t.simplifyCount?3:t.simplifyCount,e.downPoint=[0,0],e.map=t.map,e.snapshotCanvas=document.createElement("canvas"),e.snapshotContext=e.snapshotCanvas.getContext("2d"),e.snapshot=null,e.updatingSnapshot=!1,e.discardRadius=void 0===t.discardRadius?20:t.discardRadius,e.sketchFeature=null,e.sketchSource=t.source,void 0===e.sketchSource&&(e.sketchSource=new Wb,e.map.addLayer(new kb({source:e.sketchSource,zIndex:200}))),e.sketchStyle=void 0===t.style?null:t.style,e.isShowingPoint=!1,e.indicatorPoint=new Iy(new ov([20,20])),void 0!==t.indicatorPointStyle&&e.indicatorPoint.setStyle(t.indicatorPointStyle),e.isShowingCross=!1,e.indicatorCross=new Iy(new ov([100,100])),void 0!==t.indicatorCrossStyle?e.indicatorCross.setStyle(t.indicatorCrossStyle):e.indicatorCross.setStyle([new Ib({image:new mb({stroke:new wb({color:[0,153,255,1],width:3}),points:4,radius1:6,radius2:0,angle:Math.PI/4})}),new Ib({image:new mb({stroke:new wb({color:[255,255,255,.75],width:1.5}),points:4,radius1:6,radius2:0,angle:Math.PI/4})})]),e.indicatorSource=new Wb,e.map.addLayer(new kb({source:e.indicatorSource,zIndex:200})),e.toggleActive(),e}return e=o,(i=[{key:"getHighDpiScaling",value:function(){return this.snapshot.height/this.map.getSize()[1]}},{key:"toSnapshotCoordinates",value:function(t){var e=this.map.getView().calculateExtent(this.map.getSize()),i=this.snapshot.height,n=this.getHighDpiScaling()/this.map.getView().getResolution();return t.map((function(t){return[Math.round((t[0]-e[0])*n),i-Math.round((t[1]-e[1])*n)]}))}},{key:"fromSnapshotCoordinates",value:function(t){var e=this.map.getView().calculateExtent(this.map.getSize()),i=this.snapshot.height,n=this.map.getView().getResolution()/this.getHighDpiScaling();return t.map((function(t){return[Math.round(t[0]*n+e[0]),Math.round((i-t[1])*n+e[1])]}))}},{key:"fromMagicWandCoordinates",value:function(t){return t.map((function(t){return[t.x,t.y]}))}},{key:"handleUpEvent",value:function(){return this.currentThreshold=this.colorThreshold,this.isShowingCross?this.sketchSource.removeFeature(this.sketchFeature):this.dispatchEvent({type:"drawend",feature:this.sketchFeature}),this.sketchFeature=null,this.indicatorSource.clear(),this.isShowingPoint=!1,this.isShowingCross=!1,!1}},{key:"handleDownEvent",value:function(t){return this.downPoint[0]=Math.round(t.coordinate[0]),this.downPoint[1]=Math.round(t.coordinate[1]),this.drawSketch(),this.indicatorPoint.getGeometry().setCoordinates(this.downPoint),this.indicatorCross.getGeometry().setCoordinates(this.downPoint),this.indicatorSource.clear(),this.indicatorSource.addFeature(this.indicatorCross),this.isShowingCross=!0,this.isShowingPoint=!1,!0}},{key:"handleDragEvent",value:function(t){var e=this.toSnapshotCoordinates([t.coordinate]).shift(),i=Math.round(e[0]),n=Math.round(e[1]),r=this.toSnapshotCoordinates([this.downPoint]).shift(),o=r[0],s=r[1];if(i!==o||n!==s){var a=i-o,l=n-s,u=Math.sqrt(a*a+l*l);u<=this.discardRadius&&!t.originalEvent.shiftKey?this.isShowingCross||(this.indicatorSource.clear(),this.indicatorSource.addFeature(this.indicatorCross),this.isShowingCross=!0,this.isShowingPoint=!1):this.isShowingPoint||(this.indicatorSource.clear(),this.indicatorSource.addFeature(this.indicatorPoint),this.isShowingCross=!1,this.isShowingPoint=!0);var h=Math.min(Math.max(this.colorThreshold+Math.round(u/2-this.colorThreshold),1),255);h!=this.currentThreshold&&(this.currentThreshold=h,this.drawSketch())}}},{key:"handleMoveEvent",value:function(t){this.isShowingPoint||(this.indicatorSource.clear(),this.indicatorSource.addFeature(this.indicatorPoint),this.isShowingPoint=!0,this.isShowingCross=!1),this.indicatorPoint.getGeometry().setCoordinates(t.coordinate)}},{key:"toggleActive",value:function(){this.getActive()?(this.map.on(["moveend","change:size"],this.updateSnapshot.bind(this)),this.updateSnapshot()):(this.map.un(["moveend","change:size"],this.updateSnapshot.bind(this)),this.indicatorSource.clear(),this.isShowingPoint=!1,this.isShowingCross=!1,this.sketchFeature&&(this.sketchSource.removeFeature(this.sketchFeature),this.sketchFeature=null))}},{key:"updateSnapshot",value:function(){!this.updatingSnapshot&&this.layer&&(this.layer.once("postcompose",this.updateSnapshotCanvas.bind(this)),this.updatingSnapshot=!0,this.map.renderSync(),this.updatingSnapshot=!1)}},{key:"updateSnapshotCanvas",value:function(t){this.snapshotCanvas.width=t.context.canvas.width,this.snapshotCanvas.height=t.context.canvas.height,this.snapshotContext.drawImage(t.context.canvas,0,0),this.snapshot=this.snapshotContext.getImageData(0,0,this.snapshotCanvas.width,this.snapshotCanvas.height),this.snapshot.bytes=4}},{key:"setLayer",value:function(t){this.layer=t}},{key:"drawSketch",value:function(){var t=this.toSnapshotCoordinates([this.downPoint]).shift(),e=Ew().floodFill(this.snapshot,t[0],t[1],this.currentThreshold);this.blurRadius>0&&(e=Ew().gaussBlurOnlyBorder(e,this.blurRadius));for(var i=e.data,n=this.snapshot.data,r=i.length-1;r>=0;r--)0===n[4*r]&&(i[r]=0);var o=Ew().traceContours(e).filter((function(t){return!t.innner})).shift();if(o){this.simplifyTolerant>0&&(o=Ew().simplifyContours([o],this.simplifyTolerant,this.simplifyCount).shift());var s=this.fromSnapshotCoordinates(this.fromMagicWandCoordinates(o.points));this.sketchFeature?this.sketchFeature.getGeometry().setCoordinates([s]):(this.sketchFeature=new Iy(new _v([s])),this.sketchStyle&&this.sketchFeature.setStyle(this.sketchStyle),this.sketchSource.addFeature(this.sketchFeature))}}}])&&Aw(e.prototype,i),n&&Aw(e,n),o}(zv);var Mw;const Ow=Tl({computed:{crossOrigin:function(){return this.image&&this.image.crossOrigin},isMagicWanding:function(){return"magicWand"===this.interactionMode&&!this.crossOrigin}},methods:{toggleMagicWand:function(){this.isMagicWanding?this.resetInteractionMode():Mw&&(this.interactionMode="magicWand")},maybeUpdateMagicWandSnapshot:function(t){t&&!t.tiled&&this.isMagicWanding&&Mw.updateSnapshot()},maybeSetMagicWandLayer:function(t,e){t&&!this.crossOrigin&&(!0===t.tiled?e&&!0===e.tiled||Mw.setLayer(this.tiledImageLayer):e&&!0!==e.tiled||Mw.setLayer(this.imageLayer))},toggleMagicWandInteraction:function(t){t?this.hasSelectedLabel?Mw.setActive(!0):this.requireSelectedLabel():Mw.setActive(!1)}},created:function(){this.canAdd&&(Ll.on("Shift+g",this.toggleMagicWand,0,this.listenerSet),this.$watch("image",this.maybeUpdateMagicWandSnapshot),this.$watch("image",this.maybeSetMagicWandLayer),this.$watch("isMagicWanding",this.toggleMagicWandInteraction))},mounted:function(){this.canAdd&&((Mw=new Fw({map:this.map,source:this.annotationSource,style:vw.editing,indicatorPointStyle:vw.editing,indicatorCrossStyle:vw.cross,simplifyTolerant:.1})).on("drawend",this.handleNewFeature),Mw.setActive(!1),this.map.addInteraction(Mw))}},undefined,undefined,!1,null,null,null).exports,$w="pointermove",Dw="pointerdown",jw="pointerup",Nw="pointerover",Bw="pointerout",Uw="pointerenter",zw="pointerleave",Vw="pointercancel";var Gw=["","unavailable","touch","pen","mouse"];function qw(t){this.pointerMap[t.pointerId.toString()]=t;var e=this.prepareEvent_(t);this.dispatcher.down(e,t)}function Ww(t){var e=this.prepareEvent_(t);this.dispatcher.move(e,t)}function Kw(t){var e=this.prepareEvent_(t);this.dispatcher.up(e,t),this.cleanup(t.pointerId)}function Xw(t){var e=this.prepareEvent_(t);this.dispatcher.leaveOut(e,t)}function Yw(t){var e=this.prepareEvent_(t);this.dispatcher.enterOver(e,t)}function Hw(t){var e=this.prepareEvent_(t);this.dispatcher.cancel(e,t),this.cleanup(t.pointerId)}function Zw(t){var e=this.dispatcher.makeEvent("lostpointercapture",t,t);this.dispatcher.dispatchEvent(e)}function Jw(t){var e=this.dispatcher.makeEvent("gotpointercapture",t,t);this.dispatcher.dispatchEvent(e)}const Qw=function(t){function e(e){var i={MSPointerDown:qw,MSPointerMove:Ww,MSPointerUp:Kw,MSPointerOut:Xw,MSPointerOver:Yw,MSPointerCancel:Hw,MSGotPointerCapture:Jw,MSLostPointerCapture:Zw};t.call(this,e,i),this.pointerMap=e.pointerMap}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvent_=function(t){var e=t;return"number"==typeof t.pointerType&&((e=this.dispatcher.cloneEvent(t,t)).pointerType=Gw[t.pointerType]),e},e.prototype.cleanup=function(t){delete this.pointerMap[t.toString()]},e}(c_);function tx(t){this.dispatcher.fireNativeEvent(t)}function ex(t){this.dispatcher.fireNativeEvent(t)}function ix(t){this.dispatcher.fireNativeEvent(t)}function nx(t){this.dispatcher.fireNativeEvent(t)}function rx(t){this.dispatcher.fireNativeEvent(t)}function ox(t){this.dispatcher.fireNativeEvent(t)}function sx(t){this.dispatcher.fireNativeEvent(t)}function ax(t){this.dispatcher.fireNativeEvent(t)}const lx=function(t){function e(e){var i={pointerdown:tx,pointermove:ex,pointerup:ix,pointerout:nx,pointerover:rx,pointercancel:ox,gotpointercapture:ax,lostpointercapture:sx};t.call(this,e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(c_);var ux=!1,hx=function(t){function e(e,i,n){t.call(this,e),this.originalEvent=i;var r=n||{};this.buttons=function(t){var e;if(t.buttons||ux)e=t.buttons;else switch(t.which){case 1:e=1;break;case 2:e=4;break;case 3:e=2;break;default:e=0}return e}(r),this.pressure=function(t,e){var i=0;i=t.pressure?t.pressure:e?.5:0;return i}(r,this.buttons),this.bubbles="bubbles"in r&&r.bubbles,this.cancelable="cancelable"in r&&r.cancelable,this.view="view"in r?r.view:null,this.detail="detail"in r?r.detail:null,this.screenX="screenX"in r?r.screenX:0,this.screenY="screenY"in r?r.screenY:0,this.clientX="clientX"in r?r.clientX:0,this.clientY="clientY"in r?r.clientY:0,this.ctrlKey="ctrlKey"in r&&r.ctrlKey,this.altKey="altKey"in r&&r.altKey,this.shiftKey="shiftKey"in r&&r.shiftKey,this.metaKey="metaKey"in r&&r.metaKey,this.button="button"in r?r.button:0,this.relatedTarget="relatedTarget"in r?r.relatedTarget:null,this.pointerId="pointerId"in r?r.pointerId:0,this.width="width"in r?r.width:0,this.height="height"in r?r.height:0,this.tiltX="tiltX"in r?r.tiltX:0,this.tiltY="tiltY"in r?r.tiltY:0,this.pointerType="pointerType"in r?r.pointerType:"",this.hwTimestamp="hwTimestamp"in r?r.hwTimestamp:0,this.isPrimary="isPrimary"in r&&r.isPrimary,i.preventDefault&&(this.preventDefault=function(){i.preventDefault()})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Af);!function(){try{var t=new MouseEvent("click",{buttons:1});ux=1===t.buttons}catch(t){}}();const cx=hx;function dx(t){this.vacuumTouches_(t),this.setPrimaryTouch_(t.changedTouches[0]),this.dedupSynthMouse_(t),this.clickCount_++,this.processTouches_(t,this.overDown_)}function fx(t){this.processTouches_(t,this.moveOverOut_)}function px(t){this.dedupSynthMouse_(t),this.processTouches_(t,this.upOut_)}function gx(t){this.processTouches_(t,this.cancelOut_)}const mx=function(t){function e(e,i){var n={touchstart:dx,touchmove:fx,touchend:px,touchcancel:gx};t.call(this,e,n),this.pointerMap=e.pointerMap,this.mouseSource=i,this.firstTouchId_=void 0,this.clickCount_=0,this.resetId_,this.dedupTimeout_=2500}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isPrimaryTouch_=function(t){return this.firstTouchId_===t.identifier},e.prototype.setPrimaryTouch_=function(t){var e=Object.keys(this.pointerMap).length;(0===e||1===e&&1..toString()in this.pointerMap)&&(this.firstTouchId_=t.identifier,this.cancelResetClickCount_())},e.prototype.removePrimaryPointer_=function(t){t.isPrimary&&(this.firstTouchId_=void 0,this.resetClickCount_())},e.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),200)},e.prototype.resetClickCountHandler_=function(){this.clickCount_=0,this.resetId_=void 0},e.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)},e.prototype.touchToPointer_=function(t,e){var i=this.dispatcher.cloneEvent(t,e);return i.pointerId=e.identifier+2,i.bubbles=!0,i.cancelable=!0,i.detail=this.clickCount_,i.button=0,i.buttons=1,i.width=e.radiusX||0,i.height=e.radiusY||0,i.pressure=e.force||.5,i.isPrimary=this.isPrimaryTouch_(e),i.pointerType="touch",i.clientX=e.clientX,i.clientY=e.clientY,i.screenX=e.screenX,i.screenY=e.screenY,i},e.prototype.processTouches_=function(t,e){var i=Array.prototype.slice.call(t.changedTouches),n=i.length;function r(){t.preventDefault()}for(var o=0;o<n;++o){var s=this.touchToPointer_(t,i[o]);s.preventDefault=r,e.call(this,t,s)}},e.prototype.findTouch_=function(t,e){for(var i=t.length,n=0;n<i;n++){if(t[n].identifier===e)return!0}return!1},e.prototype.vacuumTouches_=function(t){var e=t.touches,i=Object.keys(this.pointerMap),n=i.length;if(n>=e.length){for(var r=[],o=0;o<n;++o){var s=Number(i[o]),a=this.pointerMap[s];1==s||this.findTouch_(e,s-2)||r.push(a.out)}for(var l=0;l<r.length;++l)this.cancelOut_(t,r[l])}},e.prototype.overDown_=function(t,e){this.pointerMap[e.pointerId]={target:e.target,out:e,outTarget:e.target},this.dispatcher.over(e,t),this.dispatcher.enter(e,t),this.dispatcher.down(e,t)},e.prototype.moveOverOut_=function(t,e){var i=e,n=this.pointerMap[i.pointerId];if(n){var r=n.out,o=n.outTarget;this.dispatcher.move(i,t),r&&o!==i.target&&(r.relatedTarget=i.target,i.relatedTarget=o,r.target=o,i.target?(this.dispatcher.leaveOut(r,t),this.dispatcher.enterOver(i,t)):(i.target=o,i.relatedTarget=null,this.cancelOut_(t,i))),n.out=i,n.outTarget=i.target}},e.prototype.upOut_=function(t,e){this.dispatcher.up(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},e.prototype.cancelOut_=function(t,e){this.dispatcher.cancel(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},e.prototype.cleanUpPointer_=function(t){delete this.pointerMap[t.pointerId],this.removePrimaryPointer_(t)},e.prototype.dedupSynthMouse_=function(t){var e=this.mouseSource.lastTouches,i=t.changedTouches[0];if(this.isPrimaryTouch_(i)){var n=[i.clientX,i.clientY];e.push(n),setTimeout((function(){var t,i,r;i=n,r=(t=e).indexOf(i),r>-1&&t.splice(r,1)}),this.dedupTimeout_)}},e}(c_);var vx=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]];const yx=function(t){function e(e){t.call(this),this.element_=e,this.pointerMap={},this.eventMap_={},this.eventSourceList_=[],this.registerSources()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.registerSources=function(){if(Wy)this.registerSource("native",new lx(this));else if(Ky)this.registerSource("ms",new Qw(this));else{var t=new __(this);this.registerSource("mouse",t),qy&&this.registerSource("touch",new mx(this,t))}this.register_()},e.prototype.registerSource=function(t,e){var i=e,n=i.getEvents();n&&(n.forEach(function(t){var e=i.getHandlerForEvent(t);e&&(this.eventMap_[t]=e.bind(i))}.bind(this)),this.eventSourceList_.push(i))},e.prototype.register_=function(){for(var t=this.eventSourceList_.length,e=0;e<t;e++){var i=this.eventSourceList_[e];this.addEvents_(i.getEvents())}},e.prototype.unregister_=function(){for(var t=this.eventSourceList_.length,e=0;e<t;e++){var i=this.eventSourceList_[e];this.removeEvents_(i.getEvents())}},e.prototype.eventHandler_=function(t){var e=t.type,i=this.eventMap_[e];i&&i(t)},e.prototype.addEvents_=function(t){t.forEach(function(t){vf(this.element_,t,this.eventHandler_,this)}.bind(this))},e.prototype.removeEvents_=function(t){t.forEach(function(t){_f(this.element_,t,this.eventHandler_,this)}.bind(this))},e.prototype.cloneEvent=function(t,e){for(var i={},n=0,r=vx.length;n<r;n++){var o=vx[n][0];i[o]=t[o]||e[o]||vx[n][1]}return i},e.prototype.down=function(t,e){this.fireEvent(Dw,t,e)},e.prototype.move=function(t,e){this.fireEvent($w,t,e)},e.prototype.up=function(t,e){this.fireEvent(jw,t,e)},e.prototype.enter=function(t,e){t.bubbles=!1,this.fireEvent(Uw,t,e)},e.prototype.leave=function(t,e){t.bubbles=!1,this.fireEvent(zw,t,e)},e.prototype.over=function(t,e){t.bubbles=!0,this.fireEvent(Nw,t,e)},e.prototype.out=function(t,e){t.bubbles=!0,this.fireEvent(Bw,t,e)},e.prototype.cancel=function(t,e){this.fireEvent(Vw,t,e)},e.prototype.leaveOut=function(t,e){this.out(t,e),this.contains_(t.target,t.relatedTarget)||this.leave(t,e)},e.prototype.enterOver=function(t,e){this.over(t,e),this.contains_(t.target,t.relatedTarget)||this.enter(t,e)},e.prototype.contains_=function(t,e){return!(!t||!e)&&t.contains(e)},e.prototype.makeEvent=function(t,e,i){return new cx(t,i,e)},e.prototype.fireEvent=function(t,e,i){var n=this.makeEvent(t,e,i);this.dispatchEvent(n)},e.prototype.fireNativeEvent=function(t){var e=this.makeEvent(t.type,t,t);this.dispatchEvent(e)},e.prototype.wrapMouseEvent=function(t,e){return this.makeEvent(t,y_(e,this),e)},e.prototype.disposeInternal=function(){this.unregister_(),t.prototype.disposeInternal.call(this)},e}(Pf);const _x=function(t){function e(e,i){t.call(this),this.map_=e,this.clickTimeoutId_,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=i?i*Vy:Vy,this.down_=null;var n=this.map_.getViewport();this.activePointers_=0,this.trackedTouches_={},this.pointerEventHandler_=new yx(n),this.documentPointerEventHandler_=null,this.pointerdownListenerKey_=vf(this.pointerEventHandler_,Dw,this.handlePointerDown_,this),this.relayedListenerKey_=vf(this.pointerEventHandler_,$w,this.relayEvent_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.emulateClick_=function(t){var e=new ky(kv.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new ky(kv.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var e=new ky(kv.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var e=t;e.type==kv.POINTERUP||e.type==kv.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==kv.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new ky(kv.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(bf),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null,this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null)},e.prototype.isMouseActionButton_=function(t){return 0===t.button},e.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);var e=new ky(kv.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&(this.documentPointerEventHandler_=new yx(document),this.dragListenerKeys_.push(vf(this.documentPointerEventHandler_,kv.POINTERMOVE,this.handlePointerMove_,this),vf(this.documentPointerEventHandler_,kv.POINTERUP,this.handlePointerUp_,this),vf(this.pointerEventHandler_,kv.POINTERCANCEL,this.handlePointerUp_,this)))},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new ky(kv.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}t.preventDefault()},e.prototype.relayEvent_=function(t){var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new ky(t.type,this.map_,t,e))},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(bf(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&(bf(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(bf),this.dragListenerKeys_.length=0,this.documentPointerEventHandler_&&(this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null),this.pointerEventHandler_&&(this.pointerEventHandler_.dispose(),this.pointerEventHandler_=null),t.prototype.disposeInternal.call(this)},e}(Pf),bx="layergroup",wx="size",xx="target",Sx="view",Cx=0,Tx=1,Ex=2,Ix=3,Ax=4,Px=5;var kx=1/0,Rx=function(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}};Rx.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,hf(this.queuedElements_)},Rx.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var n=this.keyFunction_(i);return delete this.queuedElements_[n],i},Rx.prototype.enqueue=function(t){vp(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=kx&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},Rx.prototype.getCount=function(){return this.elements_.length},Rx.prototype.getLeftChildIndex_=function(t){return 2*t+1},Rx.prototype.getRightChildIndex_=function(t){return 2*t+2},Rx.prototype.getParentIndex_=function(t){return t-1>>1},Rx.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},Rx.prototype.isEmpty=function(){return 0===this.elements_.length},Rx.prototype.isKeyQueued=function(t){return t in this.queuedElements_},Rx.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},Rx.prototype.siftUp_=function(t){for(var e=this.elements_,i=this.priorities_,n=e.length,r=e[t],o=i[t],s=t;t<n>>1;){var a=this.getLeftChildIndex_(t),l=this.getRightChildIndex_(t),u=l<n&&i[l]<i[a]?l:a;e[t]=e[u],i[t]=i[u],t=u}e[t]=r,i[t]=o,this.siftDown_(s,t)},Rx.prototype.siftDown_=function(t,e){for(var i=this.elements_,n=this.priorities_,r=i[e],o=n[e];e>t;){var s=this.getParentIndex_(e);if(!(n[s]>o))break;i[e]=i[s],n[e]=n[s],e=s}i[e]=r,n[e]=o},Rx.prototype.reprioritize=function(){var t,e,i,n=this.priorityFunction_,r=this.elements_,o=this.priorities_,s=0,a=r.length;for(e=0;e<a;++e)(i=n(t=r[e]))==kx?delete this.queuedElements_[this.keyFunction_(t)]:(o[s]=i,r[s++]=t);r.length=s,o.length=s,this.heapify_()};const Lx=function(t){function e(e,i){t.call(this,(function(t){return e.apply(null,t)}),(function(t){return t[0].getKey()})),this.tileChangeCallback_=i,this.tilesLoading_=0,this.tilesLoadingKeys_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.enqueue=function(e){var i=t.prototype.enqueue.call(this,e);i&&vf(e[0],kf,this.handleTileChange,this);return i},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var e=t.target,i=e.getState();if(i===Ex||i===Ix||i===Ax||i===Px){_f(e,kf,this.handleTileChange,this);var n=e.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,e){for(var i,n,r,o=0,s=!1;this.tilesLoading_<t&&o<e&&this.getCount()>0;)r=(n=this.dequeue()[0]).getKey(),(i=n.getState())===Px?s=!0:i!==Cx||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++o,n.load());0===o&&s&&this.tileChangeCallback_()},e}(Rx);var Fx=256;function Mx(t){return t}function Ox(t,e){return void 0!==t?0:void 0}function $x(t,e){return void 0!==t?t+e:void 0}const Dx=0,jx=1,Nx="center",Bx="resolution",Ux="rotation";function zx(t,e){setTimeout((function(){t(e)}),0)}function Vx(t){return!(t.sourceCenter&&t.targetCenter&&!Fy(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}const Gx=function(t){function e(e){t.call(this);var i=uf({},e);this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.updateAnimations_=this.updateAnimations_.bind(this),this.projection_=xm(i.projection,"EPSG:3857"),this.applyOptions_(i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.applyOptions_=function(t){var e={};e[Nx]=void 0!==t.center?t.center:null;var i=function(t){var e,i,n,r=28,o=2,s=void 0!==t.minZoom?t.minZoom:0,a=void 0!==t.maxZoom?t.maxZoom:r,l=void 0!==t.zoomFactor?t.zoomFactor:o;if(void 0!==t.resolutions){var u=t.resolutions;i=u[s],n=void 0!==u[a]?u[a]:u[u.length-1],e=function(t){return function(e,i,n){if(void 0!==e){var r=yg(t,e,n);r=jg(r+i,0,t.length-1);var o=Math.floor(r);if(r!=o&&o<t.length-1){var s=t[o]/t[o+1];return t[o]/Math.pow(s,r-o)}return t[o]}}}(u)}else{var h=xm(t.projection,"EPSG:3857"),c=h.getExtent(),d=(c?Math.max(rg(c),tg(c)):360*Xg[Yg.DEGREES]/h.getMetersPerUnit())/Fx/Math.pow(o,0),f=d/Math.pow(o,r-0);void 0!==(i=t.maxResolution)?s=0:i=d/Math.pow(l,s),void 0===(n=t.minResolution)&&(n=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(l,a):d/Math.pow(l,a):f),a=s+Math.floor(Math.log(i/n)/Math.log(l)),n=i/Math.pow(l,a-s),e=function(t,e,i){return function(n,r,o){if(void 0!==n){var s=-o/2+.5,a=Math.floor(Math.log(e/n)/Math.log(t)+s),l=Math.max(a+r,0);return void 0!==i&&(l=Math.min(l,i)),e/Math.pow(t,l)}}}(l,i,a-s)}return{constraint:e,maxResolution:i,minResolution:n,minZoom:s,zoomFactor:l}}(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=i.minZoom;var n=function(t){return void 0!==t.extent?(e=t.extent,function(t){return t?[jg(t[0],e[0],e[2]),jg(t[1],e[1],e[3])]:void 0}):Mx;var e}(t),r=i.constraint,o=function(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?(o=r||zg(5),function(t,e){return void 0!==t?Math.abs(t+e)<=o?0:t+e:void 0}):!1===e?$x:"number"==typeof e?(i=e,n=2*Math.PI/i,function(t,e){return void 0!==t?t=Math.floor((t+e)/n+.5)*n:void 0}):$x}return Ox;var i,n;var r,o}(t);this.constraints_={center:n,resolution:r,rotation:o},void 0!==t.resolution?e[Bx]=t.resolution:void 0!==t.zoom&&(e[Bx]=this.constrainResolution(this.maxResolution_,t.zoom-this.minZoom_),this.resolutions_&&(e[Bx]=jg(Number(this.getResolution()||e[Bx]),this.minResolution_,this.maxResolution_))),e[Ux]=void 0!==t.rotation?t.rotation:0,this.setProperties(e),this.options_=t},e.prototype.getUpdatedOptions_=function(t){var e=uf({},this.options_);return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenter(),e.rotation=this.getRotation(),uf({},e,t)},e.prototype.animate=function(t){var e,i=arguments,n=arguments.length;if(n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n),!this.isDef()){var r=arguments[n-1];return r.center&&this.setCenter(r.center),void 0!==r.zoom&&this.setZoom(r.zoom),void 0!==r.rotation&&this.setRotation(r.rotation),void(e&&zx(e,!0))}for(var o=Date.now(),s=this.getCenter().slice(),a=this.getResolution(),l=this.getRotation(),u=[],h=0;h<n;++h){var c=i[h],d={start:o,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||Fv};if(c.center&&(d.sourceCenter=s,d.targetCenter=c.center,s=d.targetCenter),void 0!==c.zoom?(d.sourceResolution=a,d.targetResolution=this.constrainResolution(this.maxResolution_,c.zoom-this.minZoom_,0),a=d.targetResolution):c.resolution&&(d.sourceResolution=a,d.targetResolution=c.resolution,a=d.targetResolution),void 0!==c.rotation){d.sourceRotation=l;var f=Vg(c.rotation-l+Math.PI,2*Math.PI)-Math.PI;d.targetRotation=l+f,l=d.targetRotation}d.callback=e,Vx(d)?d.complete=!0:o+=d.duration,u.push(d)}this.animations_.push(u),this.setHint(Dx,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[Dx]>0},e.prototype.getInteracting=function(){return this.hints_[jx]>0},e.prototype.cancelAnimations=function(){this.setHint(Dx,-this.hints_[Dx]);for(var t=0,e=this.animations_.length;t<e;++t){var i=this.animations_[t];i[0].callback&&zx(i[0].callback,!1)}this.animations_.length=0},e.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,i=this.animations_.length-1;i>=0;--i){for(var n=this.animations_[i],r=!0,o=0,s=n.length;o<s;++o){var a=n[o];if(!a.complete){var l=t-a.start,u=a.duration>0?l/a.duration:1;u>=1?(a.complete=!0,u=1):r=!1;var h=a.easing(u);if(a.sourceCenter){var c=a.sourceCenter[0],d=a.sourceCenter[1],f=c+h*(a.targetCenter[0]-c),p=d+h*(a.targetCenter[1]-d);this.set(Nx,[f,p])}if(a.sourceResolution&&a.targetResolution){var g=1===h?a.targetResolution:a.sourceResolution+h*(a.targetResolution-a.sourceResolution);a.anchor&&this.set(Nx,this.calculateCenterZoom(g,a.anchor)),this.set(Bx,g)}if(void 0!==a.sourceRotation&&void 0!==a.targetRotation){var m=1===h?Vg(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+h*(a.targetRotation-a.sourceRotation);a.anchor&&this.set(Nx,this.calculateCenterRotate(m,a.anchor)),this.set(Ux,m)}if(e=!0,!a.complete)break}}if(r){this.animations_[i]=null,this.setHint(Dx,-1);var v=n[0].callback;v&&zx(v,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_))}},e.prototype.calculateCenterRotate=function(t,e){var i,n=this.getCenter();return void 0!==n&&(My(i=[n[0]-e[0],n[1]-e[1]],t-this.getRotation()),Ry(i,e)),i},e.prototype.calculateCenterZoom=function(t,e){var i,n=this.getCenter(),r=this.getResolution();void 0!==n&&void 0!==r&&(i=[e[0]-t*(e[0]-n[0])/r,e[1]-t*(e[1]-n[1])/r]);return i},e.prototype.getSizeFromViewport_=function(){var t=[100,100],e='.ol-viewport[data-view="'+sf(this)+'"]',i=document.querySelector(e);if(i){var n=getComputedStyle(i);t[0]=parseInt(n.width,10),t[1]=parseInt(n.height,10)}return t},e.prototype.constrainCenter=function(t){return this.constraints_.center(t)},e.prototype.constrainResolution=function(t,e,i){var n=e||0,r=i||0;return this.constraints_.resolution(t,n,r)},e.prototype.constrainRotation=function(t,e){var i=e||0;return this.constraints_.rotation(t,i)},e.prototype.getCenter=function(){return this.get(Nx)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){var e=t||this.getSizeFromViewport_(),i=this.getCenter();vp(i,1);var n=this.getResolution();vp(void 0!==n,2);var r=this.getRotation();return vp(void 0!==r,3),Qp(i,n,r,e)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(Bx)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,e){var i=e||this.getSizeFromViewport_(),n=rg(t)/i[0],r=tg(t)/i[1];return Math.max(n,r)},e.prototype.getResolutionForValueFunction=function(t){var e=t||2,i=this.maxResolution_,n=this.minResolution_,r=Math.log(i/n)/Math.log(e);return function(t){return i/Math.pow(e,t*r)}},e.prototype.getRotation=function(){return this.get(Ux)},e.prototype.getValueForResolutionFunction=function(t){var e=t||2,i=this.maxResolution_,n=this.minResolution_,r=Math.log(i/n)/Math.log(e);return function(t){return Math.log(i/t)/Math.log(e)/r}},e.prototype.getState=function(t){var e=this.getCenter(),i=this.getProjection(),n=this.getResolution(),r=n/t,o=this.getRotation();return{center:[Math.round(e[0]/r)*r,Math.round(e[1]/r)*r],projection:void 0!==i?i:null,resolution:n,rotation:o,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t},e.prototype.getZoomForResolution=function(t){var e,i,n=this.minZoom_||0;if(this.resolutions_){var r=yg(this.resolutions_,t,1);n=r,e=this.resolutions_[r],i=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(e/t)/Math.log(i)},e.prototype.getResolutionForZoom=function(t){return this.constrainResolution(this.maxResolution_,t-this.minZoom_,0)},e.prototype.fit=function(t,e){var i,n=e||{},r=n.size;r||(r=this.getSizeFromViewport_()),vp(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t)?(vp(!sg(t),25),i=bv(t)):t.getType()===Mg?(i=bv(t=t.getExtent())).rotate(this.getRotation(),Zp(t)):i=t;var o,s=void 0!==n.padding?n.padding:[0,0,0,0],a=void 0===n.constrainResolution||n.constrainResolution,l=void 0!==n.nearest&&n.nearest;o=void 0!==n.minResolution?n.minResolution:void 0!==n.maxZoom?this.constrainResolution(this.maxResolution_,n.maxZoom-this.minZoom_,0):0;for(var u=i.getFlatCoordinates(),h=this.getRotation(),c=Math.cos(-h),d=Math.sin(-h),f=1/0,p=1/0,g=-1/0,m=-1/0,v=i.getStride(),y=0,_=u.length;y<_;y+=v){var b=u[y]*c-u[y+1]*d,w=u[y]*d+u[y+1]*c;f=Math.min(f,b),p=Math.min(p,w),g=Math.max(g,b),m=Math.max(m,w)}var x=this.getResolutionForExtent([f,p,g,m],[r[0]-s[1]-s[3],r[1]-s[0]-s[2]]);if(x=isNaN(x)?o:Math.max(x,o),a){var S=this.constrainResolution(x,0,0);!l&&S<x&&(S=this.constrainResolution(S,-1,0)),x=S}d=-d;var C=(f+g)/2,T=(p+m)/2,E=[(C+=(s[1]-s[3])/2*x)*c-(T+=(s[0]-s[2])/2*x)*d,T*c+C*d],I=n.callback?n.callback:Tf;void 0!==n.duration?this.animate({resolution:x,center:E,duration:n.duration,easing:n.easing},I):(this.setResolution(x),this.setCenter(E),zx(I,!0))},e.prototype.centerOn=function(t,e,i){var n=this.getRotation(),r=Math.cos(-n),o=Math.sin(-n),s=t[0]*r-t[1]*o,a=t[1]*r+t[0]*o,l=this.getResolution(),u=(s+=(e[0]/2-i[0])*l)*r-(a+=(i[1]-e[1]/2)*l)*(o=-o),h=a*r+s*o;this.setCenter([u,h])},e.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()},e.prototype.rotate=function(t,e){if(void 0!==e){var i=this.calculateCenterRotate(t,e);this.setCenter(i)}this.setRotation(t)},e.prototype.setCenter=function(t){this.set(Nx,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setHint=function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.set(Bx,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setRotation=function(t){this.set(Ux,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e}(Yf);var qx="layers";const Wx=function(t){function e(e){var i=e||{},n=uf({},i);delete n.layers;var r=i.layers;t.call(this,n),this.layersListenerKeys_=[],this.listenerKeys_={},vf(this,Xf(qx),this.handleLayersChanged_,this),r?Array.isArray(r)?r=new Ty(r.slice(),{unique:!0}):vp("function"==typeof r.getArray,43):r=new Ty(void 0,{unique:!0}),this.setLayers(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(bf),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(vf(t,wy,this.handleLayersAdd_,this),vf(t,xy,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(bf);hf(this.listenerKeys_);for(var i=t.getArray(),n=0,r=i.length;n<r;n++){var o=i[n];this.listenerKeys_[sf(o)]=[vf(o,lf,this.handleLayerChange_,this),vf(o,kf,this.handleLayerChange_,this)]}this.changed()},e.prototype.handleLayersAdd_=function(t){var e=t.element;this.listenerKeys_[sf(e)]=[vf(e,lf,this.handleLayerChange_,this),vf(e,kf,this.handleLayerChange_,this)],this.changed()},e.prototype.handleLayersRemove_=function(t){var e=sf(t.element);this.listenerKeys_[e].forEach(bf),delete this.listenerKeys_[e],this.changed()},e.prototype.getLayers=function(){return this.get(qx)},e.prototype.setLayers=function(t){this.set(qx,t)},e.prototype.getLayersArray=function(t){var e=void 0!==t?t:[];return this.getLayers().forEach((function(t){t.getLayersArray(e)})),e},e.prototype.getLayerStatesArray=function(t){var e=void 0!==t?t:[],i=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));for(var n=this.getLayerState(),r=i,o=e.length;r<o;r++){var s=e[r];s.opacity*=n.opacity,s.visible=s.visible&&n.visible,s.maxResolution=Math.min(s.maxResolution,n.maxResolution),s.minResolution=Math.max(s.minResolution,n.minResolution),void 0!==n.extent&&(void 0!==s.extent?s.extent=eg(s.extent,n.extent):s.extent=n.extent)}return e},e.prototype.getSourceState=function(){return cy},e}(R_);function Kx(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:e[0]=e[1]=t,e)}const Xx=function(t){function e(e){t.call(this);var i=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var i,n,r,o={},s=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new Wx({layers:t.layers});o[bx]=s,o[xx]=t.target,o[Sx]=void 0!==t.view?t.view:new Gx,void 0!==t.controls&&(Array.isArray(t.controls)?i=new Ty(t.controls.slice()):(vp("function"==typeof t.controls.getArray,47),i=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?n=new Ty(t.interactions.slice()):(vp("function"==typeof t.interactions.getArray,48),n=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?r=new Ty(t.overlays.slice()):(vp("function"==typeof t.overlays.getArray,49),r=t.overlays):r=new Ty;return{controls:i,interactions:n,keyboardEventTarget:e,overlays:r,values:o}}(e);this.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,this.loadTilesWhileAnimating_=void 0!==e.loadTilesWhileAnimating&&e.loadTilesWhileAnimating,this.loadTilesWhileInteracting_=void 0!==e.loadTilesWhileInteracting&&e.loadTilesWhileInteracting,this.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:Vy,this.animationDelayKey_,this.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_.call(this,Date.now())}.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+(qy?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.viewport_.style.msTouchAction="none",this.viewport_.style.touchAction="none",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";for(var n=[Ff,Mf,Nf,Vf,Uf,kv.POINTERDOWN,Bf,Gf],r=0,o=n.length;r<o;++r)vf(this.overlayContainerStopEvent_,n[r],If);for(var s in this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=new _x(this,e.moveTolerance),kv)vf(this.mapBrowserEventHandler_,kv[s],this.handleMapBrowserEvent,this);this.keyboardEventTarget_=i.keyboardEventTarget,this.keyHandlerKeys_=null,vf(this.viewport_,Lf,this.handleBrowserEvent,this),vf(this.viewport_,Gf,this.handleBrowserEvent,this),vf(this.viewport_,Bf,this.handleBrowserEvent,this),this.controls=i.controls||new Ty,this.interactions=i.interactions||new Ty,this.overlays_=i.overlays,this.overlayIdIndex_={},this.renderer_=this.createRenderer(),this.handleResize_,this.focus_=null,this.postRenderFunctions_=[],this.tileQueue_=new Lx(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.skippedFeatureUids_={},vf(this,Xf(bx),this.handleLayerGroupChanged_,this),vf(this,Xf(Sx),this.handleViewChanged_,this),vf(this,Xf(wx),this.handleSizeChanged_,this),vf(this,Xf(xx),this.handleTargetChanged_,this),this.setProperties(i.values),this.controls.forEach(function(t){t.setMap(this)}.bind(this)),vf(this.controls,wy,(function(t){t.element.setMap(this)}),this),vf(this.controls,xy,(function(t){t.element.setMap(null)}),this),this.interactions.forEach(function(t){t.setMap(this)}.bind(this)),vf(this.interactions,wy,(function(t){t.element.setMap(this)}),this),vf(this.interactions,xy,(function(t){t.element.setMap(null)}),this),this.overlays_.forEach(this.addOverlayInternal_.bind(this)),vf(this.overlays_,wy,(function(t){this.addOverlayInternal_(t.element)}),this),vf(this.overlays_,xy,(function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)}),this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),_f(this.viewport_,Lf,this.handleBrowserEvent,this),_f(this.viewport_,Gf,this.handleBrowserEvent,this),_f(this.viewport_,Bf,this.handleBrowserEvent,this),void 0!==this.handleResize_&&(removeEventListener(zf,this.handleResize_,!1),this.handleResize_=void 0),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),this.setTarget(null),t.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,e,i){if(this.frameState_){var n=this.getCoordinateFromPixel(t),r=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=void 0!==i.layerFilter?i.layerFilter:Sf;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,e,null,o,null)}},e.prototype.getFeaturesAtPixel=function(t,e){var i=null;return this.forEachFeatureAtPixel(t,(function(t){i||(i=[]),i.push(t)}),e),i},e.prototype.forEachLayerAtPixel=function(t,e,i){if(this.frameState_){var n=i||{},r=void 0!==n.hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=n.layerFilter||Sf;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,r,e,null,o,null)}},e.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_)return!1;var i=this.getCoordinateFromPixel(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:Sf,r=void 0!==e.hitTolerance?e.hitTolerance*this.frameState_.pixelRatio:0;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,n,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect(),i="changedTouches"in t?t.changedTouches[0]:t;return[i.clientX-e.left,i.clientY-e.top]},e.prototype.getTarget=function(){return this.get(xx)},e.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){var e=this.frameState_;return e?Lm(e.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(bx)},e.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},e.prototype.getPixelFromCoordinate=function(t){var e=this.frameState_;return e?Lm(e.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(wx)},e.prototype.getView=function(){return this.get(Sx)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getTilePriority=function(t,e,i,n){var r=this.frameState_;if(!r||!(e in r.wantedTiles))return kx;if(!r.wantedTiles[e][t.getKey()])return kx;var o=i[0]-r.focus[0],s=i[1]-r.focus[1];return 65536*Math.log(n)+Math.sqrt(o*o+s*s)/n},e.prototype.handleBrowserEvent=function(t,e){var i=e||t.type,n=new Py(i,this,t);this.handleMapBrowserEvent(n)},e.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){this.focus_=t.coordinate,t.frameState=this.frameState_;var e=this.getInteractions().getArray();if(!1!==this.dispatchEvent(t))for(var i=e.length-1;i>=0;i--){var n=e[i];if(n.getActive())if(!n.handleEvent(t))break}}},e.prototype.handlePostRender=function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var i=this.maxTilesLoading_,n=i;if(t){var r=t.viewHints;r[Dx]&&(i=this.loadTilesWhileAnimating_?8:0,n=2),r[jx]&&(i=this.loadTilesWhileInteracting_?8:0,n=2)}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,n))}!t||!this.hasListener(O_)||t.animate||this.tileQueue_.getTilesLoading()||Yx(this.getLayers().getArray())||this.renderer_.dispatchRenderEvent(O_,t);for(var o=this.postRenderFunctions_,s=0,a=o.length;s<a;++s)o[s](this,t);o.length=0},e.prototype.handleSizeChanged_=function(){this.render()},e.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.keyHandlerKeys_){for(var e=0,i=this.keyHandlerKeys_.length;e<i;++e)bf(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null}if(t){t.appendChild(this.viewport_);var n=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[vf(n,$f,this.handleBrowserEvent,this),vf(n,Df,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),addEventListener(zf,this.handleResize_,!1))}else this.renderer_.removeLayerRenderers(),pp(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(zf,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(bf(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(bf(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.viewport_.setAttribute("data-view",sf(t)),this.viewPropertyListenerKey_=vf(t,lf,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=vf(t,kf,this.handleViewPropertyChanged_,this)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(bf),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[vf(t,lf,this.render,this),vf(t,kf,this.render,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.render=function(){void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var e,i=this.getSize(),n=this.getView(),r=[1/0,1/0,-1/0,-1/0],o=this.frameState_,s=null;if(void 0!==i&&function(t){return t[0]>0&&t[1]>0}(i)&&n&&n.isDef()){for(var a=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=this.getLayerGroup().getLayerStatesArray(),u={},h=0,c=l.length;h<c;++h)u[sf(l[h].layer)]=l[h];e=n.getState(this.pixelRatio_),s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,extent:r,focus:this.focus_?this.focus_:e.center,index:this.frameIndex_++,layerStates:u,layerStatesArray:l,pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:i,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:e,viewHints:a,wantedTiles:{}}}if(s&&(s.extent=Qp(e.center,e.resolution,e.rotation,s.size,r)),this.frameState_=s,this.renderer_.renderFrame(s),s){if(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),o)(!this.previousExtent_||!sg(this.previousExtent_)&&!Up(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Ay(ef,this,o)),this.previousExtent_=jp(this.previousExtent_));this.previousExtent_&&!s.viewHints[Dx]&&!s.viewHints[jx]&&!Up(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Ay(nf,this,s)),kp(s.extent,this.previousExtent_))}this.dispatchEvent(new Ay(tf,this,s)),setTimeout(this.handlePostRender.bind(this),0)},e.prototype.setLayerGroup=function(t){this.set(bx,t)},e.prototype.setSize=function(t){this.set(wx,t)},e.prototype.setTarget=function(t){this.set(xx,t)},e.prototype.setView=function(t){this.set(Sx,t)},e.prototype.skipFeature=function(t){this.skippedFeatureUids_[sf(t)]=!0,this.render()},e.prototype.updateSize=function(){var t=this.getTargetElement();if(t){var e=getComputedStyle(t);this.setSize([t.offsetWidth-parseFloat(e.borderLeftWidth)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderRightWidth),t.offsetHeight-parseFloat(e.borderTopWidth)-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)-parseFloat(e.borderBottomWidth)])}else this.setSize(void 0)},e.prototype.unskipFeature=function(t){delete this.skippedFeatureUids_[sf(t)],this.render()},e}(Yf);function Yx(t){for(var e=0,i=t.length;e<i;++e){var n=t[e];if("function"==typeof n.getLayers)return Yx(n.getLayers().getArray());var r=n.getSource();if(r&&r.loading)return!0}return!1}const Hx=function(t){function e(e){t.call(this),this.element=e.element?e.element:null,this.target_=null,this.map_=null,this.listenerKeys=[],this.render=e.render?e.render:Tf,e.target&&this.setTarget(e.target)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){pp(this.element),t.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&pp(this.element);for(var e=0,i=this.listenerKeys.length;e<i;++e)bf(this.listenerKeys[e]);(this.listenerKeys.length=0,this.map_=t,this.map_)&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Tf&&this.listenerKeys.push(vf(t,tf,this.render,this)),t.render())},e.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},e}(Yf);function Zx(t){this.updateElement_(t.frameState)}const Jx=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),render:i.render||Zx,target:i.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===i.collapsed||i.collapsed,this.overrideCollapsible_=void 0!==i.collapsible,this.collapsible_=void 0===i.collapsible||i.collapsible,this.collapsible_||(this.collapsed_=!1);var n=void 0!==i.className?i.className:"ol-attribution",r=void 0!==i.tipLabel?i.tipLabel:"Attributions",o=void 0!==i.collapseLabel?i.collapseLabel:"»";"string"==typeof o?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=o):this.collapseLabel_=o;var s=void 0!==i.label?i.label:"i";"string"==typeof s?(this.label_=document.createElement("span"),this.label_.textContent=s):this.label_=s;var a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,l=document.createElement("button");l.setAttribute("type","button"),l.title=r,l.appendChild(a),vf(l,Ff,this.handleClick_,this);var u=n+" "+"ol-unselectable "+ap+(this.collapsed_&&this.collapsible_?" ol-collapsed":"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=u,h.appendChild(this.ulElement_),h.appendChild(l),this.renderedAttributions_=[],this.renderedVisible_=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.collectSourceAttributions_=function(t){for(var e={},i=[],n=t.layerStatesArray,r=t.viewState.resolution,o=0,s=n.length;o<s;++o){var a=n[o];if($_(a,r)){var l=a.layer.getSource();if(l){var u=l.getAttributions();if(u){var h=u(t);if(h)if(this.overrideCollapsible_||!1!==l.getAttributionsCollapsible()||this.setCollapsible(!1),Array.isArray(h))for(var c=0,d=h.length;c<d;++c)h[c]in e||(i.push(h[c]),e[h[c]]=!0);else h in e||(i.push(h),e[h]=!0)}}}}return i},e.prototype.updateElement_=function(t){if(t){var e=this.collectSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!wg(e,this.renderedAttributions_)){gp(this.ulElement_);for(var n=0,r=e.length;n<r;++n){var o=document.createElement("li");o.innerHTML=e[n],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},e.prototype.handleToggle_=function(){this.element.classList.toggle(lp),this.collapsed_?fp(this.collapseLabel_,this.label_):fp(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e}(Hx);function Qx(t){var e=t.frameState;if(e){var i=e.viewState.rotation;if(i!=this.rotation_){var n="rotate("+i+"rad)";if(this.autoHide_){var r=this.element.classList.contains(op);r||0!==i?r&&0!==i&&this.element.classList.remove(op):this.element.classList.add(op)}this.label_.style.msTransform=n,this.label_.style.webkitTransform=n,this.label_.style.transform=n}this.rotation_=i}}const tS=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),render:i.render||Qx,target:i.target});var n=void 0!==i.className?i.className:"ol-rotate",r=void 0!==i.label?i.label:"⇧";this.label_=null,"string"==typeof r?(this.label_=document.createElement("span"),this.label_.className="ol-compass",this.label_.textContent=r):(this.label_=r,this.label_.classList.add("ol-compass"));var o=i.tipLabel?i.tipLabel:"Reset rotation",s=document.createElement("button");s.className=n+"-reset",s.setAttribute("type","button"),s.title=o,s.appendChild(this.label_),vf(s,Ff,this.handleClick_,this);var a=n+" "+"ol-unselectable "+ap,l=this.element;l.className=a,l.appendChild(s),this.callResetNorth_=i.resetNorth?i.resetNorth:void 0,this.duration_=void 0!==i.duration?i.duration:250,this.autoHide_=void 0===i.autoHide||i.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(op)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap().getView();t&&void 0!==t.getRotation()&&(this.duration_>0?t.animate({rotation:0,duration:this.duration_,easing:Lv}):t.setRotation(0))},e}(Hx);const eS=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),target:i.target});var n=void 0!==i.className?i.className:"ol-zoom",r=void 0!==i.delta?i.delta:1,o=void 0!==i.zoomInLabel?i.zoomInLabel:"+",s=void 0!==i.zoomOutLabel?i.zoomOutLabel:"−",a=void 0!==i.zoomInTipLabel?i.zoomInTipLabel:"Zoom in",l=void 0!==i.zoomOutTipLabel?i.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=n+"-in",u.setAttribute("type","button"),u.title=a,u.appendChild("string"==typeof o?document.createTextNode(o):o),vf(u,Ff,this.handleClick_.bind(this,r));var h=document.createElement("button");h.className=n+"-out",h.setAttribute("type","button"),h.title=l,h.appendChild("string"==typeof s?document.createTextNode(s):s),vf(h,Ff,this.handleClick_.bind(this,-r));var c=n+" "+"ol-unselectable "+ap,d=this.element;d.className=c,d.appendChild(u),d.appendChild(h),this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t,e){e.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var e=this.getMap().getView();if(e){var i=e.getResolution();if(i){var n=e.constrainResolution(i,t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({resolution:n,duration:this.duration_,easing:Lv})):e.setResolution(n)}}},e}(Hx);var iS=function(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0};iS.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},iS.prototype.update=function(t,e){this.points_.push(t,e,Date.now())},iS.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var i=e-3;i>0&&this.points_[i+2]>t;)i-=3;var n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;var r=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/n,this.initialVelocity_>this.minVelocity_},iS.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},iS.prototype.getAngle=function(){return this.angle_};const nS=iS;function rS(t){var e=!1;if(t.type==kv.DBLCLICK){var i=t.originalEvent,n=t.map,r=t.coordinate,o=i.shiftKey?-this.delta_:this.delta_;jv(n.getView(),o,r,this.duration_),t.preventDefault(),e=!0}return!e}const oS=function(t){function e(e){t.call(this,{handleEvent:rS});var i=e||{};this.delta_=i.delta?i.delta:1,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Bv);const sS=function(t){function e(e){t.call(this,{stopDown:Cf});var i=e||{};this.kinetic_=i.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1,this.condition_=i.condition?i.condition:i_,this.noKinetic_=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().setHint(jx,1));var e=this.targetPointers,i=Uv(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){var n=this.lastCentroid[0]-i[0],r=i[1]-this.lastCentroid[1],o=t.map.getView(),s=[n,r];Oy(s,o.getResolution()),My(s,o.getRotation()),Ry(s,o.getCenter()),s=o.constrainCenter(s),o.setCenter(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=e.length},e.prototype.handleUpEvent=function(t){var e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var n=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=i.getCenter(),s=e.getPixelFromCoordinate(o),a=e.getCoordinateFromPixel([s[0]-n*Math.cos(r),s[1]-n*Math.sin(r)]);i.animate({center:i.constrainCenter(a),duration:500,easing:Lv})}return this.panning_&&(this.panning_=!1,i.setHint(jx,-1)),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.setCenter(t.frameState.viewState.center),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},e}(zv);const aS=function(t){function e(e){var i=e||{};t.call(this,{stopDown:Cf}),this.condition_=i.condition?i.condition:Yy,this.lastAngle_=void 0,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){if(o_(t)){var e=t.map,i=e.getView();if(i.getConstraints().rotation!==Ox){var n=e.getSize(),r=t.pixel,o=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2);if(void 0!==this.lastAngle_){var s=o-this.lastAngle_,a=i.getRotation();Dv(i,a-s)}this.lastAngle_=o}}},e.prototype.handleUpEvent=function(t){if(!o_(t))return!0;var e=t.map.getView();e.setHint(jx,-1);var i=e.getRotation();return $v(e,i,void 0,this.duration_),!1},e.prototype.handleDownEvent=function(t){return!!o_(t)&&(!(!Qy(t)||!this.condition_(t))&&(t.map.getView().setHint(jx,1),this.lastAngle_=void 0,!0))},e}(zv);const lS=function(t){function e(e){t.call(this),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,i="px",n=this.element_.style;n.left=Math.min(t[0],e[0])+i,n.top=Math.min(t[1],e[1])+i,n.width=Math.abs(e[0]-t[0])+i,n.height=Math.abs(e[1]-t[1])+i},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left=e.top=e.width=e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixel,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new _v([i])},e.prototype.getGeometry=function(){return this.geometry_},e}(xf);var uS="boxstart",hS="boxdrag",cS="boxend",dS=function(t){function e(e,i,n){t.call(this,e),this.coordinate=i,this.mapBrowserEvent=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Af);function fS(){var t=this.getMap(),e=t.getView(),i=t.getSize(),n=this.getGeometry().getExtent();if(this.out_){var r=e.calculateExtent(i),o=function(t,e){return Gp(jp(e),t)}([t.getPixelFromCoordinate(Yp(n)),t.getPixelFromCoordinate(ng(n))]);!function(t,e){var i=(t[2]-t[0])/2*(e-1),n=(t[3]-t[1])/2*(e-1);t[0]-=i,t[2]+=i,t[1]-=n,t[3]+=n}(r,1/e.getResolutionForExtent(o,i)),n=r}var s=e.constrainResolution(e.getResolutionForExtent(n,i)),a=Zp(n);a=e.constrainCenter(a),e.animate({resolution:s,center:a,duration:this.duration_,easing:Lv})}const pS=function(t){function e(e){var i=e||{},n=i.condition?i.condition:n_;t.call(this,{condition:n,className:i.className||"ol-dragzoom",onBoxEnd:fS}),this.duration_=void 0!==i.duration?i.duration:200,this.out_=void 0!==i.out&&i.out}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(function(t){function e(e){t.call(this);var i=e||{};this.box_=new lS(i.className||"ol-dragbox"),this.minArea_=void 0!==i.minArea?i.minArea:64,this.onBoxEnd_=i.onBoxEnd?i.onBoxEnd:Tf,this.startPixel_=null,this.condition_=i.condition?i.condition:Zy,this.boxEndCondition_=i.boxEndCondition?i.boxEndCondition:this.defaultBoxEndCondition}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.defaultBoxEndCondition=function(t,e,i){var n=i[0]-e[0],r=i[1]-e[1];return n*n+r*r>=this.minArea_},e.prototype.getGeometry=function(){return this.box_.getGeometry()},e.prototype.handleDragEvent=function(t){o_(t)&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new dS(hS,t.coordinate,t)))},e.prototype.handleUpEvent=function(t){return!o_(t)||(this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd_(t),this.dispatchEvent(new dS(cS,t.coordinate,t))),!1)},e.prototype.handleDownEvent=function(t){return!!o_(t)&&(!(!Qy(t)||!this.condition_(t))&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new dS(uS,t.coordinate,t)),!0))},e}(zv)),gS=37,mS=38,vS=39,yS=40;function _S(t){var e=!1;if(t.type==$f){var i=t.originalEvent.keyCode;if(this.condition_(t)&&(i==yS||i==gS||i==vS||i==mS)){var n=t.map.getView(),r=n.getResolution()*this.pixelDelta_,o=0,s=0;i==yS?s=-r:i==gS?o=-r:i==vS?o=r:s=r;var a=[o,s];My(a,n.getRotation()),function(t,e,i){var n=t.getCenter();if(n){var r=t.constrainCenter([n[0]+e[0],n[1]+e[1]]);i?t.animate({duration:i,easing:Mv,center:r}):t.setCenter(r)}}(n,a,this.duration_),t.preventDefault(),e=!0}}return!e}const bS=function(t){function e(e){t.call(this,{handleEvent:_S});var i=e||{};this.defaultCondition_=function(t){return i_(t)&&r_(t)},this.condition_=void 0!==i.condition?i.condition:this.defaultCondition_,this.duration_=void 0!==i.duration?i.duration:100,this.pixelDelta_=void 0!==i.pixelDelta?i.pixelDelta:128}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Bv);function wS(t){var e=!1;if(t.type==$f||t.type==Df){var i=t.originalEvent.charCode;if(this.condition_(t)&&(i=="+".charCodeAt(0)||i=="-".charCodeAt(0))){var n=t.map,r=i=="+".charCodeAt(0)?this.delta_:-this.delta_;jv(n.getView(),r,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}const xS=function(t){function e(e){t.call(this,{handleEvent:wS});var i=e||{};this.condition_=i.condition?i.condition:r_,this.delta_=i.delta?i.delta:1,this.duration_=void 0!==i.duration?i.duration:100}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Bv);var SS="trackpad",CS="wheel";const TS=function(t){function e(e){var i=e||{};t.call(this,i),this.delta_=0,this.duration_=void 0!==i.duration?i.duration:250,this.timeout_=void 0!==i.timeout?i.timeout:80,this.useAnchor_=void 0===i.useAnchor||i.useAnchor,this.constrainResolution_=i.constrainResolution||!1,this.condition_=i.condition?i.condition:Zy,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.trackpadDeltaPerZoom_=300,this.trackpadZoomBuffer_=1.5}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.decrementInteractingHint_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().setHint(jx,-1)},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;var e=t.type;if(e!==Gf&&e!==Bf)return!0;t.preventDefault();var i,n=t.map,r=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==Gf?(i=r.deltaY,Ny&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(i/=Vy),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(i*=40)):t.type==Bf&&(i=-r.wheelDeltaY,By&&(i/=3)),0===i)return!1;var o=Date.now();if(void 0===this.startTime_&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(i)<4?SS:CS),this.mode_===SS){var s=n.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):s.setHint(jx,1),this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);var a=s.getResolution()*Math.pow(2,i/this.trackpadDeltaPerZoom_),l=s.getMinResolution(),u=s.getMaxResolution(),h=0;if(a<l?(a=Math.max(a,l/this.trackpadZoomBuffer_),h=1):a>u&&(a=Math.min(a,u*this.trackpadZoomBuffer_),h=-1),this.lastAnchor_){var c=s.calculateCenterZoom(a,this.lastAnchor_);s.setCenter(s.constrainCenter(c))}return s.setResolution(a),0===h&&this.constrainResolution_&&s.animate({resolution:s.constrainResolution(a,i>0?-1:1),easing:Lv,anchor:this.lastAnchor_,duration:this.duration_}),h>0?s.animate({resolution:l,easing:Lv,anchor:this.lastAnchor_,duration:500}):h<0&&s.animate({resolution:u,easing:Lv,anchor:this.lastAnchor_,duration:500}),this.startTime_=o,!1}this.delta_+=i;var d=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),d),!1},e.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();jv(e,-jg(this.delta_,-1,1),this.lastAnchor_,this.duration_),this.mode_=void 0,this.delta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(Bv);const ES=function(t){function e(e){var i=e||{},n=i;n.stopDown||(n.stopDown=Cf),t.call(this,n),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==i.threshold?i.threshold:.3,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){var e=0,i=this.targetPointers[0],n=this.targetPointers[1],r=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){var o=r-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=o}this.lastAngle_=r;var s=t.map,a=s.getView();if(a.getConstraints().rotation!==Ox){var l=s.getViewport().getBoundingClientRect(),u=Uv(this.targetPointers);if(u[0]-=l.left,u[1]-=l.top,this.anchor_=s.getCoordinateFromPixel(u),this.rotating_){var h=a.getRotation();s.render(),Dv(a,h+e,this.anchor_)}}},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView();if(e.setHint(jx,-1),this.rotating_){var i=e.getRotation();$v(e,i,this.anchor_,this.duration_)}return!1}return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().setHint(jx,1),!0}return!1},e}(zv);const IS=function(t){function e(e){var i=e||{},n=i;n.stopDown||(n.stopDown=Cf),t.call(this,n),this.constrainResolution_=i.constrainResolution||!1,this.anchor_=null,this.duration_=void 0!==i.duration?i.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){var e=1,i=this.targetPointers[0],n=this.targetPointers[1],r=i.clientX-n.clientX,o=i.clientY-n.clientY,s=Math.sqrt(r*r+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/s),this.lastDistance_=s;var a=t.map,l=a.getView(),u=l.getResolution(),h=l.getMaxResolution(),c=l.getMinResolution(),d=u*e;d>h?(e=h/u,d=h):d<c&&(e=c/u,d=c),1!=e&&(this.lastScaleDelta_=e);var f=a.getViewport().getBoundingClientRect(),p=Uv(this.targetPointers);p[0]-=f.left,p[1]-=f.top,this.anchor_=a.getCoordinateFromPixel(p),a.render(),Nv(l,d,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView();e.setHint(jx,-1);var i=e.getResolution();if(this.constrainResolution_||i<e.getMinResolution()||i>e.getMaxResolution()){var n=this.lastScaleDelta_-1;!function(t,e,i,n,r){e=t.constrainResolution(e,0,r),Nv(t,e,i,n)}(e,i,this.anchor_,this.duration_,n)}return!1}return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().setHint(jx,1),!0}return!1},e}(zv);function AS(t){var e=t||{},i=new Ty,n=new nS(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&i.push(new aS),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&i.push(new oS({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&i.push(new sS({condition:e.onFocusOnly?Hy:void 0,kinetic:n})),(void 0===e.pinchRotate||e.pinchRotate)&&i.push(new ES),(void 0===e.pinchZoom||e.pinchZoom)&&i.push(new IS({constrainResolution:e.constrainResolution,duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(i.push(new bS),i.push(new xS({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&i.push(new TS({condition:e.onFocusOnly?Hy:void 0,constrainResolution:e.constrainResolution,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&i.push(new pS({duration:e.zoomDuration})),i}const PS=function(t){function e(e,i,n,r,o){t.call(this,e),this.vectorContext=i,this.frameState=n,this.context=r,this.glContext=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Af);var kS=function(){};kS.prototype.drawCustom=function(t,e,i){},kS.prototype.drawGeometry=function(t){},kS.prototype.setStyle=function(t){},kS.prototype.drawCircle=function(t,e){},kS.prototype.drawEllipse=function(t,e){},kS.prototype.drawFeature=function(t,e){},kS.prototype.drawGeometryCollection=function(t,e){},kS.prototype.drawLineString=function(t,e){},kS.prototype.drawMultiLineString=function(t,e){},kS.prototype.drawMultiPoint=function(t,e){},kS.prototype.drawMultiPolygon=function(t,e){},kS.prototype.drawPoint=function(t,e){},kS.prototype.drawPolygon=function(t,e){},kS.prototype.drawText=function(t,e){},kS.prototype.setFillStrokeStyle=function(t,e){},kS.prototype.setImageStyle=function(t,e){},kS.prototype.setTextStyle=function(t,e){};const RS=kS;const LS=function(t){function e(e,i,n,r,o){t.call(this),this.context_=e,this.pixelRatio_=i,this.extent_=n,this.transform_=r,this.viewRotation_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=0,this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=0,this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=[1,0,0,1,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawImages_=function(t,e,i,n){if(this.image_){var r=Dg(t,e,i,2,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.tmpLocalTransform_,a=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=a*this.imageOpacity_);var l=this.imageRotation_;this.imageRotateWithView_&&(l+=this.viewRotation_);for(var u=0,h=r.length;u<h;u+=2){var c=r[u]-this.imageAnchorX_,d=r[u+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_){var f=c+this.imageAnchorX_,p=d+this.imageAnchorY_;Om(s,f,p,this.imageScale_,this.imageScale_,l,-f,-p),o.setTransform.apply(o,s)}o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,c,d,this.imageWidth_,this.imageHeight_)}0===l&&1==this.imageScale_||o.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(o.globalAlpha=a)}},e.prototype.drawText_=function(t,e,i,n){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var r=Dg(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.textRotation_;for(this.textRotateWithView_&&(s+=this.viewRotation_);e<i;e+=n){var a=r[e]+this.textOffsetX_,l=r[e+1]+this.textOffsetY_;if(0!==s||1!=this.textScale_){var u=Om(this.tmpLocalTransform_,a,l,this.textScale_,this.textScale_,s,-a,-l);o.setTransform.apply(o,u)}this.textStrokeState_&&o.strokeText(this.text_,a,l),this.textFillState_&&o.fillText(this.text_,a,l)}0===s&&1==this.textScale_||o.setTransform(1,0,0,1,0,0)}},e.prototype.moveToLineTo_=function(t,e,i,n,r){var o=this.context_,s=Dg(t,e,i,n,this.transform_,this.pixelCoordinates_);o.moveTo(s[0],s[1]);var a=s.length;r&&(a-=2);for(var l=2;l<a;l+=2)o.lineTo(s[l],s[l+1]);return r&&o.closePath(),i},e.prototype.drawRings_=function(t,e,i,n){for(var r=0,o=i.length;r<o;++r)e=this.moveToLineTo_(t,e,i[r],n,!0);return e},e.prototype.drawCircle=function(t){if(og(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=function(t,e,i){var n=t.getFlatCoordinates();if(n){var r=t.getStride();return Dg(n,0,n.length,r,e,i)}return null}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],r=Math.sqrt(i*i+n*n),o=this.context_;o.beginPath(),o.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.drawGeometry=function(t){switch(t.getType()){case Eg:this.drawPoint(t);break;case Ig:this.drawLineString(t);break;case Pg:case Og:case $g:this.drawPolygon(t);break;case kg:this.drawMultiPoint(t);break;case Rg:this.drawMultiLineString(t);break;case Lg:this.drawMultiPolygon(t);break;case Fg:this.drawGeometryCollection(t);break;case Mg:this.drawCircle(t)}},e.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&og(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t){for(var e=t.getGeometriesArray(),i=0,n=e.length;i<n;++i)this.drawGeometry(e[i])},e.prototype.drawPoint=function(t){var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawMultiPoint=function(t){var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawLineString=function(t){if(og(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var n=t.getFlatMidpoint();this.drawText_(n,0,2,2)}}},e.prototype.drawMultiLineString=function(t){var e=t.getExtent();if(og(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,n=t.getFlatCoordinates(),r=0,o=t.getEnds(),s=t.getStride();i.beginPath();for(var a=0,l=o.length;a<l;++a)r=this.moveToLineTo_(n,r,o[a],s,!1);i.stroke()}if(""!==this.text_){var u=t.getFlatMidpoints();this.drawText_(u,0,u.length,2)}}},e.prototype.drawPolygon=function(t){if(og(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(og(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getOrientedFlatCoordinates(),n=0,r=t.getEndss(),o=t.getStride();e.beginPath();for(var s=0,a=r.length;s<a;++s){var l=r[s];n=this.drawRings_(i,n,l,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var u=t.getFlatInteriorPoints();this.drawText_(u,0,u.length,2)}}},e.prototype.setContextFillState_=function(t){var e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=e.lineCap=t.lineCap),Gy&&(wg(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,Gy&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:Q_;i?(i.font!=t.font&&(i.font=e.font=t.font),i.textAlign!=n&&(i.textAlign=e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,e){if(t){var i=t.getColor();this.fillState_={fillStyle:q_(i||X_)}}else this.fillState_=null;if(e){var n=e.getColor(),r=e.getLineCap(),o=e.getLineDash(),s=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),u=e.getMiterLimit();this.strokeState_={lineCap:void 0!==r?r:Y_,lineDash:o||H_,lineDashOffset:s||0,lineJoin:void 0!==a?a:Z_,lineWidth:this.pixelRatio_*(void 0!==l?l:1),miterLimit:void 0!==u?u:10,strokeStyle:q_(n||J_)}}else this.strokeState_=null},e.prototype.setImageStyle=function(t){if(t){var e=t.getAnchor(),i=t.getImage(1),n=t.getOrigin(),r=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=r[1],this.image_=i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=n[0],this.imageOriginY_=n[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageWidth_=r[0]}else this.image_=null},e.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var i=e.getColor();this.textFillState_={fillStyle:q_(i||X_)}}else this.textFillState_=null;var n=t.getStroke();if(n){var r=n.getColor(),o=n.getLineCap(),s=n.getLineDash(),a=n.getLineDashOffset(),l=n.getLineJoin(),u=n.getWidth(),h=n.getMiterLimit();this.textStrokeState_={lineCap:void 0!==o?o:Y_,lineDash:s||H_,lineDashOffset:a||0,lineJoin:void 0!==l?l:Z_,lineWidth:void 0!==u?u:1,miterLimit:void 0!==h?h:10,strokeStyle:q_(r||J_)}}else this.textStrokeState_=null;var c=t.getFont(),d=t.getOffsetX(),f=t.getOffsetY(),p=t.getRotateWithView(),g=t.getRotation(),m=t.getScale(),v=t.getText(),y=t.getTextAlign(),_=t.getTextBaseline();this.textState_={font:void 0!==c?c:K_,textAlign:void 0!==y?y:Q_,textBaseline:void 0!==_?_:tb},this.text_=void 0!==v?v:"",this.textOffsetX_=void 0!==d?this.pixelRatio_*d:0,this.textOffsetY_=void 0!==f?this.pixelRatio_*f:0,this.textRotateWithView_=void 0!==p&&p,this.textRotation_=void 0!==g?g:0,this.textScale_=this.pixelRatio_*(void 0!==m?m:1)}else this.text_=""},e}(RS);var FS=function(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32};function MS(t,e,i){return e+":"+t+":"+(i?z_(i):"null")}FS.prototype.clear=function(){this.cache_={},this.cacheSize_=0},FS.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){var t=0;for(var e in this.cache_){var i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},FS.prototype.get=function(t,e,i){var n=MS(t,e,i);return n in this.cache_?this.cache_[n]:null},FS.prototype.set=function(t,e,i,n){var r=MS(t,e,i);this.cache_[r]=n,++this.cacheSize_},FS.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()};var OS=new FS;function $S(t,e){OS.expire()}function DS(t,e){return t.zIndex-e.zIndex}var jS=[];const NS=function(t){function e(e){t.call(this,e);var i=e.getViewport();this.context_=hp(),this.canvas_=this.context_.canvas,this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=sp,i.insertBefore(this.canvas_,i.childNodes[0]||null),this.renderedVisible_=!0,this.transform_=[1,0,0,1,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispatchRenderEvent=function(t,e){var i=this.getMap(),n=this.context_;if(i.hasListener(t)){var r=e.extent,o=e.pixelRatio,s=e.viewState.rotation,a=this.getTransform(e),l=new LS(n,o,r,a,s),u=new PS(t,l,e,n,null);i.dispatchEvent(u)}},e.prototype.getTransform=function(t){var e=t.viewState,i=this.canvas_.width/2,n=this.canvas_.height/2,r=t.pixelRatio/e.resolution,o=-r,s=-e.rotation,a=-e.center[0],l=-e.center[1];return Om(this.transform_,i,n,r,o,s,a,l)},e.prototype.renderFrame=function(t){if(t){var e=this.context_,i=t.pixelRatio,n=Math.round(t.size[0]*i),r=Math.round(t.size[1]*i);this.canvas_.width!=n||this.canvas_.height!=r?(this.canvas_.width=n,this.canvas_.height=r):e.clearRect(0,0,n,r);var o=t.viewState.rotation;this.calculateMatrices2D(t),this.dispatchRenderEvent(F_,t);var s=t.layerStatesArray;!function(t,e){var i,n=t.length,r=Array(t.length);for(i=0;i<n;i++)r[i]={index:i,value:t[i]};for(r.sort((function(t,i){return e(t.value,i.value)||t.index-i.index})),i=0;i<t.length;i++)t[i]=r[i].value}(s,DS),o&&(e.save(),db(e,o,n/2,r/2));var a,l,u=t.viewState.resolution;for(a=0,l=s.length;a<l;++a){var h=s[a],c=h.layer,d=this.getLayerRenderer(c);$_(h,u)&&h.sourceState==cy&&(d.prepareFrame(t,h)&&d.composeFrame(t,h,e))}o&&e.restore(),this.dispatchRenderEvent(L_,t),this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.scheduleRemoveUnusedLayerRenderers(t),this.scheduleExpireIconCache(t)}else this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1)},e.prototype.forEachLayerAtPixel=function(t,e,i,n,r,o,s){var a,l,u=e.viewState.resolution,h=e.layerStatesArray,c=h.length,d=Lm(e.pixelToCoordinateTransform,t.slice());for(l=c-1;l>=0;--l){var f=h[l],p=f.layer;if($_(f,u)&&o.call(s,p))if(a=this.getLayerRenderer(p).forEachLayerAtCoordinate(d,e,i,n,r))return a}},e.prototype.registerLayerRenderers=function(e){t.prototype.registerLayerRenderers.call(this,e);for(var i=0,n=e.length;i<n;++i){var r=e[i];vg(jS,r)||jS.push(r)}},e}(function(t){function e(e){t.call(this),this.map_=e,this.layerRenderers_={},this.layerRendererListeners_={},this.layerRendererConstructors_=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispatchRenderEvent=function(t,e){rf()},e.prototype.registerLayerRenderers=function(t){this.layerRendererConstructors_.push.apply(this.layerRendererConstructors_,t)},e.prototype.calculateMatrices2D=function(t){var e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;Om(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),function(t){var e,i=(e=t)[0]*e[3]-e[1]*e[2];vp(0!==i,32);var n=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5];t[0]=s/i,t[1]=-r/i,t[2]=-o/i,t[3]=n/i,t[4]=(o*l-s*a)/i,t[5]=-(n*l-r*a)/i}(Rm(n,i))},e.prototype.removeLayerRenderers=function(){for(var t in this.layerRenderers_)this.removeLayerRendererByKey_(t).dispose()},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r,o,s){var a,l=e.viewState,u=l.resolution;function h(t,i){var o=e.layerStates[sf(i)].managed;if(!(sf(t)in e.skippedFeatureUids)||o)return n.call(r,t,o?i:null)}var c=l.projection,d=t;if(c.canWrapX()){var f=c.getExtent(),p=rg(f),g=t[0];if(g<f[0]||g>f[2])d=[g+p*Math.ceil((f[0]-g)/p),t[1]]}var m,v=e.layerStatesArray;for(m=v.length-1;m>=0;--m){var y=v[m],_=y.layer;if($_(y,u)&&o.call(s,_)){var b=this.getLayerRenderer(_),w=_.getSource();if(w&&(a=b.forEachFeatureAtCoordinate(w.getWrapX()?d:t,e,i,h)),a)return a}}},e.prototype.forEachLayerAtPixel=function(t,e,i,n,r,o,s){return rf()},e.prototype.hasFeatureAtCoordinate=function(t,e,i,n,r){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,Sf,this,n,r)},e.prototype.getLayerRenderer=function(t){var e=sf(t);if(e in this.layerRenderers_)return this.layerRenderers_[e];for(var i,n=0,r=this.layerRendererConstructors_.length;n<r;++n){var o=this.layerRendererConstructors_[n];if(o.handles(t)){i=o.create(this,t);break}}if(!i)throw new Error("Unable to create renderer for layer: "+t.getType());return this.layerRenderers_[e]=i,this.layerRendererListeners_[e]=vf(i,kf,this.handleLayerRendererChange_,this),i},e.prototype.getLayerRendererByKey=function(t){return this.layerRenderers_[t]},e.prototype.getLayerRenderers=function(){return this.layerRenderers_},e.prototype.getMap=function(){return this.map_},e.prototype.handleLayerRendererChange_=function(){this.map_.render()},e.prototype.removeLayerRendererByKey_=function(t){var e=this.layerRenderers_[t];return delete this.layerRenderers_[t],bf(this.layerRendererListeners_[t]),delete this.layerRendererListeners_[t],e},e.prototype.removeUnusedLayerRenderers_=function(t,e){for(var i in this.layerRenderers_)e&&i in e.layerStates||this.removeLayerRendererByKey_(i).dispose()},e.prototype.renderFrame=function(t){rf()},e.prototype.scheduleExpireIconCache=function(t){t.postRenderFunctions.push($S)},e.prototype.scheduleRemoveUnusedLayerRenderers=function(t){for(var e in this.layerRenderers_)if(!(e in t.layerStates))return void t.postRenderFunctions.push(this.removeUnusedLayerRenderers_.bind(this))},e}(xf));const BS=function(t){function e(e){t.call(this,e),this.renderedResolution,this.transform_=[1,0,0,1,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clip=function(t,e,i){var n=e.pixelRatio,r=e.size[0]*n,o=e.size[1]*n,s=e.viewState.rotation,a=ig(i),l=ng(i),u=Hp(i),h=Yp(i);Lm(e.coordinateToPixelTransform,a),Lm(e.coordinateToPixelTransform,l),Lm(e.coordinateToPixelTransform,u),Lm(e.coordinateToPixelTransform,h),t.save(),db(t,-s,r/2,o/2),t.beginPath(),t.moveTo(a[0]*n,a[1]*n),t.lineTo(l[0]*n,l[1]*n),t.lineTo(u[0]*n,u[1]*n),t.lineTo(h[0]*n,h[1]*n),t.clip(),db(t,s,r/2,o/2)},e.prototype.dispatchComposeEvent_=function(t,e,i,n){var r=this.getLayer();if(r.hasListener(t)){var o=i.size[0]*i.pixelRatio,s=i.size[1]*i.pixelRatio,a=i.viewState.rotation;db(e,-a,o/2,s/2);var l=void 0!==n?n:this.getTransform(i,0),u=new LS(e,i.pixelRatio,i.extent,l,i.viewState.rotation),h=new PS(t,u,i,e,null);r.dispatchEvent(h),db(e,a,o/2,s/2)}},e.prototype.forEachLayerAtCoordinate=function(t,e,i,n,r){return this.forEachFeatureAtCoordinate(t,e,i,Sf)?n.call(r,this.getLayer(),null):void 0},e.prototype.postCompose=function(t,e,i,n){this.dispatchComposeEvent_(L_,t,e,n)},e.prototype.preCompose=function(t,e,i){this.dispatchComposeEvent_(F_,t,e,i)},e.prototype.dispatchRenderEvent=function(t,e,i){this.dispatchComposeEvent_(M_,t,e,i)},e.prototype.getTransform=function(t,e){var i=t.viewState,n=t.pixelRatio,r=n*t.size[0]/2,o=n*t.size[1]/2,s=n/i.resolution,a=-s,l=-i.rotation,u=-i.center[0]+e,h=-i.center[1];return Om(this.transform_,r,o,s,a,l,u,h)},e.prototype.composeFrame=function(t,e,i){rf()},e.prototype.prepareFrame=function(t,e){return rf()},e}(function(t){function e(e){t.call(this),this.layer_=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createLoadedTileFinder=function(t,e,i){return function(n,r){return t.forEachLoadedTile(e,n,r,(function(t){i[n]||(i[n]={}),i[n][t.tileCoord.toString()]=t}))}},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n){},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleImageChange_=function(t){t.target.getState()===ey&&this.renderIfReadyAndVisible()},e.prototype.hasFeatureAtCoordinate=function(t,e){return!1},e.prototype.loadImage=function(t){var e=t.getState();return e!=ey&&e!=iy&&vf(t,kf,this.handleImageChange_,this),e==Qv&&(t.load(),e=t.getState()),e==ey},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==cy&&this.changed()},e.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var i=function(t,e,i){var n=sf(t);n in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[n])}.bind(null,e);t.postRenderFunctions.push(i)}},e.prototype.updateUsedTiles=function(t,e,i,n){var r=sf(e),o=i.toString();r in t?o in t[r]?t[r][o].extend(n):t[r][o]=n:(t[r]={},t[r][o]=n)},e.prototype.manageTilePyramid=function(t,e,i,n,r,o,s,a,l,u){var h=sf(e);h in t.wantedTiles||(t.wantedTiles[h]={});var c,d,f,p,g,m,v=t.wantedTiles[h],y=t.tileQueue;for(m=i.getMinZoom();m<=s;++m)for(d=i.getTileRangeForExtentAndZ(o,m,d),f=i.getResolution(m),p=d.minX;p<=d.maxX;++p)for(g=d.minY;g<=d.maxY;++g)s-m<=a?((c=e.getTile(m,p,g,n,r)).getState()==Cx&&(v[c.getKey()]=!0,y.isKeyQueued(c.getKey())||y.enqueue([c,h,i.getTileCoordCenter(c.tileCoord),f])),void 0!==l&&l.call(u,c)):e.useTile(m,p,g,r)},e}(qf));const US=function(t){function e(e){t.call(this,e),this.coordinateToCanvasPixelTransform=[1,0,0,1,0,0],this.hitCanvasContext_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.composeFrame=function(t,e,i){this.preCompose(i,t);var n=this.getImage();if(n){var r=e.extent,o=void 0!==r&&!Fp(r,t.extent)&&og(r,t.extent);o&&this.clip(i,t,r);var s=this.getImageTransform(),a=i.globalAlpha;i.globalAlpha=e.opacity;var l=s[4],u=s[5],h=n.width*s[0],c=n.height*s[3];h>=.5&&c>=.5&&i.drawImage(n,0,0,+n.width,+n.height,Math.round(l),Math.round(u),Math.round(h),Math.round(c)),i.globalAlpha=a,o&&i.restore()}this.postCompose(i,t,e)},e.prototype.getImage=function(){return rf()},e.prototype.getImageTransform=function(){return rf()},e.prototype.forEachLayerAtCoordinate=function(t,e,i,n,r){if(this.getImage()){var o=Lm(this.coordinateToCanvasPixelTransform,t.slice());Oy(o,e.viewState.resolution/this.renderedResolution),this.hitCanvasContext_||(this.hitCanvasContext_=hp(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.getImage(),o[0],o[1],1,1,0,0,1,1);var s=this.hitCanvasContext_.getImageData(0,0,1,1).data;return s[3]>0?n.call(r,this.getLayer(),s):void 0}},e}(BS);var zS=function(t){function e(i){if(t.call(this,i),this.image_=null,this.imageTransform_=[1,0,0,1,0,0],this.skippedFeatures_=[],this.vectorRenderer_=null,i.getType()===S_)for(var n=0,r=jS.length;n<r;++n){var o=jS[n];if(o!==e&&o.handles(i)){this.vectorRenderer_=new o(i);break}}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.vectorRenderer_&&this.vectorRenderer_.dispose(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.image_?this.image_.getImage():null},e.prototype.getImageTransform=function(){return this.imageTransform_},e.prototype.prepareFrame=function(t,e){var i,n=t.pixelRatio,r=t.size,o=t.viewState,s=o.center,a=o.resolution,l=this.getLayer().getSource(),u=t.viewHints,h=this.vectorRenderer_,c=t.extent;if(h||void 0===e.extent||(c=eg(c,e.extent)),!u[Dx]&&!u[jx]&&!sg(c)){var d=o.projection,f=this.skippedFeatures_;if(h){var p=h.context,g=uf({},t,{size:[rg(c)/a,tg(c)/a],viewState:uf({},t.viewState,{rotation:0})}),m=Object.keys(g.skippedFeatureUids).sort();i=new _y(c,a,n,p.canvas,(function(t){!h.prepareFrame(g,e)||!h.replayGroupChanged&&wg(f,m)||(p.canvas.width=g.size[0]*n,p.canvas.height=g.size[1]*n,h.compose(p,g,e),f=m,t())}))}else i=l.getImage(c,a,n,d);i&&this.loadImage(i)&&(this.image_=i,this.skippedFeatures_=f)}if(this.image_){var v=(i=this.image_).getExtent(),y=i.getResolution(),_=i.getPixelRatio(),b=n*y/(a*_),w=Om(this.imageTransform_,n*r[0]/2,n*r[1]/2,b,b,0,_*(v[0]-s[0])/y,_*(s[1]-v[3])/y);Om(this.coordinateToCanvasPixelTransform,n*r[0]/2-w[4],n*r[1]/2-w[5],n/a,-n/a,0,-s[0],-s[1]),this.renderedResolution=y*n/_}return!!this.image_},e.prototype.forEachFeatureAtCoordinate=function(e,i,n,r){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(e,i,n,r):t.prototype.forEachFeatureAtCoordinate.call(this,e,i,n,r)},e}(US);zS.handles=function(t){return t.getType()===b_||t.getType()===S_&&t.getRenderMode()===j_},zS.create=function(t,e){return new zS(e)};const VS=zS;var GS=function(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n};function qS(t,e,i,n,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=i,r.maxY=n,r):new GS(t,e,i,n)}GS.prototype.contains=function(t){return this.containsXY(t[1],t[2])},GS.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},GS.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},GS.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},GS.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},GS.prototype.getHeight=function(){return this.maxY-this.minY+1},GS.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},GS.prototype.getWidth=function(){return this.maxX-this.minX+1},GS.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY};const WS=GS;var KS=function(t){function e(e,i){t.call(this,e),this.context=i?null:hp(),this.oversampling_,this.renderedExtent_=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=[1/0,1/0,-1/0,-1/0],this.tmpTileRange_=new WS(0,0,0,0),this.imageTransform_=[1,0,0,1,0,0],this.zDirection=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isDrawableTile_=function(t){var e=this.getLayer(),i=t.getState(),n=e.getUseInterimTilesOnError();return i==Ex||i==Ax||i==Ix&&!n},e.prototype.getTile=function(t,e,i,n,r){var o=this.getLayer(),s=o.getSource().getTile(t,e,i,n,r);return s.getState()==Ix&&(o.getUseInterimTilesOnError()?o.getPreload()>0&&(this.newTiles_=!0):s.setState(Ex)),this.isDrawableTile_(s)||(s=s.getInterimTile()),s},e.prototype.prepareFrame=function(t,e){var i=t.pixelRatio,n=t.size,r=t.viewState,o=r.projection,s=r.resolution,a=r.center,l=this.getLayer(),u=l.getSource(),h=u.getRevision(),c=u.getTileGridForProjection(o),d=c.getZForResolution(s,this.zDirection),f=c.getResolution(d),p=Math.round(s/f)||1,g=t.extent;if(void 0!==e.extent&&(g=eg(g,e.extent)),sg(g))return!1;var m=c.getTileRangeForExtentAndZ(g,d),v=c.getTileRangeExtent(d,m),y=u.getTilePixelRatio(i),_={};_[d]={};var b,w,x,S=this.createLoadedTileFinder(u,o,_),C=t.viewHints,T=C[Dx]||C[jx],E=this.tmpExtent,I=this.tmpTileRange_;for(this.newTiles_=!1,w=m.minX;w<=m.maxX;++w)for(x=m.minY;x<=m.maxY;++x)if(!(Date.now()-t.time>16&&T)){if(b=this.getTile(d,w,x,i,o),this.isDrawableTile_(b)){var A=sf(this);if(b.getState()==Ex){_[d][b.tileCoord.toString()]=b;var P=b.inTransition(A);this.newTiles_||!P&&-1!==this.renderedTiles.indexOf(b)||(this.newTiles_=!0)}if(1===b.getAlpha(A,t.time))continue}var k=c.getTileCoordChildTileRange(b.tileCoord,I,E),R=!1;k&&(R=S(d+1,k)),R||c.forEachTileCoordParentTileRange(b.tileCoord,S,null,I,E)}var L=f*i/y*p;if(!(this.renderedResolution&&Date.now()-t.time>16&&T)&&(this.newTiles_||!this.renderedExtent_||!Fp(this.renderedExtent_,g)||this.renderedRevision!=h||p!=this.oversampling_||!T&&L!=this.renderedResolution)){var F=this.context;if(F){var M=u.getTilePixelSize(d,i,o),O=Math.round(m.getWidth()*M[0]/p),$=Math.round(m.getHeight()*M[1]/p),D=F.canvas;D.width!=O||D.height!=$?(this.oversampling_=p,D.width=O,D.height=$):(this.renderedExtent_&&!Up(v,this.renderedExtent_)&&F.clearRect(0,0,O,$),p=this.oversampling_)}this.renderedTiles.length=0;var j,N,B,U,z,V,G,q,W,K,X=Object.keys(_).map(Number);for(X.sort((function(t,e){return t===d?1:e===d?-1:t>e?1:t<e?-1:0})),U=0,z=X.length;U<z;++U)for(var Y in B=X[U],N=u.getTilePixelSize(B,i,o),j=c.getResolution(B)/f,G=y*u.getGutterForProjection(o),q=_[B])b=q[Y],w=((V=c.getTileCoordExtent(b.getTileCoord(),E))[0]-v[0])/f*y/p,x=(v[3]-V[3])/f*y/p,W=N[0]*j/p,K=N[1]*j/p,this.drawTileImage(b,t,e,w,x,W,K,G,d===B),this.renderedTiles.push(b);this.renderedRevision=h,this.renderedResolution=f*i/y*p,this.renderedExtent_=v}var H=this.renderedResolution/s,Z=Om(this.imageTransform_,i*n[0]/2,i*n[1]/2,H,H,0,(this.renderedExtent_[0]-a[0])/this.renderedResolution*i,(a[1]-this.renderedExtent_[3])/this.renderedResolution*i);return Om(this.coordinateToCanvasPixelTransform,i*n[0]/2-Z[4],i*n[1]/2-Z[5],i/s,-i/s,0,-a[0],-a[1]),this.updateUsedTiles(t.usedTiles,u,d,m),this.manageTilePyramid(t,u,c,i,o,g,d,l.getPreload()),this.scheduleExpireCache(t,u),this.renderedTiles.length>0},e.prototype.drawTileImage=function(t,e,i,n,r,o,s,a,l){var u=this.getTileImage(t);if(u){var h=sf(this),c=l?t.getAlpha(h,e.time):1,d=this.getLayer().getSource();1!==c||d.getOpaque(e.viewState.projection)||this.context.clearRect(n,r,o,s);var f=c!==this.context.globalAlpha;f&&(this.context.save(),this.context.globalAlpha=c),this.context.drawImage(u,a,a,u.width-2*a,u.height-2*a,n,r,o,s),f&&this.context.restore(),1!==c?e.animate=!0:l&&t.endTransition(h)}},e.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},e.prototype.getImageTransform=function(){return this.imageTransform_},e.prototype.getTileImage=function(t){return t.getImage()},e}(US);KS.handles=function(t){return t.getType()===w_},KS.create=function(t,e){return new KS(e)},KS.prototype.getLayer;const XS=KS;var YS=function(){};YS.prototype.getReplay=function(t,e){return rf()},YS.prototype.isEmpty=function(){return rf()},YS.prototype.addDeclutter=function(t){return rf()};const HS=YS,ZS="Circle",JS="Default",QS="Image",tC="LineString",eC="Polygon",iC="Text",nC="Ellipse";function rC(t,e,i,n,r,o,s,a){for(var l,u,h,c=[],d=t[e]>t[i-n],f=r.length,p=t[e],g=t[e+1],m=t[e+=n],v=t[e+1],y=0,_=Math.sqrt(Math.pow(m-p,2)+Math.pow(v-g,2)),b="",w=0,x=0;x<f;++x){u=d?f-x-1:x;var S=r.charAt(u),C=o(b=d?S+b:b+S)-w;w+=C;for(var T=s+C/2;e<i-n&&y+_<T;)p=m,g=v,m=t[e+=n],v=t[e+1],y+=_,_=Math.sqrt(Math.pow(m-p,2)+Math.pow(v-g,2));var E=T-y,I=Math.atan2(v-g,m-p);if(d&&(I+=I>0?-Math.PI:Math.PI),void 0!==h){var A=I-h;if(A+=A>Math.PI?-2*Math.PI:A<-Math.PI?2*Math.PI:0,Math.abs(A)>a)return null}var P=E/_,k=Gg(p,m,P),R=Gg(g,v,P);h==I?(d&&(l[0]=k,l[1]=R,l[2]=C/2),l[4]=b):(w=C,l=[k,R,C/2,I,b=S],d?c.unshift(l):c.push(l),h=I),s+=C}return c}var oC={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12,ELLIPSE:13},sC=[oC.FILL],aC=[oC.STROKE],lC=[oC.BEGIN_PATH],uC=[oC.CLOSE_PATH];const hC=oC;var cC=[eC,ZS,nC,tC,QS,iC,JS],dC={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},fC=[1/0,1/0,-1/0,-1/0],pC=[1,0,0,1,0,0];const gC=function(t){function e(e,i,n,r,o,s){t.call(this),this.declutterTree=s,this.tolerance=e,this.maxExtent=i,this.overlaps=o,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=n,this.alignFill_,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=[],this.pixelCoordinates_=null,this.state={},this.viewRotation_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replayTextBackground_=function(t,e,i,n,r,o,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())},e.prototype.replayImage_=function(t,e,i,n,r,o,s,a,l,u,h,c,d,f,p,g,m,v){var y=m||v;e-=r*=d,i-=o*=d;var _,b,w,x,S=p+u>n.width?n.width-u:p,C=a+h>n.height?n.height-h:a,T=g[3]+S*d+g[1],E=g[0]+C*d+g[2],I=e-g[3],A=i-g[0];(y||0!==c)&&(_=[I,A],b=[I+T,A],w=[I+T,A+E],x=[I,A+E]);var P=null;if(0!==c){var k=e+r,R=i+o;P=Om(pC,k,R,1,1,c,-k,-R),jp(fC),Vp(fC,Lm(pC,_)),Vp(fC,Lm(pC,b)),Vp(fC,Lm(pC,w)),Vp(fC,Lm(pC,x))}else Dp(I,A,I+T,A+E,fC);var L=t.canvas,F=v?v[2]*d/2:0,M=fC[0]-F<=L.width&&fC[2]+F>=0&&fC[1]-F<=L.height&&fC[3]+F>=0;if(f&&(e=Math.round(e),i=Math.round(i)),s){if(!M&&1==s[4])return;zp(s,fC);var O=M?[t,P?P.slice(0):null,l,n,u,h,S,C,e,i,d]:null;O&&y&&O.push(m,v,_,b,w,x),s.push(O)}else M&&(y&&this.replayTextBackground_(t,_,b,w,x,m,v),pb(t,P,l,n,u,h,S,C,e,i,d))},e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))},e.prototype.appendFlatCoordinates=function(t,e,i,n,r,o){var s=this.coordinates.length,a=this.getBufferedMaxExtent();o&&(e+=n);var l,u,h,c=[t[e],t[e+1]],d=[NaN,NaN],f=!0;for(l=e+n;l<i;l+=n)d[0]=t[l],d[1]=t[l+1],(h=Op(a,d))!==u?(f&&(this.coordinates[s++]=c[0],this.coordinates[s++]=c[1]),this.coordinates[s++]=d[0],this.coordinates[s++]=d[1],f=!1):h===Sp?(this.coordinates[s++]=d[0],this.coordinates[s++]=d[1],f=!1):f=!0,c[0]=d[0],c[1]=d[1],u=h;return(r&&f||l===e+n)&&(this.coordinates[s++]=c[0],this.coordinates[s++]=c[1]),s},e.prototype.drawCustomCoordinates_=function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o],l=this.appendFlatCoordinates(t,e,a,n,!1,!1);r.push(l),e=a}return e},e.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);var n,r,o,s,a,l=t.getType(),u=t.getStride(),h=this.coordinates.length;if(l==Lg){n=(t=t).getOrientedFlatCoordinates(),s=[];var c=t.getEndss();a=0;for(var d=0,f=c.length;d<f;++d){var p=[];a=this.drawCustomCoordinates_(n,a,c[d],u,p),s.push(p)}this.instructions.push([hC.CUSTOM,h,s,t,i,Zm])}else l==Pg||l==Rg?(o=[],n=l==Pg?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),a=this.drawCustomCoordinates_(n,0,t.getEnds(),u,o),this.instructions.push([hC.CUSTOM,h,o,t,i,Hm])):l==Ig||l==kg?(n=t.getFlatCoordinates(),r=this.appendFlatCoordinates(n,0,n.length,u,!1,!1),this.instructions.push([hC.CUSTOM,h,r,t,i,Ym])):l==Eg&&(n=t.getFlatCoordinates(),this.coordinates.push(n[0],n[1]),r=this.coordinates.length,this.instructions.push([hC.CUSTOM,h,r,t,i]));this.endGeometry(t,e)},e.prototype.beginGeometry=function(t,e){this.beginGeometryInstruction1_=[hC.BEGIN_GEOMETRY,e,0],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[hC.BEGIN_GEOMETRY,e,0],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){},e.prototype.fill_=function(t){if(this.alignFill_){var e=Lm(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.setTransform.apply(t,fb)},e.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],Gy&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},e.prototype.renderDeclutter_=function(t,e){if(t&&t.length>5){var i=t[4];if(1==i||i==t.length-5){var n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};if(!this.declutterTree.collides(n)){this.declutterTree.insert(n);for(var r=5,o=t.length;r<o;++r){var s=t[r];s&&(s.length>11&&this.replayTextBackground_(s[0],s[13],s[14],s[15],s[16],s[11],s[12]),pb.apply(void 0,s))}}t.length=5,jp(t)}}},e.prototype.replay_=function(t,e,i,n,r,o,s){var a;this.pixelCoordinates_&&wg(e,this.renderedTransform_)?a=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),a=Dg(this.coordinates,0,this.coordinates.length,2,e,this.pixelCoordinates_),Rm(this.renderedTransform_,e));for(var l,u,h,c,d,f,p,g,m,v,y,_,b=!df(i),w=0,x=n.length,S=0,C=0,T=0,E=null,I=null,A=this.coordinateCache_,P=this.viewRotation_,k={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:P},R=this.instructions!=n||this.overlaps?0:200;w<x;){var L=n[w];switch(L[0]){case hC.BEGIN_GEOMETRY:v=L[1],b&&i[sf(v)]||!v.getGeometry()?w=L[2]:void 0===s||og(s,v.getGeometry().getExtent())?++w:w=L[2]+1;break;case hC.BEGIN_PATH:C>R&&(this.fill_(t),C=0),T>R&&(t.stroke(),T=0),C||T||(t.beginPath(),c=d=NaN),++w;break;case hC.CIRCLE:var F=a[S=L[1]],M=a[S+1],O=a[S+2]-F,$=a[S+3]-M,D=Math.sqrt(O*O+$*$);t.moveTo(F+D,M),t.arc(F,M,D,0,2*Math.PI,!0),++w;break;case hC.ELLIPSE:S=L[1],l=L[2];var j=a[S],N=a[S+1],B=a[S+2],U=a[S+3],z=a[S+4],V=a[S+5],G=a[S+6],q=a[S+7];if(l-S==8){var W=.2761424*(z-j),K=.2761424*(V-N),X=.2761424*(G-B),Y=.2761424*(q-U);t.moveTo(j,N),t.bezierCurveTo(j-X,N-Y,B-W,U-K,B,U),t.bezierCurveTo(B+W,U+K,z-X,V-Y,z,V),t.bezierCurveTo(z+X,V+Y,G+W,q+K,G,q),t.bezierCurveTo(G-W,q-K,j+X,N+Y,j,N)}++w;break;case hC.CLOSE_PATH:t.closePath(),++w;break;case hC.CUSTOM:S=L[1],l=L[2];var H=L[3],Z=L[4],J=6==L.length?L[5]:void 0;k.geometry=H,k.feature=v,w in A||(A[w]=[]);var Q=A[w];J?J(a,S,l,2,Q):(Q[0]=a[S],Q[1]=a[S+1],Q.length=2),Z(Q,k),++w;break;case hC.DRAW_IMAGE:S=L[1],l=L[2],m=L[3],u=L[4],h=L[5],g=o?null:L[6];var tt=L[7],et=L[8],it=L[9],nt=L[10],rt=L[11],ot=L[12],st=L[13],at=L[14],lt=void 0,ut=void 0,ht=void 0;for(L.length>16?(lt=L[15],ut=L[16],ht=L[17]):(lt=eb,ut=ht=!1),rt&&(ot+=P);S<l;S+=2)this.replayImage_(t,a[S],a[S+1],m,u,h,g,tt,et,it,nt,ot,st,r,at,lt,ut?E:null,ht?I:null);this.renderDeclutter_(g,v),++w;break;case hC.DRAW_CHARS:var ct=L[1],dt=L[2],ft=L[3];g=o?null:L[4];var pt=L[5],gt=L[6],mt=L[7],vt=L[8],yt=L[9],_t=L[10],bt=L[11],wt=L[12],xt=L[13],St=L[14],Ct=Ev(a,ct,dt,2),Tt=vt(wt);if(pt||Tt<=Ct){var Et=this,It=Et.textStates[xt].textAlign,At=rC(a,ct,dt,2,wt,vt,(Ct-Tt)*dC[It],mt);if(At){var Pt=void 0,kt=void 0,Rt=void 0,Lt=void 0,Ft=void 0;if(_t)for(Pt=0,kt=At.length;Pt<kt;++Pt)Rt=(Ft=At[Pt])[4],Lt=Et.getImage(Rt,xt,"",_t),u=Ft[2]+bt,h=ft*Lt.height+2*(.5-ft)*bt-yt,this.replayImage_(t,Ft[0],Ft[1],Lt,u,h,g,Lt.height,1,0,0,Ft[3],St,!1,Lt.width,eb,null,null);if(gt)for(Pt=0,kt=At.length;Pt<kt;++Pt)Rt=(Ft=At[Pt])[4],Lt=Et.getImage(Rt,xt,gt,""),u=Ft[2],h=ft*Lt.height-yt,this.replayImage_(t,Ft[0],Ft[1],Lt,u,h,g,Lt.height,1,0,0,Ft[3],St,!1,Lt.width,eb,null,null)}}this.renderDeclutter_(g,v),++w;break;case hC.END_GEOMETRY:if(void 0!==o){var Mt=o(v=L[1]);if(Mt)return Mt}++w;break;case hC.FILL:R?C++:this.fill_(t),++w;break;case hC.MOVE_TO_LINE_TO:for(S=L[1],l=L[2],y=a[S],p=(_=a[S+1])+.5|0,(f=y+.5|0)===c&&p===d||(t.moveTo(y,_),c=f,d=p),S+=2;S<l;S+=2)f=(y=a[S])+.5|0,p=(_=a[S+1])+.5|0,S!=l-2&&f===c&&p===d||(t.lineTo(y,_),c=f,d=p);++w;break;case hC.SET_FILL_STYLE:E=L,this.alignFill_=L[2],C&&(this.fill_(t),C=0,T&&(t.stroke(),T=0)),t.fillStyle=L[1],++w;break;case hC.SET_STROKE_STYLE:I=L,T&&(t.stroke(),T=0),this.setStrokeStyle_(t,L),++w;break;case hC.STROKE:R?T++:t.stroke(),++w;break;default:++w}}C&&this.fill_(t),T&&t.stroke()},e.prototype.replay=function(t,e,i,n,r){this.viewRotation_=i,this.replay_(t,e,n,this.instructions,r,void 0,void 0)},e.prototype.replayHitDetection=function(t,e,i,n,r,o){return this.viewRotation_=i,this.replay_(t,e,n,this.hitDetectionInstructions,!0,r,o)},e.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var i,n,r=e.length,o=-1;for(t=0;t<r;++t)(n=(i=e[t])[0])==hC.END_GEOMETRY?o=t:n==hC.BEGIN_GEOMETRY&&(i[2]=t,_g(this.hitDetectionInstructions,o,t),o=-1)},e.prototype.setFillStrokeStyle=function(t,e){var i=this.state;if(t){var n=t.getColor();i.fillStyle=q_(n||X_)}else i.fillStyle=void 0;if(e){var r=e.getColor();i.strokeStyle=q_(r||J_);var o=e.getLineCap();i.lineCap=void 0!==o?o:Y_;var s=e.getLineDash();i.lineDash=s?s.slice():H_;var a=e.getLineDashOffset();i.lineDashOffset=a||0;var l=e.getLineJoin();i.lineJoin=void 0!==l?l:Z_;var u=e.getWidth();i.lineWidth=void 0!==u?u:1;var h=e.getMiterLimit();i.miterLimit=void 0!==h?h:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},e.prototype.createFill=function(t,e){var i=t.fillStyle,n=[hC.SET_FILL_STYLE,i];return"string"!=typeof i&&n.push(!0),n},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[hC.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,e,i){var n=t.fillStyle;"string"==typeof n&&t.currentFillStyle==n||(void 0!==n&&this.instructions.push(e.call(this,t,i)),t.currentFillStyle=n)},e.prototype.updateStrokeStyle=function(t,e){var i=t.strokeStyle,n=t.lineCap,r=t.lineDash,o=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,l=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!wg(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=l)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=l)},e.prototype.endGeometry=function(t,e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var i=[hC.END_GEOMETRY,e];this.instructions.push(i),this.hitDetectionInstructions.push(i)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=kp(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;Pp(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(RS);const mC=function(t){function e(e,i,n,r,o,s){t.call(this,e,i,n,r,o,s),this.declutterGroup_=null,this.hitDetectionImage_=null,this.image_=null,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawCoordinates_=function(t,e,i,n){return this.appendFlatCoordinates(t,e,i,n,!1,!1)},e.prototype.drawPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,o=this.drawCoordinates_(i,0,i.length,n);this.instructions.push([hC.DRAW_IMAGE,r,o,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([hC.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(t,e)}},e.prototype.drawMultiPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,o=this.drawCoordinates_(i,0,i.length,n);this.instructions.push([hC.DRAW_IMAGE,r,o,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([hC.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(t,e)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0},e.prototype.setImageStyle=function(t,e){var i=t.getAnchor(),n=t.getSize(),r=t.getHitDetectionImage(1),o=t.getImage(1),s=t.getOrigin();this.anchorX_=i[0],this.anchorY_=i[1],this.declutterGroup_=e,this.hitDetectionImage_=r,this.image_=o,this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.width_=n[0]},e}(gC);const vC=function(t){function e(e,i,n,r,o,s){t.call(this,e,i,n,r,o,s)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawFlatCoordinates_=function(t,e,i,n){var r=this.coordinates.length,o=this.appendFlatCoordinates(t,e,i,n,!1,!1),s=[hC.MOVE_TO_LINE_TO,r,o];return this.instructions.push(s),this.hitDetectionInstructions.push(s),i},e.prototype.drawLineString=function(t,e){var i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0!==n&&void 0!==r){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([hC.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],lC);var o=t.getFlatCoordinates(),s=t.getStride();this.drawFlatCoordinates_(o,0,o.length,s),this.hitDetectionInstructions.push(aC),this.endGeometry(t,e)}},e.prototype.drawMultiLineString=function(t,e){var i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0!==n&&void 0!==r){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([hC.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],lC);for(var o=t.getEnds(),s=t.getFlatCoordinates(),a=t.getStride(),l=0,u=0,h=o.length;u<h;++u)l=this.drawFlatCoordinates_(s,l,o[u],a);this.hitDetectionInstructions.push(aC),this.endGeometry(t,e)}},e.prototype.finish=function(){var t=this.state;null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(aC),this.reverseHitDetectionInstructions(),this.state=null},e.prototype.applyStroke=function(e){null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(aC),e.lastStroke=this.coordinates.length),e.lastStroke=0,t.prototype.applyStroke.call(this,e),this.instructions.push(lC)},e}(gC);const yC=function(t){function e(e,i,n,r,o,s){t.call(this,e,i,n,r,o,s)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawFlatCoordinatess_=function(t,e,i,n){var r=this.state,o=void 0!==r.fillStyle,s=null!=r.strokeStyle,a=i.length;this.instructions.push(lC),this.hitDetectionInstructions.push(lC);for(var l=0;l<a;++l){var u=i[l],h=this.coordinates.length,c=this.appendFlatCoordinates(t,e,u,n,!0,!s),d=[hC.MOVE_TO_LINE_TO,h,c];this.instructions.push(d),this.hitDetectionInstructions.push(d),s&&(this.instructions.push(uC),this.hitDetectionInstructions.push(uC)),e=u}return o&&(this.instructions.push(sC),this.hitDetectionInstructions.push(sC)),s&&(this.instructions.push(aC),this.hitDetectionInstructions.push(aC)),e},e.prototype.drawCircle=function(t,e){var i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0!==n||void 0!==r){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([hC.SET_FILL_STYLE,z_(X_)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([hC.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getFlatCoordinates(),s=t.getStride(),a=this.coordinates.length;this.appendFlatCoordinates(o,0,o.length,s,!1,!1);var l=[hC.CIRCLE,a];this.instructions.push(lC,l),this.hitDetectionInstructions.push(lC,l),this.hitDetectionInstructions.push(sC),void 0!==i.fillStyle&&this.instructions.push(sC),void 0!==i.strokeStyle&&(this.instructions.push(aC),this.hitDetectionInstructions.push(aC)),this.endGeometry(t,e)}},e.prototype.drawEllipse=function(t,e){var i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0!==n||void 0!==r){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),this.hitDetectionInstructions.push([hC.SET_FILL_STYLE,z_(X_)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([hC.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getFlatCoordinates(),s=this.coordinates.length;Array.prototype.push.apply(this.coordinates,o);var a=this.coordinates.length,l=[hC.BEGIN_PATH],u=[hC.ELLIPSE,s,a];this.instructions.push(l,u),this.hitDetectionInstructions.push(l,u);var h=[hC.FILL];if(this.hitDetectionInstructions.push(h),void 0!==i.fillStyle&&this.instructions.push(h),void 0!==i.strokeStyle){var c=[hC.STROKE];this.instructions.push(c),this.hitDetectionInstructions.push(c)}this.endGeometry(t,e)}},e.prototype.drawPolygon=function(t,e){var i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0!==n||void 0!==r){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([hC.SET_FILL_STYLE,z_(X_)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([hC.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getEnds(),s=t.getOrientedFlatCoordinates(),a=t.getStride();this.drawFlatCoordinatess_(s,0,o,a),this.endGeometry(t,e)}},e.prototype.drawMultiPolygon=function(t,e){var i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0!==n||void 0!==r){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([hC.SET_FILL_STYLE,z_(X_)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([hC.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);for(var o=t.getEndss(),s=t.getOrientedFlatCoordinates(),a=t.getStride(),l=0,u=0,h=o.length;u<h;++u)l=this.drawFlatCoordinatess_(s,l,o[u],a);this.endGeometry(t,e)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(0!==t)for(var e=this.coordinates,i=0,n=e.length;i<n;++i)e[i]=tv(e[i],t)},e.prototype.setFillStrokeStyles_=function(t){var e=this.state;void 0!==e.fillStyle&&this.updateFillStyle(e,this.createFill,t),void 0!==e.strokeStyle&&this.updateStrokeStyle(e,this.applyStroke)},e}(gC);function _C(t,e,i,n,r){var o,s,a,l,u,h,c,d,f,p=i,g=i,m=0,v=0,y=i;for(o=i;o<n;o+=r){var _=e[o],b=e[o+1];void 0!==l&&(d=_-l,f=b-u,a=Math.sqrt(d*d+f*f),void 0!==h&&(v+=s,Math.acos((h*d+c*f)/(s*a))>t&&(v>m&&(m=v,p=y,g=o),v=0,y=o-r)),s=a,h=d,c=f),l=_,u=b}return(v+=a)>m?[y,o]:[p,g]}const bC="line";var wC={Circle:yC,Default:gC,Image:mC,LineString:vC,Polygon:yC,Text:function(t){function e(e,i,n,r,o,s){t.call(this,e,i,n,r,o,s),this.declutterGroup_,this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.widths_={},ib.prune()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawText=function(t,e){var i=this.textFillState_,n=this.textStrokeState_,r=this.textState_;if(""!==this.text_&&r&&(i||n)){var o,s,a=this.coordinates.length,l=t.getType(),u=null,h=2,c=2;if(r.placement===bC){if(!og(this.getBufferedMaxExtent(),t.getExtent()))return;var d;if(u=t.getFlatCoordinates(),c=t.getStride(),l==Ig)d=[u.length];else if(l==Rg)d=t.getEnds();else if(l==Pg)d=t.getEnds().slice(0,1);else if(l==Lg){var f=t.getEndss();for(d=[],o=0,s=f.length;o<s;++o)d.push(f[o][0])}this.beginGeometry(t,e);for(var p,g=r.textAlign,m=0,v=0,y=d.length;v<y;++v){if(null==g){var _=_C(r.maxAngle,u,m,d[v],c);m=_[0],p=_[1]}else p=d[v];for(o=m;o<p;o+=c)this.coordinates.push(u[o],u[o+1]);h=this.coordinates.length,m=d[v],this.drawChars_(a,h,this.declutterGroup_),a=h}this.endGeometry(t,e)}else{var b=this.getImage(this.text_,this.textKey_,this.fillKey_,this.strokeKey_),w=b.width/this.pixelRatio;switch(l){case Eg:case kg:h=(u=t.getFlatCoordinates()).length;break;case Ig:u=t.getFlatMidpoint();break;case Mg:u=t.getCenter();break;case Rg:h=(u=t.getFlatMidpoints()).length;break;case Pg:if(u=t.getFlatInteriorPoint(),!r.overflow&&u[2]/this.resolution<w)return;c=3;break;case Lg:var x=t.getFlatInteriorPoints();for(u=[],o=0,s=x.length;o<s;o+=3)(r.overflow||x[o+2]/this.resolution>=w)&&u.push(x[o],x[o+1]);if(0==(h=u.length))return}h=this.appendFlatCoordinates(u,0,h,c,!1,!1),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&(this.updateFillStyle(this.state,this.createFill,t),this.hitDetectionInstructions.push(this.createFill(this.state,t))),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e),this.drawTextImage_(b,a,h),this.endGeometry(t,e)}}},e.prototype.getImage=function(t,e,i,n){var r,o=n+e+t+i+this.pixelRatio;if(!ib.containsKey(o)){var s=n?this.strokeStates[n]||this.textStrokeState_:null,a=i?this.fillStates[i]||this.textFillState_:null,l=this.textStates[e]||this.textState_,u=this.pixelRatio,h=l.scale*u,c=dC[l.textAlign||Q_],d=n&&s.lineWidth?s.lineWidth:0,f=t.split("\n"),p=f.length,g=[],m=function(t,e,i){for(var n=e.length,r=0,o=0;o<n;++o){var s=cb(t,e[o]);r=Math.max(r,s),i.push(s)}return r}(l.font,f,g),v=hb(l.font),y=v*p,_=m+d,b=hp(Math.ceil(_*h),Math.ceil((y+d)*h));r=b.canvas,ib.set(o,r),1!=h&&b.scale(h,h),b.font=l.font,n&&(b.strokeStyle=s.strokeStyle,b.lineWidth=d,b.lineCap=s.lineCap,b.lineJoin=s.lineJoin,b.miterLimit=s.miterLimit,Gy&&s.lineDash.length&&(b.setLineDash(s.lineDash),b.lineDashOffset=s.lineDashOffset)),i&&(b.fillStyle=a.fillStyle),b.textBaseline="middle",b.textAlign="center";var w,x=.5-c,S=c*r.width/h+x*d;if(n)for(w=0;w<p;++w)b.strokeText(f[w],S+x*g[w],.5*(d+v)+w*v);if(i)for(w=0;w<p;++w)b.fillText(f[w],S+x*g[w],.5*(d+v)+w*v)}return ib.get(o)},e.prototype.drawTextImage_=function(t,e,i){var n=this.textState_,r=this.textStrokeState_,o=this.pixelRatio,s=dC[n.textAlign||Q_],a=dC[n.textBaseline],l=r&&r.lineWidth?r.lineWidth:0,u=s*t.width/o+2*(.5-s)*l,h=a*t.height/o+2*(.5-a)*l;this.instructions.push([hC.DRAW_IMAGE,e,i,t,(u-this.textOffsetX_)*o,(h-this.textOffsetY_)*o,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1,t.width,n.padding==eb?eb:n.padding.map((function(t){return t*o})),!!n.backgroundFill,!!n.backgroundStroke]),this.hitDetectionInstructions.push([hC.DRAW_IMAGE,e,i,t,(u-this.textOffsetX_)*o,(h-this.textOffsetY_)*o,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1/o,t.width,n.padding,!!n.backgroundFill,!!n.backgroundStroke])},e.prototype.drawChars_=function(t,e,i){var n=this.textStrokeState_,r=this.textState_,o=this.textFillState_,s=this.strokeKey_;n&&(s in this.strokeStates||(this.strokeStates[s]={strokeStyle:n.strokeStyle,lineCap:n.lineCap,lineDashOffset:n.lineDashOffset,lineWidth:n.lineWidth,lineJoin:n.lineJoin,miterLimit:n.miterLimit,lineDash:n.lineDash}));var a=this.textKey_;this.textKey_ in this.textStates||(this.textStates[this.textKey_]={font:r.font,textAlign:r.textAlign||Q_,scale:r.scale});var l=this.fillKey_;o&&(l in this.fillStates||(this.fillStates[l]={fillStyle:o.fillStyle}));var u=this.pixelRatio,h=dC[r.textBaseline],c=this.textOffsetY_*u,d=this.text_,f=r.font,p=r.scale,g=n?n.lineWidth*p/2:0,m=this.widths_[f];m||(this.widths_[f]=m={}),this.instructions.push([hC.DRAW_CHARS,t,e,h,i,r.overflow,l,r.maxAngle,function(t){var e=m[t];return e||(e=m[t]=cb(f,t)),e*p*u},c,s,g*u,d,a,1]),this.hitDetectionInstructions.push([hC.DRAW_CHARS,t,e,h,i,r.overflow,l,r.maxAngle,function(t){var e=m[t];return e||(e=m[t]=cb(f,t)),e*p},c,s,g,d,a,1/u])},e.prototype.setTextStyle=function(t,e){var i,n,r;if(t){this.declutterGroup_=e;var o=t.getFill();o?((n=this.textFillState_)||(n=this.textFillState_={}),n.fillStyle=q_(o.getColor()||X_)):n=this.textFillState_=null;var s=t.getStroke();if(s){(r=this.textStrokeState_)||(r=this.textStrokeState_={});var a=s.getLineDash(),l=s.getLineDashOffset(),u=s.getWidth(),h=s.getMiterLimit();r.lineCap=s.getLineCap()||Y_,r.lineDash=a?a.slice():H_,r.lineDashOffset=void 0===l?0:l,r.lineJoin=s.getLineJoin()||Z_,r.lineWidth=void 0===u?1:u,r.miterLimit=void 0===h?10:h,r.strokeStyle=q_(s.getColor()||J_)}else r=this.textStrokeState_=null;i=this.textState_;var c=t.getFont()||K_;sb(c);var d=t.getScale();i.overflow=t.getOverflow(),i.font=c,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.textBaseline=t.getTextBaseline()||tb,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||eb,i.scale=void 0===d?1:d;var f=t.getOffsetX(),p=t.getOffsetY(),g=t.getRotateWithView(),m=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===f?0:f,this.textOffsetY_=void 0===p?0:p,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===m?0:m,this.strokeKey_=r?("string"==typeof r.strokeStyle?r.strokeStyle:sf(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+sf(n.fillStyle):""}else this.text_=""},e}(gC),Ellipse:yC},xC=function(t){function e(e,i,n,r,o,s,a){t.call(this),this.declutterTree_=s,this.declutterGroup_=null,this.tolerance_=e,this.maxExtent_=i,this.overlaps_=o,this.pixelRatio_=r,this.resolution_=n,this.renderBuffer_=a,this.replaysByZIndex_={},this.hitDetectionContext_=hp(1,1),this.hitDetectionTransform_=[1,0,0,1,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addDeclutter=function(t){var e=null;return this.declutterTree_&&(t?(e=this.declutterGroup_)[4]++:(e=this.declutterGroup_=[1/0,1/0,-1/0,-1/0]).push(1)),e},e.prototype.clip=function(t,e){var i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()},e.prototype.hasReplays=function(t){for(var e in this.replaysByZIndex_)for(var i=this.replaysByZIndex_[e],n=0,r=t.length;n<r;++n)if(t[n]in i)return!0;return!1},e.prototype.finish=function(){for(var t in this.replaysByZIndex_){var e=this.replaysByZIndex_[t];for(var i in e)e[i].finish()}},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r,o,s){var a,l=2*(n=Math.round(n))+1,u=Om(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),h=this.hitDetectionContext_;h.canvas.width!==l||h.canvas.height!==l?(h.canvas.width=l,h.canvas.height=l):h.clearRect(0,0,l,l),void 0!==this.renderBuffer_&&(Vp(a=[1/0,1/0,-1/0,-1/0],t),Pp(a,e*(this.renderBuffer_+n),a));var c,d,f=function(t){if(void 0!==SC[t])return SC[t];for(var e=2*t+1,i=new Array(e),n=0;n<e;n++)i[n]=new Array(e);var r=t,o=0,s=0;for(;r>=o;)CC(i,t+r,t+o),CC(i,t+o,t+r),CC(i,t-o,t+r),CC(i,t-r,t+o),CC(i,t-r,t-o),CC(i,t-o,t-r),CC(i,t+o,t-r),CC(i,t+r,t-o),2*((s+=1+2*++o)-r)+1>0&&(s+=1-2*(r-=1));return SC[t]=i,i}(n);function p(t){for(var e=h.getImageData(0,0,l,l).data,i=0;i<l;i++)for(var n=0;n<l;n++)if(f[i][n]&&e[4*(n*l+i)+3]>0){var r=void 0;return(!c||d!=QS&&d!=iC||-1!==c.indexOf(t))&&(r=o(t)),r||void h.clearRect(0,0,l,l)}}this.declutterTree_&&(c=this.declutterTree_.all().map((function(t){return t.value})));var g,m,v,y,_,b=Object.keys(this.replaysByZIndex_).map(Number);for(b.sort(mg),g=b.length-1;g>=0;--g){var w=b[g].toString();for(v=this.replaysByZIndex_[w],m=cC.length-1;m>=0;--m)if(void 0!==(y=v[d=cC[m]]))if(!s||d!=QS&&d!=iC){if(_=y.replayHitDetection(h,u,i,r,p,a))return _}else{var x=s[w];x?x.push(y,u.slice(0)):s[w]=[y,u.slice(0)]}}},e.prototype.getClipCoords=function(t){var e=this.maxExtent_,i=e[0],n=e[1],r=e[2],o=e[3],s=[i,n,i,o,r,o,r,n];return Dg(s,0,8,2,t,s),s},e.prototype.getReplay=function(t,e){var i=void 0!==t?t.toString():"0",n=this.replaysByZIndex_[i];void 0===n&&(n={},this.replaysByZIndex_[i]=n);var r=n[e];void 0===r&&(r=new(0,wC[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_,this.overlaps_,this.declutterTree_),n[e]=r);return r},e.prototype.getReplays=function(){return this.replaysByZIndex_},e.prototype.isEmpty=function(){return df(this.replaysByZIndex_)},e.prototype.replay=function(t,e,i,n,r,o,s){var a=Object.keys(this.replaysByZIndex_).map(Number);a.sort(mg),t.save(),this.clip(t,e);var l,u,h,c,d,f,p=o||cC;for(l=0,u=a.length;l<u;++l){var g=a[l].toString();for(d=this.replaysByZIndex_[g],h=0,c=p.length;h<c;++h){var m=p[h];if(f=d[m],void 0!==f)if(!s||m!=QS&&m!=iC)f.replay(t,e,i,n,r);else{var v=s[g];v?v.push(f,e.slice(0)):s[g]=[f,e.slice(0)]}}}t.restore()},e}(HS),SC={0:[[!0]]};function CC(t,e,i){var n,r=Math.floor(t.length/2);if(e>=r)for(n=r;n<e;n++)t[n][i]=!0;else if(e<r)for(n=e+1;n<r;n++)t[n][i]=!0}const TC=xC;var EC={Point:function(t,e,i,n){var r=i.getImage();if(r){if(r.getImageState()!=ey)return;var o=t.getReplay(i.getZIndex(),QS);o.setImageStyle(r,t.addDeclutter(!1)),o.drawPoint(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),iC);a.setTextStyle(s,t.addDeclutter(!!r)),a.drawText(e,n)}},LineString:function(t,e,i,n){var r=i.getStroke();if(r){var o=t.getReplay(i.getZIndex(),tC);o.setFillStrokeStyle(null,r),o.drawLineString(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),iC);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n)}},Polygon:LC,MultiPoint:function(t,e,i,n){var r=i.getImage();if(r){if(r.getImageState()!=ey)return;var o=t.getReplay(i.getZIndex(),QS);o.setImageStyle(r,t.addDeclutter(!1)),o.drawMultiPoint(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),iC);a.setTextStyle(s,t.addDeclutter(!!r)),a.drawText(e,n)}},MultiLineString:function(t,e,i,n){var r=i.getStroke();if(r){var o=t.getReplay(i.getZIndex(),tC);o.setFillStrokeStyle(null,r),o.drawMultiLineString(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),iC);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n)}},MultiPolygon:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(o||r){var s=t.getReplay(i.getZIndex(),eC);s.setFillStrokeStyle(r,o),s.drawMultiPolygon(e,n)}var a=i.getText();if(a){var l=t.getReplay(i.getZIndex(),iC);l.setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n)}},GeometryCollection:function(t,e,i,n){var r,o,s=e.getGeometriesArray();for(r=0,o=s.length;r<o;++r){(0,EC[s[r].getType()])(t,s[r],i,n)}},Circle:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(r||o){var s=t.getReplay(i.getZIndex(),ZS);s.setFillStrokeStyle(r,o),s.drawCircle(e,n)}var a=i.getText();if(a){var l=t.getReplay(i.getZIndex(),iC);l.setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n)}},Rectangle:LC,Ellipse:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(r||o){var s=t.getReplay(i.getZIndex(),nC);s.setFillStrokeStyle(r,o),s.drawEllipse(e,n)}var a=i.getText();if(a){var l=t.getReplay(i.getZIndex(),iC);l.setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n)}}};function IC(t,e){return parseInt(sf(t),10)-parseInt(sf(e),10)}function AC(t,e){var i=PC(t,e);return i*i}function PC(t,e){return.5*t/e}function kC(t,e,i,n,r,o){var s=!1,a=i.getImage();if(a){var l=a.getImageState();l==ey||l==iy?a.unlistenImageChange(r,o):(l==Qv&&a.load(),l=a.getImageState(),a.listenImageChange(r,o),s=!0)}return function(t,e,i,n){var r=i.getGeometryFunction()(e);if(!r)return;var o=r.getSimplifiedGeometry(n);if(i.getRenderer())RC(t,o,i,e);else{(0,EC[o.getType()])(t,o,i,e)}}(t,e,i,n),s}function RC(t,e,i,n){if(e.getType()!=Fg)t.getReplay(i.getZIndex(),JS).drawCustom(e,n,i.getRenderer());else for(var r=e.getGeometries(),o=0,s=r.length;o<s;++o)RC(t,r[o],i,n)}function LC(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(r||o){var s=t.getReplay(i.getZIndex(),eC);s.setFillStrokeStyle(r,o),s.drawPolygon(e,n)}var a=i.getText();if(a){var l=t.getReplay(i.getZIndex(),iC);l.setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n)}}var FC=function(t){function e(e){t.call(this,e),this.declutterTree_=e.getDeclutter()?zb()(9,void 0):null,this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.context=hp(),vf(ib,Rf,this.handleFontsChanged_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){_f(ib,Rf,this.handleFontsChanged_,this),t.prototype.disposeInternal.call(this)},e.prototype.compose=function(t,e,i){var n=e.extent,r=e.pixelRatio,o=i.managed?e.skippedFeatureUids:{},s=e.viewState,a=s.projection,l=s.rotation,u=a.getExtent(),h=this.getLayer().getSource(),c=this.getTransform(e,0),d=i.extent,f=void 0!==d;f&&this.clip(t,e,d);var p=this.replayGroup_;if(p&&!p.isEmpty()){this.declutterTree_&&this.declutterTree_.clear();var g,m=this.getLayer(),v=0,y=0,_=1!==i.opacity,b=m.hasListener(M_);if(_||b){var w=t.canvas.width,x=t.canvas.height;if(l){var S=Math.round(Math.sqrt(w*w+x*x));v=(S-w)/2,y=(S-x)/2,w=x=S}this.context.canvas.width=w,this.context.canvas.height=x,g=this.context}else g=t;var C=g.globalAlpha;_||(g.globalAlpha=i.opacity),g!=t&&g.translate(v,y);var T=e.viewHints,E=!(T[Dx]||T[jx]),I=e.size[0]*r,A=e.size[1]*r;if(db(g,-l,I/2,A/2),p.replay(g,c,l,o,E),h.getWrapX()&&a.canWrapX()&&!Fp(u,n)){for(var P,k=n[0],R=rg(u),L=0;k<u[0];)P=R*--L,c=this.getTransform(e,P),p.replay(g,c,l,o,E),k+=R;for(L=0,k=n[2];k>u[2];)P=R*++L,c=this.getTransform(e,P),p.replay(g,c,l,o,E),k-=R}if(db(g,l,I/2,A/2),b&&this.dispatchRenderEvent(g,e,c),g!=t){if(_){var F=t.globalAlpha;t.globalAlpha=i.opacity,t.drawImage(g.canvas,-v,-y),t.globalAlpha=F}else t.drawImage(g.canvas,-v,-y);g.translate(-v,-y)}_||(g.globalAlpha=C)}f&&t.restore()},e.prototype.composeFrame=function(t,e,i){var n=this.getTransform(t,0);this.preCompose(i,t,n),this.compose(i,t,e),this.postCompose(i,t,e,n)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r){if(this.replayGroup_){var o=e.viewState.resolution,s=e.viewState.rotation,a=this.getLayer(),l={};return this.replayGroup_.forEachFeatureAtCoordinate(t,o,s,i,{},(function(t){var e=sf(t);if(!(e in l))return l[e]=!0,n.call(r,t,a)}),null)}},e.prototype.handleFontsChanged_=function(t){var e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t,e){var i=this.getLayer(),n=i.getSource(),r=t.viewHints[Dx],o=t.viewHints[jx],s=i.getUpdateWhileAnimating(),a=i.getUpdateWhileInteracting();if(!this.dirty_&&!s&&r||!a&&o)return!0;var l=t.extent,u=t.viewState,h=u.projection,c=u.resolution,d=t.pixelRatio,f=i.getRevision(),p=i.getRenderBuffer(),g=i.getRenderOrder();void 0===g&&(g=IC);var m=Pp(l,p*c),v=u.projection.getExtent();if(n.getWrapX()&&u.projection.canWrapX()&&!Fp(v,t.extent)){var y=rg(v),_=Math.max(rg(m)/2,y);m[0]=v[0]-_,m[2]=v[2]+_}if(!this.dirty_&&this.renderedResolution_==c&&this.renderedRevision_==f&&this.renderedRenderOrder_==g&&Fp(this.renderedExtent_,m))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var b=new TC(PC(c,d),m,c,d,n.getOverlaps(),this.declutterTree_,i.getRenderBuffer());n.loadFeatures(m,c,h);var w=function(t){var e,n=t.getStyleFunction()||i.getStyleFunction();if(n&&(e=n(t,c)),e){var r=this.renderFeature(t,c,d,e,b);this.dirty_=this.dirty_||r}}.bind(this);if(g){var x=[];n.forEachFeatureInExtent(m,(function(t){x.push(t)})),x.sort(g);for(var S=0,C=x.length;S<C;++S)w(x[S])}else n.forEachFeatureInExtent(m,w);return b.finish(),this.renderedResolution_=c,this.renderedRevision_=f,this.renderedRenderOrder_=g,this.renderedExtent_=m,this.replayGroup_=b,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,e,i,n,r){if(!n)return!1;var o=!1;if(Array.isArray(n))for(var s=0,a=n.length;s<a;++s)o=kC(r,t,n[s],AC(e,i),this.handleStyleImageChange_,this)||o;else o=kC(r,t,n,AC(e,i),this.handleStyleImageChange_,this);return o},e}(BS);FC.handles=function(t){return t.getType()===S_},FC.create=function(t,e){return new FC(e)};const MC=FC,OC="image",$C="vector";var DC={image:[eC,ZS,tC,QS,iC],hybrid:[eC,tC]},jC={image:[JS],hybrid:[QS,iC,JS],vector:cC},NC=function(t){function e(e){t.call(this,e,!0),this.declutterTree_=e.getDeclutter()?zb()(9,void 0):null,this.dirty_=!1,this.renderedLayerRevision_,this.tmpTransform_=[1,0,0,1,0,0];var i=e.getRenderMode();this.zDirection=i===$C?1:0,i!==$C&&(this.context=hp()),vf(ib,Rf,this.handleFontsChanged_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){_f(ib,Rf,this.handleFontsChanged_,this),t.prototype.disposeInternal.call(this)},e.prototype.getTile=function(e,i,n,r,o){var s=t.prototype.getTile.call(this,e,i,n,r,o);return s.getState()===Ex&&(this.createReplayGroup_(s,r,o),this.context&&this.renderTileImage_(s,r,o)),s},e.prototype.getTileImage=function(t){var e=this.getLayer();return t.getImage(e)},e.prototype.prepareFrame=function(e,i){var n=this.getLayer().getRevision();return this.renderedLayerRevision_!=n&&(this.renderedTiles.length=0),this.renderedLayerRevision_=n,t.prototype.prepareFrame.call(this,e,i)},e.prototype.createReplayGroup_=function(t,e,i){var n=this,r=this.getLayer(),o=r.getRevision(),s=r.getRenderOrder()||null,a=t.getReplayState(r);if(a.dirty||a.renderedRevision!=o||a.renderedRenderOrder!=s){for(var l=r.getSource(),u=l.getTileGrid(),h=l.getTileGridForProjection(i).getResolution(t.tileCoord[0]),c=t.extent,d=function(o,d){var f=t.getTile(t.tileKeys[o]);if(f.getState()==Ex){var p=f.tileCoord,g=u.getTileCoordExtent(p),m=eg(c,g),v=Up(g,m)?null:Pp(m,r.getRenderBuffer()*h,n.tmpExtent),y=f.getProjection(),_=!1;Sm(i,y)||(_=!0,f.setProjection(i)),a.dirty=!1;var b=new TC(0,m,h,e,l.getOverlaps(),n.declutterTree_,r.getRenderBuffer()),w=AC(h,e),x=function(t){var e,i=t.getStyleFunction()||r.getStyleFunction();if(i&&(e=i(t,h)),e){var n=this.renderFeature(t,w,e,b);this.dirty_=this.dirty_||n,a.dirty=a.dirty||n}},S=f.getFeatures();s&&s!==a.renderedRenderOrder&&S.sort(s);for(var C=0,T=S.length;C<T;++C){var E=S[C];_&&(y.getUnits()==Yg.TILE_PIXELS&&(y.setWorldExtent(g),y.setExtent(f.getExtent())),E.getGeometry().transform(y,i)),v&&!og(v,E.getGeometry().getExtent())||x.call(n,E)}b.finish(),f.setReplayGroup(r,t.tileCoord.toString(),b)}},f=0,p=t.tileKeys.length;f<p;++f)d(f);a.renderedRevision=o,a.renderedRenderOrder=s}},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r){var o=e.viewState.resolution,s=e.viewState.rotation;i=null==i?0:i;var a,l,u,h,c=this.getLayer(),d={},f=this.renderedTiles;for(u=0,h=f.length;u<h;++u){var p=f[u];if(Lp(a=Pp(p.extent,i*o,a),t))for(var g=0,m=p.tileKeys.length;g<m;++g){var v=p.getTile(p.tileKeys[g]);if(v.getState()==Ex){var y=v.getReplayGroup(c,p.tileCoord.toString());l=l||y.forEachFeatureAtCoordinate(t,o,s,i,{},(function(t){var e=sf(t);if(!(e in d))return d[e]=!0,n.call(r,t,c)}),null)}}}return l},e.prototype.getReplayTransform_=function(t,e){var i=this.getLayer().getSource().getTileGrid(),n=t.tileCoord,r=i.getResolution(n[0]),o=e.viewState,s=e.pixelRatio,a=o.resolution/s,l=i.getTileCoordExtent(n,this.tmpExtent),u=o.center,h=ig(l),c=e.size,d=Math.round(s*c[0]/2),f=Math.round(s*c[1]/2);return Om(this.tmpTransform_,d,f,r/a,r/a,o.rotation,(h[0]-u[0])/r,(u[1]-h[1])/r)},e.prototype.handleFontsChanged_=function(t){var e=this.getLayer();e.getVisible()&&void 0!==this.renderedLayerRevision_&&e.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.postCompose=function(e,i,n){var r=this.getLayer(),o=r.getRenderMode();if(o!=OC){var s,a,l=r.getDeclutter()?{}:null,u=r.getSource(),h=jC[o],c=i.pixelRatio,d=i.viewState.rotation,f=i.size;d&&db(e,-d,s=Math.round(c*f[0]/2),a=Math.round(c*f[1]/2)),l&&this.declutterTree_.clear();for(var p=i.viewHints,g=!(p[Dx]||p[jx]),m=this.renderedTiles,v=u.getTileGridForProjection(i.viewState.projection),y=[],_=[],b=m.length-1;b>=0;--b){var w=m[b];if(w.getState()!=Px)for(var x=w.tileCoord,S=v.getTileCoordExtent(x,this.tmpExtent)[0]-w.extent[0],C=void 0,T=0,E=w.tileKeys.length;T<E;++T){var I=w.getTile(w.tileKeys[T]);if(I.getState()==Ex){var A=I.getReplayGroup(r,x.toString());if(A&&A.hasReplays(h)){C||(C=this.getTransform(i,S));var P=I.tileCoord[0],k=A.getClipCoords(C);e.save(),e.globalAlpha=n.opacity;for(var R=0,L=y.length;R<L;++R){var F=y[R];P<_[R]&&(e.beginPath(),e.moveTo(k[0],k[1]),e.lineTo(k[2],k[3]),e.lineTo(k[4],k[5]),e.lineTo(k[6],k[7]),e.moveTo(F[6],F[7]),e.lineTo(F[4],F[5]),e.lineTo(F[2],F[3]),e.lineTo(F[0],F[1]),e.clip())}A.replay(e,C,d,{},g,h,l),e.restore(),y.push(k),_.push(P)}}}}l&&function(t,e,i,n){for(var r=Object.keys(t).map(Number).sort(mg),o={},s=0,a=r.length;s<a;++s)for(var l=t[r[s].toString()],u=0,h=l.length;u<h;){var c=l[u++],d=l[u++];c.replay(e,d,i,o,n)}}(l,e,d,g),d&&db(e,d,s,a)}t.prototype.postCompose.call(this,e,i,n)},e.prototype.renderFeature=function(t,e,i,n){if(!i)return!1;var r=!1;if(Array.isArray(i))for(var o=0,s=i.length;o<s;++o)r=kC(n,t,i[o],e,this.handleStyleImageChange_,this)||r;else r=kC(n,t,i,e,this.handleStyleImageChange_,this);return r},e.prototype.renderTileImage_=function(t,e,i){var n=this.getLayer(),r=t.getReplayState(n),o=n.getRevision(),s=DC[n.getRenderMode()];if(s&&r.renderedTileRevision!==o){r.renderedTileRevision=o;var a=t.wrappedTileCoord,l=a[0],u=n.getSource(),h=u.getTileGridForProjection(i),c=h.getResolution(l),d=t.getContext(n),f=u.getTilePixelSize(l,e,i);d.canvas.width=f[0],d.canvas.height=f[1];for(var p=h.getTileCoordExtent(a,this.tmpExtent),g=0,m=t.tileKeys.length;g<m;++g){var v=t.getTile(t.tileKeys[g]);if(v.getState()==Ex){var y=e/c,_=Am(this.tmpTransform_);Fm(_,y,-y),Mm(_,-p[0],-p[3]),v.getReplayGroup(n,t.tileCoord.toString()).replay(d,_,0,{},!0,s)}}}},e}(XS);NC.handles=function(t){return t.getType()===x_},NC.create=function(t,e){return new NC(e)};const BC=NC;const UC=function(t){function e(e){(e=uf({},e)).controls||(e.controls=function(t){var e=t||{},i=new Ty;return(void 0===e.zoom||e.zoom)&&i.push(new eS(e.zoomOptions)),(void 0===e.rotate||e.rotate)&&i.push(new tS(e.rotateOptions)),(void 0===e.attribution||e.attribution)&&i.push(new Jx(e.attributionOptions)),i}()),e.interactions||(e.interactions=AS()),t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createRenderer=function(){var t=new NS(this);return t.registerLayerRenderers([VS,XS,MC,BC]),t},e}(Xx);var zC,VC;const GC=Tl({data:function(){return{hasMeasureFeature:!1,measureFeaturePosition:[0,0]}},computed:{isMeasuring:function(){return"measure"===this.interactionMode}},methods:{toggleMeasuring:function(){this.isMeasuring?this.resetInteractionMode():this.interactionMode="measure"},handleMeasureDrawStart:function(t){zC.getSource().clear(),this.setMeasureFeature(t.feature)},updateMeasureFeature:function(t){this.measureFeaturePosition=t.target.getGeometry().getLastCoordinate(),this.$emit("changeMeasureFeature",[t.target])},setMeasureFeature:function(t){this.measureFeature=t,this.hasMeasureFeature=!!t,t&&(this.updateMeasureFeature({target:t}),t.on("change",this.updateMeasureFeature))}},watch:{isMeasuring:function(t){t?(this.map.addLayer(zC),this.map.addInteraction(VC),this.$emit("measuring")):(zC.getSource().clear(),this.setMeasureFeature(void 0),this.map.removeLayer(zC),this.map.removeInteraction(VC))},image:function(){this.isMeasuring&&this.$nextTick((function(){this.updateMeasureFeature({target:this.measureFeature})}))}},created:function(){zC=new kb({source:new Wb,style:vw.editing,zIndex:200,updateWhileAnimating:!0,updateWhileInteracting:!0}),(VC=new rw({source:zC.getSource(),type:"LineString",style:zC.getStyle()})).on("drawstart",this.handleMeasureDrawStart),Ll.on("Shift+f",this.toggleMeasuring,0,this.listenerSet),this.measureFeature=void 0}},undefined,undefined,!1,null,null,null).exports;const qC=Tl({props:{extent:{type:Array,required:!0},intendedWidth:{type:Number,default:250},intendedHeight:{type:Number,default:200}},data:function(){return{}},computed:{minimap:function(){return new UC({controls:[],interactions:[]})},viewport:function(){return new Iy}},methods:{updateViewport:function(){this.mapSize&&this.mapView.getCenter()&&this.viewport.setGeometry(bv(this.mapView.calculateExtent(this.mapSize)))},dragViewport:function(t){this.mapView.setCenter(t.coordinate)},updateMapSize:function(t){this.mapSize=t.target.getSize()},updateMapView:function(t){this.mapView&&(this.mapView.un("change:center",this.updateViewport),this.mapView.un("change:resolution",this.updateViewport)),this.mapView=t.target.getView(),this.mapView.on("change:center",this.updateViewport),this.mapView.on("change:resolution",this.updateViewport)},updateElementSize:function(){var t=this.extent[2],e=this.extent[3],i=Math.max(t/this.intendedWidth,e/this.intendedHeight);this.minimap.setView(new Gx({projection:this.mapView.getProjection(),center:Zp(this.extent),resolution:i})),this.$el.style.width=Math.round(t/i)+"px",this.$el.style.height=Math.round(e/i)+"px",this.minimap.updateSize()},refreshImageLayer:function(t){var e=t.element.get("name");if(e&&e.startsWith("image")){var i=this.minimap.getLayers();i.getLength()>1?i.setAt(0,t.element):i.insertAt(0,t.element)}},initImageLayer:function(t){var e=this;t.getArray().forEach((function(t){e.refreshImageLayer({element:t})}))},render:function(){this.minimap.render()}},watch:{extent:function(){this.updateElementSize()}},created:function(){var t=new Wb;t.addFeature(this.viewport);var e=this.$parent.map;this.mapSize=e.getSize(),this.updateMapView({target:e}),e.on("change:size",this.updateMapSize),e.on("change:view",this.updateMapView),e.once("postcompose",this.updateViewport),this.minimap.addLayer(new kb({source:t,style:vw.viewport})),e.getLayers().on("add",this.refreshImageLayer),this.minimap.on("pointerdrag",this.dragViewport),this.minimap.on("click",this.dragViewport),this.initImageLayer(e.getLayers()),this.$parent.$on("render",this.render)},mounted:function(){this.updateElementSize(),this.minimap.setTarget(this.$el),this.updateViewport()},beforeDestroy:function(){var t=this.$parent.map;this.mapView.un("change:center",this.updateViewport),this.mapView.un("change:resolution",this.updateViewport),t.un("change:size",this.updateMapSize),t.un("change:view",this.updateMapView),t.getLayers().un("add",this.refreshImageLayer),this.$parent.$off("render",this.render)}},(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"minimap"})}),[],!1,null,null,null).exports;var WC="modifystart",KC="modifyend",XC=function(t){function e(e,i,n){t.call(this,e),this.features=i,this.mapBrowserEvent=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Af);function YC(t,e){return t.index-e.index}function HC(t,e){var i,n,r=e.geometry;if(r.getType()===Mg){var o=r;if(1===e.index){var s=$y(o.getCenter(),t),a=Math.sqrt(s)-o.getRadius();return a*a}}return i=t,n=e.segment,$y(i,Ly(i,n))}function ZC(t,e){var i=e.geometry;return i.getType()===Mg&&1===e.index||i.getType()===$g||i.getType()===Og?i.getClosestPoint(t):Ly(t,e.segment)}function JC(){var t=Tb();return function(e,i){return t[Eg]}}const QC=function(t){function e(e){var i;if(t.call(this,e),this.condition_=e.condition?e.condition:s_,this.defaultDeleteCondition_=function(t){return Xy(t)&&e_(t)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:Zy,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new Gb,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new kb({source:new Wb({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:JC(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Rectangle:this.writePolygonGeometry_,Ellipse:this.writePolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null,e.source?(this.source_=e.source,i=new Ty(this.source_.getFeatures()),vf(this.source_,Db,this.handleSourceAdd_,this),vf(this.source_,Bb,this.handleSourceRemove_,this)):i=e.features,!i)throw new Error("The modify interaction requires features or a source");this.features_=i,this.features_.forEach(this.addFeature_.bind(this)),vf(this.features_,wy,this.handleFeatureAdd_,this),vf(this.features_,xy,this.handleFeatureRemove_,this),this.lastPointerEvent_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature_=function(t){var e=t.getGeometry();e&&e.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[e.getType()].call(this,t,e);var i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),vf(t,kf,this.handleFeatureChange_,this)},e.prototype.willModifyFeatures_=function(t){this.modified_||(this.modified_=!0,this.dispatchEvent(new XC(WC,this.features_,t)))},e.prototype.removeFeature_=function(t){this.removeFeatureSegmentData_(t),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),_f(t,kf,this.handleFeatureChange_,this)},e.prototype.removeFeatureSegmentData_=function(t){var e=this.rBush_,i=[];e.forEach((function(e){t===e.feature&&i.push(e)}));for(var n=i.length-1;n>=0;--n)e.remove(i[n])},e.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.prototype.setActive.call(this,e)},e.prototype.setMap=function(e){this.overlay_.setMap(e),t.prototype.setMap.call(this,e)},e.prototype.getOverlay=function(){return this.overlay_},e.prototype.handleSourceAdd_=function(t){t.feature&&this.features_.push(t.feature)},e.prototype.handleSourceRemove_=function(t){t.feature&&this.features_.remove(t.feature)},e.prototype.handleFeatureAdd_=function(t){this.addFeature_(t.element)},e.prototype.handleFeatureChange_=function(t){if(!this.changingFeature_){var e=t.target;this.removeFeature_(e),this.addFeature_(e)}},e.prototype.handleFeatureRemove_=function(t){var e=t.element;this.removeFeature_(e)},e.prototype.writePointGeometry_=function(t,e){var i=e.getCoordinates(),n={feature:t,geometry:e,segment:[i,i]};this.rBush_.insert(e.getExtent(),n)},e.prototype.writeMultiPointGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n){var o=i[n],s={feature:t,geometry:e,depth:[n],index:n,segment:[o,o]};this.rBush_.insert(e.getExtent(),s)}},e.prototype.writeLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length-1;n<r;++n){var o=i.slice(n,n+2),s={feature:t,geometry:e,index:n,segment:o};this.rBush_.insert(Ap(o),s)}},e.prototype.writeMultiLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n)for(var o=i[n],s=0,a=o.length-1;s<a;++s){var l=o.slice(s,s+2),u={feature:t,geometry:e,depth:[n],index:s,segment:l};this.rBush_.insert(Ap(l),u)}},e.prototype.writePolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n)for(var o=i[n],s=0,a=o.length-1;s<a;++s){var l=o.slice(s,s+2),u={feature:t,geometry:e,depth:[n],index:s,segment:l};this.rBush_.insert(Ap(l),u)}},e.prototype.writeMultiPolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n)for(var o=i[n],s=0,a=o.length;s<a;++s)for(var l=o[s],u=0,h=l.length-1;u<h;++u){var c=l.slice(u,u+2),d={feature:t,geometry:e,depth:[s,n],index:u,segment:c};this.rBush_.insert(Ap(c),d)}},e.prototype.writeCircleGeometry_=function(t,e){var i=e.getCenter(),n={feature:t,geometry:e,index:0,segment:[i,i]},r={feature:t,geometry:e,index:1,segment:[i,i]},o=[n,r];n.featureSegments=r.featureSegments=o,this.rBush_.insert(Np(i),n),this.rBush_.insert(e.getExtent(),r)},e.prototype.writeGeometryCollectionGeometry_=function(t,e){for(var i=e.getGeometriesArray(),n=0;n<i.length;++n)this.SEGMENT_WRITERS_[i[n].getType()].call(this,t,i[n])},e.prototype.createOrUpdateVertexFeature_=function(t){var e=this.vertexFeature_;e?e.getGeometry().setCoordinates(t):(e=new Iy(new ov(t)),this.vertexFeature_=e,this.overlay_.getSource().addFeature(e));return e},e.prototype.handleEvent=function(e){return!e.pointerEvent||(this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=kv.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(i=!(e.type!=kv.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==kv.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),t.prototype.handleEvent.call(this,e)&&!i);var i},e.prototype.handleDragEvent=function(t){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(t);for(var e=t.coordinate,i=0,n=this.dragSegments_.length;i<n;++i){for(var r=this.dragSegments_[i],o=r[0],s=o.depth,a=o.geometry,l=void 0,u=o.segment,h=r[1];e.length<a.getStride();)e.push(u[h][e.length]);switch(a.getType()){case Eg:l=e,u[0]=u[1]=e;break;case kg:(l=a.getCoordinates())[o.index]=e,u[0]=u[1]=e;break;case Ig:(l=a.getCoordinates())[o.index+h]=e,u[h]=e;break;case Rg:case Pg:(l=a.getCoordinates())[s[0]][o.index+h]=e,u[h]=e;break;case Lg:(l=a.getCoordinates())[s[1]][s[0]][o.index+h]=e,u[h]=e;break;case Og:var c=(v=(l=a.getCoordinates())[s[0]])[(o.index+h+2)%4],d=[e[0]-c[0],e[1]-c[1]],f=[(y=v[(o.index+h+1)%4])[0]-c[0],y[1]-c[1]],p=Math.sqrt(f[0]*f[0]+f[1]*f[1]);f[0]=f[0]/p,f[1]=f[1]/p;var g=d[0]*f[0]+d[1]*f[1];v[(o.index+h+1)%4]=[c[0]+g*f[0],c[1]+g*f[1]];var m=[(_=v[(o.index+h+3)%4])[0]-c[0],_[1]-c[1]];p=Math.sqrt(m[0]*m[0]+m[1]*m[1]),m[0]=m[0]/p,m[1]=m[1]/p,g=d[0]*m[0]+d[1]*m[1],v[(o.index+h+3)%4]=[c[0]+g*m[0],c[1]+g*m[1]],v[o.index+h]=e;break;case $g:var v,y=(v=(l=a.getCoordinates())[s[0]])[(o.index+h+1)%4],_=(c=v[(o.index+h+2)%4],v[(o.index+h+3)%4]),b=Math.sqrt(Math.pow(y[0]-_[0],2)+Math.pow(y[1]-_[1],2))/2,w=[e[0]-c[0],e[1]-c[1]],x=[-1*w[1],w[0]];p=Math.sqrt(x[0]*x[0]+x[1]*x[1]);x[0]=x[0]/p,x[1]=x[1]/p;var S=[c[0]+w[0]/2,c[1]+w[1]/2];v[(o.index+h+1)%4]=[S[0]+x[0]*b,S[1]+x[1]*b],v[(o.index+h+3)%4]=[S[0]-x[0]*b,S[1]-x[1]*b],v[o.index+h]=e;break;case Mg:u[0]=u[1]=e,0===o.index?(this.changingFeature_=!0,a.setCenter(e),this.changingFeature_=!1):(this.changingFeature_=!0,a.setRadius(Dy(a.getCenter(),e)),this.changingFeature_=!1)}l&&this.setGeometryCoordinates_(a,l)}this.createOrUpdateVertexFeature_(e)},e.prototype.handleDownEvent=function(t){if(!this.condition_(t))return!1;this.handlePointerAtPixel_(t.pixel,t.map);var e=t.map.getCoordinateFromPixel(t.pixel);this.dragSegments_.length=0,this.modified_=!1;var i=this.vertexFeature_;if(i){var n=[],r=i.getGeometry().getCoordinates(),o=Ap([r]),s=this.rBush_.getInExtent(o),a={};s.sort(YC);for(var l=0,u=s.length;l<u;++l){var h=s[l],c=h.segment,d=sf(h.feature),f=h.depth;if(f&&(d+="-"+f.join("-")),a[d]||(a[d]=new Array(2)),h.geometry.getType()===Mg&&1===h.index)Fy(ZC(e,h),r)&&!a[d][0]&&(this.dragSegments_.push([h,0]),a[d][0]=h);else if(Fy(c[0],r)&&!a[d][0])this.dragSegments_.push([h,0]),a[d][0]=h;else if(Fy(c[1],r)&&!a[d][1]){if((h.geometry.getType()===Ig||h.geometry.getType()===Rg)&&a[d][0]&&0===a[d][0].index)continue;this.dragSegments_.push([h,1]),a[d][1]=h}else this.insertVertexCondition_(t)&&sf(c)in this.vertexSegments_&&!a[d][0]&&!a[d][1]&&n.push([h,r])}n.length&&this.willModifyFeatures_(t);for(var p=n.length-1;p>=0;--p)this.insertVertex_.apply(this,n[p])}return!!this.vertexFeature_},e.prototype.handleUpEvent=function(t){for(var e=this.dragSegments_.length-1;e>=0;--e){var i=this.dragSegments_[e][0],n=i.geometry;if(n.getType()===Og||n.getType()===$g)this.features_.remove(i.feature),this.features_.push(i.feature);else if(n.getType()===Mg){var r=n.getCenter(),o=i.featureSegments[0],s=i.featureSegments[1];o.segment[0]=o.segment[1]=r,s.segment[0]=s.segment[1]=r,this.rBush_.update(Np(r),o),this.rBush_.update(n.getExtent(),s)}else this.rBush_.update(Ap(i.segment),i)}return this.modified_&&(this.dispatchEvent(new XC(KC,this.features_,t)),this.modified_=!1),!1},e.prototype.handlePointerMove_=function(t){this.lastPixel_=t.pixel,this.handlePointerAtPixel_(t.pixel,t.map)},e.prototype.handlePointerAtPixel_=function(t,e){var i=e.getCoordinateFromPixel(t),n=Pp(Np(i),e.getView().getResolution()*this.pixelTolerance_),r=this.rBush_.getInExtent(n);if(r.length>0){r.sort((function(t,e){return HC(i,t)-HC(i,e)}));var o=r[0],s=o.segment,a=ZC(i,o),l=e.getPixelFromCoordinate(a),u=Dy(t,l);if(u<=this.pixelTolerance_){var h={};if(o.geometry.getType()===Mg&&1===o.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(a);else{var c=e.getPixelFromCoordinate(s[0]),d=e.getPixelFromCoordinate(s[1]),f=$y(l,c),p=$y(l,d);u=Math.sqrt(Math.min(f,p)),this.snappedToVertex_=u<=this.pixelTolerance_,this.snappedToVertex_&&(a=f>p?s[1]:s[0]),this.createOrUpdateVertexFeature_(a);for(var g=1,m=r.length;g<m;++g){var v=r[g].segment;if(!(Fy(s[0],v[0])&&Fy(s[1],v[1])||Fy(s[0],v[1])&&Fy(s[1],v[0])))break;h[sf(v)]=!0}}return h[sf(s)]=!0,void(this.vertexSegments_=h)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},e.prototype.insertVertex_=function(t,e){for(var i,n=t.segment,r=t.feature,o=t.geometry,s=t.depth,a=t.index;e.length<o.getStride();)e.push(0);switch(o.getType()){case Rg:case Pg:(i=o.getCoordinates())[s[0]].splice(a+1,0,e);break;case Lg:(i=o.getCoordinates())[s[1]][s[0]].splice(a+1,0,e);break;case Ig:(i=o.getCoordinates()).splice(a+1,0,e);break;default:return}this.setGeometryCoordinates_(o,i);var l=this.rBush_;l.remove(t),this.updateSegmentIndices_(o,a,s,1);var u={segment:[n[0],e],feature:r,geometry:o,depth:s,index:a};l.insert(Ap(u.segment),u),this.dragSegments_.push([u,1]);var h={segment:[e,n[1]],feature:r,geometry:o,depth:s,index:a+1};l.insert(Ap(h.segment),h),this.dragSegments_.push([h,0]),this.ignoreNextSingleClick_=!0},e.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=kv.POINTERDRAG){var t=this.lastPointerEvent_;return this.willModifyFeatures_(t),this.removeVertex_(),this.dispatchEvent(new XC(KC,this.features_,t)),this.modified_=!1,!0}return!1},e.prototype.removeVertex_=function(){var t,e,i,n,r,o,s,a,l,u,h,c=this.dragSegments_,d={},f=!1;for(r=c.length-1;r>=0;--r)h=sf((u=(i=c[r])[0]).feature),u.depth&&(h+="-"+u.depth.join("-")),h in d||(d[h]={}),0===i[1]?(d[h].right=u,d[h].index=u.index):1==i[1]&&(d[h].left=u,d[h].index=u.index+1);for(h in d){switch(l=d[h].right,s=d[h].left,(a=(o=d[h].index)-1)<0&&(a=0),t=e=(n=(u=void 0!==s?s:l).geometry).getCoordinates(),f=!1,n.getType()){case Rg:e[u.depth[0]].length>2&&(e[u.depth[0]].splice(o,1),f=!0);break;case Ig:e.length>2&&(e.splice(o,1),f=!0);break;case Lg:t=t[u.depth[1]];case Pg:(t=t[u.depth[0]]).length>4&&(o==t.length-1&&(o=0),t.splice(o,1),f=!0,0===o&&(t.pop(),t.push(t[0]),a=t.length-1))}if(f){this.setGeometryCoordinates_(n,e);var p=[];if(void 0!==s&&(this.rBush_.remove(s),p.push(s.segment[0])),void 0!==l&&(this.rBush_.remove(l),p.push(l.segment[1])),void 0!==s&&void 0!==l){var g={depth:u.depth,feature:u.feature,geometry:u.geometry,index:a,segment:p};this.rBush_.insert(Ap(g.segment),g)}this.updateSegmentIndices_(n,o,u.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),c.length=0}}return f},e.prototype.setGeometryCoordinates_=function(t,e){this.changingFeature_=!0,t.setCoordinates(e),this.changingFeature_=!1},e.prototype.updateSegmentIndices_=function(t,e,i,n){this.rBush_.forEachInExtent(t.getExtent(),(function(r){r.geometry===t&&(void 0===i||void 0===r.depth||wg(r.depth,i))&&r.index>e&&(r.index+=n)}))},e}(zv);const tT=Tl({props:{position:{type:Array,required:!0}},computed:{positionText:function(){return this.position.join(" × ")}}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"mouse-position-indicator",attrs:{title:"Mouse position in the image"},domProps:{textContent:t._s(t.positionText)}})}),[],!1,null,null,null).exports;const eT=Tl({components:{mousePositionIndicator:tT},props:{showMousePosition:{type:Boolean,default:!1}},data:function(){return{mousePositionIC:[0,0]}},watch:{mousePosition:function(t){var e=this;ou((function(){e.mousePositionIC=e.invertPointsYAxis(t.slice()).map(Math.round)}),100,"annotations.canvas.mouse-position-ic")}}},undefined,undefined,!1,null,null,null).exports;var iT=6371008.8,nT={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*iT,kilometers:6371.0088,kilometres:6371.0088,meters:iT,metres:iT,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:iT/1852,radians:1,yards:5825721.287490856};function rT(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function oT(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!pT(t[0])||!pT(t[1]))throw new Error("coordinates must contain numbers");return rT({type:"Point",coordinates:t},e,i)}function sT(t,e,i){void 0===i&&(i={});for(var n=0,r=t;n<r.length;n++){var o=r[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return rT({type:"Polygon",coordinates:t},e,i)}function aT(t,e,i){if(void 0===i&&(i={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return rT({type:"LineString",coordinates:t},e,i)}function lT(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function uT(t,e,i){return void 0===i&&(i={}),rT({type:"MultiPolygon",coordinates:t},e,i)}function hT(t,e){void 0===e&&(e="kilometers");var i=nT[e];if(!i)throw new Error(e+" units is invalid");return t*i}function cT(t,e){void 0===e&&(e="kilometers");var i=nT[e];if(!i)throw new Error(e+" units is invalid");return t/i}function dT(t){return 180*(t%(2*Math.PI))/Math.PI}function fT(t){return t%360*Math.PI/180}function pT(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function gT(t,e,i){if(null!==t)for(var n,r,o,s,a,l,u,h,c=0,d=0,f=t.type,p="FeatureCollection"===f,g="Feature"===f,m=p?t.features.length:1,v=0;v<m;v++){a=(h=!!(u=p?t.features[v].geometry:g?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var y=0;y<a;y++){var _=0,b=0;if(null!==(s=h?u.geometries[y]:u)){l=s.coordinates;var w=s.type;switch(c=!i||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(l,d,v,_,b))return!1;d++,_++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(!1===e(l[n],d,v,_,b))return!1;d++,"MultiPoint"===w&&_++}"LineString"===w&&_++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(r=0;r<l[n].length-c;r++){if(!1===e(l[n][r],d,v,_,b))return!1;d++}"MultiLineString"===w&&_++,"Polygon"===w&&b++}"Polygon"===w&&_++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(b=0,r=0;r<l[n].length;r++){for(o=0;o<l[n][r].length-c;o++){if(!1===e(l[n][r][o],d,v,_,b))return!1;d++}b++}_++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(!1===gT(s.geometries[n],e,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function mT(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function vT(t,e){var i,n,r,o,s,a,l,u,h,c,d=0,f="FeatureCollection"===t.type,p="Feature"===t.type,g=f?t.features.length:1;for(i=0;i<g;i++){for(a=f?t.features[i].geometry:p?t.geometry:t,u=f?t.features[i].properties:p?t.properties:{},h=f?t.features[i].bbox:p?t.bbox:void 0,c=f?t.features[i].id:p?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=l?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,d,u,h,c))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===e(o.geometries[n],d,u,h,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,u,h,c))return!1;d++}}function yT(t,e){vT(t,(function(t,i,n,r,o){var s,a=null===t?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==e(rT(t,n,{bbox:r,id:o}),i,0)&&void 0}switch(a){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var l=0;l<t.coordinates.length;l++){var u=t.coordinates[l];if(!1===e(rT({type:s,coordinates:u},n),i,l))return!1}}))}function _T(t,e){yT(t,(function(t,i,n){var r=0;if(t.geometry){var o=t.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var s,a=0,l=0,u=0;return!1!==gT(t,(function(o,h,c,d,f){if(void 0===s||i>a||d>l||f>u)return s=o,a=i,l=d,u=f,void(r=0);var p=aT([s,o],t.properties);if(!1===e(p,i,n,f,r))return!1;r++,s=o}))&&void 0}}}))}function bT(t){var e=[1/0,1/0,-1/0,-1/0];return gT(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}bT.default=bT;const wT=bT;function xT(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function ST(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function CT(t){return"Feature"===t.type?t.geometry:t}function TT(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var n=xT(t),r=CT(e),o=r.type,s=e.bbox,a=r.coordinates;if(s&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(n,s))return!1;"Polygon"===o&&(a=[a]);for(var l=!1,u=0;u<a.length&&!l;u++)if(ET(n,a[u][0],i.ignoreBoundary)){for(var h=!1,c=1;c<a[u].length&&!h;)ET(n,a[u][c],!i.ignoreBoundary)&&(h=!0),c++;h||(l=!0)}return l}function ET(t,e,i){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,o=e.length-1;r<e.length;o=r++){var s=e[r][0],a=e[r][1],l=e[o][0],u=e[o][1];if(t[1]*(s-l)+a*(l-t[0])+u*(t[0]-s)==0&&(s-t[0])*(l-t[0])<=0&&(a-t[1])*(u-t[1])<=0)return!i;a>t[1]!=u>t[1]&&t[0]<(l-s)*(t[1]-a)/(u-a)+s&&(n=!n)}return n}function IT(t,e,i,n){var r=i[0],o=i[1],s=t[0],a=t[1],l=e[0],u=e[1],h=l-s,c=u-a;return 0==(i[0]-s)*c-(i[1]-a)*h&&(n?"start"===n?Math.abs(h)>=Math.abs(c)?h>0?s<r&&r<=l:l<=r&&r<s:c>0?a<o&&o<=u:u<=o&&o<a:"end"===n?Math.abs(h)>=Math.abs(c)?h>0?s<=r&&r<l:l<r&&r<=s:c>0?a<=o&&o<u:u<o&&o<=a:"both"===n&&(Math.abs(h)>=Math.abs(c)?h>0?s<r&&r<l:l<r&&r<s:c>0?a<o&&o<u:u<o&&o<a):Math.abs(h)>=Math.abs(c)?h>0?s<=r&&r<=l:l<=r&&r<=s:c>0?a<=o&&o<=u:u<=o&&o<=a)}const AT=function(t,e,i){void 0===i&&(i={});for(var n=xT(t),r=ST(e),o=0;o<r.length-1;o++){var s=!1;if(i.ignoreEndVertices&&(0===o&&(s="start"),o===r.length-2&&(s="end"),0===o&&o+1===r.length-1&&(s="both")),IT(r[o],r[o+1],n,s))return!0}return!1};function PT(t,e){var i=CT(t),n=CT(e),r=i.type,o=n.type,s=i.coordinates,a=n.coordinates;switch(r){case"Point":switch(o){case"Point":return RT(s,a);default:throw new Error("feature2 "+o+" geometry not supported")}case"MultiPoint":switch(o){case"Point":return function(t,e){var i,n=!1;for(i=0;i<t.coordinates.length;i++)if(RT(t.coordinates[i],e.coordinates)){n=!0;break}return n}(i,n);case"MultiPoint":return function(t,e){for(var i=0,n=e.coordinates;i<n.length;i++){for(var r=n[i],o=!1,s=0,a=t.coordinates;s<a.length;s++){if(RT(r,a[s])){o=!0;break}}if(!o)return!1}return!0}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"Point":return AT(n,i,{ignoreEndVertices:!0});case"LineString":return function(t,e){for(var i=!1,n=0,r=e.coordinates;n<r.length;n++){var o=r[n];if(AT({type:"Point",coordinates:o},t,{ignoreEndVertices:!0})&&(i=!0),!AT({type:"Point",coordinates:o},t,{ignoreEndVertices:!1}))return!1}return i}(i,n);case"MultiPoint":return function(t,e){for(var i=!1,n=0,r=e.coordinates;n<r.length;n++){var o=r[n];if(AT(o,t,{ignoreEndVertices:!0})&&(i=!0),!AT(o,t))return!1}if(i)return!0;return!1}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"Point":return TT(n,i,{ignoreBoundary:!0});case"LineString":return function(t,e){var i=!1,n=0,r=wT(t),o=wT(e);if(!kT(r,o))return!1;for(;n<e.coordinates.length-1;n++){if(TT({type:"Point",coordinates:LT(e.coordinates[n],e.coordinates[n+1])},t,{ignoreBoundary:!0})){i=!0;break}}return i}(i,n);case"Polygon":return function(t,e){if("Feature"===t.type&&null===t.geometry)return!1;if("Feature"===e.type&&null===e.geometry)return!1;var i=wT(t),n=wT(e);if(!kT(i,n))return!1;for(var r=CT(e).coordinates,o=0,s=r;o<s.length;o++)for(var a=0,l=s[o];a<l.length;a++){if(!TT(l[a],t))return!1}return!0}(i,n);case"MultiPoint":return function(t,e){for(var i=0,n=e.coordinates;i<n.length;i++){if(!TT(n[i],t,{ignoreBoundary:!0}))return!1}return!0}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+r+" geometry not supported")}}function kT(t,e){return!(t[0]>e[0])&&(!(t[2]<e[2])&&(!(t[1]>e[1])&&!(t[3]<e[3])))}function RT(t,e){return t[0]===e[0]&&t[1]===e[1]}function LT(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}var FT=i(787);const MT=function(t){if(!t)throw new Error("geojson is required");var e=[];return yT(t,(function(t){!function(t,e){var i=[],n=t.geometry;if(null!==n){switch(n.type){case"Polygon":i=ST(n);break;case"LineString":i=[ST(n)]}i.forEach((function(i){(function(t,e){var i=[];return t.reduce((function(t,n){var r,o,s,a,l,u,h=aT([t,n],e);return h.bbox=(o=n,s=(r=t)[0],a=r[1],l=o[0],u=o[1],[s<l?s:l,a<u?a:u,s>l?s:l,a>u?a:u]),i.push(h),n})),i})(i,t.properties).forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),lT(e)};function OT(t,e,i){if(void 0===i&&(i={}),!0===i.final)return function(t,e){var i=OT(e,t);return i=(i+180)%360}(t,e);var n=xT(t),r=xT(e),o=fT(n[0]),s=fT(r[0]),a=fT(n[1]),l=fT(r[1]),u=Math.sin(s-o)*Math.cos(l),h=Math.cos(a)*Math.sin(l)-Math.sin(a)*Math.cos(l)*Math.cos(s-o);return dT(Math.atan2(u,h))}const $T=function(t,e,i){void 0===i&&(i={});var n=xT(t),r=xT(e),o=fT(r[1]-n[1]),s=fT(r[0]-n[0]),a=fT(n[1]),l=fT(r[1]),u=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(a)*Math.cos(l);return hT(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),i.units)};function DT(t,e,i,n){void 0===n&&(n={});var r=xT(t),o=fT(r[0]),s=fT(r[1]),a=fT(i),l=cT(e,n.units),u=Math.asin(Math.sin(s)*Math.cos(l)+Math.cos(s)*Math.sin(l)*Math.cos(a));return oT([dT(o+Math.atan2(Math.sin(a)*Math.sin(l)*Math.cos(s),Math.cos(l)-Math.sin(s)*Math.sin(u))),dT(u)],n.properties)}function jT(t,e){var i=ST(t),n=ST(e);if(2!==i.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==n.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var r=i[0][0],o=i[0][1],s=i[1][0],a=i[1][1],l=n[0][0],u=n[0][1],h=n[1][0],c=n[1][1],d=(c-u)*(s-r)-(h-l)*(a-o),f=(h-l)*(o-u)-(c-u)*(r-l),p=(s-r)*(o-u)-(a-o)*(r-l);if(0===d)return null;var g=f/d,m=p/d;return g>=0&&g<=1&&m>=0&&m<=1?oT([r+g*(s-r),o+g*(a-o)]):null}const NT=function(t,e){var i={},n=[];if("LineString"===t.type&&(t=rT(t)),"LineString"===e.type&&(e=rT(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var r=jT(t,e);return r&&n.push(r),lT(n)}var o=FT();return o.load(MT(e)),mT(MT(t),(function(t){mT(o.search(t),(function(e){var r=jT(t,e);if(r){var o=ST(r).join(",");i[o]||(i[o]=!0,n.push(r))}}))})),lT(n)};const BT=function(t,e,i){void 0===i&&(i={});var n=oT([1/0,1/0],{dist:1/0}),r=0;return yT(t,(function(t){for(var o=ST(t),s=0;s<o.length-1;s++){var a=oT(o[s]);a.properties.dist=$T(e,a,i);var l=oT(o[s+1]);l.properties.dist=$T(e,l,i);var u=$T(a,l,i),h=Math.max(a.properties.dist,l.properties.dist),c=OT(a,l),d=DT(e,h,c+90,i),f=DT(e,h,c-90,i),p=NT(aT([d.geometry.coordinates,f.geometry.coordinates]),aT([a.geometry.coordinates,l.geometry.coordinates])),g=null;p.features.length>0&&((g=p.features[0]).properties.dist=$T(e,g,i),g.properties.location=r+$T(a,g,i)),a.properties.dist<n.properties.dist&&((n=a).properties.index=s,n.properties.location=r),l.properties.dist<n.properties.dist&&((n=l).properties.index=s+1,n.properties.location=r+u),g&&g.properties.dist<n.properties.dist&&((n=g).properties.index=s),r+=u}})),n};var UT=i(251);function zT(t,e){var i=ST(e),n=ST(t),r=n[0],o=n[n.length-1],s=t.geometry.coordinates;return UT(i[0],r)?s.unshift(i[1]):UT(i[0],o)?s.push(i[1]):UT(i[1],r)?s.unshift(i[0]):UT(i[1],o)&&s.push(i[0]),t}const VT=function(t,e,i){if(void 0===i&&(i={}),!(n=i=i||{})||n.constructor!==Object)throw new Error("options is invalid");var n,r,o=i.tolerance||0,s=[],a=FT(),l=MT(t);return a.load(l),_T(e,(function(t){var e=!1;mT(a.search(t),(function(i){if(!1===e){var n=ST(t).sort(),s=ST(i).sort();UT(n,s)||(0===o?AT(n[0],i)&&AT(n[1],i):BT(i,n[0]).properties.dist<=o&&BT(i,n[1]).properties.dist<=o)?(e=!0,r=r?zT(r,t):t):(0===o?AT(s[0],t)&&AT(s[1],t):BT(t,s[0]).properties.dist<=o&&BT(t,s[1]).properties.dist<=o)&&(r=r?zT(r,i):i)}})),!1===e&&r&&(s.push(r),r=void 0)})),r&&s.push(r),lT(s)};var GT=i(657);function qT(t,e){var i=CT(t),n=CT(e),r=i.type,o=n.type;if("MultiPoint"===r&&"MultiPoint"!==o||("LineString"===r||"MultiLineString"===r)&&"LineString"!==o&&"MultiLineString"!==o||("Polygon"===r||"MultiPolygon"===r)&&"Polygon"!==o&&"MultiPolygon"!==o)throw new Error("features must be of the same type");if("Point"===r)throw new Error("Point geometry not supported");if(new GT({precision:6}).compare(t,e))return!1;var s=0;switch(r){case"MultiPoint":for(var a=0;a<i.coordinates.length;a++)for(var l=0;l<n.coordinates.length;l++){var u=i.coordinates[a],h=n.coordinates[l];if(u[0]===h[0]&&u[1]===h[1])return!0}return!1;case"LineString":case"MultiLineString":_T(t,(function(t){_T(e,(function(e){VT(t,e).features.length&&s++}))}));break;case"Polygon":case"MultiPolygon":_T(t,(function(t){_T(e,(function(e){NT(t,e).features.length&&s++}))}))}return s>0}var WT=i(676);const KT=function(t,e,i){void 0===i&&(i={});var n=CT(t),r=CT(e),o=WT.union(n.coordinates,r.coordinates);return 0===o.length?null:1===o.length?sT(o[0],i.properties):uT(o,i.properties)};function XT(t,e){t.geometry.coordinates=nv(t.geometry.coordinates),e.geometry.coordinates=nv(e.geometry.coordinates);var i=KT(t,e);return"MultiPolygon"===i.geometry.type?i.geometry.coordinates[0]:i.geometry.coordinates}var YT=i(977),HT=i.n(YT);var ZT=function(t){var e=t.pointerEvent;return e&&"pen"===e.pointerType};function JT(t,e){var i=t.originalEvent.deltaY;t.type==Bf?0===(i=-t.originalEvent.wheelDeltaY)&&(i=-t.originalEvent.wheelDeltaX):0===i&&(i=t.originalEvent.deltaX);var n=5;return e<=25&&(n=1),i>0?e+n:i<0?Math.max(e-n,5):e}function QT(t,e){return 0!=t.pointerEvent.pressure?(e=JT(t,e),Math.max(e*t.pointerEvent.pressure,5)*t.map.getView().getResolution()):e}function tE(){var t=Tb();return t[Pg]=t[Pg].concat(t[Ig]),function(e,i){return t[e.getGeometry().getType()]}}const eE=function(t){function e(e){e.freehandCondition=e.freehandCondition?e.freehandCondition:ZT,t.call(this,e),this.overlay_=new kb({source:this.overlay_.getSource(),style:e.style?e.style:tE(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.sketchPointRadius_=void 0!==e.brushRadius?e.brushRadius:100,this.condition_=void 0!==e.condition?e.condition:Zy,this.resizeCondition_=void 0!==e.resizeCondition?e.resizeCondition:n_,this.isDrawing_=!1,this.sketchCircle_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMap=function(e){if(t.prototype.setMap.call(this,e),e){var i=e.getView();i&&this.watchViewForChangedResolution(i),e.on("change:view",function(t){this.watchViewForChangedResolution(t.target.getView())}.bind(this))}},e.prototype.watchViewForChangedResolution=function(t){t.on("change:resolution",this.updateRelativeSketchPointRadius_.bind(this))},e.prototype.handleEvent=function(e){var i=e.type,n=!0;return this.resizeCondition_(e)&&(i===Gf||Bf)&&(e.originalEvent.preventDefault(),this.updateAbsoluteSketchPointRadius_(e),n=!1),e.type===kv.POINTERDRAG&&this.handlingDownUpSequence&&(n=!1),t.prototype.handleEvent.call(this,e)&&n},e.prototype.handleDownEvent=function(t){return!(this.handlingDownUpSequence||!this.condition_(t))&&(this.startDrawing_(t),!0)},e.prototype.handleUpEvent=function(t){return!(!this.handlingDownUpSequence||!this.isDrawing_)&&(this.finishDrawing(),!0)},e.prototype.createOrUpdateSketchPoint_=function(t){var e=t.coordinate.slice();if(this.sketchPoint_){this.sketchPoint_.getGeometry().setCenter(e)}else{var i=t.map.getView().getResolution()*this.sketchPointRadius_;this.sketchPoint_=new Iy(new Sv(e,i)),this.updateSketchFeatures_()}},e.prototype.updateRelativeSketchPointRadius_=function(t){this.sketchPoint_&&this.sketchPoint_.getGeometry().setRadius(this.sketchPointRadius_*t.target.getResolution())},e.prototype.updateAbsoluteSketchPointRadius_=function(t){this.sketchPoint_&&(this.sketchPointRadius_=JT(t,this.sketchPointRadius_),this.sketchPoint_.getGeometry().setRadius(this.sketchPointRadius_*t.map.getView().getResolution()))},e.prototype.createOrUpdateSketchCircle_=function(t){var e=t.coordinate.slice();this.sketchCircle_?(this.sketchCircle_.setCenter(e),this.sketchCircle_.setRadius(this.sketchPoint_.getGeometry().getRadius())):this.sketchCircle_=new Sv(e,this.sketchPoint_.getGeometry().getRadius()),"pen"===t.originalEvent.pointerType&&this.sketchCircle_.setRadius(QT(t,this.sketchPointRadius_))},e.prototype.startDrawing_=function(t){this.isDrawing_=!0,this.createOrUpdateSketchPoint_(t),this.createOrUpdateSketchCircle_(t);var e=t.coordinate;this.finishCoordinate_=e,this.sketchFeature_=new Iy(wv(this.sketchCircle_)),this.updateSketchFeatures_(),this.dispatchEvent(new iw(tw,this.sketchFeature_))},e.prototype.handlePointerMove_=function(t){if(this.createOrUpdateSketchPoint_(t),this.createOrUpdateSketchCircle_(t),this.isDrawing_&&this.sketchFeature_){var e=sT(wv(this.sketchCircle_).getCoordinates()),i=this.sketchFeature_.getGeometry(),n=sT(i.getCoordinates());(qT(e,n)||PT(e,n))&&i.setCoordinates(XT(e,n))}},e.prototype.finishDrawing=function(){this.isDrawing_=!1;var t=this.abortDrawing_();t&&(this.dispatchEvent(new iw(ew,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t))},e.prototype.getBrushRadius=function(){return this.sketchPointRadius_},e.prototype.abortDrawing_=function(){return this.sketchCircle_=null,t.prototype.abortDrawing_.call(this)},e}(rw);var iE="modifyremove";const nE=function(t){function e(e){t.call(this,e),this.overlay_.setStyle(e.style?e.style:function(){var t=Tb();return function(e,i){return t[Mg]}}()),this.sketchPoint_=null,this.sketchPointRadius_=void 0!==e.brushRadius?e.brushRadius:100,this.addCondition_=void 0!==e.addCondition?e.addCondition:Zy,this.subtractCondition_=void 0!==e.subtractCondition?e.subtractCondition:Zy,this.resizeCondition_=void 0!==e.resizeCondition?e.resizeCondition:n_,this.allowRemove_=void 0===e.allowRemove||e.allowRemove,this.isAdding_=!1,this.isSubtracting_=!1,this.sketchCircle_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMap=function(e){if(t.prototype.setMap.call(this,e),e){var i=e.getView();i&&this.watchViewForChangedResolution(i),e.on("change:view",function(t){this.watchViewForChangedResolution(t.target.getView())}.bind(this))}},e.prototype.watchViewForChangedResolution=function(t){t.on("change:resolution",this.updateRelativeSketchPointRadius_.bind(this))},e.prototype.createOrUpdateSketchPoint_=function(t){var e=t.coordinate.slice();if(this.sketchPoint_){this.sketchPoint_.getGeometry().setCenter(e)}else{var i=t.map.getView().getResolution()*this.sketchPointRadius_;this.sketchPoint_=new Iy(new Sv(e,i)),this.overlay_.getSource().addFeature(this.sketchPoint_)}},e.prototype.createOrUpdateSketchCircle_=function(t){var e=t.coordinate.slice();this.sketchCircle_?(this.sketchCircle_.setCenter(e),this.sketchCircle_.setRadius(this.sketchPoint_.getGeometry().getRadius())):this.sketchCircle_=new Sv(e,this.sketchPoint_.getGeometry().getRadius()),"pen"===t.originalEvent.pointerType&&this.sketchCircle_.setRadius(QT(t,this.sketchPointRadius_))},e.prototype.updateRelativeSketchPointRadius_=function(t){this.sketchPoint_&&this.sketchPoint_.getGeometry().setRadius(this.sketchPointRadius_*t.target.getResolution())},e.prototype.updateAbsoluteSketchPointRadius_=function(t){this.sketchPoint_&&(this.sketchPointRadius_=JT(t,this.sketchPointRadius_),this.sketchPoint_.getGeometry().setRadius(this.sketchPointRadius_*t.map.getView().getResolution()))},e.prototype.handleEvent=function(e){var i=e.type,n=!0;return this.resizeCondition_(e)&&(i===Gf||Bf)&&(e.originalEvent.preventDefault(),this.updateAbsoluteSketchPointRadius_(e),n=!1),t.prototype.handleEvent.call(this,e)&&n},e.prototype.handlePointerMove_=function(t){this.createOrUpdateSketchPoint_(t),this.createOrUpdateSketchCircle_(t)},e.prototype.handleDownEvent=function(t){if(!this.handlingDownUpSequence){if(this.createOrUpdateSketchPoint_(t),this.createOrUpdateSketchCircle_(t),this.subtractCondition_(t))return this.startSubtracting_(t),!0;if(this.addCondition_(t))return this.startAdding_(t),!0}return!1},e.prototype.handleUpEvent=function(t){return!(!this.handlingDownUpSequence||!this.isSubtracting_&&!this.isAdding_)&&(this.finishModifying_(t),!0)},e.prototype.startSubtracting_=function(t){this.isSubtracting_=!0,this.willModifyFeatures_(t),this.subtractCurrentFeatures_(t)},e.prototype.startAdding_=function(t){this.isAdding_=!0,this.willModifyFeatures_(t),this.addCurrentFeatures_(t)},e.prototype.handleDragEvent=function(t){this.createOrUpdateSketchPoint_(t),this.createOrUpdateSketchCircle_(t),this.isSubtracting_?this.subtractCurrentFeatures_(t):this.isAdding_&&this.addCurrentFeatures_(t)},e.prototype.subtractCurrentFeatures_=function(t){var e=wv(this.sketchCircle_),i=sT(e.getCoordinates()),n=e.getArea();this.features_.getArray().forEach((function(e){var r=e.getGeometry();try{var o=sT(r.getCoordinates())}catch(t){return}if(qT(i,o)){var s=function(t,e){t.geometry.coordinates=nv(t.geometry.coordinates),e.geometry.coordinates=nv(e.geometry.coordinates);var i=HT()(t,e);if("MultiPolygon"===i.geometry.type){for(var n,r=0,o=0;o<i.geometry.coordinates.length;o++){var s=new _v(i.geometry.coordinates[o]).getArea();s>r&&(r=s,n=i.geometry.coordinates[o])}return n}return i.geometry.coordinates}(o,i);if(!this.allowRemove_&&n>new _v(s).getArea())return;r.setCoordinates(s)}else PT(i,o)&&this.allowRemove_&&(this.features_.remove(e),this.source_&&this.source_.removeFeature(e),this.dispatchEvent(new XC(iE,new Ty([e]),t)))}),this)},e.prototype.addCurrentFeatures_=function(t){var e=wv(this.sketchCircle_),i=sT(e.getCoordinates());this.features_.getArray().forEach((function(t){var n=t.getGeometry();try{var r=sT(n.getCoordinates())}catch(t){return}qT(i,r)?n.setCoordinates(XT(i,r)):PT(i,r)&&n.setCoordinates(e.getCoordinates())}),this)},e.prototype.finishModifying_=function(t){this.isSubtracting_=!1,this.isAdding_=!1,this.dispatchEvent(new XC(KC,this.features_,t))},e.prototype.getBrushRadius=function(){return this.sketchPointRadius_},e}(QC);var rE="select",oE=function(t){function e(e,i,n,r){t.call(this,e),this.selected=i,this.deselected=n,this.mapBrowserEvent=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Af);function sE(t){if(!this.condition_(t))return!0;var e=this.addCondition_(t),i=this.removeCondition_(t),n=this.toggleCondition_(t),r=!e&&!i&&!n,o=t.map,s=this.getFeatures(),a=[],l=[];if(r){hf(this.featureLayerAssociation_),o.forEachFeatureAtPixel(t.pixel,function(t,e){if(this.filter_(t,e))return l.push(t),this.addFeatureLayerAssociation_(t,e),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var u=s.getLength()-1;u>=0;--u){var h=s.item(u),c=l.indexOf(h);c>-1?l.splice(c,1):(s.remove(h),a.push(h))}0!==l.length&&s.extend(l)}else{o.forEachFeatureAtPixel(t.pixel,function(t,r){if(this.filter_(t,r))return!e&&!n||vg(s.getArray(),t)?(i||n)&&vg(s.getArray(),t)&&(a.push(t),this.removeFeatureLayerAssociation_(t)):(l.push(t),this.addFeatureLayerAssociation_(t,r)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var d=a.length-1;d>=0;--d)s.remove(a[d]);s.extend(l)}return(l.length>0||a.length>0)&&this.dispatchEvent(new oE(rE,l,a,t)),function(t){return"pointermove"==t.type}(t)}function aE(){var t=Tb();return bg(t[Pg],t[Ig]),bg(t[Fg],t[Ig]),function(e,i){return e.getGeometry()?t[e.getGeometry().getType()]:null}}const lE=function(t){function e(e){t.call(this,{handleEvent:sE});var i=e||{};this.condition_=i.condition?i.condition:e_,this.addCondition_=i.addCondition?i.addCondition:t_,this.removeCondition_=i.removeCondition?i.removeCondition:t_,this.toggleCondition_=i.toggleCondition?i.toggleCondition:n_,this.multi_=!!i.multi&&i.multi,this.filter_=i.filter?i.filter:Sf,this.hitTolerance_=i.hitTolerance?i.hitTolerance:0;var n,r=new kb({source:new Wb({useSpatialIndex:!1,features:i.features,wrapX:i.wrapX}),style:i.style?i.style:aE(),updateWhileAnimating:!0,updateWhileInteracting:!0});if(this.featureOverlay_=r,i.layers)if("function"==typeof i.layers)n=i.layers;else{var o=i.layers;n=function(t){return vg(o,t)}}else n=Sf;this.layerFilter_=n,this.featureLayerAssociation_={};var s=this.getFeatures();vf(s,wy,this.addFeature_,this),vf(s,xy,this.removeFeature_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeatureLayerAssociation_=function(t,e){this.featureLayerAssociation_[sf(t)]=e},e.prototype.getFeatures=function(){return this.featureOverlay_.getSource().getFeaturesCollection()},e.prototype.getHitTolerance=function(){return this.hitTolerance_},e.prototype.getLayer=function(t){return this.featureLayerAssociation_[sf(t)]},e.prototype.getOverlay=function(){return this.featureOverlay_},e.prototype.setHitTolerance=function(t){this.hitTolerance_=t},e.prototype.setMap=function(e){var i=this.getMap(),n=this.getFeatures();i&&n.forEach(i.unskipFeature.bind(i)),t.prototype.setMap.call(this,e),this.featureOverlay_.setMap(e),e&&n.forEach(e.skipFeature.bind(e))},e.prototype.addFeature_=function(t){var e=this.getMap();e&&e.skipFeature(t.element)},e.prototype.removeFeature_=function(t){var e=this.getMap();e&&e.unskipFeature(t.element)},e.prototype.removeFeatureLayerAssociation_=function(t){delete this.featureLayerAssociation_[sf(t)]},e}(Bv);var uE,hE,cE=50;const dE=Tl({computed:{isUsingPolygonBrush:function(){return"polygonBrush"===this.interactionMode},isUsingPolygonEraser:function(){return"polygonEraser"===this.interactionMode},isUsingPolygonFill:function(){return"polygonFill"===this.interactionMode}},methods:{togglePolygonBrush:function(){this.isUsingPolygonBrush?this.resetInteractionMode():this.hasSelectedLabel?this.canAdd&&(this.interactionMode="polygonBrush"):this.requireSelectedLabel()},togglePolygonEraser:function(){this.isUsingPolygonEraser?this.resetInteractionMode():this.canModify&&(this.interactionMode="polygonEraser")},togglePolygonFill:function(){this.isUsingPolygonFill?this.resetInteractionMode():this.canModify&&(this.interactionMode="polygonFill")},toggleCurrentInteraction:function(t){hE&&(cE=hE.getBrushRadius(),this.map.removeInteraction(hE),hE=null),this.canAdd&&"polygonBrush"===t?((hE=new eE({map:this.map,source:this.annotationSource,style:vw.editing,brushRadius:cE,resizeCondition:Xy})).on("drawend",this.handleNewFeature),this.map.addInteraction(hE)):this.canModify&&"polygonEraser"===t?((hE=new nE({map:this.map,features:this.selectInteraction.getFeatures(),style:vw.editing,brushRadius:cE,allowRemove:!1,addCondition:t_,subtractCondition:i_,resizeCondition:Xy})).on("modifystart",this.handleFeatureModifyStart),hE.on("modifyend",this.handleFeatureModifyEnd),this.map.addInteraction(hE),this.map.addInteraction(uE)):this.canModify&&"polygonFill"===t&&((hE=new nE({map:this.map,features:this.selectInteraction.getFeatures(),style:vw.editing,brushRadius:cE,addCondition:i_,subtractCondition:t_,resizeCondition:Xy})).on("modifystart",this.handleFeatureModifyStart),hE.on("modifyend",this.handleFeatureModifyEnd),this.map.addInteraction(hE),this.map.addInteraction(uE))}},created:function(){this.canAdd&&Ll.on("e",this.togglePolygonBrush,0,this.listenerSet),this.canModify&&(Ll.on("r",this.togglePolygonEraser,0,this.listenerSet),Ll.on("t",this.togglePolygonFill,0,this.listenerSet)),(this.canAdd||this.canModify)&&this.$watch("interactionMode",this.toggleCurrentInteraction)},mounted:function(){this.canModify&&(uE=new lE({condition:function(t){return Jy(t)&&n_(t)},style:vw.highlight,layers:[this.annotationLayer],features:this.selectInteraction.getFeatures(),multi:!0})).on("select",this.handleFeatureSelect)}},undefined,undefined,!1,null,null,null).exports;var fE,pE;const gE=Tl({data:function(){return{regularSamplingRows:null,regularSamplingColumns:null,currentSamplingIndex:null,randomSamplingCount:null,randomLocationMemory:{}}},computed:{regularSamplingLocations:function(){for(var t=[this.image.width/this.regularSamplingColumns,this.image.height/this.regularSamplingRows],e=[t[0]/2,t[1]/2],i=[],n=this.regularSamplingRows-1;n>=0;n--)for(var r=this.regularSamplingColumns-1;r>=0;r--)i.unshift([e[0]+r*t[0],e[1]+n*t[1]]);return i},randomSamplingLocations:function(){if(!this.randomLocationMemory.hasOwnProperty(this.image.id)){for(var t=[],e=this.image.width,i=this.image.height,n=this.randomSamplingCount;n>0;n--)t.push([Math.round(Math.random()*e),Math.round(Math.random()*i)]);this.randomLocationMemory[this.image.id]=t}return this.randomLocationMemory[this.image.id]},samplingLocations:function(){return this[this.annotationMode+"Locations"]},isSamplingAnnotationMode:function(){return this.annotationMode.endsWith("Sampling")}},methods:{setSamplingData:function(t,e){"regularSampling"===t?Array.isArray(e)&&e[0]>0&&e[1]>0&&(this.regularSamplingRows=e[0],this.regularSamplingColumns=e[1]):"randomSampling"===t&&e>0&&(this.randomSamplingCount=e)},updateShownSamplingLocation:function(){var t=this.currentSamplingIndex;null!==t&&t>=0&&t<this.samplingLocations.length&&(this.map.getView().setCenter(this.samplingLocations[t]),pE.getGeometry().setCoordinates(this.samplingLocations[t]))},showFirstSamplingLocation:function(){this.currentSamplingIndex=0,this.updateShownSamplingLocation()},showLastSamplingLocation:function(){this.currentSamplingIndex=this.samplingLocations.length-1,this.updateShownSamplingLocation()},showPreviousSamplingLocation:function(){var t=this.currentSamplingIndex-1;return!(t<0)&&(this.currentSamplingIndex=t,this.updateShownSamplingLocation(),!0)},showNextSamplingLocation:function(){var t=this.currentSamplingIndex+1;return!(t>=this.samplingLocations.length)&&(this.currentSamplingIndex=t,this.updateShownSamplingLocation(),!0)},createSampledAnnotation:function(){var t=this.samplingLocations[this.currentSamplingIndex];this.createPointAnnotationAt(t[0],t[1])}},watch:{isSamplingAnnotationMode:function(t){t?this.map.addLayer(fE):this.map.removeLayer(fE)},randomSamplingCount:function(){this.randomLocationMemory={}}},created:function(){fE=new kb({source:new Wb,style:[new Ib({image:new vb({radius:6,stroke:new wb({color:"white",width:4})})}),new Ib({image:new vb({radius:6,stroke:new wb({color:[0,153,255,1],width:2,lineDash:[3]})})})],zIndex:90,updateWhileAnimating:!0,updateWhileInteracting:!0}),pE=new Iy(new ov([0,0])),fE.getSource().addFeature(pE)}},undefined,undefined,!1,null,null,null).exports;var mE=Tl({mixins:[gg],props:{resolution:{required:!0}},data:function(){return{targetWidth:100,leadingDigits:[1,2,5]}},computed:{scale:function(){return this.targetWidth*this.scaleMultiplier},scalePowerOfTen:function(){return this.powerOfTen(this.scale)},scaleMultiplier:function(){return this.hasArea?this.resolution*this.pxWidthInMeter:this.resolution||0},scaleNearest:function(){for(var t=0,e=1/0,i=this.leadingDigits.length-1;i>=0;i--){var n=this.leadingDigits[i]*this.scalePowerOfTen;Math.abs(this.scale-n)<e&&(t=i,e=Math.abs(this.scale-n))}return this.leadingDigits[t]*this.scalePowerOfTen},unitNearest:function(){for(var t=0,e=1/0,i=this.unitMultipliers.length-1;i>=0;i--)Math.abs(this.unitMultipliers[i]-this.scalePowerOfTen)<e&&(t=i,e=Math.abs(this.unitMultipliers[i]-this.scalePowerOfTen));return t},width:function(){return Math.round(this.scaleNearest/this.scaleMultiplier)},styleObject:function(){return{width:this.width+"px"}},text:function(){return this.hasArea?Math.round(this.scaleNearest/this.unitMultipliers[this.unitNearest])+" "+this.unitNames[this.unitNearest]:Math.round(this.scaleNearest)+" px"}}},undefined,undefined,!1,null,null,null);const vE=Tl({components:{scaleLineIndicator:mE.exports},props:{showScaleLine:{type:Boolean,default:!1},imagesArea:{type:Object,default:null}}},undefined,undefined,!1,null,null,null).exports,yE="preload",_E="useInterimTilesOnError";var bE=function(t){function e(e){var i=e||{},n=uf({},i);delete n.preload,delete n.useInterimTilesOnError,t.call(this,n),this.setPreload(void 0!==i.preload?i.preload:0),this.setUseInterimTilesOnError(void 0===i.useInterimTilesOnError||i.useInterimTilesOnError),this.type=w_}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getPreload=function(){return this.get(yE)},e.prototype.setPreload=function(t){this.set(yE,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(_E)},e.prototype.setUseInterimTilesOnError=function(t){this.set(_E,t)},e}(D_);bE.prototype.getSource;const wE=bE;var xE="translatestart",SE="translating",CE="translateend",TE=function(t){function e(e,i,n){t.call(this,e),this.features=i,this.coordinate=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Af);function EE(t){return(EE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function IE(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function AE(t,e){return(AE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function PE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=RE(t);if(e){var r=RE(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return kE(this,i)}}function kE(t,e){return!e||"object"!==EE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function RE(t){return(RE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}const LE=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&AE(t,e)}(o,t);var e,i,n,r=PE(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,t)).features=void 0!==t.features?t.features:null,e.on("change:active",e.toggleListeners),e.translateUp=function(){return e.translate(0,1)},e.translateDown=function(){return e.translate(0,-1)},e.translateLeft=function(){return e.translate(-1,0)},e.translateRight=function(){return e.translate(1,0)},e.setMap(t.map),e.translating=!1,e}return e=o,(i=[{key:"toggleListeners",value:function(t){if(t.oldValue){Ll.off("ArrowLeft",this.translateLeft),Ll.off("ArrowUp",this.translateUp),Ll.off("ArrowRight",this.translateRight),Ll.off("ArrowDown",this.translateDown);var e=this.getMap().getTargetElement();e&&(e.style.cursor="")}else Ll.on("ArrowLeft",this.translateLeft,10),Ll.on("ArrowUp",this.translateUp,10),Ll.on("ArrowRight",this.translateRight,10),Ll.on("ArrowDown",this.translateDown,10)}},{key:"translate",value:function(t,e){var i=this;return!(null===this.lastCoordinate_&&this.features&&this.features.getLength()>0)||(this.translating||(this.dispatchEvent({type:"translatestart",features:this.features}),this.translating=!0),this.features.forEach((function(i){var n=i.getGeometry();n.translate(t,e),i.setGeometry(n)})),eu((function(){i.translating=!1,i.dispatchEvent({type:"translateend",features:i.features})}),500,"ol.interactions.Translate.translateend"),!1)}}])&&IE(e.prototype,i),n&&IE(e,n),o}(function(t){function e(e){var i,n=e||{};if(t.call(this,n),this.lastCoordinate_=null,this.features_=void 0!==n.features?n.features:null,n.layers)if("function"==typeof n.layers)i=n.layers;else{var r=n.layers;i=function(t){return vg(r,t)}}else i=Sf;this.layerFilter_=i,this.hitTolerance_=n.hitTolerance?n.hitTolerance:0,this.lastFeature_=null,vf(this,Xf(Ov),this.handleActiveChanged_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDownEvent=function(t){if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);var e=this.features_||new Ty([this.lastFeature_]);return this.dispatchEvent(new TE(xE,e,t.coordinate)),!0}return!1},e.prototype.handleUpEvent=function(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);var e=this.features_||new Ty([this.lastFeature_]);return this.dispatchEvent(new TE(CE,e,t.coordinate)),!0}return!1},e.prototype.handleDragEvent=function(t){if(this.lastCoordinate_){var e=t.coordinate,i=e[0]-this.lastCoordinate_[0],n=e[1]-this.lastCoordinate_[1],r=this.features_||new Ty([this.lastFeature_]);r.forEach((function(t){var e=t.getGeometry();e.translate(i,n),t.setGeometry(e)})),this.lastCoordinate_=e,this.dispatchEvent(new TE(SE,r,e))}},e.prototype.handleMoveEvent=function(t){var e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")},e.prototype.featuresAtPixel_=function(t,e){return e.forEachFeatureAtPixel(t,function(t){if(!this.features_||vg(this.features_.getArray(),t))return t}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},e.prototype.getHitTolerance=function(){return this.hitTolerance_},e.prototype.setHitTolerance=function(t){this.hitTolerance_=t},e.prototype.setMap=function(e){var i=this.getMap();t.prototype.setMap.call(this,e),this.updateState_(i)},e.prototype.handleActiveChanged_=function(){this.updateState_(null)},e.prototype.updateState_=function(t){var e=this.getMap(),i=this.getActive();e&&i||(e=e||t)&&e.getViewport().classList.remove("ol-grab","ol-grabbing")},e}(zv));var FE;const ME=Tl({computed:{isTranslating:function(){return"translate"===this.interactionMode}},methods:{toggleTranslating:function(){this.isTranslating?this.resetInteractionMode():this.modifyInProgress||(this.interactionMode="translate")}},watch:{isTranslating:function(t){this.canModify&&FE.setActive(t)}},mounted:function(){this.canModify&&((FE=new LE({features:this.selectInteraction.getFeatures(),map:this.map})).setActive(!1),FE.on("translatestart",this.handleFeatureModifyStart),FE.on("translateend",this.handleFeatureModifyEnd),this.map.addInteraction(FE),Ll.on("m",this.toggleTranslating,0,this.listenerSet))}},undefined,undefined,!1,null,null,null).exports;const OE=function(t){function e(e,i,n){t.call(this);var r=n||{};this.tileCoord=e,this.state=i,this.interimTile=null,this.key="",this.transition_=void 0===r.transition?250:r.transition,this.transitionStarts_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){this.dispatchEvent(kf)},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==Ex)return t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==Ex){t.interimTile=null;break}t.getState()==Tx?e=t:t.getState()==Cx?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){this.state=t,this.changed()},e.prototype.load=function(){},e.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;var n=e-i+1e3/60;return n>=this.transition_?1:Rv(n/this.transition_)},e.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(Pf);function $E(){var t=hp(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}const DE=function(t){function e(e,i,n,r,o,s){t.call(this,e,i,s),this.crossOrigin_=r,this.src_=n,this.image_=new Image,null!==r&&(this.image_.crossOrigin=r),this.imageListenerKeys_=null,this.tileLoadFunction_=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==Tx&&(this.unlistenImage_(),this.image_=$E()),this.interimTile&&this.interimTile.dispose(),this.state=Px,this.changed(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.image_},e.prototype.getKey=function(){return this.src_},e.prototype.handleImageError_=function(){this.state=Ix,this.unlistenImage_(),this.image_=$E(),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=Ex:this.state=Ax,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==Ix&&(this.state=Cx,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Cx&&(this.state=Tx,this.changed(),this.imageListenerKeys_=[yf(this.image_,Of,this.handleImageError_,this),yf(this.image_,jf,this.handleImageLoad_,this)],this.tileLoadFunction_(this,this.src_))},e.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(bf),this.imageListenerKeys_=null},e}(OE);function jE(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function NE(t,e,i){return t+"/"+e+"/"+i}function BE(t){return NE(t[0],t[1],t[2])}function UE(t,e){var i=/\{z\}/g,n=/\{x\}/g,r=/\{y\}/g,o=/\{-y\}/g;return function(s,a,l){return s?t.replace(i,s[0].toString()).replace(n,s[1].toString()).replace(r,(function(){return(-s[2]-1).toString()})).replace(o,(function(){var t=s[0],i=e.getFullTileRange(t);return vp(i,55),(i.getHeight()+s[2]).toString()})):void 0}}function zE(t){return 1===t.length?t[0]:function(e,i,n){if(e){var r=Vg(function(t){return(t[1]<<t[0])+t[2]}(e),t.length);return t[r](e,i,n)}}}function VE(t,e,i){}function GE(t){var e=[],i=/\{([a-z])-([a-z])\}/.exec(t);if(i){var n,r=i[1].charCodeAt(0),o=i[2].charCodeAt(0);for(n=r;n<=o;++n)e.push(t.replace(i[0],String.fromCharCode(n)));return e}if(i=i=/\{(\d+)-(\d+)\}/.exec(t)){for(var s=parseInt(i[2],10),a=parseInt(i[1],10);a<=s;a++)e.push(t.replace(i[0],a.toString()));return e}return e.push(t),e}const qE=function(t){function e(e){t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.expireCache=function(t){for(;this.canExpireCache();){var e=this.peekLast(),i=e.tileCoord[0].toString();if(i in t&&t[i].contains(e.tileCoord))break;this.pop().dispose()}},e.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=function(t){return t.split("/").map(Number)}(this.peekFirstKey())[0];this.forEach((function(e){e.tileCoord[0]!==t&&(this.remove(BE(e.tileCoord)),e.dispose())}),this)}},e}(W_);const WE=function(t){function e(e,i,n,r,o,s,a,l,u,h,c){t.call(this,o,Cx),this.renderEdges_=void 0!==c&&c,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=i,this.targetTileGrid_=r,this.wrappedTileCoord_=s||o,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;var d=r.getTileCoordExtent(this.wrappedTileCoord_),f=this.targetTileGrid_.getExtent(),p=this.sourceTileGrid_.getExtent(),g=f?eg(d,f):d;if(0!==Xp(g)){var m=e.getExtent();m&&(p=p?eg(p,m):m);var v=r.getResolution(this.wrappedTileCoord_[0]),y=ry(e,n,Zp(g),v);if(!isFinite(y)||y<=0)this.state=Ax;else{var _=void 0!==h?h:.5;if(this.triangulation_=new ly(e,n,g,p,y*_),0!==this.triangulation_.getTriangles().length){this.sourceZ_=i.getZForResolution(y);var b=this.triangulation_.calculateSourceExtent();if(p&&(e.canWrapX()?(b[1]=jg(b[1],p[1],p[3]),b[3]=jg(b[3],p[1],p[3])):b=eg(b,p)),Xp(b)){for(var w=i.getTileRangeForExtentAndZ(b,this.sourceZ_),x=w.minX;x<=w.maxX;x++)for(var S=w.minY;S<=w.maxY;S++){var C=u(this.sourceZ_,x,S,a);C&&this.sourceTiles_.push(C)}0===this.sourceTiles_.length&&(this.state=Ax)}else this.state=Ax}else this.state=Ax}}else this.state=Ax}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==Tx&&this.unlistenSources_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,i,n){e&&e.getState()==Ex&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=Ix;else{var e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n="number"==typeof i?i:i[0],r="number"==typeof i?i:i[1],o=this.targetTileGrid_.getResolution(e),s=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=sy(n,r,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),o,a,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=Ex}this.changed()},e.prototype.load=function(){if(this.state==Cx){this.state=Tx,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,i,n){var r=e.getState();if(r==Cx||r==Tx){t++;var o=vf(e,kf,(function(i){var n=e.getState();n!=Ex&&n!=Ix&&n!=Ax||(bf(o),0===--t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(o)}}.bind(this)),this.sourceTiles_.forEach((function(t,e,i){t.getState()==Cx&&t.load()})),0===t&&setTimeout(this.reproject_.bind(this),0)}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(bf),this.sourcesListenerKeys_=null},e}(OE);var KE=[0,0,0],XE=function(t){var e,i,n,r;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,vp((e=this.resolutions_,i=!0,n=function(t,e){return e-t}||mg,e.every((function(t,r){if(0===r)return!0;var o=n(e[r-1],t);return!(o>0||i&&0===o)}))),17),!t.origins)for(var o=0,s=this.resolutions_.length-1;o<s;++o)if(r){if(this.resolutions_[o]/this.resolutions_[o+1]!==r){r=void 0;break}}else r=this.resolutions_[o]/this.resolutions_[o+1];this.zoomFactor_=r,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,vp(this.origins_.length==this.resolutions_.length,20));var a=t.extent;void 0===a||this.origin_||this.origins_||(this.origin_=ig(a)),vp(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,vp(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:Fx,vp(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==a?a:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((function(t,e){return new WS(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))}),this):a&&this.calculateTileRanges_(a)};XE.prototype.forEachTileCoord=function(t,e,i){for(var n=this.getTileRangeForExtentAndZ(t,e),r=n.minX,o=n.maxX;r<=o;++r)for(var s=n.minY,a=n.maxY;s<=a;++s)i([e,r,s])},XE.prototype.forEachTileCoordParentTileRange=function(t,e,i,n,r){var o,s,a,l=null,u=t[0]-1;for(2===this.zoomFactor_?(s=t[1],a=t[2]):l=this.getTileCoordExtent(t,r);u>=this.minZoom;){if(o=2===this.zoomFactor_?qS(s=Math.floor(s/2),s,a=Math.floor(a/2),a,n):this.getTileRangeForExtentAndZ(l,u,n),e.call(i,u,o))return!0;--u}return!1},XE.prototype.getExtent=function(){return this.extent_},XE.prototype.getMaxZoom=function(){return this.maxZoom},XE.prototype.getMinZoom=function(){return this.minZoom},XE.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},XE.prototype.getResolution=function(t){return this.resolutions_[t]},XE.prototype.getResolutions=function(){return this.resolutions_},XE.prototype.getTileCoordChildTileRange=function(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var n=2*t[1],r=2*t[2];return qS(n,n+1,r,r+1,e)}var o=this.getTileCoordExtent(t,i);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null},XE.prototype.getTileRangeExtent=function(t,e,i){var n=this.getOrigin(t),r=this.getResolution(t),o=Kx(this.getTileSize(t),this.tmpSize_),s=n[0]+e.minX*o[0]*r,a=n[0]+(e.maxX+1)*o[0]*r;return Dp(s,n[1]+e.minY*o[1]*r,a,n[1]+(e.maxY+1)*o[1]*r,i)},XE.prototype.getTileRangeForExtentAndZ=function(t,e,i){var n=KE;this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n);var r=n[1],o=n[2];return this.getTileCoordForXYAndZ_(t[2],t[3],e,!0,n),qS(r,n[1],o,n[2],i)},XE.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=Kx(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]+(t[2]+.5)*n[1]*i]},XE.prototype.getTileCoordExtent=function(t,e){var i=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=Kx(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*r[0]*n,s=i[1]+t[2]*r[1]*n;return Dp(o,s,o+r[0]*n,s+r[1]*n,e)},XE.prototype.getTileCoordForCoordAndResolution=function(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)},XE.prototype.getTileCoordForXYAndResolution_=function(t,e,i,n,r){var o=this.getZForResolution(i),s=i/this.getResolution(o),a=this.getOrigin(o),l=Kx(this.getTileSize(o),this.tmpSize_),u=n?.5:0,h=n?0:.5,c=Math.floor((t-a[0])/i+u),d=Math.floor((e-a[1])/i+h),f=s*c/l[0],p=s*d/l[1];return n?(f=Math.ceil(f)-1,p=Math.ceil(p)-1):(f=Math.floor(f),p=Math.floor(p)),jE(o,f,p,r)},XE.prototype.getTileCoordForXYAndZ_=function(t,e,i,n,r){var o=this.getOrigin(i),s=this.getResolution(i),a=Kx(this.getTileSize(i),this.tmpSize_),l=n?.5:0,u=n?0:.5,h=Math.floor((t-o[0])/s+l),c=Math.floor((e-o[1])/s+u),d=h/a[0],f=c/a[1];return n?(d=Math.ceil(d)-1,f=Math.ceil(f)-1):(d=Math.floor(d),f=Math.floor(f)),jE(i,d,f,r)},XE.prototype.getTileCoordForCoordAndZ=function(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)},XE.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},XE.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},XE.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},XE.prototype.getZForResolution=function(t,e){return jg(yg(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)},XE.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,i=new Array(e),n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i};const YE=XE;function HE(t){var e=t.getDefaultTileGrid();return e||(e=function(t,e,i,n){return function(t,e,i,n){var r=void 0!==n?n:bp,o=ZE(t,e,i);return new YE({extent:t,origin:Jp(t,r),resolutions:o,tileSize:i})}(JE(t),e,i,n)}(t),t.setDefaultTileGrid(e)),e}function ZE(t,e,i){for(var n=void 0!==e?e:42,r=tg(t),o=rg(t),s=Kx(void 0!==i?i:Fx),a=Math.max(o/s[0],r/s[1]),l=n+1,u=new Array(l),h=0;h<l;++h)u[h]=a/Math.pow(2,h);return u}function JE(t){var e=(t=_m(t)).getExtent();if(!e){var i=180*Xg[Yg.DEGREES]/t.getMetersPerUnit();e=Dp(-i,-i,i,i)}return e}var QE=function(t){function e(e){t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX}),this.opaque_=void 0!==e.opaque&&e.opaque,this.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,this.tileGrid=void 0!==e.tileGrid?e.tileGrid:null,this.tileCache=new qE(e.cacheSize),this.tmpSize=[0,0],this.key_=e.key||"",this.tileOptions={transition:e.transition}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);i&&i.expireCache(e)},e.prototype.forEachLoadedTile=function(t,e,i,n){var r=this.getTileCacheForProjection(t);if(!r)return!1;for(var o,s,a,l=!0,u=i.minX;u<=i.maxX;++u)for(var h=i.minY;h<=i.maxY;++h)s=NE(e,u,h),a=!1,r.containsKey(s)&&(a=(o=r.get(s)).getState()===Ex)&&(a=!1!==n(o)),a||(l=!1);return l},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},e.prototype.getTile=function(t,e,i,n,r){return rf()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:HE(t)},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();return e&&!Sm(e,t)?null:this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,e,i){var n,r,o,s=this.getTileGridForProjection(i),a=this.getTilePixelRatio(e),l=Kx(s.getTileSize(t),this.tmpSize);return 1==a?l:(n=l,r=a,void 0===(o=this.tmpSize)&&(o=[0,0]),o[0]=n[0]*r+.5|0,o[1]=n[1]*r+.5|0,o)},e.prototype.getTileCoordForTileUrlFunction=function(t,e){var i=void 0!==e?e:this.getProjection(),n=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=function(t,e,i){var n=e[0],r=t.getTileCoordCenter(e),o=JE(i);if(Lp(o,r))return e;var s=rg(o),a=Math.ceil((o[0]-r[0])/s);return r[0]+=s*a,t.getTileCoordForCoordAndZ(r,n)}(n,t,i)),function(t,e){var i=t[0],n=t[1],r=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;var o,s=e.getExtent();return!(o=s?e.getTileRangeForExtentAndZ(s,i):e.getFullTileRange(i))||o.containsXY(n,r)}(t,n)?t:null},e.prototype.refresh=function(){this.tileCache.clear(),this.changed()},e.prototype.useTile=function(t,e,i,n){},e}(fy),tI=function(t){function e(e,i){t.call(this,e),this.tile=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Af);const eI="tileloadstart",iI="tileloadend",nI="tileloaderror";function rI(t,e){t.getImage().src=e}const oI=function(t){function e(e){t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:rI,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible}),this.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,this.tileClass=void 0!==e.tileClass?e.tileClass:DE,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);for(var n in this.tileCache.expireCache(this.tileCache==i?e:{}),this.tileCacheForProjection){var r=this.tileCacheForProjection[n];r.expireCache(r==i?e:{})}},e.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!Sm(this.getProjection(),t)?0:this.getGutter()},e.prototype.getGutter=function(){return 0},e.prototype.getOpaque=function(e){return!(this.getProjection()&&e&&!Sm(this.getProjection(),e))&&t.prototype.getOpaque.call(this,e)},e.prototype.getTileGridForProjection=function(t){var e=this.getProjection();if(!this.tileGrid||e&&!Sm(e,t)){var i=sf(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=HE(t)),this.tileGridForProjection[i]}return this.tileGrid},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();if(!e||Sm(e,t))return this.tileCache;var i=sf(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new qE(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]},e.prototype.createTile_=function(t,e,i,n,r,o){var s=[t,e,i],a=this.getTileCoordForTileUrlFunction(s,r),l=a?this.tileUrlFunction(a,n,r):void 0,u=new this.tileClass(s,void 0!==l?Cx:Ax,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,vf(u,kf,this.handleTileChange,this),u},e.prototype.getTile=function(t,e,i,n,r){var o=this.getProjection();if(o&&r&&!Sm(o,r)){var s,a=this.getTileCacheForProjection(r),l=[t,e,i],u=BE(l);a.containsKey(u)&&(s=a.get(u));var h=this.getKey();if(s&&s.key==h)return s;var c=this.getTileGridForProjection(o),d=this.getTileGridForProjection(r),f=this.getTileCoordForTileUrlFunction(l,r),p=new WE(o,c,r,d,l,f,this.getTilePixelRatio(n),this.getGutter(),function(t,e,i,n){return this.getTileInternal(t,e,i,n,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return p.key=h,s?(p.interimTile=s,p.refreshInterimChain(),a.replace(u,p)):a.set(u,p),p}return this.getTileInternal(t,e,i,n,o||r)},e.prototype.getTileInternal=function(t,e,i,n,r){var o=null,s=NE(t,e,i),a=this.getKey();if(this.tileCache.containsKey(s)){if((o=this.tileCache.get(s)).key!=a){var l=o;o=this.createTile_(t,e,i,n,r,a),l.getState()==Cx?o.interimTile=l.interimTile:o.interimTile=l,o.refreshInterimChain(),this.tileCache.replace(s,o)}}else o=this.createTile_(t,e,i,n,r,a),this.tileCache.set(s,o);return o},e.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,e){var i=_m(t);if(i){var n=sf(i);n in this.tileGridForProjection||(this.tileGridForProjection[n]=e)}},e}(function(t){function e(e){t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible}),this.generateTileUrlFunction_=!e.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,this.tileUrlFunction=e.tileUrlFunction?e.tileUrlFunction.bind(this):VE,this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),e.tileUrlFunction&&this.setTileUrlFunction(e.tileUrlFunction,this.key_),this.tileLoadingKeys_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var e,i=t.target,n=sf(i),r=i.getState();r==Tx?(this.tileLoadingKeys_[n]=!0,e=eI):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],e=r==Ix?nI:r==Ex||r==Px?iI:void 0),null!=e&&this.dispatchEvent(new tI(e,i))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},e.prototype.setUrl=function(t){var e=this.urls=GE(t);this.setUrls(e)},e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,e){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=UE(t[r],e);return zE(n)}(t,this.tileGrid),e):this.setKey(e)},e.prototype.useTile=function(t,e,i){var n=NE(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)},e}(QE));var sI="default",aI="truncated",lI=function(t){function e(e,i,n,r,o,s,a){t.call(this,i,n,r,o,s,a),this.zoomifyImage_=null,this.tileSize_=Kx(e.getTileSize(i[0]))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getImage=function(){if(this.zoomifyImage_)return this.zoomifyImage_;var e=t.prototype.getImage.call(this);if(this.state==Ex){var i=this.tileSize_;if(e.width==i[0]&&e.height==i[1])return this.zoomifyImage_=e,e;var n=hp(i[0],i[1]);return n.drawImage(e,0,0),this.zoomifyImage_=n.canvas,n.canvas}return e},e}(DE);const uI=function(t){function e(e){var i=e||{},n=i.size,r=void 0!==i.tierSizeCalculation?i.tierSizeCalculation:sI,o=n[0],s=n[1],a=i.extent||[0,-n[1],n[0],0],l=[],u=i.tileSize||Fx,h=u;switch(r){case sI:for(;o>h||s>h;)l.push([Math.ceil(o/h),Math.ceil(s/h)]),h+=h;break;case aI:for(var c=o,d=s;c>h||d>h;)l.push([Math.ceil(c/h),Math.ceil(d/h)]),c>>=1,d>>=1;break;default:vp(!1,53)}l.push([1,1]),l.reverse();for(var f=[1],p=[0],g=1,m=l.length;g<m;g++)f.push(1<<g),p.push(l[g-1][0]*l[g-1][1]+p[g-1]);f.reverse();var v=new YE({tileSize:u,extent:a,origin:ig(a),resolutions:f}),y=i.url;y&&-1==y.indexOf("{TileGroup}")&&-1==y.indexOf("{tileIndex}")&&(y+="{TileGroup}/{z}-{x}-{y}.jpg");var _=zE(GE(y).map((function(t){return function(e,i,n){if(e){var r=e[0],o=e[1],s=-e[2]-1,a=o+s*l[r][0],u=v.getTileSize(r),h=Array.isArray(u)?u[0]:u,c={z:r,x:o,y:s,tileIndex:a,TileGroup:"TileGroup"+((a+p[r])/h|0)};return t.replace(/\{(\w+?)\}/g,(function(t,e){return c[e]}))}}}))),b=lI.bind(null,v);t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileClass:b,tileGrid:v,tileUrlFunction:_,transition:i.transition})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(oI);var hI=Tl({props:{resolution:{required:!0}},computed:{zoomLevelText:function(){return(Math.round(100/this.resolution)/100||0)+"x"}}},undefined,undefined,!1,null,null,null);const cI=Tl({components:{zoomLevelIndicator:hI.exports},props:{showZoomLevel:{type:Boolean,default:!1}}},undefined,undefined,!1,null,null,null).exports;const dI=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),target:i.target}),this.extent=i.extent?i.extent:null;var n=void 0!==i.className?i.className:"ol-zoom-extent",r=void 0!==i.label?i.label:"E",o=void 0!==i.tipLabel?i.tipLabel:"Fit to extent",s=document.createElement("button");s.setAttribute("type","button"),s.title=o,s.appendChild("string"==typeof r?document.createTextNode(r):r),vf(s,Ff,this.handleClick_,this);var a=n+" "+"ol-unselectable "+ap,l=this.element;l.className=a,l.appendChild(s)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t){t.preventDefault(),this.handleZoomToExtent()},e.prototype.handleZoomToExtent=function(){var t=this.getMap().getView(),e=this.extent?this.extent:t.getProjection().getExtent();t.fit(e)},e}(Hx);function fI(t){return(fI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pI(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function gI(t,e){return(gI=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function mI(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=_I(t);if(e){var r=_I(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return vI(this,i)}}function vI(t,e){return!e||"object"!==fI(e)&&"function"!=typeof e?yI(t):e}function yI(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _I(t){return(_I=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}const bI=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gI(t,e)}(o,t);var e,i,n,r=mI(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var i=t||{},n=i.label?i.label:"1",s=document.createElement("button");s.innerHTML=n,s.title="Zoom to original resolution",s.addEventListener("click",(function(){e.zoomToNative.call(yI(e))}));var a=document.createElement("div");return a.className="zoom-to-native ol-unselectable ol-control",a.appendChild(s),(e=r.call(this,{element:a,target:i.target})).duration_=void 0!==i.duration?i.duration:250,e}return e=o,(i=[{key:"zoomToNative",value:function(){var t=this.getMap().getView();t&&t.getResolution()&&(this.duration_>0?t.animate({resolution:1,duration:this.duration_}):t.setResolution(1))}}])&&pI(e.prototype,i),n&&pI(e,n),o}(Hx);const wI=Tl({mixins:[Pv,Jv,bw,Cw,Ow,GC,eT,dE,gE,vE,ME,cI],components:{minimap:qC,labelIndicator:Sw,controlButton:Ey},props:{canAdd:{type:Boolean,default:!1},canModify:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},image:{type:Object,default:null},annotations:{type:Array,default:function(){return[]}},selectedAnnotations:{type:Array,default:function(){return[]}},center:{type:Array,default:void 0},resolution:{type:Number,default:void 0},selectedLabel:{default:null},lastCreatedAnnotation:{default:null},annotationOpacity:{type:Number,default:1},annotationMode:{type:String,default:"default"},showMinimap:{type:Boolean,default:!0},listenerSet:{type:String,default:"default"}},data:function(){return{initialized:!1,focusOptions:{padding:50,duration:250,resolution:1},interactionMode:"default",mapSize:[0,0],mousePosition:[0,0],modifyInProgress:!1}},computed:{extent:function(){return this.image?[0,0,this.image.width,this.image.height]:[0,0,0,0]},viewExtent:function(){return this.initialized&&this.resolution&&this.map?this.map.getView().calculateExtent(this.mapSize):[0,0,0,0]},projection:function(){return new Zg({code:"biigle-image",units:"pixels",extent:this.extent})},selectedFeatures:function(){return this.selectInteraction?this.selectInteraction.getFeatures():[]},isDefaultInteractionMode:function(){return"default"===this.interactionMode},hasSelectedLabel:function(){return Boolean(this.selectedLabel)},hasSelectedAnnotations:function(){return this.selectedAnnotations.length>0},hasLastCreatedAnnotation:function(){return null!==this.lastCreatedAnnotation},previousButtonTitle:function(){switch(this.annotationMode){case"volare":return"Previous annotation";case"lawnmower":return"Previous image section";case"randomSampling":case"regularSampling":return"Previous sample location";default:return"Previous image"}},nextButtonTitle:function(){switch(this.annotationMode){case"volare":return"Next annotation";case"lawnmower":return"Next image section";case"randomSampling":case"regularSampling":return"Next sample location";default:return"Next image"}}},methods:{createMap:function(){var t=new dI({tipLabel:"Zoom to show whole image",label:""});Ll.on("-",t.handleZoomToExtent.bind(t),0,this.listenerSet);var e=new UC({controls:[new eS,t],interactions:AS({altShiftDragRotate:!1,doubleClickZoom:!1,keyboard:!1,shiftDragZoom:!1,pinchRotate:!1,pinchZoom:!1,mouseWheelZoom:!1})});return e.addInteraction(new TS({condition:function(t){return!n_(t)}})),t=new bI({label:""}),Ll.on("+",t.zoomToNative.bind(t),0,this.listenerSet),e.addControl(t),e},declareNonReactiveProperties:function(){this.map=this.createMap(),this.imageLayer=new xw,this.tiledImageLayer=new wE,this.annotationFeatures=new Ty,this.annotationSource=new Wb({features:this.annotationFeatures}),this.annotationLayer=new kb({source:this.annotationSource,zIndex:100,updateWhileAnimating:!0,updateWhileInteracting:!0,style:vw.features}),this.selectInteraction=new lE({condition:Jy,style:vw.highlight,layers:[this.annotationLayer],multi:!0}),this.canModify&&(this.featureRevisionMap={},this.modifyInteraction=new QC({features:this.selectInteraction.getFeatures(),deleteCondition:function(t){return n_(t)&&e_(t)}}))},updateMapSize:function(){this.mapSize=this.map.getSize()},updateMapView:function(t){var e=t.target.getView();this.$emit("moveend",{center:e.getCenter(),resolution:e.getResolution()})},invertPointsYAxis:function(t){for(var e=this.extent[3],i=1;i<t.length;i+=2)t[i]=e-t[i];return t},convertPointsFromOlToDb:function(t){return this.invertPointsYAxis(Array.prototype.concat.apply([],t))},convertPointsFromDbToOl:function(t){t=this.invertPointsYAxis(t.slice());for(var e=[],i=0;i<t.length;i+=2)e.push([t[i],t[i+1]||0]);return e},getGeometry:function(t){var e=this.convertPointsFromDbToOl(t.points);switch(t.shape){case"Point":return new ov(e[0]);case"Rectangle":return new Kb([e]);case"Polygon":return new _v([e]);case"LineString":return new Iv(e);case"Circle":return new Sv(e[0],e[1][0]);case"Ellipse":return new Xb([e]);default:return void console.error("Unknown annotation shape: "+t.shape)}},createFeature:function(t){var e=new Iy(this.getGeometry(t));return e.setId(t.id),e.set("annotation",t),t.labels&&t.labels.length>0&&e.set("color",t.labels[0].label.color),e},handleFeatureModifyStart:function(t){var e=this;this.modifyInProgress=!0,t.features.getArray().forEach((function(t){e.featureRevisionMap[t.getId()]=t.getRevision()}))},handleFeatureModifyEnd:function(t){var e=this;this.modifyInProgress=!1;var i=t.features.getArray().filter((function(t){return e.featureRevisionMap[t.getId()]!==t.getRevision()})).map((function(t){return{id:t.getId(),image_id:t.get("annotation").image_id,points:e.getPoints(t.getGeometry())}}));i.length>0&&this.$emit("update",i)},focusAnnotation:function(t,e,i){var n=this.annotationSource.getFeatureById(t.id);if(n){var r=this.map.getView(),o=e?0:this.focusOptions.duration,s=i?this.resolution:this.focusOptions.resolution,a=n.getGeometry().getExtent().slice();if(a[0]-=this.focusOptions.padding,a[1]-=this.focusOptions.padding,a[2]+=this.focusOptions.padding,a[3]+=this.focusOptions.padding,!i){var l=r.getResolutionForExtent(a);s=l>this.focusOptions.resolution?l:s}r.animate({center:Zp(a),resolution:s,duration:o})}},fitImage:function(){this.map.getView().fit(this.extent,this.map.getSize())},extractAnnotationFromFeature:function(t){return t.get("annotation")},handleFeatureSelect:function(t){this.$emit("select",t.selected.map(this.extractAnnotationFromFeature),t.deselected.map(this.extractAnnotationFromFeature))},handlePrevious:function(){this.modifyInProgress||this.$emit("previous")},conditionalHandleScroll:function(t){n_({originalEvent:t})&&this.handleScroll(t)},handleScroll:function(t){t.preventDefault();var e=t.deltaY||t.deltaX;e<0?this.handleNext():e>0&&this.handlePrevious()},handleNext:function(){this.modifyInProgress||this.$emit("next")},resetInteractionMode:function(){this.interactionMode="default"},getPoints:function(t){var e;switch(t.getType()){case"Circle":e=[t.getCenter(),[t.getRadius()]];break;case"Polygon":case"Rectangle":case"Ellipse":e=t.getCoordinates()[0];break;case"Point":e=[t.getCoordinates()];break;default:e=t.getCoordinates()}return this.convertPointsFromOlToDb(e)},handleNewFeature:function(t){var e=this;if(this.hasSelectedLabel){var i=t.feature.getGeometry();t.feature.set("color",this.selectedLabel.color);this.$emit("new",{shape:i.getType(),points:this.getPoints(i)},(function(){try{e.annotationSource.removeFeature(t.feature)}catch(t){}}))}else this.annotationSource.removeFeature(t.feature)},deleteSelectedAnnotations:function(){!this.modifyInProgress&&this.hasSelectedAnnotations&&confirm("Are you sure you want to delete all selected annotations?")&&this.$emit("delete",this.selectedAnnotations)},deleteLastCreatedAnnotation:function(){this.hasLastCreatedAnnotation&&this.$emit("delete",[this.lastCreatedAnnotation])},createPointAnnotationAt:function(t,e){if(this.hasSelectedLabel){var i=new Iy(new ov([t,e]));this.annotationSource.addFeature(i),this.handleNewFeature({feature:i})}else this.requireSelectedLabel()},requireSelectedLabel:function(){this.$emit("requires-selected-label"),this.resetInteractionMode()},render:function(){this.map&&(this.map.render(),this.$emit("render"))},handleRegularImage:function(t){t?this.imageLayer.setSource(new by({canvas:t.canvas,projection:this.projection,canvasExtent:this.extent,canvasSize:[t.width,t.height]})):this.imageLayer.setSource(null)},handleTiledImage:function(t){t?this.tiledImageLayer.setSource(new uI({url:t.url,size:[t.width,t.height],extent:[0,0,t.width,t.height],transition:100})):this.tiledImageLayer.setSource(null)},updateMousePosition:function(t){this.mousePosition=t.coordinate},refreshAnnotationSource:function(t,e){var i={};t.forEach((function(t){i[t.id]=null}));var n={},r=e.getFeatures(),o=r.filter((function(t){return n[t.getId()]=null,!i.hasOwnProperty(t.getId())}));o.length===r.length?e.clear(!0):(o.filter((function(t){return void 0!==t.getId()})).forEach((function(t){e.removeFeature(t)})),t=t.filter((function(t){return!n.hasOwnProperty(t.id)}))),e.addFeatures(t.map(this.createFeature))}},watch:{image:function(t,e){t?!0===t.tiled?(e&&!0===e.tiled||(this.map.removeLayer(this.imageLayer),this.map.addLayer(this.tiledImageLayer)),this.handleTiledImage(t,e)):(e&&!0!==e.tiled||(this.map.removeLayer(this.tiledImageLayer),this.map.addLayer(this.imageLayer)),this.handleRegularImage(t,e)):(this.map.removeLayer(this.tiledImageLayer),this.map.removeLayer(this.imageLayer))},annotations:function(t){this.refreshAnnotationSource(t,this.annotationSource),this.resetHoveredAnnotations()},selectedAnnotations:function(t){var e=this.annotationSource,i=this.selectedFeatures;i.clear(),t.forEach((function(t){i.push(e.getFeatureById(t.id))}))},extent:function(t,e){if(t[2]!==e[2]||t[3]!==e[3]){var i=Zp(t);this.initialized||(i=this.center||i),this.map.setView(new Gx({projection:this.projection,center:i,resolution:this.resolution,zoomFactor:2,minResolution:.01,extent:t})),void 0===this.resolution&&this.map.getView().fit(t),this.initialized||(this.updateMapView({target:this.map}),this.initialized=!0)}},annotationOpacity:function(t){this.annotationLayer.setOpacity(t)},isDefaultInteractionMode:function(t){this.selectInteraction.setActive(t||this.isTranslating),this.canModify&&this.modifyInteraction.setActive(t)}},created:function(){var t=this;this.declareNonReactiveProperties(),this.annotationLayer.set("name","annotations"),this.map.addLayer(this.annotationLayer),this.imageLayer.set("name","imageRegular"),this.tiledImageLayer.set("name","imageTile"),Rl.$on("sidebar.toggle",(function(){t.$nextTick((function(){t.map.updateSize()}))})),this.map.on("change:size",this.updateMapSize),this.map.on("moveend",this.updateMapView),this.map.on("pointermove",this.updateMousePosition),this.selectInteraction.on("select",this.handleFeatureSelect),this.map.addInteraction(this.selectInteraction),Ll.on(" ",this.handleNext,0,this.listenerSet),Ll.on("ArrowRight",this.handleNext,0,this.listenerSet),Ll.on("ArrowLeft",this.handlePrevious,0,this.listenerSet),Ll.on("Escape",this.resetInteractionMode,0,this.listenerSet),this.canModify&&(this.modifyInteraction.on("modifystart",this.handleFeatureModifyStart),this.modifyInteraction.on("modifyend",this.handleFeatureModifyEnd),this.map.addInteraction(this.modifyInteraction)),this.canDelete&&(Ll.on("Delete",this.deleteSelectedAnnotations,0,this.listenerSet),Ll.on("Backspace",this.deleteLastCreatedAnnotation,0,this.listenerSet))},mounted:function(){this.map.setTarget(this.$el)}},undefined,undefined,!1,null,null,null).exports;const xI=Tl(new Vue({data:{cache:{}},computed:{shapeMap:function(){return biigle.$require("annotations.shapes")},inverseShapeMap:function(){var t={};for(var e in this.shapeMap)t[this.shapeMap[e]]=parseInt(e,10);return t}},methods:{parseResponse:function(t){return t.data},resolveShape:function(t){return t.shape=this.shapeMap[t.shape_id],t},resolveAllShapes:function(t){return t.forEach(this.resolveShape,this),t},setDeselected:function(t){return t.selected=!1,t},setAllDeselected:function(t){return t.forEach(this.setDeselected),t},fetchAnnotations:function(t){return this.cache.hasOwnProperty(t)||(this.cache[t]=ml.getAnnotations({id:t}).catch((function(){return Vue.Promise.reject("Failed to load annotations for image ".concat(t,"!"))})).then(this.parseResponse).then(this.resolveAllShapes)),this.cache[t].then(this.setAllDeselected)},create:function(t,e){var i=this;return e.shape_id=this.inverseShapeMap[e.shape],delete e.shape,ml.saveAnnotations({id:t},e).then(this.parseResponse).then(this.resolveShape).then(this.setDeselected).then((function(e){return i.cache[t].then((function(t){t.unshift(e)})),e}))},update:function(t){var e=this,i=gl.update({id:t.id},{points:t.points});return i.then((function(){e.cache[t.image_id].then((function(e){for(var i=e.length-1;i>=0;i--)if(e[i].id===t.id)return void(e[i].points=t.points)}))})),i},attachLabel:function(t,e){var i=gl.attachLabel({id:t.id},e);return i.then((function(e){t.labels.unshift(e.data)}),(function(){})),i},detachLabel:function(t,e){var i=gl.detachLabel({annotation_label_id:e.id});return i.then((function(){for(var i=t.labels.length-1;i>=0;i--)if(t.labels[i].id===e.id)return void t.labels.splice(i,1)})),i},delete:function(t){var e=gl.delete({id:t.id}),i=this.cache[t.image_id];return e.then((function(){i.then((function(e){for(var i=e.length-1;i>=0;i--)if(e[i].id===t.id)return void e.splice(i,1)}))})),e}}}),undefined,undefined,!1,null,null,null).exports;var SI=i(789),CI=i.n(SI);function TI(t){return(TI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function EI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function II(t,e){return!e||"object"!==TI(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function AI(t){var e="function"==typeof Map?new Map:void 0;return(AI=function(t){if(null===t||(i=t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return PI(t,arguments,LI(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),RI(n,t)})(t)}function PI(t,e,i){return(PI=kI()?Reflect.construct:function(t,e,i){var n=[null];n.push.apply(n,e);var r=new(Function.bind.apply(t,n));return i&&RI(r,i.prototype),r}).apply(null,arguments)}function kI(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function RI(t,e){return(RI=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function LI(t){return(LI=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var FI=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&RI(t,e)}(r,t);var e,i,n=(e=r,i=kI(),function(){var t,n=LI(e);if(i){var r=LI(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return II(this,t)});function r(){return EI(this,r),n.apply(this,arguments)}return r}(AI(Error));const MI=Tl(new Vue({data:{initialized:!1,cache:{},cachedIds:[],maxCacheSize:200,supportsColorAdjustment:!1,currentlyDrawnImage:null,colorAdjustmentDefaults:{brightnessContrast:[0,0],brightnessRGB:[0,0,0],hueSaturation:[0,0],vibrance:[0],gamma:[1]},colorAdjustment:{brightnessContrast:[0,0],brightnessRGB:[0,0,0],hueSaturation:[0,0],vibrance:[0],gamma:[1]}},computed:{imageFileUri:function(){return biigle.$require("annotations.imageFileUri")},tilesUri:function(){return biigle.$require("annotations.tilesUri")},supportedTextureSize:function(){return this.fxCanvas?this.fxCanvas._.gl.getParameter(this.fxCanvas._.gl.MAX_TEXTURE_SIZE):0},hasColorAdjustment:function(){for(var t in this.colorAdjustment)if(this.colorAdjustment.hasOwnProperty(t)&&this.isAdjustmentActive(t))return!0;return!1}},methods:{initialize:function(){this.initialized=!0,this.drawCanvas=document.createElement("canvas"),this.drawCanvas.style.imageOrientation="none",this.drawCanvas.style.visibility="hidden",this.drawCanvas.style.position="fixed",document.body.appendChild(this.drawCanvas);try{this.fxCanvas=CI().canvas(),this.fxTexture=null,this.loadedImageTexture=null}catch(t){console.warn("WebGL not supported. Color adjustment disabled.")}window.addEventListener("beforeunload",(function(){this.fxTexture&&(this.fxTexture.destroy(),this.fxCanvas.width=1,this.fxCanvas.height=1)}))},isTiledImage:function(t){return!0===t.tiled},isAdjustmentActive:function(t){var e=this;return this.colorAdjustment[t].some((function(i,n){return i!==e.colorAdjustmentDefaults[t][n]}))},checkSupportsColorAdjustment:function(t){if(!this.fxCanvas||t.crossOrigin)return!1;if(this.isTiledImage(t))this.supportsColorAdjustment=!1;else{if(this.currentlyDrawnImage&&this.currentlyDrawnImage.width===t.width&&this.currentlyDrawnImage.height===t.height)return this.supportsColorAdjustment;var e=this.supportedTextureSize;if(e<t.width||e<t.height)return console.warn("Insufficient WebGL texture size. Required: ".concat(t.width,"x").concat(t.height,", available: ").concat(e,"x").concat(e,". Color adjustment disabled.")),void(this.supportsColorAdjustment=!1);var i=CI().canvas();if(i.width=t.width,i.height=t.height,t.width!==i._.gl.drawingBufferWidth||t.height!==i._.gl.drawingBufferHeight)return console.warn("Your browser does not allow a WebGL drawing buffer with the size of the original image. Color adjustment disabled."),void(this.supportsColorAdjustment=!1);this.supportsColorAdjustment=!0}},createImage:function(t){var e=this,i=document.createElement("img"),n={id:t,source:i,width:0,height:0,canvas:document.createElement("canvas"),crossOrigin:!1};i.style.imageOrientation="none",i.style.visibility="hidden",i.style.position="fixed",document.body.appendChild(i);var r=new Vue.Promise((function(e,r){i.onload=function(){n.width=i.width,n.height=i.height,e(n)},i.onerror=function(){r("Failed to load image ".concat(t,"!"))}}));return r.finally((function(){document.body.removeChild(i)})),Vue.http.get(this.imageFileUri.replace(":id",t),{responseType:"blob"}).then((function(t){if("application/json"===t.headers.get("content-type")){var n=t.body.uuid;return t.body.url=e.tilesUri.replace(":uuid",n[0]+n[1]+"/"+n[2]+n[3]+"/"+n),t.body}return t.blob().then((function(t){var e=window.URL||window.webkitURL;i.src=e.createObjectURL(t)})),r})).catch((function(e){return 0===e.status?(n.crossOrigin=!0,i.src=e.url,r):Vue.Promise.reject("Failed to load image ".concat(t,"!"))}))},drawSimpleImage:function(t){return document.body.appendChild(t.source),this.drawCanvas.width=t.width,this.drawCanvas.height=t.height,this.drawCanvas.getContext("2d").drawImage(t.source,0,0),document.body.removeChild(t.source),t.canvas.width=t.width,t.canvas.height=t.height,t.canvas.getContext("2d").drawImage(this.drawCanvas,0,0),t},drawColorAdjustedImage:function(t){for(var e in this.loadedImageTexture!==t.source.src&&(document.body.appendChild(t.source),this.drawCanvas.width=t.width,this.drawCanvas.height=t.height,this.drawCanvas.getContext("2d").drawImage(t.source,0,0),document.body.removeChild(t.source),this.fxTexture?this.fxTexture.loadContentsOf(this.drawCanvas):this.fxTexture=this.fxCanvas.texture(this.drawCanvas),this.loadedImageTexture=t.source.src),this.fxCanvas.draw(this.fxTexture),this.colorAdjustment)this.colorAdjustment.hasOwnProperty(e)&&this.isAdjustmentActive(e)&&this.fxCanvas[e].apply(this.fxCanvas,this.colorAdjustment[e]);return this.fxCanvas.update(),t.canvas.width=t.width,t.canvas.height=t.height,t.canvas.getContext("2d").drawImage(this.fxCanvas,0,0),t},drawImage:function(t){return this.initialized||this.initialize(),this.checkSupportsColorAdjustment(t),this.currentlyDrawnImage=t,this.supportsColorAdjustment&&this.hasColorAdjustment?this.drawColorAdjustedImage(t):this.isTiledImage(t)?t:this.drawSimpleImage(t)},fetchImage:function(t){return this.cache.hasOwnProperty(t)||(Rl.$emit("images.fetching",t),this.cache[t]=this.createImage(t),this.cachedIds.push(t)),this.cache[t]},fetchAndDrawImage:function(t){return this.fetchImage(t).then(this.drawImage)},updateColorAdjustment:function(t){if(this.supportsColorAdjustment){var e,i,n=this.colorAdjustment,r=this.hasColorAdjustment;for(e in t)if(t.hasOwnProperty(e))for(i=t[e].length-1;i>=0;i--)n[e].splice(i,1,t[e][i]);this.hasColorAdjustment?this.drawColorAdjustedImage(this.currentlyDrawnImage):r&&this.drawSimpleImage(this.currentlyDrawnImage)}}},watch:{cachedIds:function(t){if(t.length>this.maxCacheSize){var e=t.shift();delete this.cache[e]}}}}),undefined,undefined,!1,null,null,null).exports;const OI=Tl({props:{annotationFilters:{type:Array,default:function(){return[]}},hasActiveFilter:{type:Boolean,default:!1}},data:function(){return{chosenFilterIndex:null}},computed:{hasFilters:function(){return this.annotationFilters.length>0},chosenFilter:function(){return this.annotationFilters[this.chosenFilterIndex]},clearButtonClass:function(){return{"btn-info":this.hasActiveFilter}}},methods:{emitSelectFilter:function(t){this.$emit("select",t)},emitUnselectFilter:function(){this.$emit("unselect")}},watch:{chosenFilter:function(t,e){e&&(this.$refs.filterElement.removeChild(e.$el),e.$off("select",this.emitSelectFilter),e.$off("unselect",this.emitUnselectFilter)),this.$refs.filterElement.appendChild(t.$el),t.$on("select",this.emitSelectFilter),t.$on("unselect",this.emitUnselectFilter)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("form",{staticClass:"annotations-tab__filter form-inline",on:{submit:function(t){t.preventDefault()}}},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.chosenFilterIndex,expression:"chosenFilterIndex"}],staticClass:"form-control",on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.chosenFilterIndex=e.target.multiple?i:i[0]}}},t._l(t.annotationFilters,(function(e,n){return i("option",{domProps:{value:n,textContent:t._s(e.name)}})})),0),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.chosenFilter,expression:"chosenFilter"}],ref:"filterElement"}),t._v(" "),i("input",{directives:[{name:"show",rawName:"v-show",value:!t.chosenFilter,expression:"!chosenFilter"}],staticClass:"form-control",attrs:{placeholder:"Filter annotations",type:"text",disabled:"true"}}),t._v(" "),i("button",{staticClass:"btn btn-default",class:t.clearButtonClass,attrs:{title:"Clear annotation filter",disabled:!t.hasActiveFilter},on:{click:function(e){return e.preventDefault(),t.emitUnselectFilter(e)}}},[i("i",{staticClass:"fa fa-times"})])])}),[],!1,null,null,null).exports;var $I=Tl({props:{annotation:{type:Object,required:!0},annotationLabel:{type:Object,required:!0},canDetach:{type:Boolean,default:!1}},computed:{classObject:function(){return{selected:!1!==this.annotation.selected}},shapeClass:function(){return"icon-"+this.annotation.shape.toLowerCase()},username:function(){return this.annotationLabel.user?this.annotationLabel.user.firstname+" "+this.annotationLabel.user.lastname:"(user deleted)"}},methods:{emitSelect:function(t){this.$emit("select",this.annotation,t.shiftKey)},emitDetach:function(){this.$emit("detach",this.annotation,this.annotationLabel)},emitFocus:function(){this.$emit("focus",this.annotation)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"annotations-tab-item__sub-item",class:t.classObject,attrs:{"data-annotation-id":t.annotation.id},on:{click:t.emitSelect,dblclick:t.emitFocus}},[t.canDetach?i("button",{staticClass:"close",attrs:{type:"button",title:"Detach this label from the annotation"},on:{click:function(e){return e.stopPropagation(),t.emitDetach(e)}}},[i("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])]):t._e(),t._v(" "),i("span",{staticClass:"icon",class:t.shapeClass}),t._v(" "),i("span",{domProps:{textContent:t._s(t.username)}})])}),[],!1,null,null,null);var DI=Tl({components:{annotationItem:$I.exports},props:{label:{type:Object,default:function(){return{}}},annotations:{type:Array,default:function(){return[]}},canDetachOthers:{type:Boolean,default:!1},ownUserId:{type:Number,default:null}},data:function(){return{open:!1}},computed:{title:function(){return"Annotations with label ".concat(this.label.name)},classObject:function(){return{selected:this.isSelected}},count:function(){return this.annotationItems.length},countTitle:function(){return"There are ".concat(this.count," annotations with label ").concat(this.label.name)},colorStyle:function(){return"background-color: #"+this.label.color},isSelected:function(){return this.open||this.annotations.reduce((function(t,e){return t||!1!==e.selected}),!1)},annotationItems:function(){var t=this,e=[];return this.annotations.forEach((function(i){i.labels.forEach((function(n){n.label_id===t.label.id&&e.push({annotation:i,annotationLabel:n,canDetach:t.canDetachAnnotationLabel(n)})}))})),e}},methods:{toggleOpen:function(){this.open=!this.open},emitSelect:function(t,e){this.$emit("select",t,e)},emitDetach:function(t,e){this.$emit("detach",t,e)},emitFocus:function(t){this.$emit("focus",t)},canDetachAnnotationLabel:function(t){return this.canDetachOthers||this.ownUserId===t.user_id}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"annotations-tab-item",class:t.classObject,attrs:{title:t.title}},[i("div",{staticClass:"annotations-tab-item__title",on:{click:t.toggleOpen}},[i("span",{staticClass:"pull-right badge",attrs:{title:t.countTitle},domProps:{textContent:t._s(t.count)}}),t._v(" "),i("span",{staticClass:"annotations-tab-item__color",style:t.colorStyle}),t._v(" "),i("span",{domProps:{textContent:t._s(t.label.name)}})]),t._v(" "),i("ul",{directives:[{name:"show",rawName:"v-show",value:t.isSelected,expression:"isSelected"}],staticClass:"annotations-tab-item__list list-unstyled"},t._l(t.annotationItems,(function(e){return i("annotation-item",{key:e.annotationLabel.id,attrs:{annotation:e.annotation,"annotation-label":e.annotationLabel,"can-detach":e.canDetach},on:{select:t.emitSelect,detach:t.emitDetach,focus:t.emitFocus}})})),1)])}),[],!1,null,null,null);const jI=Tl({components:{filters:OI,labelItem:DI.exports},props:{hasActiveFilter:{type:Boolean,default:!1},annotations:{type:Array,default:function(){return[]}},annotationFilters:{type:Array,default:function(){return[]}},canDetachOthers:{type:Boolean,default:!1},ownUserId:{type:Number,default:null},selectedAnnotations:{type:Array,default:function(){return[]}},annotationsHiddenByFilter:{type:Boolean,default:!1}},computed:{labelItems:function(){var t={},e={},i={};return this.annotations.forEach((function(n){n.labels.forEach((function(r){t.hasOwnProperty(r.label.id)||(t[r.label_id]=r.label,e[r.label_id]=[]);var o=n.id+"-"+r.label_id;i.hasOwnProperty(o)||(i[o]=null,e[r.label_id].push(n))}))})),Object.values(t).sort((function(t,e){return t.name.toLowerCase()>e.name.toLowerCase()?1:-1})).map((function(t){return{id:t.id,label:t,annotations:e[t.id]}}))}},methods:{handleSelect:function(t,e){!1!==t.selected&&e?this.$emit("deselect",t):this.$emit("select",t,e)},emitDetach:function(t,e){this.$emit("detach",t,e)},emitSelectFilter:function(t){this.$emit("select-filter",t)},emitUnselectFilter:function(){this.$emit("unselect-filter")},emitFocus:function(t){this.$emit("focus",t)},scrollIntoView:function(t){var e,i=this.$refs.scrollList,n=i.scrollTop,r=i.offsetHeight,o=1/0,s=0;t.forEach((function(t){for(var n=i.querySelectorAll('[data-annotation-id="'.concat(t.id,'"]')),r=n.length-1;r>=0;r--)e=n[r],o=Math.min(e.offsetTop,o),s=Math.max(e.offsetTop+e.offsetHeight,s)})),n>o?i.scrollTop=o:n+r<s&&(i.scrollTop=r>=s-o?s-i.offsetHeight:o)}},watch:{selectedAnnotations:function(t){t.length>0&&this.$nextTick((function(){this.scrollIntoView(t)}))}}},undefined,undefined,!1,null,null,null).exports;var NI={};const BI=Tl({mixins:[jI],computed:{plugins:function(){return NI}}},undefined,undefined,!1,null,null,null).exports;var UI={};const zI=Tl({components:{labelTrees:ec},data:function(){return{labelTrees:[],selectedLabel:null}},computed:{plugins:function(){return UI}},methods:{handleSelectedLabel:function(t){this.selectedLabel=t,this.$emit("select",t)},handleDeselectedLabel:function(){this.selectedLabel=null,this.$emit("select",null)}},created:function(){this.labelTrees=biigle.$require("annotations.labelTrees")}},undefined,undefined,!1,null,null,null).exports;const VI=Tl({data:function(){return{filenames:{},currentId:null}},computed:{filename:function(){if(this.currentId){var t=this.filenames[this.currentId].split(".");return t.length>1&&(t[t.length-1]="png"),"biigle_screenshot_"+(t=t.join(".").toLowerCase())}return"biigle_screenshot.png"}},methods:{trimCanvas:function(t){var e,i,n,r=t.getContext("2d"),o=document.createElement("canvas").getContext("2d"),s=r.getImageData(0,0,t.width,t.height),a=s.data.length,l={top:null,left:null,right:null,bottom:null};for(e=0;e<a;e+=4)0!==s.data[e+3]&&(i=e/4%t.width,n=~~(e/4/t.width),null===l.top&&(l.top=n),(null===l.left||i<l.left)&&(l.left=i),(null===l.right||l.right<i)&&(l.right=i),(null===l.bottom||l.bottom<n)&&(l.bottom=n));var u=l.bottom-l.top,h=l.right-l.left,c=r.getImageData(l.left,l.top,h,u);return o.canvas.width=h,o.canvas.height=u,o.putImageData(c,0,0),o.canvas},makeBlob:function(t){try{t=this.trimCanvas(t)}catch(t){return Vue.Promise.reject("Could not create screenshot. Maybe the image is not loaded yet?")}var e="image/png";if(HTMLCanvasElement.prototype.toBlob)return new Vue.Promise((function(i){t.toBlob(i,e)}));for(var i=atob(t.toDataURL(e).split(",")[1]),n=i.length,r=new Uint8Array(n),o=0;o<n;o++)r[o]=i.charCodeAt(o);return new Vue.Promise((function(t){t(new Blob([r],{type:e}))}))},download:function(t){var e=document.createElement("a");e.style="display: none",e.download=this.filename,e.href=URL.createObjectURL(t),document.body.appendChild(e),e.click(),window.setTimeout((function(){document.body.removeChild(e),URL.revokeObjectURL(e.href)}),100)},capture:function(){var t=this;this.map&&(this.map.once("postcompose",(function(e){t.makeBlob(e.context.canvas).then(t.download).catch(t.handleError)})),this.map.renderSync())},handleError:function(t){uu.danger(t)},setMap:function(t){this.map=t},updateCurrentId:function(t){this.currentId=t}},created:function(){var t=biigle.$require("annotations.imagesIds"),e={};biigle.$require("annotations.imagesFilenames").forEach((function(i,n){e[t[n]]=i})),this.filenames=e,this.currentId=biigle.$require("annotations.imageId"),Rl.$on("images.change",this.updateCurrentId),Rl.$on("annotations.map.init",this.setMap)}},undefined,undefined,!1,null,null,null).exports;var GI={annotationOpacity:1,cachedImagesCount:1,mousePosition:!1,zoomLevel:!1,scaleLine:!1,labelTooltip:!1,measureTooltip:!1,minimap:!0,progressIndicator:!0,randomSamplingNumber:9,regularSamplingRows:3,regularSamplingColumns:3};const qI=new du({data:{urlParams:Object.keys(GI),storageKey:"biigle.annotations.settings",defaults:GI}});var WI={};const KI=Tl({components:{screenshotButton:VI,powerToggle:Pl},props:{image:{type:Object,default:null}},data:function(){return{restoreKeys:["annotationOpacity","cachedImagesCount","mousePosition","zoomLevel","scaleLine","labelTooltip","measureTooltip","minimap","progressIndicator"],annotationOpacity:1,cachedImagesCount:1,mousePosition:!1,zoomLevel:!1,scaleLine:!1,labelTooltip:!1,measureTooltip:!1,minimap:!0,progressIndicator:!0}},computed:{plugins:function(){return WI},crossOrigin:function(){return this.image&&this.image.crossOrigin},settings:function(){return qI}},methods:{showMousePosition:function(){this.mousePosition=!0},hideMousePosition:function(){this.mousePosition=!1},showZoomLevel:function(){this.zoomLevel=!0},hideZoomLevel:function(){this.zoomLevel=!1},showScaleLine:function(){this.scaleLine=!0},hideScaleLine:function(){this.scaleLine=!1},showLabelTooltip:function(){this.labelTooltip=!0,this.measureTooltip=!1},hideLabelTooltip:function(){this.labelTooltip=!1},showMeasureTooltip:function(){this.measureTooltip=!0,this.labelTooltip=!1},hideMeasureTooltip:function(){this.measureTooltip=!1},showMinimap:function(){this.minimap=!0},hideMinimap:function(){this.minimap=!1},showProgressIndicator:function(){this.progressIndicator=!0},hideProgressIndicator:function(){this.progressIndicator=!1},toggleAnnotationOpacity:function(){this.annotationOpacity>0?this.annotationOpacity=0:this.annotationOpacity=1}},watch:{annotationOpacity:function(t){t=parseFloat(t),this.$emit("change","annotationOpacity",t),this.settings.set("annotationOpacity",t)},cachedImagesCount:function(t){t=parseFloat(t),this.$emit("change","cachedImagesCount",t),this.settings.set("cachedImagesCount",t)},mousePosition:function(t){this.$emit("change","mousePosition",t),this.settings.set("mousePosition",t)},zoomLevel:function(t){this.$emit("change","zoomLevel",t),this.settings.set("zoomLevel",t)},scaleLine:function(t){this.$emit("change","scaleLine",t),this.settings.set("scaleLine",t)},labelTooltip:function(t){this.$emit("change","labelTooltip",t),this.settings.set("labelTooltip",t)},measureTooltip:function(t){this.$emit("change","measureTooltip",t),this.settings.set("measureTooltip",t)},minimap:function(t){this.$emit("change","minimap",t),this.settings.set("minimap",t)},progressIndicator:function(t){this.$emit("change","progressIndicator",t),this.settings.set("progressIndicator",t)}},created:function(){var t=this;this.restoreKeys.forEach((function(e){t[e]=t.settings.get(e)})),Ll.on("o",this.toggleAnnotationOpacity)}},undefined,undefined,!1,null,null,null).exports;biigle.$declare("annotations.components.annotationCanvas",wI),biigle.$declare("annotations.components.annotationsTabPlugins",NI),biigle.$declare("annotations.components.labelsTabPlugins",UI),biigle.$declare("annotations.components.settingsTabPlugins",WI),biigle.$declare("annotations.ol.AttachLabelInteraction",Yv),biigle.$declare("annotations.stores.annotations",xI),biigle.$declare("annotations.stores.images",MI),biigle.$declare("annotations.stores.styles",vw);var XI=i(379),YI=i.n(XI),HI=i(442),ZI={insert:"head",singleton:!1};YI()(HI.Z,ZI);HI.Z.locals;const JI=Tl({components:{powerToggle:Pl},data:function(){return{mode:"default",modes:["default","volare","lawnmower","randomSampling","regularSampling"],restoreKeys:["randomSamplingNumber","regularSamplingRows","regularSamplingColumns"],randomSamplingNumber:9,regularSamplingRows:3,regularSamplingColumns:3}},computed:{isVolareActive:function(){return"volare"===this.mode},isLawnmowerActive:function(){return"lawnmower"===this.mode},isRandomSamplingActive:function(){return"randomSampling"===this.mode},isRegularSamplingActive:function(){return"regularSampling"===this.mode}},methods:{startVolare:function(){this.setMode("volare")},startLawnmower:function(){this.setMode("lawnmower")},startRandomSampling:function(){this.setMode("randomSampling")},startRegularSampling:function(){this.setMode("regularSampling")},setMode:function(t){-1!==this.modes.indexOf(t)&&(this.mode=t)},resetMode:function(){this.mode="default"},emitAttachLabel:function(){this.$emit("attach-label")},emitCreateSample:function(){this.$emit("create-sample")}},watch:{mode:function(t,e){switch(e){case"volare":Ll.off("Enter",this.emitAttachLabel);break;case"randomSampling":case"regularSampling":Ll.off("Enter",this.emitCreateSample)}switch(t){case"volare":Ll.on("Enter",this.emitAttachLabel);break;case"randomSampling":case"regularSampling":Ll.on("Enter",this.emitCreateSample)}switch(t){case"randomSampling":this.$emit("change",t,this.randomSamplingNumber);break;case"regularSampling":this.$emit("change",t,[this.regularSamplingRows,this.regularSamplingColumns]);break;default:this.$emit("change",t)}},randomSamplingNumber:function(t){qI.set("randomSamplingNumber",t)},regularSamplingRows:function(t){qI.set("regularSamplingRows",t)},regularSamplingColumns:function(t){qI.set("regularSamplingColumns",t)}},created:function(){var t=this;this.restoreKeys.forEach((function(e){return t[e]=qI.get(e)}));var e=iu.get("annotationMode");e&&Rl.$once("images.change",(function(){return t.setMode(e)}))}},undefined,undefined,!1,null,null,null).exports;const QI=Tl({data:function(){return{isBrightnessRgbActive:!1,colorAdjustmentDefaults:{brightnessContrast:[0,0],brightnessRGB:[0,0,0],hueSaturation:[0,0],vibrance:[0],gamma:[1]},colorAdjustment:{brightnessContrast:[0,0],brightnessRGB:[0,0,0],hueSaturation:[0,0],vibrance:[0],gamma:[1]}}},methods:{resetType:function(t,e){void 0!==e?this.colorAdjustment[t].splice(e,1,this.colorAdjustmentDefaults[t][e]):this.colorAdjustment[t]=this.colorAdjustmentDefaults[t].slice()},reset:function(){for(var t in this.colorAdjustment)this.colorAdjustment.hasOwnProperty(t)&&this.resetType(t)},toggleBrightnessRgb:function(){this.isBrightnessRgbActive?this.resetType("brightnessRGB"):this.resetType("brightnessContrast",0),this.isBrightnessRgbActive=!this.isBrightnessRgbActive}},watch:{colorAdjustment:{handler:function(){this.$emit("change",this.colorAdjustment)},deep:!0}}},undefined,undefined,!1,null,null,null).exports;const tA=Tl({mixins:[cu],components:{fileLabelList:Kd},props:{fileId:{required:!0,type:Number},selectedLabel:{type:Object,default:null},type:{type:String,default:"image"}},data:function(){return{cache:{},open:!1,currentLabels:[],saving:!1,userId:null,isAdmin:!1}},computed:{hasLabels:function(){return this.currentLabels.length>0},hasSelectedLabel:function(){return null!==this.selectedLabel},canAttachSelectedLabel:function(){if(this.hasSelectedLabel){for(var t=this.currentLabels.length-1;t>=0;t--)if(this.currentLabels[t].label.id===this.selectedLabel.id)return!1;return!this.saving}return!1},proposedLabelTitle:function(){return this.hasSelectedLabel?this.canAttachSelectedLabel?"Attach '".concat(this.selectedLabel.name,"' as new ").concat(this.type," label"):"The selected label is already attached.":"Please select a label first."}},methods:{startSaving:function(){this.saving=!0},finishSaving:function(){this.saving=!1},showFileLabels:function(t){this.cache.hasOwnProperty(t)||(this.startLoading(),this.currentLabels=[],"image"===this.type?this.cache[t]=Gd.query({image_id:t}):this.cache[t]=qd.query({video_id:t}),this.cache[t].finally(this.finishLoading)),this.cache[t].then(this.updateCurrentLabels,lu)},updateCurrentLabels:function(t){this.currentLabels=t.body},handleDeletedLabel:function(t){for(var e=this.currentLabels.length-1;e>=0;e--)if(this.currentLabels[e].id===t.id){this.currentLabels.splice(e,1);break}},attachSelectedLabel:function(){var t=this;this.startSaving(),("image"===this.type?Gd.save({image_id:this.fileId},{label_id:this.selectedLabel.id}):qd.save({video_id:this.fileId},{label_id:this.selectedLabel.id})).then((function(e){return t.currentLabels.push(e.data)}),lu).finally(this.finishSaving)},attachSelectedLabelIfPossible:function(){if(this.canAttachSelectedLabel)return this.attachSelectedLabel(),!1}},watch:{fileId:function(t){this.open&&this.showFileLabels(t)},open:function(t){t?(this.showFileLabels(this.fileId),Ll.on("Enter",this.attachSelectedLabelIfPossible)):Ll.off("Enter",this.attachSelectedLabelIfPossible)}},created:function(){var t=this;this.$parent.$watch("open",(function(e){return t.open=e}))}},undefined,undefined,!1,null,null,null).exports;const eA=Tl({mixins:[tA],created:function(){this.userId=biigle.$require("annotations.userId"),this.isAdmin=biigle.$require("annotations.isAdmin")}},undefined,undefined,!1,null,null,null).exports;const iA=Tl({components:{typeahead:Ql},data:function(){return{name:"",placeholder:"",selectedItem:null}},computed:{items:function(){return[]},selectedItemName:function(){return this.selectedItem?this.selectedItem.name:""}},methods:{select:function(t){this.selectedItem=t},filter:function(t){return t},reset:function(){this.selectedItem=null}},watch:{selectedItem:function(t){t?this.$emit("select",this):this.$emit("unselect")}},created:function(){this.$mount()}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("typeahead",{attrs:{items:t.items,placeholder:t.placeholder,value:t.selectedItemName},on:{select:t.select}})}),[],!1,null,null,null).exports;const nA=Tl(Vue.extend({mixins:[iA],components:{typeahead:tc},data:function(){return{name:"label",annotations:[],placeholder:"label name"}},computed:{items:function(){var t={};return this.annotations.forEach((function(e){e.labels.forEach((function(e){t[e.label.id]=e.label}))})),Object.values(t)}},methods:{filter:function(t){if(!this.selectedItem)return t;var e=this.selectedItem.id;return t.filter((function(t){return t.labels.reduce((function(t,i){return t||i.label.id===e}),!1)}))}}}),undefined,undefined,!1,null,null,null).exports;const rA=Tl(Vue.extend({mixins:[iA],data:function(){return{name:"session",sessions:[],placeholder:"session name"}},computed:{items:function(){return this.sessions.map((function(t){return t.starts_at=new Date(t.starts_at),t.ends_at=new Date(t.ends_at),t}))}},methods:{filter:function(t){if(!this.selectedItem)return t;var e=this.selectedItem,i={};return e.users.forEach((function(t){i[t.id]=null})),t.filter((function(t){for(var n=t.labels.length-1;n>=0;n--)if(i.hasOwnProperty(t.labels[n].user_id)){var r=new Date(t.created_at);return r>=e.starts_at&&r<e.ends_at}return!1}))}}}),undefined,undefined,!1,null,null,null).exports;const oA=Tl(Vue.extend({mixins:[iA],data:function(){return{name:"shape",shapes:[],placeholder:"shape name"}},computed:{items:function(){var t=this;return Object.keys(this.shapes).map((function(e){return{id:parseInt(e),name:t.shapes[e]}}))}},methods:{filter:function(t){var e=this;return this.selectedItem?t.filter((function(t){return t.shape_id===e.selectedItem.id})):t}}}),undefined,undefined,!1,null,null,null).exports;const sA=Tl(Vue.extend({mixins:[iA],data:function(){return{name:"user",annotations:[],placeholder:"user name"}},computed:{items:function(){var t={};return this.annotations.forEach((function(e){e.labels.forEach((function(e){t[e.user_id]=e.user}))})),Object.values(t).map((function(t){return t.name=t.firstname+" "+t.lastname,t}))}},methods:{filter:function(t){if(!this.selectedItem)return t;var e=this.selectedItem.id;return t.filter((function(t){return t.labels.reduce((function(t,i){return t||i.user_id===e}),!1)}))}}}),undefined,undefined,!1,null,null,null).exports,aA=Vue.resource("api/v1/volumes{/id}/images/area");function lA(t){return(lA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}const uA=Tl({mixins:[cu],components:{sidebar:Fl,sidebarTab:Ml,annotationsTab:BI,labelsTab:zI,annotationModesTab:JI,colorAdjustmentTab:QI,imageLabelTab:eA,settingsTab:KI,annotationCanvas:wI},data:function(){return{allImagesIds:[],volumeId:null,isEditor:!1,imageIndex:null,image:null,annotations:[],annotationFilter:null,annotationFilters:[],lastCreatedAnnotation:null,lastCreatedAnnotationTimeout:null,annotationOpacity:1,cachedImagesCount:1,mapCenter:void 0,mapResolution:void 0,selectedLabel:null,annotationMode:"default",focussedAnnotationIndex:null,annotationModeCarry:null,showMousePosition:!1,showZoomLevel:!1,showLabelTooltip:!1,showMeasureTooltip:!1,showMinimap:!0,showScaleLine:!1,imagesArea:null,openTab:null,userUpdatedVolareResolution:!1,userId:null,crossOriginError:!1}},computed:{imageId:function(){return this.imagesIds[this.imageIndex]},hasAnnotationFilter:function(){return null!==this.annotationFilter},filteredAnnotations:function(){var t=this.annotations.filter((function(t){return!t.markedForDeletion}));return this.annotationFilter?this.annotationFilter.filter(t):t},selectedAnnotations:function(){return this.filteredAnnotations.filter((function(t){return t.selected}))},supportsColorAdjustment:function(){return MI.supportsColorAdjustment},focussedAnnotation:function(){return this.filteredAnnotations[this.focussedAnnotationIndex]},isDefaultAnnotationMode:function(){return"default"===this.annotationMode},isVolareAnnotationMode:function(){return"volare"===this.annotationMode},isLawnmowerAnnotationMode:function(){return"lawnmower"===this.annotationMode},isSamplingAnnotationMode:function(){return this.annotationMode.endsWith("Sampling")},imagesIds:function(){var t=this.allImagesIds.slice(),e=window.localStorage.getItem("biigle.volumes.".concat(this.volumeId,".files"));if(e){var i={};return t.forEach((function(t){i[t]=null})),JSON.parse(e).filter((function(t){return i.hasOwnProperty(t)}))}return t},hasCrossOriginError:function(){return!this.loading&&this.crossOriginError},annotationsHiddenByFilter:function(){return this.annotations.length!==this.filteredAnnotations.length}},methods:{getImageAndAnnotationsPromises:function(t){return[MI.fetchAndDrawImage(t),xI.fetchAnnotations(t)]},setCurrentImageAndAnnotations:function(t){t?(this.image=t[0],this.annotations=t[1]):(this.image=null,this.annotations=[])},updateUrlSlug:function(){iu.setSlug(this.imageId,-2)},getNextIndex:function(t){return(t+1)%this.imagesIds.length},getPreviousIndex:function(t){return(t+this.imagesIds.length-1)%this.imagesIds.length},handleNext:function(){if(!this.loading){if(this.isVolareAnnotationMode){if(this.focussedAnnotationIndex<this.filteredAnnotations.length-1)return void this.focussedAnnotationIndex++;this.focussedAnnotationIndex===1/0?this.focussedAnnotationIndex=Math.min(1,this.filteredAnnotations.length-1):this.focussedAnnotationIndex=-1/0}else if(this.isLawnmowerAnnotationMode){if(this.$refs.canvas.showNextImageSection())return;this.annotationModeCarry=0}else if(this.isSamplingAnnotationMode){if(this.$refs.canvas.showNextSamplingLocation())return;this.annotationModeCarry=0}this.imageIndex=this.getNextIndex(this.imageIndex)}},handlePrevious:function(){if(!this.loading){if(this.isVolareAnnotationMode){if(this.focussedAnnotationIndex>0)return void this.focussedAnnotationIndex--;this.focussedAnnotationIndex===-1/0?this.focussedAnnotationIndex=Math.max(this.filteredAnnotations.length-2,0):this.focussedAnnotationIndex=1/0}else if(this.isLawnmowerAnnotationMode){if(this.$refs.canvas.showPreviousImageSection())return;this.annotationModeCarry=1/0}else if(this.isSamplingAnnotationMode){if(this.$refs.canvas.showPreviousSamplingLocation())return;this.annotationModeCarry=1/0}this.imageIndex=this.getPreviousIndex(this.imageIndex)}},maybeUpdateFocussedAnnotation:function(){this.isVolareAnnotationMode?this.filteredAnnotations.length>0?this.focussedAnnotationIndex===1/0?this.focussedAnnotationIndex=this.filteredAnnotations.length-1:this.focussedAnnotationIndex=0:(this.focussedAnnotationIndex=null,this.$refs.canvas.fitImage()):this.focussedAnnotationIndex=null},maybeUpdateShownImageSection:function(){this.isLawnmowerAnnotationMode&&(this.annotationModeCarry===1/0?this.$refs.canvas.showLastImageSection():this.$refs.canvas.showFirstImageSection())},maybeUpdateShownSampling:function(t){this.isSamplingAnnotationMode&&(this.$refs.canvas.setSamplingData(this.annotationMode,t),this.annotationModeCarry===1/0?this.$nextTick(this.$refs.canvas.showLastSamplingLocation):this.$nextTick(this.$refs.canvas.showFirstSamplingLocation))},maybeUpdateAnnotationMode:function(t){this.maybeUpdateFocussedAnnotation(),this.maybeUpdateShownImageSection(),this.maybeUpdateShownSampling(t)},handleMapMoveend:function(t){this.mapCenter=t.center,this.mapResolution=t.resolution,iu.set({r:Math.round(100*t.resolution),x:Math.round(t.center[0]),y:Math.round(t.center[1])})},handleSelectAnnotation:function(t,e){!0===e||"object"===lA(e)&&e.shiftKey?t.selected=!0:this.annotations.forEach((function(e){e.selected=t.id===e.id}))},handleSelectAnnotations:function(t,e){t.forEach((function(t){t.selected=!0})),e.forEach((function(t){t.selected=!1}))},handleDeselectAnnotation:function(t){t?t.selected=!1:this.annotations.forEach((function(t){t.selected=!1}))},focusAnnotation:function(t,e,i){this.$refs.canvas.focusAnnotation(t,e,i)},handleDetachAnnotationLabel:function(t,e){this.isEditor&&(t.labels.length>1?xI.detachLabel(t,e).catch(lu):confirm("Detaching the last label of an annotation deletes the whole annotation. Do you want to delete the annotation?")&&this.handleDeleteAnnotation(t))},handleDeleteAnnotation:function(t){this.isEditor&&(this.lastCreatedAnnotation&&this.lastCreatedAnnotation.id===t.id&&(this.lastCreatedAnnotation=null),Vue.set(t,"markedForDeletion",!0),xI.delete(t).catch((function(e){t.markedForDeletion=!1,lu(e)})))},handleDeleteAnnotations:function(t){t.forEach(this.handleDeleteAnnotation)},handleUpdateAnnotations:function(t){this.isEditor&&Vue.Promise.all(t.map(xI.update)).catch(lu)},selectAndFocusAnnotation:function(t,e){this.selectedAnnotations.forEach((function(t){t.selected=!1})),t.selected=!0,this.focusAnnotation(t,!0,e)},handleFilter:function(t){this.annotationFilter=t},resetFilter:function(){this.annotationFilter&&this.annotationFilter.reset(),this.annotationFilter=null},handleSelectedLabel:function(t){this.selectedLabel=t},handleNewAnnotation:function(t,e){this.isEditor&&(t.label_id=this.selectedLabel.id,t.confidence=1,xI.create(this.imageId,t).then(this.setLastCreatedAnnotation).catch(lu).finally(e))},handleAttachLabel:function(t,e){if(e=e||this.selectedLabel,this.isEditor&&e){var i={label_id:e.id,confidence:1},n=xI.attachLabel(t,i);return n.catch(lu),n}return Vue.Promise.reject()},handleSwapLabel:function(t,e){var i=this;if(e=e||this.selectedLabel,this.isEditor&&e){var n=t.labels.filter((function(t){return t.user_id===i.userId})).sort((function(t,e){return t.id-e.id})).pop();this.handleAttachLabel(t,e).then((function(){n&&i.handleDetachAnnotationLabel(t,n)})).catch(lu)}},handleAttachAllSelected:function(){this.selectedAnnotations.forEach(this.handleAttachLabel)},emitImageChanged:function(){Rl.$emit("images.change",this.imageId,this.image)},cachePreviousAndNext:function(){for(var t=[],e=[this.imageId],i=Math.min(this.cachedImagesCount,this.imagesIds.length),n=1;n<=i;n++){var r=this.imagesIds[this.getNextIndex(this.imageIndex+n)];e.includes(r)||(t.push(xI.fetchAnnotations(r)),t.push(MI.fetchImage(r)),e.push(r));var o=this.imagesIds[this.getPreviousIndex(this.imageIndex-n)];e.includes(o)||(t.push(xI.fetchAnnotations(o)),t.push(MI.fetchImage(o)),e.push(o))}Vue.Promise.all(t).catch((function(){}))},setLastCreatedAnnotation:function(t){var e=this;this.lastCreatedAnnotationTimeout&&window.clearTimeout(this.lastCreatedAnnotationTimeout),this.lastCreatedAnnotation=t,this.lastCreatedAnnotationTimeout=window.setTimeout((function(){e.lastCreatedAnnotation=null}),1e4)},updateColorAdjustment:function(t){var e=this.$refs.canvas;eu((function(){MI.updateColorAdjustment(t),e.render()}),100,"annotations.color-adjustment.update")},handleSettingsChange:function(t,e){switch(t){case"annotationOpacity":this.annotationOpacity=e;break;case"cachedImagesCount":this.cachedImagesCount=e;break;case"mousePosition":this.showMousePosition=e;break;case"zoomLevel":this.showZoomLevel=e;break;case"scaleLine":this.showScaleLine=e;break;case"labelTooltip":this.showLabelTooltip=e;break;case"measureTooltip":this.showMeasureTooltip=e;break;case"minimap":this.showMinimap=e}},handleAnnotationModeChange:function(t,e){this.annotationMode=t,this.annotationModeCarry=null,this.maybeUpdateAnnotationMode(e)},handleOpenedTab:function(t){qI.set("openTab",t)},handleClosedTab:function(){qI.delete("openTab")},handleLoadingError:function(t){t instanceof FI?this.crossOriginError=!0:uu.danger(t)},createSampledAnnotation:function(){this.$refs.canvas.createSampledAnnotation()},fetchImagesArea:function(){this.imagesArea||(this.imagesArea={},aA.get({id:this.volumeId}).then(this.setImagesArea,lu))},setImagesArea:function(t){this.imagesArea=t.body},handleRequiresSelectedLabel:function(){uu.info("Please select a label first."),this.$refs.sidebar.$emit("open","labels")},maybeShowTilingInProgressMessage:function(){this.image.tilingInProgress&&uu.warning("This image is currently being processed. Please retry later.")},dismissCrossOriginError:function(){this.crossOriginError=!1}},watch:{imageId:function(t){t&&(this.startLoading(),this.crossOriginError=!1,Vue.Promise.all(this.getImageAndAnnotationsPromises(t)).then(this.setCurrentImageAndAnnotations).then(this.updateUrlSlug).then(this.maybeUpdateAnnotationMode).then(this.emitImageChanged).then(this.maybeShowTilingInProgressMessage).then(this.cachePreviousAndNext).catch(this.handleLoadingError).finally(this.finishLoading))},cachedImagesCount:function(){eu(this.cachePreviousAndNext,1e3,"annotations.cached-image-count.update")},focussedAnnotation:function(t){t&&this.selectAndFocusAnnotation(t,this.userUpdatedVolareResolution)},annotationFilter:function(){this.maybeUpdateFocussedAnnotation()},showScaleLine:function(t){t&&this.fetchImagesArea()},showMeasureTooltip:function(t){t&&this.fetchImagesArea()},isVolareAnnotationMode:function(t){t||(this.userUpdatedVolareResolution=!1)},mapResolution:function(){this.isVolareAnnotationMode&&(this.userUpdatedVolareResolution=!0)},annotations:function(t){this.annotationFilters[0].annotations=t,this.annotationFilters[1].annotations=t},image:function(t){this.crossOriginError=t.crossOrigin}},created:function(){var t=this;if(this.allImagesIds=biigle.$require("annotations.imagesIds"),this.volumeId=biigle.$require("annotations.volumeId"),this.isEditor=biigle.$require("annotations.isEditor"),this.userId=biigle.$require("annotations.userId"),this.annotationFilters=[new nA,new sA,new oA({data:{shapes:biigle.$require("annotations.shapes")}}),new rA({data:{sessions:biigle.$require("annotations.sessions")}})],0!==this.imagesIds.length){var e=this.imagesIds.indexOf(biigle.$require("annotations.imageId"));if(-1===e&&(e=0,uu.info("The requested image does not exist in your current volume filtering. Switching to the first image.")),this.imageIndex=e,void 0!==iu.get("r")&&(this.mapResolution=parseInt(iu.get("r"),10)/100),void 0!==iu.get("x")&&void 0!==iu.get("y")&&(this.mapCenter=[parseInt(iu.get("x"),10),parseInt(iu.get("y"),10)]),Rl.$on("annotations.select",this.handleSelectAnnotation),Rl.$on("annotations.deselect",this.handleDeselectAnnotation),Rl.$on("annotations.detachLabel",this.handleDetachAnnotationLabel),Rl.$on("annotations.delete",this.handleDeleteAnnotation),Rl.$on("annotations.focus",this.focusAnnotation),iu.get("annotation")){var i=parseInt(iu.get("annotation"));Rl.$once("images.change",(function(){for(var e=t.annotations,n=e.length-1;n>=0;n--)if(e[n].id===i)return void t.selectAndFocusAnnotation(e[n])}))}if(qI.has("openTab")){var n=qI.get("openTab");"color-adjustment"===n?Rl.$once("images.change",(function(){t.supportsColorAdjustment&&(t.openTab=n)})):this.openTab=n}}else uu.info("Your current volume filtering contains no images.")},mounted:function(){Rl.$emit("annotations.map.init",this.$refs.canvas.map)}},undefined,undefined,!1,null,null,null).exports;var hA=function(t){return[Math.cos(2*Math.PI*t)+1,Math.sin(2*Math.PI*t)+1]};const cA=Tl({props:{fileIds:{type:Array,default:function(){return[]}},filenames:{type:Object,default:function(){return{}}},showIndicator:{type:Boolean,default:!0},currentFileId:{type:Number,required:!0},type:{type:String,required:!0}},data:function(){return{fileIdsLeft:[]}},computed:{progressPath:function(){return"M 2 1 A 1 1 0 "+(this.progress>=.5?1:0)+" 1 "+hA(this.progress).join(" ")+"L 1 1"},initialProgressPath:function(){return"M 1 1 L "+hA(this.initialProgress).join(" ")},progressTitle:function(){var t=["started at ".concat(this.initialFileNumber)];return this.hasSeenAllFiles&&t.push("seen all"),"".concat(su(this.type)," ").concat(this.currentFileNumber," of ").concat(this.fileIds.length," (").concat(t.join(", "),")")},currentFileNumber:function(){return this.currentFileId?this.fileIds.indexOf(this.currentFileId)+1:0},progress:function(){return this.currentFileNumber/this.fileIds.length},initialProgress:function(){return this.initialFileNumber/this.fileIds.length},hasSeenAllFiles:function(){return 0===this.fileIdsLeft.length},showInitialProgressMarker:function(){return 1!==this.initialFileNumber},indicatorClass:function(){return this.hasSeenAllFiles?"progress-indicator--all":""},filenameClass:function(){return this.hasSeenAllFiles?"text-success":""},filenameTitle:function(){return this.hasSeenAllFiles?"You have seen all ".concat(this.type,"s"):""},currentFilename:function(){return this.filenames[this.currentFileId]}},watch:{currentFileId:function(t){this.fileIdsLeft=this.fileIdsLeft.filter((function(e){return e!==t}))}},created:function(){var t=this;this.initialFileNumber=this.fileIds.indexOf(this.currentFileId)+1,this.fileIdsLeft=this.fileIds.filter((function(e){return e!==t.currentFileId}))}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",[t.showIndicator?i("span",{staticClass:"progress-indicator-container",attrs:{title:t.progressTitle}},[i("svg",{staticClass:"progress-indicator",class:t.indicatorClass,attrs:{viewBox:"-0.2 -0.2 2.4 2.4"}},[i("circle",{staticClass:"progress-indicator__background",attrs:{cx:"1",cy:"1",r:"1"}}),t._v(" "),i("g",{staticClass:"progress-indicator__progress"},[1==t.progress?i("circle",{attrs:{cx:"1",cy:"1",r:"1"}}):i("path",{attrs:{d:t.progressPath}})]),t._v(" "),t.showInitialProgressMarker?i("path",{staticClass:"progress-indicator__marker",attrs:{d:t.initialProgressPath}}):t._e()])]):t._e(),t._v(" "),i("strong",{class:t.filenameClass,attrs:{title:t.filenameTitle},domProps:{textContent:t._s(t.currentFilename)}})])}),[],!1,null,null,null).exports;const dA=Tl({components:{breadcrumb:cA},data:function(){return{volumeId:null,allIds:[],filenames:{},showIndicator:!0,currentId:null}},computed:{currentFilename:function(){return this.filenames[this.currentId]},ids:function(){var t=this.allIds.slice(),e=window.localStorage.getItem("biigle.volumes.".concat(this.volumeId,".files"));if(e){var i={};return t.forEach((function(t){i[t]=null})),JSON.parse(e).filter((function(t){return i.hasOwnProperty(t)}))}return t}},methods:{updateShowIndicator:function(t){this.showIndicator=!1!==t},updateCurrentId:function(t){this.currentId=t}},watch:{currentFilename:function(t){document.title="Annotate ".concat(t," - BIIGLE")}},created:function(){var t=this;this.allIds=biigle.$require("annotations.imagesIds"),this.volumeId=biigle.$require("annotations.volumeId");var e={};biigle.$require("annotations.imagesFilenames").forEach((function(i,n){e[t.allIds[n]]=i})),this.filenames=e,this.currentId=biigle.$require("annotations.imageId"),Rl.$on("images.change",this.updateCurrentId),this.updateShowIndicator(qI.get("progressIndicator")),qI.watch("progressIndicator",this.updateShowIndicator)}},undefined,undefined,!1,null,null,null).exports;biigle.$mount("annotator-container",uA),biigle.$mount("annotations-navbar",dA);i(276);var fA={annotationOpacity:1,showMinimap:!0,autoplayDraw:0,showLabelTooltip:!1,showMousePosition:!1,showProgressIndicator:!0};const pA=new du({data:{urlParams:Object.keys(fA),storageKey:"biigle.videos.settings",defaults:fA}});const gA=Tl({components:{breadcrumb:cA},data:function(){return{ids:[],volumeId:null,filenames:{},showIndicator:!0,currentId:null}},computed:{currentFilename:function(){return this.filenames[this.currentId]}},methods:{updateShowIndicator:function(t){this.showIndicator=!1!==t},updateCurrentId:function(t){this.currentId=t},initVideoIds:function(t){var e=window.localStorage.getItem("biigle.volumes.".concat(this.volumeId,".files"));if(e){var i={};return t.forEach((function(t){i[t]=null})),JSON.parse(e).filter((function(t){return i.hasOwnProperty(t)}))}return t}},watch:{currentFilename:function(t){document.title="Annotate ".concat(t," - BIIGLE")}},created:function(){this.volumeId=biigle.$require("videos.volumeId");var t=biigle.$require("videos.videoIds");this.ids=this.initVideoIds(t);var e={};biigle.$require("videos.videoFilenames").forEach((function(i,n){e[t[n]]=i})),this.filenames=e,this.currentId=biigle.$require("videos.id"),this.updateShowIndicator(pA.get("showProgressIndicator")),pA.watch("showProgressIndicator",this.updateShowIndicator),Rl.$on("video.id",this.updateCurrentId)}},undefined,undefined,!1,null,null,null).exports;const mA=Tl({components:{previewThumbnail:Ec}},undefined,undefined,!1,null,null,null).exports,vA=Vue.resource("api/v1/video-annotations{/id}",{},{query:{method:"GET",url:"api/v1/videos{/id}/annotations"},save:{method:"POST",url:"api/v1/videos{/id}/annotations"},split:{method:"POST",url:"api/v1/video-annotations{/id}/split"},link:{method:"POST",url:"api/v1/video-annotations{/id}/link"},attachLabel:{method:"POST",url:"api/v1/video-annotations{/id}/labels"},detachLabel:{method:"DELETE",url:"api/v1/video-annotation-labels{/id}"}});var yA=function(t){var e=t.toString().split(".")[1],i=e?e.length:0;return function(t){return Math.round(t*Math.pow(10,i))/Math.pow(10,i)}};const _A=void 0,bA=" ",wA="fill";function xA(t){return"string"==typeof t}const SA=Math,CA=SA.abs,TA=SA.min,EA=SA.max,IA=SA.floor,AA=SA.round,PA=SA.sqrt,kA=SA.pow,RA=SA.cos,LA=SA.asin,FA=SA.sin,MA=SA.tan,OA=SA.PI,$A=2/3,DA=kA(2,-52);function jA(){throw new Error(Array.prototype.join.call(arguments,bA))}function NA(t,e){for(let i in e)t.hasOwnProperty(i)||(t[i]=e[i]);return t}var BA="undefined"!=typeof window&&window.navigator.userAgent;const UA=/(MSIE |Trident\/|Edge\/)/i.test(BA)?Array:Float32Array;function zA(t){return new UA(t)}function VA(t,e,i){const n=t.length,r=e.length;if(n<r)return VA(e,t,i);e.length=n;for(let o=r;o<n;o++){const n=t[o],r=zA(n.d.length);for(let t=0;t<n.d.length;t+=2)r[t]=i.absolute?i.x:n.x+n.w*i.x,r[t+1]=i.absolute?i.y:n.y+n.y*i.y;e[o]=NA({d:r},n)}}function GA(t,e,i,n){return PA((t-i)*(t-i)+(e-n)*(e-n))}function qA(t,e,i){let n=i.length;if(i[n-2]!==i[0]||i[n-1]!==i[1])return;const r=i.slice(2);let o,s;n=r.length;for(let i=0;i<n;i+=6){const n=GA(t,e,r[i],r[i+1]);(s===_A||n<s)&&(s=n,o=i)}!function(t,e){const i=t.length,n=i-e,r=zA(e);let o;for(o=0;o<e;o++)r[o]=t[o];for(o=e;o<i;o++)t[o-e]=t[o];for(o=0;o<e;o++)t[n+o]=r[o]}(r,o),i[0]=r[n-2],i[1]=r[n-1];for(let t=0;t<r.length;t++)i[t+2]=r[t]}function WA(t,e){let i=e-t.length;const n=Math.ceil(i/t.length),r=zA(e);r[0]=t[0],r[1]=t[1];let o=1,s=1;for(;s<e-1;){r[++s]=t[++o],r[++s]=t[++o],r[++s]=t[++o],r[++s]=t[++o];const e=r[++s]=t[++o],a=r[++s]=t[++o];if(i)for(let t=0;t<n&&i;t++)r[s+5]=r[s+3]=r[s+1]=e,r[s+6]=r[s+4]=r[s+2]=a,s+=6,i-=6}return r}function KA(t,e){return e.p-t.p}function XA(t,e,i){const n=YA(t),r=YA(e),o=i.origin,s=o.x,a=o.y,l=o.absolute;n.length!==r.length&&(i.optimize===wA?VA(n,r,i.origin):jA("optimize:none requires equal lengths"));const u=Array(2);if(u[0]=n.map(HA),u[1]=r.map(HA),"none"!==i.optimize)for(let t=0;t<n.length;t++){const e=n[t],i=r[t];qA(l?s:e.x+e.w*s,l?a:e.y+e.h*a,u[0][t]),qA(l?s:i.x+i.w*s,l?a:i.y+i.h*a,u[1][t])}return i.optimize===wA&&function(t,e){const i=t[0].length;for(let n=0;n<i;n++){const i=t[0][n],r=t[1][n],o=EA(i.length+e,r.length+e);t[0][n]=WA(i,o),t[1][n]=WA(r,o)}}(u,6*i.addPoints),u}function YA(t){return t.data.slice().sort(KA)}function HA(t){return t.d}const ZA={addPoints:0,optimize:wA,origin:{x:0,y:0},precision:0};function JA(t,e){e=NA(e,ZA),(!t||t.length<2)&&jA("invalid arguments");const i=t.length-1,n=Array(i);for(let r=0;r<i;r++)n[r]=QA(t[r],t[r+1],e);const r=e.precision?t=>t.toFixed(e.precision):AA;return t=>{const e=i*t,o=TA(IA(e),i-1);return function(t,e){if(xA(t))return t;let i=[];for(let n=0;n<t.length;n++){const r=t[n];let o;i.push("M",e(r[0]),e(r[1]),"C");for(let t=2;t<r.length;t+=6){const n=e(r[t]),s=e(r[t+1]),a=e(r[t+2]),l=e(r[t+3]),u=e(r[t+4]),h=e(r[t+5]);n==u&&a==u&&s==h&&l==h&&o==(o=""+n+s+a+l+u+h)||i.push(n,s,a,l,u,h)}}return i.join(bA)}(n[o]((e-o)/(o+1)),r)}}function QA(t,e,i){const n=XA(t,e,i),r=n[0].length;return i=>{if(CA(i-0)<DA)return t.path;if(CA(i-1)<DA)return e.path;const o=Array(r);for(let t=0;t<r;t++)o[t]=tP(n[0][t],n[1][t],i);return o}}function tP(t,e,i){const n=t.length,r=zA(n);for(let o=0;o<n;o++)r[o]=t[o]+(e[o]-t[o])*i;return r}function eP(t,e){return t===_A?e:t}const iP=120*OA/180,nP=2*OA;function rP(t,e,i,n,r,o,s,a,l,u,h,c,d){if(i<=0||n<=0)return[t,e,a,l,a,l];const f=OA/180*(+r||0),p=RA(f),g=FA(f),m=!!u;if(!m){const r=t,f=a,m=((t=r*p-e*-g)-(a=f*p-l*-g))/2,v=((e=r*-g+e*p)-(l=f*-g+l*p))/2;let y=m*m/(i*i)+v*v/(n*n);y>1&&(y=PA(y),i*=y,n*=y);const _=(o===s?-1:1)*PA(CA((i*i*n*n-i*i*v*v-n*n*m*m)/(i*i*v*v+n*n*m*m)));c=_*i*v/n+(t+a)/2,u=LA((e-(d=_*-n*m/i+(e+l)/2))/n),h=LA((l-d)/n),t<c&&(u=OA-u),a<c&&(h=OA-h),u<0&&(u+=nP),h<0&&(h+=nP),s&&u>h&&(u-=nP),!s&&h>u&&(h-=nP)}let v;if(CA(h-u)>iP){const t=h,e=a,o=l;v=rP(a=c+i*RA(h=u+iP*(s&&h>u?1:-1)),l=d+n*FA(h),i,n,r,0,s,e,o,h,t,c,d)}else v=[];const y=4/3*MA((h-u)/4);if(v.splice(0,0,2*t-(t+y*i*FA(u)),2*e-(e-y*n*RA(u)),a+y*i*FA(h),l-y*n*RA(h),a,l),!m)for(let t=0,e=v.length;t<e;t+=2){const e=v[t],i=v[t+1];v[t]=e*p-i*g,v[t+1]=e*g+i*p}return v}const oP={M:2,H:1,V:1,L:2,Z:0,C:6,S:4,Q:4,T:2,A:7};function sP(t,e,i,n,r,o,s){const a=t.x,l=t.y;t.x=eP(o,a),t.y=eP(s,l),t.p.push(eP(e,a),i=eP(i,l),n=eP(n,a),r=eP(r,l),t.x,t.y),t.lc=t.c}function aP(t){const e=t.c,i=t.t,n=t.x,r=t.y;if("V"===e)i[0]+=r;else if("H"===e)i[0]+=n;else if("A"===e)i[5]+=n,i[6]+=r;else for(let t=0;t<i.length;t+=2)i[t]+=n,i[t+1]+=r}function lP(t){return t.split(bA).map(uP)}function uP(t,e){return 0===e?t:+t}function hP(t){const e={x:0,y:0,s:[]},i=function(t){return t.replace(/[\^\s]*([mhvlzcsqta]|\-?\d*\.?\d+)[,\$\s]*/gi," $1").replace(/([mhvlzcsqta])/gi," $1").trim().split("  ").map(lP)}(t);for(let t=0;t<i.length;t++){const n=i[t],r=n[0],o=r.toUpperCase(),s="Z"!==o&&o!==r;e.c=o;const a=oP[o],l=n;let u=1;do{e.t=1===l.length?l:l.slice(u,u+a),s&&aP(e);const t=e.t,i=e.x,n=e.y;let r,h,c,d,f,p;if("M"===o)e.s.push(e.p=[e.x=t[0],e.y=t[1]]);else if("H"===o)sP(e,_A,_A,_A,_A,t[0],_A);else if("V"===o)sP(e,_A,_A,_A,_A,_A,t[0]);else if("L"===o)sP(e,_A,_A,_A,_A,t[0],t[1]);else if("Z"===o)sP(e,_A,_A,_A,_A,e.p[0],e.p[1]);else if("C"===o)sP(e,t[0],t[1],t[2],t[3],t[4],t[5]),e.cx=t[2],e.cy=t[3];else if("S"===o){const o="S"!==e.lc&&"C"!==e.lc;r=o?_A:2*i-e.cx,h=o?_A:2*n-e.cy,sP(e,r,h,t[0],t[1],t[2],t[3]),e.cx=t[0],e.cy=t[1]}else if("Q"===o){const r=t[0],o=t[1];c=t[2],d=t[3],sP(e,i+(r-i)*$A,n+(o-n)*$A,c+(r-c)*$A,d+(o-d)*$A,c,d),e.cx=r,e.cy=o}else if("T"===o)c=t[0],d=t[1],"Q"===e.lc||"T"===e.lc?(r=i+(2*i-e.cx-i)*$A,h=n+(2*n-e.cy-n)*$A,f=c+(2*i-e.cx-c)*$A,p=d+(2*n-e.cy-d)*$A):(r=f=i,h=p=n),sP(e,r,h,f,p,c,d),e.cx=f,e.cy=p;else if("A"===o){const r=rP(i,n,t[0],t[1],t[2],t[3],t[4],t[5],t[6]);for(let t=0;t<r.length;t+=6)sP(e,r[t],r[t+1],r[t+2],r[t+3],r[t+4],r[t+5])}else jA(e.c," is not supported");u+=a}while(u<l.length)}return e.s}function cP(t){const e=t.length;let i=t[e-2],n=t[e-1],r=0;for(let o=0;o<e;o+=6)r+=GA(t[o],t[o+1],i,n),i=t[o],n=t[o+1];return IA(r)}function dP(t){let e=t[0],i=t[1],n=i,r=e;for(let o=2;o<t.length;o+=6){let s=t[o+4],a=t[o+5];e=TA(e,s),r=EA(r,s),i=TA(i,a),n=EA(n,a)}return{d:t,x:e,y:i,w:r-e,h:n-i,p:cP(t)}}const fP=/^([#|\.]|path)/i;function pP(t){return function(t){return{path:t,data:hP(t).map(dP)}}(function(t){if(xA(t)){if(!fP.test(t))return t;t=document.querySelector(t)}return t.getAttribute("d")}(t))}const gP=Tl(Vue.extend({data:function(){return{id:0,frames:[],points:[],video_id:0,shape_id:0,created_at:"",updated_at:"",labels:[],selected:!1,revision:1,tracking:!1,pending:!1}},computed:{startFrame:function(){return this.frames[0]},endFrame:function(){return this.frames[this.frames.length-1]},interpolationPoints:function(){switch(this.shape){case"Rectangle":case"Ellipse":return this.points.map(this.rectangleToInterpolationPoints);case"LineString":case"Polygon":return this.points.map(this.polygonToSvgPath);default:return this.points}},gapRanges:function(){var t=[];return this.frames.map((function(e,i,n){null===e&&t.push([n[i-1],n[i+1]])})),t},isSelected:function(){return!1!==this.selected},isClip:function(){return this.frames.length>1},wholeFrame:function(){return"WholeFrame"===this.shape}},methods:{startPollTracking:function(){this.tracking=!0,this.continuePollTracking()},pollTracking:function(){vA.get({id:this.id}).then(this.maybeFinishPollTracking,this.cancelPollTracking)},maybeFinishPollTracking:function(t){var e=t.body;e.frames.length>1?(this.tracking=!1,this.frames=e.frames,this.points=e.points):this.continuePollTracking()},continuePollTracking:function(){this.pollTimeout=window.setTimeout(this.pollTracking,5e3)},cancelPollTracking:function(){uu.danger("Tracking of annotation ".concat(this.id," failed.")),this.tracking=!1,this.$emit("tracking-failed",this)},interpolatePoints:function(t){var e=yA(t);if(t<e(this.startFrame)||t>e(this.endFrame))return[];if(this.hasGapAt(t))return[];var i=this.frames,n=i.length-1;if(0===n)return this.points[0];for(;n>=0&&!(e(i[n])<=t&&null!==i[n]);n--);if(e(i[n])===t)return this.points[n];var r=(t-i[n])/(i[n+1]-i[n]);return this.interpolateBetweenFrames(n,n+1,r)},interpolateBetweenFrames:function(t,e,i){var n=this.interpolationPoints[t],r=this.interpolationPoints[e];switch(this.shape){case"Rectangle":case"Ellipse":return this.interpolationPointsToRectangle(this.interpolateNaive(n,r,i));case"LineString":case"Polygon":return this.interpolatePolymorph(n,r,i);default:return this.interpolateNaive(n,r,i)}},interpolateNaive:function(t,e,i){return t.map((function(t,n){return t+(e[n]-t)*i}))},interpolatePolymorph:function(t,e,i){return function(t,e){return JA(t.map(pP),e||{})}([t,e])(i).replace(/[MCL\s]+/g," ").trim().split(" ").map((function(t){return parseInt(t,10)}))},rectangleToInterpolationPoints:function(t){var e=[t[2]-t[0],t[3]-t[1]],i=[t[6]-t[0],t[7]-t[1]],n=Math.sqrt(i[0]*i[0]+i[1]*i[1]),r=Math.sqrt(e[0]*e[0]+e[1]*e[1]),o=[e[0]/r,e[1]/r],s=[(t[0]+t[2]+t[4]+t[6])/4,(t[1]+t[3]+t[5]+t[7])/4];return[s[0],s[1],o[0],o[1],n,r]},interpolationPointsToRectangle:function(t){var e=[t[2],t[3]],i=[-e[1],e[0]],n=t[4]/2*i[0],r=t[4]/2*i[1],o=t[5]/2*e[0],s=t[5]/2*e[1];return[t[0]-o-n,t[1]-s-r,t[0]+o-n,t[1]+s-r,t[0]+o+n,t[1]+s+r,t[0]-o+n,t[1]-s+r]},polygonToSvgPath:function(t){return(t=t.slice()).unshift("M"),t.splice(3,0,"L"),t.join(" ")},hasGapAt:function(t){var e=yA(t);if(t<e(this.startFrame)||t>e(this.endFrame))return!1;for(var i=this.gapRanges.length-1;i>=0;i--)if(e(this.gapRanges[i][0])<t&&e(this.gapRanges[i][1])>t)return!0;return!1},detachAnnotationLabel:function(t){var e=this.labels.indexOf(t);return-1!==e&&this.labels.splice(e,1),vA.detachLabel({id:t.id})},attachAnnotationLabel:function(t){return vA.attachLabel({id:this.id},{label_id:t.id}).then(this.handleAttachedLabel)},handleAttachedLabel:function(t){return this.labels.push(t.body),t},hasKeyframe:function(t){return-1!==this.frames.indexOf(t)},modify:function(t,e){var i=this.frames.indexOf(t);if(-1!==i)this.points.splice(i,1,e);else{for(var n=this.frames.length-1;n>=0&&!(this.frames[n]<=t);n--);this.frames.splice(n+1,0,t),this.points.splice(n+1,0,e)}return vA.update({id:this.id},{frames:this.frames,points:this.points})},split:function(t){return vA.split({id:this.id},{time:t}).then(this.handleFinishedSplit)},handleFinishedSplit:function(t){return this.frames=t.body[0].frames,this.points=t.body[0].points,t.body=t.body[1],t},link:function(t){return vA.link({id:this.id},{annotation_id:t.id}).then(this.handleFinishedLink)},handleFinishedLink:function(t){return this.frames=t.body.frames,this.points=t.body.points,this.labels=t.body.labels,t},deleteKeyframe:function(t){var e=this.frames.indexOf(t);return-1!==e?(this.frames.splice(e,1),this.points.splice(e,1),vA.update({id:this.id},{frames:this.frames,points:this.points})):Vue.Promise.reject("Unknown keyframe ".concat(t," of annotation ").concat(this.id))},delete:function(){return vA.delete({id:this.id})}},watch:{points:function(){this.revision+=1}},created:function(){this.shape=biigle.$require("videos.shapes")[this.shape_id]}}),undefined,undefined,!1,null,null,null).exports;const mP=Tl({mixins:[jI],methods:{handleSelect:function(t,e){t.isSelected&&e?this.$emit("deselect",t):this.$emit("select",t,t.startFrame,e)}}},undefined,undefined,!1,null,null,null).exports;const vP=Tl({components:{powerToggle:Pl},data:function(){return{restoreKeys:["annotationOpacity","showMinimap","autoplayDraw","showLabelTooltip","showMousePosition","showProgressIndicator"],annotationOpacity:1,showMinimap:!0,autoplayDraw:0,showLabelTooltip:!1,showMousePosition:!1,playbackRate:1,showProgressIndicator:!0}},methods:{handleShowMinimap:function(){this.showMinimap=!0},handleHideMinimap:function(){this.showMinimap=!1},handleShowLabelTooltip:function(){this.showLabelTooltip=!0},handleHideLabelTooltip:function(){this.showLabelTooltip=!1},handleShowMousePosition:function(){this.showMousePosition=!0},handleHideMousePosition:function(){this.showMousePosition=!1},handleShowProgressIndicator:function(){this.showProgressIndicator=!0},handleHideProgressIndicator:function(){this.showProgressIndicator=!1}},watch:{annotationOpacity:function(t){t=parseFloat(t),isNaN(t)||(this.$emit("update","annotationOpacity",t),pA.set("annotationOpacity",t))},showMinimap:function(t){this.$emit("update","showMinimap",t),pA.set("showMinimap",t)},autoplayDraw:function(t){t=parseFloat(t),this.$emit("update","autoplayDraw",t),pA.set("autoplayDraw",t)},showLabelTooltip:function(t){this.$emit("update","showLabelTooltip",t),pA.set("showLabelTooltip",t)},showMousePosition:function(t){this.$emit("update","showMousePosition",t),pA.set("showMousePosition",t)},playbackRate:function(t){t=parseFloat(t),isNaN(t)||this.$emit("update","playbackRate",t)},showProgressIndicator:function(t){this.$emit("update","showProgressIndicator",t),pA.set("showProgressIndicator",t)}},created:function(){var t=this;this.restoreKeys.forEach((function(e){t[e]=pA.get(e)}))}},undefined,undefined,!1,null,null,null).exports;const yP=Tl({mixins:[tA],created:function(){var t=biigle.$require("videos.user");this.userId=t?t.id:null,this.isAdmin=biigle.$require("videos.isAdmin")}},undefined,undefined,!1,null,null,null).exports;const _P=Tl({data:function(){return{renderedAnnotationMap:{},viewFitOptions:{padding:[50,50,50,50],minResolution:1}}},computed:{annotationsRevision:function(){return this.annotations.reduce((function(t,e){return t+e.revision}),0)},annotationsPreparedToRender:function(){return this.annotations.filter((function(t){return"WholeFrame"!==t.shape})).map((function(t){return{id:t.id,start:t.startFrame,end:t.endFrame,self:t}})).sort((function(t,e){return t.start-e.start}))}},methods:{refreshAnnotations:function(t){var e=this,i=this.annotationSource,n=this.selectedFeatures,r=this.annotationsPreparedToRender,o=this.renderedAnnotationMap,s={};this.renderedAnnotationMap=s;for(var a,l=[],u=!1,h=yA(t),c=0,d=r.length;c<d;c++)if(!(h(r[c].end)<t&&h(r[c].start)!==t||r[c].self.hasGapAt(t))){if(h(r[c].start)>t)break;a=r[c],u=!0,o.hasOwnProperty(a.id)?(s[a.id]=o[a.id],delete o[a.id]):l.push(a.self)}u?Object.values(o).forEach((function(t){i.removeFeature(t),n.remove(t)})):(i.clear(),n.clear());var f=l.map(this.createFeature);f.forEach((function(t){s[t.getId()]=t,t.get("annotation").isSelected&&n.push(t)})),f.length>0&&i.addFeatures(f),Object.values(s).forEach((function(i){e.updateGeometry(i,t)}))},createFeature:function(t){var e=new Iy(this.getGeometryFromPoints(t.shape,t.points[0]));return e.setId(t.id),e.set("annotation",t),t.labels&&t.labels.length>0&&e.set("color",t.labels[0].label.color),e},updateGeometry:function(t,e){var i=t.get("annotation"),n=i.interpolatePoints(e);t.setGeometry(this.getGeometryFromPoints(i.shape,n))},getGeometryFromPoints:function(t,e){switch(e=this.convertPointsFromDbToOl(e),t){case"Point":return new ov(e[0]);case"Rectangle":return new Kb([e]);case"Polygon":return new _v([e]);case"LineString":return new Iv(e);case"Circle":return new Sv(e[0],e[1][0]);case"Ellipse":return new Xb([e]);default:return void console.error("Unknown annotation shape: "+t)}},getPointsFromGeometry:function(t){var e;switch(t.getType()){case"Circle":e=[t.getCenter(),[t.getRadius()]];break;case"Polygon":case"Rectangle":case"Ellipse":e=t.getCoordinates()[0];break;case"Point":e=[t.getCoordinates()];break;default:e=t.getCoordinates()}return this.convertPointsFromOlToDb(e)},invertPointsYAxis:function(t){for(var e=this.videoCanvas.height,i=1;i<t.length;i+=2)t[i]=e-t[i];return t},convertPointsFromOlToDb:function(t){return this.invertPointsYAxis(Array.prototype.concat.apply([],t))},convertPointsFromDbToOl:function(t){t=this.invertPointsYAxis(t.slice());for(var e=[],i=0;i<t.length;i+=2)e.push([t[i],t[i+1]||0]);return e},focusAnnotation:function(t){var e=this.annotationSource.getFeatureById(t.id);e&&this.map.getView().fit(e.getGeometry(),this.viewFitOptions)}},created:function(){var t=this;this.$on("refresh",this.refreshAnnotations),this.$once("map-ready",(function(){t.$watch("annotationsRevision",(function(){t.refreshAnnotations(t.video.currentTime)}))}))}},undefined,undefined,!1,null,null,null).exports;const bP=Tl({data:function(){return{pendingAnnotation:{},autoplayDrawTimeout:null}},computed:{hasSelectedLabel:function(){return!!this.selectedLabel},hasNoSelectedLabel:function(){return!this.selectedLabel},isDrawing:function(){return this.interactionMode.startsWith("draw")},isDrawingPoint:function(){return"drawPoint"===this.interactionMode},isDrawingRectangle:function(){return"drawRectangle"===this.interactionMode},isDrawingCircle:function(){return"drawCircle"===this.interactionMode},isDrawingLineString:function(){return"drawLineString"===this.interactionMode},isDrawingPolygon:function(){return"drawPolygon"===this.interactionMode},isDrawingWholeFrame:function(){return"drawWholeFrame"===this.interactionMode},hasPendingAnnotation:function(){return this.isDrawingWholeFrame?this.pendingAnnotation.shape&&this.pendingAnnotation.frames.length>0&&0===this.pendingAnnotation.points.length:this.pendingAnnotation.shape&&this.pendingAnnotation.frames.length>0&&this.pendingAnnotation.points.length>0},cantFinishDrawAnnotation:function(){return!this.hasPendingAnnotation},cantFinishTrackAnnotation:function(){return!this.pendingAnnotation.frames||1!==this.pendingAnnotation.frames.length}},methods:{requireSelectedLabel:function(){this.$emit("requires-selected-label"),this.resetInteractionMode()},initPendingAnnotationLayer:function(t){this.pendingAnnotationSource=new Wb,this.pendingAnnotationLayer=new kb({opacity:.5,source:this.pendingAnnotationSource,updateWhileAnimating:!0,updateWhileInteracting:!0,style:vw.editing}),t.addLayer(this.pendingAnnotationLayer)},draw:function(t){this["isDrawing"+t]?this.resetInteractionMode():this.hasNoSelectedLabel?this.requireSelectedLabel():this.canAdd&&(this.interactionMode="draw"+t)},drawPoint:function(){this.draw("Point")},drawRectangle:function(){this.draw("Rectangle")},drawCircle:function(){this.draw("Circle")},drawLineString:function(){this.draw("LineString")},drawPolygon:function(){this.draw("Polygon")},drawWholeFrame:function(){this.draw("WholeFrame")},maybeUpdateDrawInteractionMode:function(t){var e=t.slice(4);this.resetPendingAnnotation(e),this.drawInteraction&&(this.map.removeInteraction(this.drawInteraction),this.drawInteraction=void 0),this.isDrawing&&this.hasSelectedLabel&&(this.pause(),this.isDrawingWholeFrame?(this.pendingAnnotation.frames.push(this.video.currentTime),this.$emit("pending-annotation",this.pendingAnnotation)):(this.drawInteraction=new rw({source:this.pendingAnnotationSource,type:e,style:vw.editing}),this.drawInteraction.on("drawend",this.extendPendingAnnotation),this.map.addInteraction(this.drawInteraction)))},finishDrawAnnotation:function(){(this.isDrawing||this.isUsingPolygonBrush)&&this.hasPendingAnnotation&&(this.isDrawingWholeFrame&&!this.pendingAnnotation.frames.includes(this.video.currentTime)&&this.pendingAnnotation.frames.push(this.video.currentTime),this.$emit("create-annotation",this.pendingAnnotation),this.isDrawingWholeFrame?this.resetInteractionMode():this.resetPendingAnnotation(this.pendingAnnotation.shape))},finishTrackAnnotation:function(){this.isDrawing&&this.hasPendingAnnotation&&(this.$emit("track-annotation",this.pendingAnnotation),this.resetPendingAnnotation(this.pendingAnnotation.shape))},resetPendingAnnotation:function(t){this.pendingAnnotationSource.clear(),this.pendingAnnotation={shape:t,frames:[],points:[]},this.$emit("pending-annotation",null)},extendPendingAnnotation:function(t){var e=this.pendingAnnotation.frames[this.pendingAnnotation.frames.length-1];void 0===e||e<this.video.currentTime?(this.pendingAnnotation.frames.push(this.video.currentTime),this.pendingAnnotation.points.push(this.getPointsFromGeometry(t.feature.getGeometry())),!this.video.ended&&this.autoplayDraw>0&&(this.play(),window.clearTimeout(this.autoplayDrawTimeout),this.autoplayDrawTimeout=window.setTimeout(this.pause,1e3*this.autoplayDraw))):this.pendingAnnotationSource.once("addfeature",(function(t){this.removeFeature(t.feature)})),this.$emit("pending-annotation",this.pendingAnnotation)}},created:function(){this.$once("map-ready",this.initPendingAnnotationLayer),this.canAdd&&(this.$watch("interactionMode",this.maybeUpdateDrawInteractionMode),Ll.on("a",this.drawPoint,0,this.listenerSet),Ll.on("s",this.drawRectangle,0,this.listenerSet),Ll.on("d",this.drawCircle,0,this.listenerSet),Ll.on("f",this.drawLineString,0,this.listenerSet),Ll.on("g",this.drawPolygon,0,this.listenerSet),Ll.on("h",this.drawWholeFrame,0,this.listenerSet),Ll.on("Enter",this.finishDrawAnnotation,0,this.listenerSet))}},undefined,undefined,!1,null,null,null).exports;const wP=Tl({components:{mousePositionIndicator:tT},data:function(){return{mousePositionImageCoordinates:[0,0]}},methods:{updateMousePositionImageCoordinates:function(){this.mousePositionImageCoordinates=this.invertPointsYAxis(this.mousePosition.slice()).map(Math.round)}},watch:{mousePosition:function(){ou(this.updateMousePositionImageCoordinates,100,"videos.update-mouse-position-ic")}}},undefined,undefined,!1,null,null,null).exports;var xP=["Point","Circle","Rectangle","WholeFrame"];const SP=Tl({data:function(){return{isTranslating:!1}},computed:{cannotSplitAnnotation:function(){return 1!==this.selectedAnnotations.length||this.selectedAnnotations[0].frames.length<=1||-1===xP.indexOf(this.selectedAnnotations[0].shape)},cannotLinkAnnotations:function(){return 2!==this.selectedAnnotations.length||this.selectedAnnotations[0].shape_id!==this.selectedAnnotations[1].shape_id},isAttaching:function(){return"attachLabel"===this.interactionMode},isSwapping:function(){return"swapLabel"===this.interactionMode}},methods:{initModifyInteraction:function(t){this.featureRevisionMap={},this.modifyInteraction=new QC({features:this.selectInteraction.getFeatures(),deleteCondition:function(t){return n_(t)&&e_(t)}}),this.modifyInteraction.on("modifystart",this.handleModifyStart),this.modifyInteraction.on("modifyend",this.handleModifyEnd),t.addInteraction(this.modifyInteraction)},handleModifyStart:function(t){var e=this;t.features.getArray().forEach((function(t){e.featureRevisionMap[t.getId()]=t.getRevision()}))},handleModifyEnd:function(t){var e=this,i=t.features.getArray().filter((function(t){return e.featureRevisionMap[t.getId()]!==t.getRevision()})).map((function(t){return{annotation:t.get("annotation"),points:e.getPointsFromGeometry(t.getGeometry()),time:e.video.currentTime}}));i.length>0&&this.$emit("modify",i)},maybeUpdateModifyInteractionMode:function(t){this.modifyInteraction&&this.modifyInteraction.setActive(t)},emitDelete:function(){var t=this;this.canDelete&&this.hasSelectedAnnotations&&this.$emit("delete",this.selectedAnnotations.map((function(e){return{annotation:e,time:t.video.currentTime}})))},toggleTranslating:function(){this.resetInteractionMode(),this.isTranslating=!this.isTranslating},initTranslateInteraction:function(t){this.translateInteraction=new LE({features:this.selectedFeatures,map:t}),this.translateInteraction.setActive(!1),this.translateInteraction.on("translatestart",this.handleModifyStart),this.translateInteraction.on("translateend",this.handleModifyEnd),this.map.addInteraction(this.translateInteraction)},maybeUpdateIsTranslating:function(t){this.translateInteraction&&!t&&(this.isTranslating=!1)},resetTranslating:function(){this.isTranslating=!1},emitSplitAnnotation:function(){this.$emit("split-annotation",this.selectedAnnotations[0],this.video.currentTime)},emitLinkAnnotations:function(){this.$emit("link-annotations",this.selectedAnnotations)},toggleAttaching:function(){this.isAttaching?this.resetInteractionMode():this.interactionMode="attachLabel"},toggleSwapping:function(){this.isSwapping?this.resetInteractionMode():this.interactionMode="swapLabel"},initAttachInteraction:function(t){this.attachInteraction=new Yv({features:this.annotationFeatures,map:t}),this.attachInteraction.setActive(!1),this.attachInteraction.on("attach",this.handleAttachLabel),this.map.addInteraction(this.attachInteraction)},initSwapInteraction:function(t){this.swapInteraction=new Yv({features:this.annotationFeatures,map:t}),this.swapInteraction.setActive(!1),this.swapInteraction.on("attach",this.handleSwapLabel),this.map.addInteraction(this.swapInteraction)},handleAttachLabel:function(t){this.$emit("attach-label",t.feature.get("annotation"))},handleSwapLabel:function(t){this.$emit("swap-label",t.feature.get("annotation"))},maybeResetAttaching:function(t){this.isAttaching&&t&&this.resetInteractionMode()},maybeResetSwapping:function(t){this.isSwapping&&t&&this.resetInteractionMode()}},watch:{isTranslating:function(t){this.translateInteraction&&(this.translateInteraction.setActive(t),t?this.modifyInteraction.setActive(!1):this.isDefaultInteractionMode&&this.modifyInteraction.setActive(!0))},isAttaching:function(t){this.attachInteraction&&this.attachInteraction.setActive(t),this.$emit("attaching-active",t)},isSwapping:function(t){this.swapInteraction&&this.swapInteraction.setActive(t),this.$emit("swapping-active",t)}},created:function(){var t=this;this.canModify&&(this.$once("map-created",(function(){t.$once("map-ready",t.initModifyInteraction),t.$once("map-ready",t.initTranslateInteraction),t.$once("map-ready",t.initAttachInteraction),t.$once("map-ready",t.initSwapInteraction)})),this.$watch("isDefaultInteractionMode",this.maybeUpdateModifyInteractionMode),this.$watch("isDefaultInteractionMode",this.maybeUpdateIsTranslating),this.$watch("hasNoSelectedLabel",this.maybeResetAttaching),this.$watch("hasNoSelectedLabel",this.maybeResetSwapping),Ll.on("m",this.toggleTranslating,0,this.listenerSet),Ll.on("Escape",this.resetTranslating,0,this.listenerSet),Ll.on("l",this.toggleAttaching,0,this.listenerSet),Ll.on("Shift+l",this.toggleSwapping,0,this.listenerSet)),this.canDelete&&Ll.on("Delete",this.emitDelete)}},undefined,undefined,!1,null,null,null).exports;const CP=Tl({data:function(){return{polygonBrushRadius:50}},computed:{isUsingPolygonBrush:function(){return"polygonBrush"===this.interactionMode},isUsingPolygonEraser:function(){return"polygonEraser"===this.interactionMode},isUsingPolygonFill:function(){return"polygonFill"===this.interactionMode}},methods:{togglePolygonBrush:function(){this.isUsingPolygonBrush?this.resetInteractionMode():this.hasSelectedLabel?this.canAdd&&(this.interactionMode="polygonBrush"):this.requireSelectedLabel()},togglePolygonEraser:function(){this.isUsingPolygonEraser?this.resetInteractionMode():this.canModify&&(this.interactionMode="polygonEraser")},togglePolygonFill:function(){this.isUsingPolygonFill?this.resetInteractionMode():this.canModify&&(this.interactionMode="polygonFill")},togglePolygonBrushInteraction:function(t){t?this.hasSelectedLabel&&(this.polygonBrushInteraction=new eE({source:this.pendingAnnotationSource,style:vw.editing,brushRadius:this.polygonBrushRadius,resizeCondition:Xy}),this.polygonBrushInteraction.on("drawend",this.extendPendingAnnotation),this.pendingAnnotation.shape="Polygon",this.map.addInteraction(this.polygonBrushInteraction)):(this.polygonBrushRadius=this.polygonBrushInteraction.getBrushRadius(),this.map.removeInteraction(this.polygonBrushInteraction))},togglePolygonEraserInteraction:function(t){t?(this.polygonEraserInteraction=new nE({features:this.selectInteraction.getFeatures(),style:vw.editing,brushRadius:this.polygonBrushRadius,allowRemove:!1,addCondition:t_,subtractCondition:i_,resizeCondition:Xy}),this.polygonEraserInteraction.on("modifystart",this.handleModifyStart),this.polygonEraserInteraction.on("modifyend",this.handleModifyEnd),this.map.addInteraction(this.polygonEraserInteraction),this.map.addInteraction(this.shiftClickSelectInteraction)):(this.polygonBrushRadius=this.polygonEraserInteraction.getBrushRadius(),this.map.removeInteraction(this.polygonEraserInteraction),this.polygonEraserInteraction=null,this.map.removeInteraction(this.shiftClickSelectInteraction))},togglePolygonFillInteraction:function(t){t?(this.polygonFillInteraction=new nE({features:this.selectInteraction.getFeatures(),style:vw.editing,brushRadius:this.polygonBrushRadius,allowRemove:!1,addCondition:i_,subtractCondition:t_,resizeCondition:Xy}),this.polygonFillInteraction.on("modifystart",this.handleModifyStart),this.polygonFillInteraction.on("modifyend",this.handleModifyEnd),this.map.addInteraction(this.polygonFillInteraction),this.map.addInteraction(this.shiftClickSelectInteraction)):(this.polygonBrushRadius=this.polygonFillInteraction.getBrushRadius(),this.map.removeInteraction(this.polygonFillInteraction),this.polygonFillInteraction=null,this.map.removeInteraction(this.shiftClickSelectInteraction))},initShiftSelectInteraction:function(){this.shiftClickSelectInteraction=new lE({condition:function(t){return Jy(t)&&n_(t)},style:vw.highlight,layers:[this.annotationLayer],features:this.selectInteraction.getFeatures(),multi:!0}),this.shiftClickSelectInteraction.on("select",this.handleFeatureSelect)}},created:function(){var t=this;this.canAdd&&(this.$watch("isUsingPolygonBrush",this.togglePolygonBrushInteraction),Ll.on("e",this.togglePolygonBrush,0,this.listenerSet)),this.canModify&&(this.$once("map-created",(function(){t.$once("map-ready",t.initShiftSelectInteraction)})),this.$watch("isUsingPolygonEraser",this.togglePolygonEraserInteraction),Ll.on("r",this.togglePolygonEraser,0,this.listenerSet),this.$watch("isUsingPolygonFill",this.togglePolygonFillInteraction),Ll.on("t",this.togglePolygonFill,0,this.listenerSet))}},undefined,undefined,!1,null,null,null).exports;const TP=Tl({components:{labelTooltip:pg},data:function(){return{hoveredFeaturesHash:""}},computed:{showTooltip:function(){return this.isDefaultInteractionMode&&this.showLabelTooltip}},methods:{annotationLayerFilter:function(t){return"annotations"===t.get("name")},updateHoveredAnnotations:function(t){var e=this.map.getFeaturesAtPixel(t.pixel,{layerFilter:this.annotationLayerFilter})||[],i=e.map((function(t){return t.getId()})).join("-");this.hoveredFeaturesHash!==i&&(this.hoveredFeaturesHash=i,this.$emit("hoverFeatures",e))},resetHoveredAnnotations:function(){this.hoveredFeaturesHash="",this.$emit("hoverFeatures",[])},updateTooltipEventListeners:function(){this.showTooltip?this.map.on("pointermove",this.updateHoveredAnnotations):(this.map.un("pointermove",this.updateHoveredAnnotations),this.resetHoveredAnnotations())}},watch:{showTooltip:function(){this.updateTooltipEventListeners()}},created:function(){this.$once("map-created",this.updateTooltipEventListeners)}},undefined,undefined,!1,null,null,null).exports;var EP=Tl({data:function(){return{playing:!1,animationFrameId:null,refreshRate:30,renderCurrentTime:-1,refreshLastTime:Date.now(),extent:[0,0,0,0],minResolution:.01}},methods:{updateVideoLayer:function(){this.videoCanvas.width=this.video.videoWidth,this.videoCanvas.height=this.video.videoHeight,this.extent=[0,0,this.videoCanvas.width,this.videoCanvas.height];var t=new Zg({code:"biigle-image",units:"pixels",extent:this.extent});this.videoLayer&&this.map.removeLayer(this.videoLayer),this.videoLayer=new xw({name:"image",source:new by({canvas:this.videoCanvas,projection:t,canvasExtent:this.extent,canvasSize:[this.extent[0],this.extent[1]]})}),this.map.addLayer(this.videoLayer),this.map.setView(new Gx({center:[0,0],projection:t,minResolution:this.minResolution,extent:this.extent})),this.map.getView().fit(this.extent)},renderVideo:function(t){if(t||this.renderCurrentTime!==this.video.currentTime){this.renderCurrentTime=this.video.currentTime,this.videoCanvasCtx.drawImage(this.video,0,0,this.video.videoWidth,this.video.videoHeight),this.videoLayer.changed();var e=Date.now();(t||e-this.refreshLastTime>=this.refreshRate)&&(this.$emit("refresh",this.video.currentTime),this.refreshLastTime=e)}},startRenderLoop:function(){this.renderVideo(),this.animationFrameId=window.requestAnimationFrame(this.startRenderLoop)},stopRenderLoop:function(){window.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null,this.renderVideo(!0)},setPlaying:function(){this.playing=!0},setPaused:function(){this.playing=!1},togglePlaying:function(){this.playing?this.pause():this.play()},play:function(){this.video.play()},pause:function(){this.video.pause(),this.renderVideo(!0)},emitMapReady:function(){this.$emit("map-ready",this.map)},attachUpdateVideoLayerListener:function(){this.video.addEventListener("loadedmetadata",this.updateVideoLayer)}},watch:{playing:function(t){t&&!this.animationFrameId?this.startRenderLoop():t||this.stopRenderLoop()}},created:function(){var t=this;this.videoCanvas=document.createElement("canvas"),this.videoCanvasCtx=this.videoCanvas.getContext("2d"),this.video.addEventListener("play",this.setPlaying),this.video.addEventListener("pause",this.setPaused),this.video.addEventListener("seeked",this.renderVideo),this.video.addEventListener("loadeddata",this.renderVideo);var e=new Vue.Promise((function(e){t.$once("map-created",e)})),i=new Vue.Promise((function(e){t.video.addEventListener("loadedmetadata",e)}));Vue.Promise.all([e,i]).then(this.updateVideoLayer).then(this.emitMapReady).then(this.attachUpdateVideoLayerListener),Ll.on(" ",this.togglePlaying),this.$watch("hasError",(function(e){t.videoLayer&&t.videoLayer.setVisible(!e)}))}},undefined,undefined,!1,null,null,null);const IP=Tl({mixins:[EP.exports,_P,bP,SP,TP,wP,CP],components:{controlButton:Ey,minimap:qC},props:{annotations:{type:Array,default:function(){return[]}},annotationOpacity:{type:Number,default:1},autoplayDraw:{type:Number,default:0},canAdd:{type:Boolean,default:!1},canModify:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},initialCenter:{type:Array,default:function(){return[0,0]}},initialResolution:{type:Number,default:0},listenerSet:{type:String,default:"default"},selectedAnnotations:{type:Array,default:function(){return[]}},selectedLabel:{type:Object},showLabelTooltip:{type:Boolean,default:!1},showMinimap:{type:Boolean,default:!0},showMousePosition:{type:Boolean,default:!0},video:{type:HTMLVideoElement,required:!0},heightOffset:{type:Number,default:0},showPrevNext:{type:Boolean,default:!0},hasError:{type:Boolean,default:!1}},data:function(){return{interactionMode:"default",mousePosition:[0,0]}},computed:{showModifyBar:function(){return this.canModify||this.canDelete},hasSelectedAnnotations:function(){return this.selectedAnnotations.length>0},hasNoSelectedAnnotations:function(){return!this.hasSelectedAnnotations},isDefaultInteractionMode:function(){return"default"===this.interactionMode},styleObject:function(){return 0!==this.heightOffset?"height: calc(65% + ".concat(this.heightOffset,"px);"):""}},methods:{createMap:function(){var t=new dI({tipLabel:"Zoom to show whole video",label:""});Ll.on("-",t.handleZoomToExtent.bind(t),0,this.listenerSet);var e=new UC({controls:[new eS,t],interactions:AS({altShiftDragRotate:!1,doubleClickZoom:!1,keyboard:!1,shiftDragZoom:!1,pinchRotate:!1,pinchZoom:!1})});return t=new bI({label:""}),Ll.on("+",t.zoomToNative.bind(t),0,this.listenerSet),e.addControl(t),e},initLayersAndInteractions:function(t){this.annotationFeatures=new Ty,this.annotationSource=new Wb({features:this.annotationFeatures}),this.annotationLayer=new kb({source:this.annotationSource,updateWhileAnimating:!0,updateWhileInteracting:!0,style:vw.features,opacity:this.annotationOpacity,name:"annotations"}),this.selectInteraction=new lE({condition:Jy,style:vw.highlight,layers:[this.annotationLayer],multi:!0}),this.selectedFeatures=this.selectInteraction.getFeatures(),this.selectInteraction.on("select",this.handleFeatureSelect),t.addLayer(this.annotationLayer),t.addInteraction(this.selectInteraction)},resetInteractionMode:function(){this.interactionMode="default"},extractAnnotationFromFeature:function(t){return t.get("annotation")},handleFeatureSelect:function(t){this.$emit("select",t.selected.map(this.extractAnnotationFromFeature),t.deselected.map(this.extractAnnotationFromFeature),this.video.currentTime)},updateMousePosition:function(t){this.mousePosition=t.coordinate},emitTrack:function(){this.$emit("track")},emitMoveend:function(t){var e=t.target.getView();this.$emit("moveend",e.getCenter(),e.getResolution())},initInitialCenterAndResolution:function(t){var e=t.getView();0!==this.initialResolution&&e.setResolution(Math.min(e.getMaxResolution(),Math.max(e.getMinResolution(),this.initialResolution))),0===this.initialCenter[0]&&0===this.initialCenter[1]||!Lp(this.extent,this.initialCenter)||e.setCenter(this.initialCenter)},updateSize:function(){var t=this;this.$nextTick((function(){return t.map.updateSize()}))},emitPrevious:function(){this.$emit("previous")},emitNext:function(){this.$emit("next")},reset:function(){this.setPaused(),this.resetInteractionMode()}},watch:{selectedAnnotations:function(t){var e,i=this.annotationSource,n=this.selectedFeatures;i&&n&&(n.clear(),t.forEach((function(t){(e=i.getFeatureById(t.id))&&n.push(e)})))},isDefaultInteractionMode:function(t){this.selectInteraction.setActive(t)},annotationOpacity:function(t){this.annotationLayer&&this.annotationLayer.setOpacity(t)},heightOffset:function(){this.updateSize()}},created:function(){this.$once("map-ready",this.initLayersAndInteractions),this.$once("map-ready",this.initInitialCenterAndResolution),this.map=this.createMap(),this.$emit("map-created",this.map),this.map.on("pointermove",this.updateMousePosition),this.map.on("moveend",this.emitMoveend),Ll.on("Escape",this.resetInteractionMode,0,this.listenerSet),Ll.on("ArrowRight",this.emitNext,0,this.listenerSet),Ll.on("ArrowLeft",this.emitPrevious,0,this.listenerSet)},mounted:function(){this.map.setTarget(this.$el)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-screen",style:t.styleObject},[t.showMinimap&&!t.hasError?i("minimap",{attrs:{extent:t.extent}}):t._e(),t._v(" "),i("label-tooltip",{attrs:{watch:"hoverFeatures",show:t.showLabelTooltip,position:t.mousePosition}}),t._v(" "),i("div",{staticClass:"controls"},[i("div",{staticClass:"btn-group"},[t.showPrevNext?i("control-button",{attrs:{icon:"fa-step-backward",title:"Previous video 𝗟𝗲𝗳𝘁 𝗮𝗿𝗿𝗼𝘄"},on:{click:t.emitPrevious}}):t._e(),t._v(" "),t.playing?i("control-button",{attrs:{icon:"fa-pause",title:"Pause 𝗦𝗽𝗮𝗰𝗲𝗯𝗮𝗿",disabled:t.hasError},on:{click:t.pause}}):i("control-button",{attrs:{icon:"fa-play",title:"Play 𝗦𝗽𝗮𝗰𝗲𝗯𝗮𝗿",disabled:t.hasError},on:{click:t.play}}),t._v(" "),t.showPrevNext?i("control-button",{attrs:{icon:"fa-step-forward",title:"Next video 𝗥𝗶𝗴𝗵𝘁 𝗮𝗿𝗿𝗼𝘄"},on:{click:t.emitNext}}):t._e()],1),t._v(" "),t.canAdd?i("div",{staticClass:"btn-group"},[i("control-button",{attrs:{icon:"icon-point",title:"Start a point annotation 𝗔",hover:!1,open:t.isDrawingPoint,active:t.isDrawingPoint,disabled:t.hasError},on:{click:t.drawPoint}},[i("control-button",{attrs:{icon:"fa-check",title:"Finish the point annotation 𝗘𝗻𝘁𝗲𝗿",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}}),t._v(" "),i("control-button",{attrs:{icon:"fa-project-diagram",title:"Finish and track the point annotation",disabled:t.cantFinishTrackAnnotation},on:{click:t.finishTrackAnnotation}})],1),t._v(" "),i("control-button",{attrs:{icon:"icon-rectangle",title:"Start a rectangle annotation 𝗦",hover:!1,open:t.isDrawingRectangle,active:t.isDrawingRectangle,disabled:t.hasError},on:{click:t.drawRectangle}},[i("control-button",{attrs:{icon:"fa-check",title:"Finish the rectangle annotation 𝗘𝗻𝘁𝗲𝗿",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}})],1),t._v(" "),i("control-button",{attrs:{icon:"icon-circle",title:"Start a circle annotation 𝗗",hover:!1,open:t.isDrawingCircle,active:t.isDrawingCircle,disabled:t.hasError},on:{click:t.drawCircle}},[i("control-button",{attrs:{icon:"fa-check",title:"Finish the circle annotation 𝗘𝗻𝘁𝗲𝗿",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}}),t._v(" "),i("control-button",{attrs:{icon:"fa-project-diagram",title:"Finish and track the circle annotation",disabled:t.cantFinishTrackAnnotation},on:{click:t.finishTrackAnnotation}})],1),t._v(" "),i("control-button",{attrs:{icon:"icon-linestring",title:"Start a line annotation 𝗙",hover:!1,open:t.isDrawingLineString,active:t.isDrawingLineString,disabled:t.hasError},on:{click:t.drawLineString}},[i("control-button",{attrs:{icon:"fa-check",title:"Finish the line annotation 𝗘𝗻𝘁𝗲𝗿",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}})],1),t._v(" "),i("control-button",{attrs:{icon:"icon-polygon",title:"Start a polygon annotation 𝗚",open:t.isDrawingPolygon,active:t.isDrawingPolygon,disabled:t.hasError},on:{click:t.drawPolygon}},[t.isDrawingPolygon||t.isUsingPolygonBrush?i("control-button",{attrs:{icon:"fa-check",title:"Finish the polygon annotation 𝗘𝗻𝘁𝗲𝗿",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}}):t._e(),t._v(" "),i("control-button",{attrs:{icon:"fa-paint-brush",title:"Draw a polygon using the brush tool 𝗘",active:t.isUsingPolygonBrush},on:{click:t.togglePolygonBrush}}),t._v(" "),i("control-button",{attrs:{icon:"fa-eraser",title:"Modify selected polygons using the eraser tool 𝗥",active:t.isUsingPolygonEraser},on:{click:t.togglePolygonEraser}}),t._v(" "),i("control-button",{attrs:{icon:"fa-fill-drip",title:"Modify selected polygons using the fill tool 𝗧",active:t.isUsingPolygonFill},on:{click:t.togglePolygonFill}})],1),t._v(" "),i("control-button",{attrs:{icon:"icon-wholeframe",title:"Start a whole frame annotation 𝗛",hover:!1,open:t.isDrawingWholeFrame,active:t.isDrawingWholeFrame,disabled:t.hasError},on:{click:t.drawWholeFrame}},[i("control-button",{attrs:{icon:"fa-check",title:"Finish the whole frame annotation 𝗘𝗻𝘁𝗲𝗿",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}})],1)],1):t._e(),t._v(" "),t.showModifyBar?i("div",{staticClass:"btn-group"},[t.canModify?i("control-button",{attrs:{icon:"fa-tag",title:"Attach the currently selected label to existing annotations 𝗟",active:t.isAttaching,disabled:t.hasNoSelectedLabel||t.hasError},on:{click:t.toggleAttaching}},[i("control-button",{attrs:{icon:"fa-sync-alt",title:"Swap the most recent label of an existing annotation with the currently selected one 𝗦𝗵𝗶𝗳𝘁+𝗟",active:t.isSwapping,disabled:t.hasNoSelectedLabel||t.hasError},on:{click:t.toggleSwapping}})],1):t._e(),t._v(" "),t.canModify?i("control-button",{attrs:{icon:"fa-arrows-alt",title:"Move selected annotations 𝗠",active:t.isTranslating,disabled:t.hasError},on:{click:t.toggleTranslating}}):t._e(),t._v(" "),t.canModify?i("control-button",{attrs:{icon:"fa-link",title:"Link selected annotations",disabled:t.cannotLinkAnnotations||t.hasError},on:{click:t.emitLinkAnnotations}}):t._e(),t._v(" "),t.canModify?i("control-button",{attrs:{icon:"fa-unlink",title:"Split selected annotation",disabled:t.cannotSplitAnnotation||t.hasError},on:{click:t.emitSplitAnnotation}}):t._e(),t._v(" "),t.canDelete?i("control-button",{attrs:{icon:"fa-trash",title:"Delete selected annotations/keyframes 𝗗𝗲𝗹𝗲𝘁𝗲",disabled:t.hasNoSelectedAnnotations||t.hasError},on:{click:t.emitDelete}}):t._e()],1):t._e()]),t._v(" "),i("div",{staticClass:"indicators indicators--left"},[t.showMousePosition?i("mouse-position-indicator",{attrs:{position:t.mousePositionImageCoordinates}}):t._e()],1),t._v(" "),i("div",{staticClass:"indicators indicators--right"},[t.selectedLabel?i("div",{staticClass:"indicator",domProps:{textContent:t._s(t.selectedLabel.name)}}):t._e()])],1)}),[],!1,null,null,null).exports;const AP=Tl({props:{currentTime:{type:Number,required:!0},hoverTime:{type:Number,default:0},seeking:{type:Boolean,default:!1}},components:{loader:El},computed:{currentTimeText:function(){return Vue.filter("videoTime")(this.currentTime)},hoverTimeText:function(){return Vue.filter("videoTime")(this.hoverTime)},classObject:function(){return{"current-time--seeking":this.seeking,"current-time--hover":this.showHoverTime}},showHoverTime:function(){return 0!==this.hoverTime}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"current-time",class:t.classObject},[t.seeking?i("loader",{attrs:{active:!0}}):i("span",[i("span",{domProps:{textContent:t._s(t.currentTimeText)}}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.showHoverTime,expression:"showHoverTime"}],staticClass:"hover-time",domProps:{textContent:t._s(t.hoverTimeText)}})])],1)}),[],!1,null,null,null).exports;var PP=Tl({props:{frame:{type:Object,required:!0},startFrame:{type:Number,required:!0},segmentDuration:{type:Number,required:!0},color:{type:String,required:!0}},computed:{offset:function(){return(this.frame.time-this.startFrame)/this.segmentDuration},style:function(){return{left:100*this.offset+"%","background-color":this.color}},classObj:function(){return{"annotation-keyframe--selected":this.frame.selected}}},methods:{emitSelect:function(t){this.$emit("select",this.frame,t.shiftKey)}}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",{staticClass:"annotation-keyframe",class:t.classObj,style:t.style,on:{click:function(e){return e.stopPropagation(),t.emitSelect(e)}}})}),[],!1,null,null,null);var kP=Tl({components:{keyframe:PP.exports},props:{annotation:{type:Object,required:!0},label:{type:Object,required:!0},frames:{type:Array,required:!0},gap:{type:Boolean,default:!1},clipDuration:{type:Number,required:!0}},computed:{startFrame:function(){return this.frames[0]},endFrame:function(){return this.frames[this.frames.length-1]},segmentDuration:function(){return this.endFrame-this.startFrame},classObject:function(){return{"annotation-segment--gap":this.gap}},width:function(){return 100*this.segmentDuration/this.clipDuration},color:function(){return"#"+(this.label.color||"000000")},style:function(){var t={width:this.width+"%"};return this.gap?t["border-top-color"]=this.color:t["background-color"]=this.color+"66",t},keyframes:function(){if(this.gap)return[];var t=this.annotation.selected;return this.frames.map((function(e){return{time:e,selected:t===e}}))}},methods:{selectFrame:function(t,e){this.$emit("select",t.time,e)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"annotation-segment",class:t.classObject,style:t.style},t._l(t.keyframes,(function(e){return i("keyframe",{key:e.time,attrs:{frame:e,"start-frame":t.startFrame,"segment-duration":t.segmentDuration,color:t.color},on:{select:t.selectFrame}})})),1)}),[],!1,null,null,null);var RP=Tl({components:{segment:kP.exports},props:{annotation:{type:Object,required:!0},label:{type:Object,required:!0},duration:{type:Number,required:!0},elementWidth:{type:Number,required:!0}},computed:{startFrame:function(){return this.annotation.startFrame},endFrame:function(){return this.annotation.endFrame},offset:function(){var t=this.startFrame/this.duration*this.elementWidth;return this.annotation.isClip||(t=Math.min(t,this.elementWidth-9)),t},clipDuration:function(){return this.endFrame-this.startFrame},width:function(){return this.clipDuration/this.duration*this.elementWidth},style:function(){return{left:this.offset+"px",width:this.width+"px"}},segments:function(){for(var t,e=[this.annotation.frames.slice()],i=[!1],n=0;-1!==(t=e[n].indexOf(null));){var r=e[n];e[n]=r.slice(0,t),e.push([r[t-1],r[t+1]]),i.push(!0),e.push(r.slice(t+1)),i.push(!1),n+=2}return e.map((function(t,e){return{frames:t,gap:i[e]}}))},selected:function(){return this.annotation.isSelected},classObj:function(){return{"annotation-clip--selected":this.selected,"annotation-clip--compact":this.shouldBeCompact,"annotation-clip--more-compact":this.shouldBeMoreCompact,"annotation-clip--tracking":this.annotation.tracking,"annotation-clip--whole-frame":this.annotation.wholeFrame,"annotation-clip--dark":this.hasDarkColor,"annotation-clip--pending":this.annotation.pending}},minTimeBetweenFrames:function(){for(var t=1/0,e=this.annotation.frames.filter((function(t){return null!==t})),i=e.length-1;i>0;i--)t=Math.min(t,e[i]-e[i-1]);return t},minDistanceBetweenFrames:function(){return this.minTimeBetweenFrames/this.duration*this.elementWidth},shouldBeCompact:function(){return this.minDistanceBetweenFrames<=18},shouldBeMoreCompact:function(){return this.minDistanceBetweenFrames<=6},title:function(){return this.annotation.pending?"Pending annotation":this.annotation.tracking?"Tracking in progress":""},hasDarkColor:function(){var t=this.label.color||"000000",e=parseInt(t,16);return.2126*(e>>16&255)+.7152*(e>>8&255)+.0722*(e>>0&255)<128}},methods:{emitSelect:function(t,e){this.selected&&e?this.$emit("deselect",this.annotation):this.$emit("select",this.annotation,t,e)},select:function(t){var e=this.startFrame+(t.clientX-this.$el.getBoundingClientRect().left)/this.$el.clientWidth*this.clipDuration;this.emitSelect(e,t.shiftKey)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.duration>0,expression:"duration > 0"}],staticClass:"annotation-clip",class:t.classObj,style:t.style,attrs:{title:t.title},on:{click:function(e){return e.stopPropagation(),t.select(e)}}},t._l(t.segments,(function(e,n){return i("segment",{key:n,attrs:{annotation:t.annotation,label:t.label,frames:e.frames,gap:e.gap,"clip-duration":t.clipDuration},on:{select:t.emitSelect}})})),1)}),[],!1,null,null,null);var LP=Tl({components:{annotationClip:RP.exports},props:{label:{type:Object,required:!0},lanes:{type:Array,required:!0},duration:{type:Number,required:!0},elementWidth:{type:Number,required:!0}},methods:{emitSelect:function(t,e,i){this.$emit("select",t,e,i)},emitDeselect:function(t){this.$emit("deselect",t)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"annotation-track"},t._l(t.lanes,(function(e){return i("div",{staticClass:"annotation-lane"},t._l(e,(function(e){return i("annotation-clip",{key:e.id,attrs:{annotation:e,"element-width":t.elementWidth,label:t.label,duration:t.duration},on:{select:t.emitSelect,deselect:t.emitDeselect}})})),1)})),0)}),[],!1,null,null,null);const FP=Tl({components:{annotationTrack:LP.exports},props:{tracks:{type:Array,required:!0},duration:{type:Number,required:!0},elementWidth:{type:Number,required:!0}},data:function(){return{dragging:!1,scrollTop:0,scrollHeight:0,clientHeight:0}},computed:{hasOverflowTop:function(){return this.scrollTop>0},hasOverflowBottom:function(){var t=this.scrollHeight-this.clientHeight-1;return t>0&&this.scrollTop<t}},methods:{emitSelect:function(t,e,i){this.$emit("select",t,e,i)},emitDeselect:function(){this.$emit("deselect")},emitDeselectAnnotation:function(t){this.$emit("deselect",t)},emitDragX:function(t){this.$emit("drag-x",t)},startDragging:function(t){this.dragging=1===t.buttons},stopDragging:function(){this.dragging=!1},continueDragging:function(t){this.dragging&&(1!==t.buttons?this.stopDragging():(this.$el.scrollTop-=t.movementY,0!==t.movementX&&this.emitDragX(t.movementX)))},updateScrollTop:function(){this.scrollTop=this.$el.scrollTop},updateScrollHeight:function(){this.scrollHeight=this.$el.scrollHeight},updateClientHeight:function(){this.clientHeight=this.$el.clientHeight}},watch:{tracks:function(){this.$nextTick(this.updateScrollHeight)},hasOverflowTop:function(t){this.$emit("overflow-top",t)},hasOverflowBottom:function(t){this.$emit("overflow-bottom",t)},scrollTop:function(t){this.$emit("scroll-y",t)}},created:function(){window.addEventListener("resize",this.updateClientHeight)},mounted:function(){this.$nextTick(this.updateClientHeight)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"annotation-tracks",on:{click:t.emitDeselect,mousedown:t.startDragging,mouseup:t.stopDragging,mousemove:t.continueDragging,scroll:function(e){return e.stopPropagation(),t.updateScrollTop(e)}}},t._l(t.tracks,(function(e){return i("annotation-track",{key:e.id,attrs:{label:e.label,lanes:e.lanes,duration:t.duration,"element-width":t.elementWidth},on:{select:t.emitSelect,deselect:t.emitDeselectAnnotation}})})),1)}),[],!1,null,null,null).exports;const MP=Tl({props:{time:{type:Number,required:!0}},computed:{style:function(){var t=this.time/this.$parent.duration*this.$parent.elementWidth;return"left: ".concat(t,"px")},text:function(){return Vue.filter("videoTime")(this.time)}}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",{staticClass:"tick",style:t.style,domProps:{textContent:t._s(t.text)}})}),[],!1,null,null,null).exports;var OP=Tl({props:{duration:{type:Number,required:!0},elementWidth:{type:Number,required:!0}},components:{tick:MP},data:function(){return{tickSpacing:100}},computed:{tickCount:function(){return Math.floor(this.elementWidth/this.tickSpacing)},ticks:function(){if(!this.hasTicks)return[];var t=this.duration/this.tickCount;return Array.apply(null,{length:this.tickCount}).map((function(e,i){return t*i}))},hasTicks:function(){return this.tickCount>0&&this.duration>0}},methods:{emitSeek:function(t){this.$emit("seek",(t.clientX-t.target.getBoundingClientRect().left)/t.target.clientWidth*this.duration)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-progress",on:{click:t.emitSeek}},t._l(t.ticks,(function(t){return i("tick",{key:t,attrs:{time:t}})})),1)}),[],!1,null,null,null);const $P=Tl({components:{videoProgress:OP.exports,annotationTracks:FP},props:{tracks:{type:Array,required:function(){return[]}},duration:{type:Number,required:!0},currentTime:{type:Number,required:!0},seeking:{type:Boolean,default:!1}},data:function(){return{zoom:1,zoomFactor:.3,scrollFactor:10,initialElementWidth:0,scrollLeft:0,hoverTime:0,hasOverflowTop:!1,hasOverflowBottom:!1}},computed:{currentTimePosition:function(){return this.duration>0?this.elementWidth*this.currentTime/this.duration:0},timeIndicatorClass:function(){return{"time-indicator--seeking":this.seeking}},timeIndicatorStyle:function(){return"transform: translateX(".concat(this.currentTimePosition,"px);")},hoverTimeIndicatorStyle:function(){return"transform: translateX(".concat(this.hoverPosition,"px);")},scrollerStyle:function(){return{width:100*this.zoom+"%",left:this.scrollLeft+"px"}},elementWidth:function(){return this.initialElementWidth*this.zoom},hoverPosition:function(){return this.duration>0?this.elementWidth*this.hoverTime/this.duration:0},showHoverTime:function(){return 0!==this.hoverTime},hasOverflowLeft:function(){return this.scrollLeft<0},hasOverflowRight:function(){return this.elementWidth+this.scrollLeft>this.initialElementWidth}},methods:{updateInitialElementWidth:function(){this.initialElementWidth=this.$el.clientWidth},emitSeek:function(t){this.$emit("seek",t)},emitSelect:function(t,e,i){this.$emit("select",t,e,i)},emitDeselect:function(t){this.$emit("deselect",t)},emitScrollY:function(t){this.$emit("scroll-y",t)},handleWheel:function(t){t.shiftKey?0!==t.deltaY&&this.updateZoom(t):t.deltaX<0?this.updateScrollLeft(this.scrollLeft+this.scrollFactor):t.deltaX>0&&this.updateScrollLeft(this.scrollLeft-this.scrollFactor)},updateZoom:function(t){var e=this,i=t.clientX-this.$el.getBoundingClientRect().left,n=(t.clientX-this.$refs.scroller.getBoundingClientRect().left)/this.elementWidth,r=t.deltaY<0?this.zoomFactor:-1*this.zoomFactor;this.zoom=Math.max(1,this.zoom+r),this.$nextTick((function(){var t=n*e.elementWidth;e.updateScrollLeft(i-t)}))},handleHideHoverTime:function(){this.hoverTime=0},handleUpdateHoverTime:function(t){this.hoverTime=(t.clientX-this.$refs.scroller.getBoundingClientRect().left)/this.elementWidth*this.duration},updateScrollLeft:function(t){this.scrollLeft=Math.max(Math.min(0,t),this.initialElementWidth-this.elementWidth)},updateOverflowTop:function(t){this.hasOverflowTop=t},updateOverflowBottom:function(t){this.hasOverflowBottom=t},handleDragX:function(t){this.updateScrollLeft(this.scrollLeft+t)},updateHeight:function(){this.$refs.annotationTracks.updateClientHeight()},reset:function(){this.zoom=1,this.scrollLeft=0,this.hoverTime=0,this.hasOverflowTop=!1,this.hasOverflowBottom=!1}},watch:{hoverTime:function(t){this.$emit("hover-time",t)},initialElementWidth:function(t,e){this.updateScrollLeft(this.scrollLeft*t/e)}},created:function(){var t=this;window.addEventListener("resize",this.updateInitialElementWidth),Rl.$on("sidebar.toggle",(function(){t.$nextTick(t.updateInitialElementWidth)})),Ll.on(" ",(function(t){t.preventDefault()}))},mounted:function(){this.$nextTick(this.updateInitialElementWidth)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"scroll-strip",on:{wheel:function(e){return e.stopPropagation(),t.handleWheel(e)},mouseleave:t.handleHideHoverTime}},[i("div",{ref:"scroller",staticClass:"scroll-strip__scroller",style:t.scrollerStyle,on:{mousemove:t.handleUpdateHoverTime}},[i("video-progress",{attrs:{duration:t.duration,"element-width":t.elementWidth},on:{seek:t.emitSeek}}),t._v(" "),i("div",{staticClass:"annotation-tracks-wrapper"},[i("annotation-tracks",{ref:"annotationTracks",attrs:{tracks:t.tracks,duration:t.duration,"element-width":t.elementWidth},on:{select:t.emitSelect,deselect:t.emitDeselect,"scroll-y":t.emitScrollY,"drag-x":t.handleDragX,"overflow-top":t.updateOverflowTop,"overflow-bottom":t.updateOverflowBottom}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.hasOverflowTop,expression:"hasOverflowTop"}],staticClass:"overflow-shadow overflow-shadow--top"}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.hasOverflowBottom,expression:"hasOverflowBottom"}],staticClass:"overflow-shadow overflow-shadow--bottom"})],1),t._v(" "),i("span",{staticClass:"time-indicator",class:t.timeIndicatorClass,style:t.timeIndicatorStyle}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.showHoverTime,expression:"showHoverTime"}],staticClass:"hover-time-indicator",style:t.hoverTimeIndicatorStyle})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.hasOverflowLeft,expression:"hasOverflowLeft"}],staticClass:"overflow-shadow overflow-shadow--left"}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.hasOverflowRight,expression:"hasOverflowRight"}],staticClass:"overflow-shadow overflow-shadow--right"})])}),[],!1,null,null,null).exports;var DP=Tl({props:{tracks:{type:Array,required:!0},scrollTop:{type:Number,default:0}},watch:{scrollTop:function(t){this.$el.scrollTop=t}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"track-headers"},t._l(t.tracks,(function(e){return i("div",{staticClass:"track-header"},[i("div",{staticClass:"label-name",attrs:{title:e.label.name},domProps:{textContent:t._s(e.label.name)}}),t._v(" "),t._l(e.lanes,(function(t){return i("div",{staticClass:"lane-dummy"})}))],2)})),0)}),[],!1,null,null,null);const jP=Tl({components:{currentTime:AP,trackHeaders:DP.exports,scrollStrip:$P},props:{annotations:{type:Array,default:function(){return[]}},video:{type:HTMLVideoElement,required:!0},seeking:{type:Boolean,default:!1},heightOffset:{type:Number,default:0},pendingAnnotation:{type:Object,default:function(){return null}}},data:function(){return{animationFrameId:null,refreshRate:30,refreshLastTime:Date.now(),currentTime:0,duration:0,scrollTop:0,hoverTime:0}},computed:{labelMap:function(){var t={},e=this.annotations;return this.pendingAnnotation&&(e=e.slice()).push(this.pendingAnnotation),e.forEach((function(e){e.labels.forEach((function(e){t.hasOwnProperty(e.label_id)||(t[e.label_id]=e.label)}))})),t},annotationTracks:function(){var t=this,e={},i=this.annotations;return this.pendingAnnotation&&(i=i.slice()).push(this.pendingAnnotation),i.forEach((function(t){t.labels.forEach((function(i){e.hasOwnProperty(i.label_id)||(e[i.label_id]=[]),e[i.label_id].push(t)}))})),Object.keys(e).map((function(i){return{id:i,label:t.labelMap[i],lanes:t.getAnnotationTrackLanes(e[i])}}))},styleObject:function(){return 0!==this.heightOffset?"height: calc(35% + ".concat(this.heightOffset,"px);"):""}},methods:{startUpdateLoop:function(){var t=Date.now();t-this.refreshLastTime>=this.refreshRate&&(this.updateCurrentTime(),this.refreshLastTime=t),this.animationFrameId=window.requestAnimationFrame(this.startUpdateLoop)},stopUpdateLoop:function(){this.updateCurrentTime(),window.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null},updateCurrentTime:function(){this.currentTime=this.video.currentTime},setDuration:function(){this.duration=this.video.duration},emitSeek:function(t){this.$emit("seek",t)},emitSelect:function(t,e,i){this.$emit("select",t,e,i)},emitDeselect:function(t){this.$emit("deselect",t)},handleScrollY:function(t){this.scrollTop=t},getAnnotationTrackLanes:function(t){var e=this,i=[[]],n=[[]];return t.forEach((function(t){var r=[t.startFrame,t.endFrame],o=0,s=!1;t:for(;!s;){if(n[o]){for(var a=i[o].length-1;a>=0;a--)if(e.rangesCollide(i[o][a],r)){o+=1;continue t}}else i[o]=[],n[o]=[];i[o].push(r),n[o].push(t),s=!0}})),n},rangesCollide:function(t,e){return t[0]>=e[0]&&t[0]<e[1]||t[1]>e[0]&&t[1]<=e[1]||e[0]>=t[0]&&e[0]<t[1]||e[1]>t[0]&&e[1]<=t[1]||t[0]===e[0]&&t[1]===e[1]},updateHoverTime:function(t){this.hoverTime=t},emitStartResize:function(t){this.$emit("start-resize",t)},reset:function(){this.currentTime=0,this.duration=0,this.scrollTop=0,this.hoverTime=0,this.$refs.scrollStrip.reset()}},watch:{heightOffset:function(){this.$refs.scrollStrip.updateHeight()}},created:function(){this.video.addEventListener("play",this.startUpdateLoop),this.video.addEventListener("pause",this.stopUpdateLoop),this.video.addEventListener("loadedmetadata",this.setDuration),this.video.addEventListener("seeked",this.updateCurrentTime)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-timeline",style:t.styleObject},[i("div",{staticClass:"grab-border",on:{mousedown:t.emitStartResize}}),t._v(" "),i("div",{staticClass:"static-strip"},[i("current-time",{attrs:{"current-time":t.currentTime,"hover-time":t.hoverTime,seeking:t.seeking}}),t._v(" "),i("track-headers",{ref:"trackheaders",attrs:{tracks:t.annotationTracks,"scroll-top":t.scrollTop}})],1),t._v(" "),i("scroll-strip",{ref:"scrollStrip",attrs:{tracks:t.annotationTracks,duration:t.duration,"current-time":t.currentTime,seeking:t.seeking},on:{seek:t.emitSeek,select:t.emitSelect,deselect:t.emitDeselect,"scroll-y":t.handleScrollY,"hover-time":t.updateHoverTime}})],1)}),[],!1,null,null,null).exports;function NP(t){return(NP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function BP(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function UP(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&KP(t,e)}function zP(t){var e=WP();return function(){var i,n=XP(t);if(e){var r=XP(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return VP(this,i)}}function VP(t,e){return!e||"object"!==NP(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function GP(t){var e="function"==typeof Map?new Map:void 0;return(GP=function(t){if(null===t||(i=t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return qP(t,arguments,XP(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),KP(n,t)})(t)}function qP(t,e,i){return(qP=WP()?Reflect.construct:function(t,e,i){var n=[null];n.push.apply(n,e);var r=new(Function.bind.apply(t,n));return i&&KP(r,i.prototype),r}).apply(null,arguments)}function WP(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function KP(t,e){return(KP=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function XP(t){return(XP=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var YP=function(t){UP(i,t);var e=zP(i);function i(){return BP(this,i),e.apply(this,arguments)}return i}(GP(Error)),HP=function(t){UP(i,t);var e=zP(i);function i(){return BP(this,i),e.apply(this,arguments)}return i}(YP),ZP=function(t){UP(i,t);var e=zP(i);function i(){return BP(this,i),e.apply(this,arguments)}return i}(YP),JP=function(t){UP(i,t);var e=zP(i);function i(){return BP(this,i),e.apply(this,arguments)}return i}(YP),QP=function(t){UP(i,t);var e=zP(i);function i(){return BP(this,i),e.apply(this,arguments)}return i}(YP),tk=function(t){UP(i,t);var e=zP(i);function i(){return BP(this,i),e.apply(this,arguments)}return i}(YP),ek=function(t){UP(i,t);var e=zP(i);function i(){return BP(this,i),e.apply(this,arguments)}return i}(YP);const ik=Tl({mixins:[cu],components:{videoScreen:IP,videoTimeline:jP,sidebar:Fl,sidebarTab:Ml,labelTrees:ec,settingsTab:vP,annotationsTab:mP,videoLabelsTab:yP},data:function(){return{volumeId:null,videoId:null,videoDuration:0,videoIds:[],videoFileUri:"",shapes:[],canEdit:!1,video:null,labelTrees:[],selectedLabel:null,pendingAnnotation:null,annotations:[],seeking:!1,settings:{annotationOpacity:1,showMinimap:!0,autoplayDraw:0,showLabelTooltip:!1,showMousePosition:!1,playbackRate:1,showProgressIndicator:!0},openTab:"",urlParams:{x:0,y:0,r:0,t:0},initialCurrentTime:0,initialMapCenter:[0,0],initialMapResolution:0,initialFocussedAnnotation:0,annotationFilters:[],activeAnnotationFilter:null,resizingTimeline:!1,timelineOffsetReference:0,timelineHeightReference:0,fixedTimelineOffset:0,currentTimelineOffset:0,errors:{},error:null,user:null,attachingLabel:!1,swappingLabel:!1}},computed:{selectedAnnotations:function(){return this.filteredAnnotations.filter((function(t){return t.isSelected}))},filteredAnnotations:function(){return this.hasActiveAnnotationFilter?this.activeAnnotationFilter.filter(this.annotations):this.annotations},hasActiveAnnotationFilter:function(){return null!==this.activeAnnotationFilter},timelineHeightOffset:function(){return this.fixedTimelineOffset+this.currentTimelineOffset},screenHeightOffset:function(){return-1*this.timelineHeightOffset},classObject:function(){return this.resizingTimeline?"resizing-timeline":""},hasSiblingVideos:function(){return this.videoIds.length>1},hasError:function(){return null!==this.error},hasVideoError:function(){return this.error instanceof YP},errorMessage:function(){if(this.hasVideoError){if(this.error instanceof HP)return"The video has not been processed yet. Please try again later.";if(this.error instanceof ZP)return"The video file has not been found. Please check the source.";if(this.error instanceof JP)return"The video MIME type is invalid.";if(this.error instanceof QP)return"The video codec is invalid.";if(this.error instanceof tk)return"The video file is malformed.";if(this.error instanceof ek)return"The video file is too large."}return""},errorClass:function(){return this.hasVideoError?this.error instanceof HP?"panel-warning text-warning":"panel-danger text-danger":""},annotationsHiddenByFilter:function(){return this.annotations.length!==this.filteredAnnotations.length}},methods:{prepareAnnotation:function(t){return new gP({data:t})},setAnnotations:function(t){this.annotations=t[0].body.map(this.prepareAnnotation)},addCreatedAnnotation:function(t){var e=this.prepareAnnotation(t.body);return e.$on("tracking-failed",this.removeAnnotation),this.annotations.push(e),e},seek:function(t){var e=this;if(!this.seeking&&this.video.currentTime!==t){var i=new Vue.Promise((function(t,i){e.video.addEventListener("seeked",t),e.video.addEventListener("error",i)}));return this.seeking=!0,this.video.currentTime=t,i}return Vue.Promise.resolve()},selectAnnotation:function(t,e,i){return this.attachingLabel?(this.attachAnnotationLabel(t),Vue.Promise.resolve()):this.swappingLabel?(this.swapAnnotationLabel(t),Vue.Promise.resolve()):i?this.selectAnnotations([t],[],e):this.selectAnnotations([t],this.selectedAnnotations,e)},selectAnnotations:function(t,e,i){e.forEach((function(t){t.selected=!1}));var n=this.selectedAnnotations.length>0;return t.forEach((function(t){t.selected=i})),void 0!==i&&!1===n?this.seek(i):Vue.Promise.resolve()},deselectAnnotation:function(t){t?t.selected=!1:this.selectedAnnotations.forEach((function(t){t.selected=!1}))},updatePendingAnnotation:function(t){if(t){var e=Object.assign({},t,{shape_id:this.shapes[t.shape],labels:[{label_id:this.selectedLabel.id,label:this.selectedLabel,user:this.user}],pending:!0});this.pendingAnnotation=new gP({data:e})}else this.pendingAnnotation=null},createAnnotation:function(t){var e=this;this.updatePendingAnnotation(t);var i=this.pendingAnnotation;this.annotations.push(i);var n=i.frames.length;this.videoDuration>0&&n>0&&i.frames[n-1]>this.videoDuration&&(i.frames[n-1]=this.videoDuration);var r=Object.assign({},t,{shape_id:this.shapes[t.shape],label_id:this.selectedLabel?this.selectedLabel.id:0});return delete r.shape,vA.save({id:this.videoId},r).then(this.addCreatedAnnotation,lu).finally((function(){var t=e.annotations.indexOf(i);-1!==t&&e.annotations.splice(t,1)}))},trackAnnotation:function(t){t.track=!0,this.createAnnotation(t).then(this.startPollTrackingAnnotation)},startPollTrackingAnnotation:function(t){t&&t.startPollTracking()},handleSelectedLabel:function(t){this.selectedLabel=t},handleDeselectedLabel:function(){this.selectedLabel=null},deleteAnnotationsOrKeyframes:function(t){confirm("Are you sure that you want to delete all selected annotations/keyframes?")&&t.forEach(this.deleteAnnotationOrKeyframe)},deleteAnnotationOrKeyframe:function(t){var e=this,i=t.annotation;i.isClip&&i.hasKeyframe(t.time)?i.deleteKeyframe(t.time).catch(lu):i.delete().then((function(){return e.removeAnnotation(i)})).catch(lu)},handleVideoSeeked:function(){this.seeking=!1},modifyAnnotations:function(t){t.forEach(this.modifyAnnotation)},modifyAnnotation:function(t){t.annotation.modify(t.time,t.points).catch(lu)},handleUpdatedSettings:function(t,e){this.settings[t]=e},handleOpenedTab:function(t){pA.set("openTab",t)},handleClosedTab:function(){pA.delete("openTab")},handleToggledTab:function(){this.$refs.videoScreen.updateSize()},removeAnnotation:function(t){var e=this.annotations.indexOf(t);-1!==e&&this.annotations.splice(e,1)},splitAnnotation:function(t,e){t.split(e).then(this.addCreatedAnnotation,lu)},linkAnnotations:function(t){var e=this;t[0].link(t[1]).then((function(){return e.removeAnnotation(t[1])})).catch(lu)},updateMapUrlParams:function(t,e){this.urlParams.x=Math.round(t[0]),this.urlParams.y=Math.round(t[1]),this.urlParams.r=Math.round(100*e)},updateVideoUrlParams:function(){this.urlParams.t=Math.round(100*this.video.currentTime)},restoreUrlParams:function(){void 0!==iu.get("r")&&(this.initialMapResolution=parseInt(iu.get("r"),10)/100),void 0!==iu.get("x")&&void 0!==iu.get("y")&&(this.initialMapCenter=[parseInt(iu.get("x"),10),parseInt(iu.get("y"),10)]),void 0!==iu.get("t")&&(this.initialCurrentTime=parseInt(iu.get("t"),10)/100),void 0!==iu.get("annotation")&&(this.initialFocussedAnnotation=parseInt(iu.get("annotation"),10))},maybeInitCurrentTime:function(){return 0===this.initialCurrentTime||this.selectedAnnotations.length>0?Vue.Promise.resolve():this.seek(this.initialCurrentTime)},maybeFocusInitialAnnotation:function(){var t=this;if(this.initialFocussedAnnotation){var e=this.annotations.find((function(e){return e.id===t.initialFocussedAnnotation}));if(e)return this.selectAnnotation(e,e.startFrame).then((function(){return t.$refs.videoScreen.focusAnnotation(e)}))}return Vue.Promise.resolve()},detachAnnotationLabel:function(t,e){var i=this;t.labels.length>1?t.detachAnnotationLabel(e).catch(lu):confirm("Detaching the last label of an annotation deletes the whole annotation. Do you want to delete the annotation?")&&t.delete().then((function(){return i.removeAnnotation(t)})).catch(lu)},attachAnnotationLabel:function(t){var e=t.attachAnnotationLabel(this.selectedLabel);return e.catch(lu),e},swapAnnotationLabel:function(t){var e=this,i=t.labels.filter((function(t){return t.user_id===e.user.id})).sort((function(t,e){return t.id-e.id})).pop();this.attachAnnotationLabel(t).then((function(){i&&e.detachAnnotationLabel(t,i)})).catch(lu)},initAnnotationFilters:function(){var t={};for(var e in this.shapes)t[this.shapes[e]]=e;this.annotationFilters=[new nA({data:{annotations:this.annotations}}),new sA({data:{annotations:this.annotations}}),new oA({data:{shapes:t}})]},updateAnnotationFilters:function(){this.annotationFilters[0].annotations=this.annotations,this.annotationFilters[1].annotations=this.annotations},setActiveAnnotationFilter:function(t){this.activeAnnotationFilter=t},resetAnnotationFilter:function(){this.activeAnnotationFilter&&this.activeAnnotationFilter.reset(),this.activeAnnotationFilter=null},handleRequiresSelectedLabel:function(){uu.info("Please select a label first."),this.$refs.sidebar.$emit("open","labels")},startUpdateTimelineHeight:function(t){t.preventDefault(),this.resizingTimeline=!0,this.timelineOffsetReference=t.clientY,this.timelineHeightReference=this.$refs.videoTimeline.$el.offsetHeight},updateTimelineHeight:function(t){this.resizingTimeline&&(t.preventDefault(),this.currentTimelineOffset=this.timelineOffsetReference-t.clientY)},finishUpdateTimelineHeight:function(){this.resizingTimeline&&(this.resizingTimeline=!1,this.fixedTimelineOffset=this.fixedTimelineOffset+this.$refs.videoTimeline.$el.offsetHeight-this.timelineHeightReference,this.currentTimelineOffset=0)},handleVideoInformationResponse:function(t){var e=t.body;if(e.error===this.errors["not-found"])throw new ZP;if(e.error===this.errors.mimetype)throw new JP;if(e.error===this.errors.codec)throw new QP;if(e.error===this.errors.malformed)throw new tk;if(e.error===this.errors["too-large"])throw new ek;if(null===e.size)throw new HP;return this.error=null,this.videoDuration=e.duration,e},handleVideoError:function(t){t instanceof YP?this.error=t:(this.error=!0,lu(t))},fetchVideoContent:function(t){var e=this,i=new Vue.Promise((function(t){e.video.addEventListener("canplay",t)})),n=vA.query({id:t.id}),r=Vue.Promise.all([n,i]).then(this.setAnnotations).then(this.updateAnnotationFilters).then(this.maybeFocusInitialAnnotation).then(this.maybeInitCurrentTime);return this.video.src=this.videoFileUri.replace(":id",t.id),r},loadVideo:function(t){return this.videoId=t,Rl.$emit("video.id",t),iu.setSlug(t,-2),this.startLoading(),$d.get({id:t}).then(this.handleVideoInformationResponse).then(this.fetchVideoContent).catch(this.handleVideoError).finally(this.finishLoading)},showPreviousVideo:function(){this.reset();var t=this.videoIds.length,e=(this.videoIds.indexOf(this.videoId)+t-1)%t;this.loadVideo(this.videoIds[e]).then(this.updateVideoUrlParams)},showNextVideo:function(){this.reset();var t=this.videoIds.length,e=(this.videoIds.indexOf(this.videoId)+t+1)%t;this.loadVideo(this.videoIds[e]).then(this.updateVideoUrlParams)},reset:function(){this.annotations=[],this.seeking=!1,this.initialCurrentTime=0,this.initialFocussedAnnotation=0,this.$refs.videoTimeline.reset(),this.$refs.videoScreen.reset()},initVideoIds:function(t){var e=window.localStorage.getItem("biigle.volumes.".concat(this.volumeId,".files"));if(e){var i={};return t.forEach((function(t){i[t]=null})),JSON.parse(e).filter((function(t){return i.hasOwnProperty(t)}))}return t},handleAttachingLabelActive:function(t){this.swappingLabel=!1,this.attachingLabel=t},handleSwappingLabelActive:function(t){this.attachingLabel=!1,this.swappingLabel=t}},watch:{"settings.playbackRate":function(t){this.video.playbackRate=t},urlParams:{deep:!0,handler:function(t){iu.set(t)}}},created:function(){var t=biigle.$require("videos.shapes"),e={};Object.keys(t).forEach((function(i){e[t[i]]=parseInt(i)})),this.shapes=e,this.video=document.createElement("video"),this.videoId=biigle.$require("videos.id"),this.volumeId=biigle.$require("videos.volumeId"),this.videoIds=this.initVideoIds(biigle.$require("videos.videoIds")),this.videoFileUri=biigle.$require("videos.videoFileUri"),this.canEdit=biigle.$require("videos.isEditor"),this.labelTrees=biigle.$require("videos.labelTrees"),this.errors=biigle.$require("videos.errors"),this.user=biigle.$require("videos.user"),this.initAnnotationFilters(),this.restoreUrlParams(),this.video.muted=!0,this.video.addEventListener("error",(function(t){t.target.error.code===MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED?t.target.error.message.startsWith("404")||t.target.error.message.startsWith("403")?uu.danger("Unable to access the video file."):uu.danger("The video file could not be accessed or the codec is not supported by your browser."):t.target.error.code!==MediaError.MEDIA_ERR_ABORTED&&uu.danger("Error while loading video file.")})),this.video.addEventListener("seeked",this.handleVideoSeeked),this.video.addEventListener("pause",this.updateVideoUrlParams),this.video.addEventListener("seeked",this.updateVideoUrlParams),pA.has("openTab")&&(this.openTab=pA.get("openTab"))},mounted:function(){this.loadVideo(this.videoId)}},undefined,undefined,!1,null,null,null).exports;biigle.$mount("search-results",mA),biigle.$mount("video-annotations-navbar",gA),biigle.$mount("video-container",ik)},276:()=>{var t=new Date(0);Vue.filter("videoTime",(function(e){return t.setTime(1e3*e),t.toISOString().split("T")[1].slice(0,-2)}))},924:(t,e,i)=>{"use strict";var n=i(210),r=i(559),o=r(n("String.prototype.indexOf"));t.exports=function(t,e){var i=n(t,!!e);return"function"==typeof i&&o(t,".prototype.")>-1?r(i):i}},559:(t,e,i)=>{"use strict";var n=i(612),r=i(210),o=r("%Function.prototype.apply%"),s=r("%Function.prototype.call%"),a=r("%Reflect.apply%",!0)||n.call(s,o),l=r("%Object.getOwnPropertyDescriptor%",!0),u=r("%Object.defineProperty%",!0),h=r("%Math.max%");if(u)try{u({},"a",{value:1})}catch(t){u=null}t.exports=function(t){var e=a(n,s,arguments);if(l&&u){var i=l(e,"length");i.configurable&&u(e,"length",{value:1+h(0,t.length-(arguments.length-1))})}return e};var c=function(){return a(n,o,arguments)};u?u(t.exports,"apply",{value:c}):t.exports.apply=c},442:(t,e,i)=>{"use strict";i.d(e,{Z:()=>o});var n=i(645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,'.ol-box{border:2px solid blue;border-radius:2px;box-sizing:border-box}.ol-mouse-position{position:absolute;right:8px;top:8px}.ol-scale-line{background:rgba(0,60,136,.3);border-radius:4px;bottom:8px;left:8px;padding:2px;position:absolute}.ol-scale-line-inner{border:1px solid #eee;border-top:none;color:#eee;font-size:10px;margin:1px;text-align:center;will-change:contents,width}.ol-overlay-container{will-change:left,right,top,bottom}.ol-unsupported{display:none}.ol-unselectable,.ol-viewport{-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ol-selectable{-webkit-touch-callout:default;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.ol-grabbing{cursor:-webkit-grabbing;cursor:grabbing}.ol-grab{cursor:move;cursor:-webkit-grab;cursor:grab}.ol-control{background-color:rgba(255,255,255,.4);border-radius:4px;padding:2px;position:absolute}.ol-control:hover{background-color:rgba(255,255,255,.6)}.ol-zoom{left:.5em;top:.5em}.ol-rotate{right:.5em;top:.5em;transition:opacity .25s linear,visibility 0s linear}.ol-rotate.ol-hidden{opacity:0;transition:opacity .25s linear,visibility 0s linear .25s;visibility:hidden}.ol-zoom-extent{left:.5em;top:4.643em}.ol-full-screen{right:.5em;top:.5em}@media print{.ol-control{display:none}}.ol-control button{background-color:rgba(0,60,136,.5);border:none;border-radius:2px;color:#fff;display:block;font-size:1.14em;font-weight:700;height:1.375em;line-height:.4em;margin:1px;padding:0;text-align:center;text-decoration:none;width:1.375em}.ol-control button::-moz-focus-inner{border:none;padding:0}.ol-zoom-extent button{line-height:1.4em}.ol-compass{display:block;font-size:1.2em;font-weight:400;will-change:transform}.ol-touch .ol-control button{font-size:1.5em}.ol-touch .ol-zoom-extent{top:5.5em}.ol-control button:focus,.ol-control button:hover{background-color:rgba(0,60,136,.7);text-decoration:none}.ol-zoom .ol-zoom-in{border-radius:2px 2px 0 0}.ol-zoom .ol-zoom-out{border-radius:0 0 2px 2px}.ol-attribution{bottom:.5em;max-width:calc(100% - 1.3em);right:.5em;text-align:right}.ol-attribution ul{color:#000;font-size:.7rem;line-height:1.375em;margin:0;padding:0 .5em;text-shadow:0 0 2px #fff}.ol-attribution li{display:inline;line-height:inherit;list-style:none}.ol-attribution li:not(:last-child):after{content:" "}.ol-attribution img{max-height:2em;max-width:inherit;vertical-align:middle}.ol-attribution button,.ol-attribution ul{display:inline-block}.ol-attribution.ol-collapsed ul{display:none}.ol-attribution:not(.ol-collapsed){background:rgba(255,255,255,.8)}.ol-attribution.ol-uncollapsible{border-radius:4px 0 0;bottom:0;height:1.1em;line-height:1em;right:0}.ol-attribution.ol-uncollapsible img{margin-top:-.2em;max-height:1.6em}.ol-attribution.ol-uncollapsible button{display:none}.ol-zoomslider{height:200px;left:.5em;top:4.5em}.ol-zoomslider button{height:10px;position:relative}.ol-touch .ol-zoomslider{top:5.5em}.ol-overviewmap{bottom:.5em;left:.5em}.ol-overviewmap.ol-uncollapsible{border-radius:0 4px 0 0;bottom:0;left:0}.ol-overviewmap .ol-overviewmap-map,.ol-overviewmap button{display:inline-block}.ol-overviewmap .ol-overviewmap-map{border:1px solid #7b98bc;height:150px;margin:2px;width:150px}.ol-overviewmap:not(.ol-collapsed) button{bottom:1px;left:2px;position:absolute}.ol-overviewmap.ol-collapsed .ol-overviewmap-map,.ol-overviewmap.ol-uncollapsible button{display:none}.ol-overviewmap:not(.ol-collapsed){background:rgba(255,255,255,.8)}.ol-overviewmap-box{border:2px dotted rgba(0,60,136,.7)}.ol-overviewmap .ol-overviewmap-box:hover{cursor:move}',""]);const o=r},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=t(e);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,n){"string"==typeof t&&(t=[[null,t,""]]);var r={};if(n)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(r[s]=!0)}for(var a=0;a<t.length;a++){var l=[].concat(t[a]);n&&r[l[0]]||(i&&(l[2]?l[2]="".concat(i," and ").concat(l[2]):l[2]=i),e.push(l))}},e}},251:(t,e,i)=>{var n=i(215),r=i(584),o=i(609),s=i(420),a=i(847),l=i(923),u=Date.prototype.getTime;function h(t,e,i){var f=i||{};return!!(f.strict?o(t,e):t===e)||(!t||!e||"object"!=typeof t&&"object"!=typeof e?f.strict?o(t,e):t==e:function(t,e,i){var o,f;if(typeof t!=typeof e)return!1;if(c(t)||c(e))return!1;if(t.prototype!==e.prototype)return!1;if(r(t)!==r(e))return!1;var p=s(t),g=s(e);if(p!==g)return!1;if(p||g)return t.source===e.source&&a(t)===a(e);if(l(t)&&l(e))return u.call(t)===u.call(e);var m=d(t),v=d(e);if(m!==v)return!1;if(m||v){if(t.length!==e.length)return!1;for(o=0;o<t.length;o++)if(t[o]!==e[o])return!1;return!0}if(typeof t!=typeof e)return!1;try{var y=n(t),_=n(e)}catch(t){return!1}if(y.length!==_.length)return!1;for(y.sort(),_.sort(),o=y.length-1;o>=0;o--)if(y[o]!=_[o])return!1;for(o=y.length-1;o>=0;o--)if(!h(t[f=y[o]],e[f],i))return!1;return!0}(t,e,f))}function c(t){return null==t}function d(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(t.length>0&&"number"!=typeof t[0]))}t.exports=h},289:(t,e,i)=>{"use strict";var n=i(215),r="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),o=Object.prototype.toString,s=Array.prototype.concat,a=Object.defineProperty,l=a&&function(){var t={};try{for(var e in a(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),u=function(t,e,i,n){var r;(!(e in t)||"function"==typeof(r=n)&&"[object Function]"===o.call(r)&&n())&&(l?a(t,e,{configurable:!0,enumerable:!1,value:i,writable:!0}):t[e]=i)},h=function(t,e){var i=arguments.length>2?arguments[2]:{},o=n(e);r&&(o=s.call(o,Object.getOwnPropertySymbols(e)));for(var a=0;a<o.length;a+=1)u(t,o[a],e[o[a]],i[o[a]])};h.supportsDescriptors=!!l,t.exports=h},648:t=>{"use strict";var e="Function.prototype.bind called on incompatible ",i=Array.prototype.slice,n=Object.prototype.toString,r="[object Function]";t.exports=function(t){var o=this;if("function"!=typeof o||n.call(o)!==r)throw new TypeError(e+o);for(var s,a=i.call(arguments,1),l=function(){if(this instanceof s){var e=o.apply(this,a.concat(i.call(arguments)));return Object(e)===e?e:this}return o.apply(t,a.concat(i.call(arguments)))},u=Math.max(0,o.length-a.length),h=[],c=0;c<u;c++)h.push("$"+c);if(s=Function("binder","return function ("+h.join(",")+"){ return binder.apply(this,arguments); }")(l),o.prototype){var d=function(){};d.prototype=o.prototype,s.prototype=new d,d.prototype=null}return s}},612:(t,e,i)=>{"use strict";var n=i(648);t.exports=Function.prototype.bind||n},657:(t,e,i)=>{var n=i(251),r=function(t){this.precision=t&&t.precision?t.precision:17,this.direction=!(!t||!t.direction)&&t.direction,this.pseudoNode=!(!t||!t.pseudoNode)&&t.pseudoNode,this.objectComparator=t&&t.objectComparator?t.objectComparator:a};function o(t){return t.coordinates.map((function(e){return{type:t.type.replace("Multi",""),coordinates:e}}))}function s(t,e){return t.hasOwnProperty("coordinates")?t.coordinates.length===e.coordinates.length:t.length===e.length}function a(t,e){return n(t,e,{strict:!0})}r.prototype.compare=function(t,e){if(t.type!==e.type||!s(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates,0,!1);case"Polygon":return this.comparePolygon(t,e);case"Feature":return this.compareFeature(t,e);default:if(0===t.type.indexOf("Multi")){var i=this,n=o(t),r=o(e);return n.every((function(t){return this.some((function(e){return i.compare(t,e)}))}),r)}}return!1},r.prototype.compareCoord=function(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i].toFixed(this.precision)!==e[i].toFixed(this.precision))return!1;return!0},r.prototype.compareLine=function(t,e,i,n){if(!s(t,e))return!1;var r=this.pseudoNode?t:this.removePseudo(t),o=this.pseudoNode?e:this.removePseudo(e);if(!n||this.compareCoord(r[0],o[0])||(o=this.fixStartIndex(o,r))){var a=this.compareCoord(r[i],o[i]);return this.direction||a?this.comparePath(r,o):!!this.compareCoord(r[i],o[o.length-(1+i)])&&this.comparePath(r.slice().reverse(),o)}},r.prototype.fixStartIndex=function(t,e){for(var i,n=-1,r=0;r<t.length;r++)if(this.compareCoord(t[r],e[0])){n=r;break}return n>=0&&(i=[].concat(t.slice(n,t.length),t.slice(1,n+1))),i},r.prototype.comparePath=function(t,e){var i=this;return t.every((function(t,e){return i.compareCoord(t,this[e])}),e)},r.prototype.comparePolygon=function(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){var i=t.coordinates.slice(1,t.coordinates.length),n=e.coordinates.slice(1,e.coordinates.length),r=this;return i.every((function(t){return this.some((function(e){return r.compareLine(t,e,1,!0)}))}),n)}return!1},r.prototype.compareFeature=function(t,e){return!(t.id!==e.id||!this.objectComparator(t.properties,e.properties)||!this.compareBBox(t,e))&&this.compare(t.geometry,e.geometry)},r.prototype.compareBBox=function(t,e){return!!(!t.bbox&&!e.bbox||t.bbox&&e.bbox&&this.compareCoord(t.bbox,e.bbox))},r.prototype.removePseudo=function(t){return t},t.exports=r},787:(t,e,i)=>{var n=i(510),r=i(102),o=i(540),s=i(705).Z,a=o.featureEach,l=(o.coordEach,r.polygon,r.featureCollection);function u(t){var e=n(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),n.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})):a(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})),n.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),n.prototype.remove.call(this,t,e)},e.clear=function(){return n.prototype.clear.call(this)},e.search=function(t){var e=n.prototype.search.call(this,this.toBBox(t));return l(e)},e.collides=function(t){return n.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=n.prototype.all.call(this);return l(t)},e.toJSON=function(){return n.prototype.toJSON.call(this)},e.fromJSON=function(t){return n.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=s(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=s(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=u,t.exports.default=u},210:(t,e,i)=>{"use strict";var n,r=SyntaxError,o=Function,s=TypeError,a=function(t){try{return o('"use strict"; return ('+t+").constructor;")()}catch(t){}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch(t){l=null}var u=function(){throw new s},h=l?function(){try{return u}catch(t){try{return l(arguments,"callee").get}catch(t){return u}}}():u,c=i(405)(),d=Object.getPrototypeOf||function(t){return t.__proto__},f={},p="undefined"==typeof Uint8Array?n:d(Uint8Array),g={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":c?d([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":o,"%GeneratorFunction%":f,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":c?d(d([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&c?d((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&c?d((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":c?d(""[Symbol.iterator]()):n,"%Symbol%":c?Symbol:n,"%SyntaxError%":r,"%ThrowTypeError%":h,"%TypedArray%":p,"%TypeError%":s,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet},m=function t(e){var i;if("%AsyncFunction%"===e)i=a("async function () {}");else if("%GeneratorFunction%"===e)i=a("function* () {}");else if("%AsyncGeneratorFunction%"===e)i=a("async function* () {}");else if("%AsyncGenerator%"===e){var n=t("%AsyncGeneratorFunction%");n&&(i=n.prototype)}else if("%AsyncIteratorPrototype%"===e){var r=t("%AsyncGenerator%");r&&(i=d(r.prototype))}return g[e]=i,i},v={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},y=i(612),_=i(642),b=y.call(Function.call,Array.prototype.concat),w=y.call(Function.apply,Array.prototype.splice),x=y.call(Function.call,String.prototype.replace),S=y.call(Function.call,String.prototype.slice),C=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,T=/\\(\\)?/g,E=function(t){var e=S(t,0,1),i=S(t,-1);if("%"===e&&"%"!==i)throw new r("invalid intrinsic syntax, expected closing `%`");if("%"===i&&"%"!==e)throw new r("invalid intrinsic syntax, expected opening `%`");var n=[];return x(t,C,(function(t,e,i,r){n[n.length]=i?x(r,T,"$1"):e||t})),n},I=function(t,e){var i,n=t;if(_(v,n)&&(n="%"+(i=v[n])[0]+"%"),_(g,n)){var o=g[n];if(o===f&&(o=m(n)),void 0===o&&!e)throw new s("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:o}}throw new r("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new s('"allowMissing" argument must be a boolean');var i=E(t),n=i.length>0?i[0]:"",o=I("%"+n+"%",e),a=o.name,u=o.value,h=!1,c=o.alias;c&&(n=c[0],w(i,b([0,1],c)));for(var d=1,f=!0;d<i.length;d+=1){var p=i[d],m=S(p,0,1),v=S(p,-1);if(('"'===m||"'"===m||"`"===m||'"'===v||"'"===v||"`"===v)&&m!==v)throw new r("property names with quotes must have matching quotes");if("constructor"!==p&&f||(h=!0),_(g,a="%"+(n+="."+p)+"%"))u=g[a];else if(null!=u){if(!(p in u)){if(!e)throw new s("base intrinsic for "+t+" exists, but the property is not available.");return}if(l&&d+1>=i.length){var y=l(u,p);u=(f=!!y)&&"get"in y&&!("originalValue"in y.get)?y.get:u[p]}else f=_(u,p),u=u[p];f&&!h&&(g[a]=u)}}return u}},405:(t,e,i)=>{"use strict";var n="undefined"!=typeof Symbol&&Symbol,r=i(419);t.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&r())))}},419:t=>{"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),i=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(i))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var n=Object.getOwnPropertySymbols(t);if(1!==n.length||n[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var r=Object.getOwnPropertyDescriptor(t,e);if(42!==r.value||!0!==r.enumerable)return!1}return!0}},642:(t,e,i)=>{"use strict";var n=i(612);t.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},584:(t,e,i)=>{"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,r=i(924)("Object.prototype.toString"),o=function(t){return!(n&&t&&"object"==typeof t&&Symbol.toStringTag in t)&&"[object Arguments]"===r(t)},s=function(t){return!!o(t)||null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Array]"!==r(t)&&"[object Function]"===r(t.callee)},a=function(){return o(arguments)}();o.isLegacyArguments=s,t.exports=a?o:s},923:t=>{"use strict";var e=Date.prototype.getDay,i=Object.prototype.toString,n="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;t.exports=function(t){return"object"==typeof t&&null!==t&&(n?function(t){try{return e.call(t),!0}catch(t){return!1}}(t):"[object Date]"===i.call(t))}},420:(t,e,i)=>{"use strict";var n,r,o,s,a=i(924),l=i(405)()&&"symbol"==typeof Symbol.toStringTag;if(l){n=a("Object.prototype.hasOwnProperty"),r=a("RegExp.prototype.exec"),o={};var u=function(){throw o};s={toString:u,valueOf:u},"symbol"==typeof Symbol.toPrimitive&&(s[Symbol.toPrimitive]=u)}var h=a("Object.prototype.toString"),c=Object.getOwnPropertyDescriptor;t.exports=l?function(t){if(!t||"object"!=typeof t)return!1;var e=c(t,"lastIndex");if(!(e&&n(e,"value")))return!1;try{r(t,s)}catch(t){return t===o}}:function(t){return!(!t||"object"!=typeof t&&"function"!=typeof t)&&"[object RegExp]"===h(t)}},252:(t,e,i)=>{t=i.nmd(t);var n,r=((n={}).floodFill=function(t,e,i,n,r,o){return o?function(t,e,i,n,r){var o,s,a,l,u,h,c,d,f,p,g=t.data,m=t.width,v=t.height,y=t.bytes,_=-1,b=m+1,w=-1,x=v+1,S=i*m+e,C=new Uint8Array(m*v),T=new Uint8Array(r||m*v);if(1===T[S])return null;var E=[g[S*=y],g[S+1],g[S+2],g[S+3]],I=[{y:i,left:e-1,right:e+1,dir:1}];do{for(p=!1,s=(l=I.shift()).left+1;s<l.right;s++)if(S=((c=l.y*m)+s)*y,1!==T[c+s]&&(p=!0,C[c+s]=1,T[c+s]=1,!((o=g[S]-E[0])>n||o<-n||(o=g[S+1]-E[1])>n||o<-n||(o=g[S+2]-E[2])>n||o<-n))){for(h=s-1;h>-1&&(S=(d=c+h)*y,1!==T[d])&&(C[d]=1,T[d]=1,h--,!((o=g[S]-E[0])>n||o<-n))&&!((o=g[S+1]-E[1])>n||o<-n)&&!((o=g[S+2]-E[2])>n||o<-n););for(u=s+1;u<m&&(S=(f=c+u)*y,1!==T[f])&&(C[f]=1,T[f]=1,u++,!((o=g[S]-E[0])>n||o<-n))&&!((o=g[S+1]-E[1])>n||o<-n)&&!((o=g[S+2]-E[2])>n||o<-n););h<b&&(b=h+1),u>_&&(_=u-1),(a=l.y-l.dir)>=0&&a<v&&(h<l.left&&I.push({y:a,left:h,right:l.left,dir:-l.dir}),l.right<u&&I.push({y:a,left:l.right,right:u,dir:-l.dir})),(a=l.y+l.dir)>=0&&a<v&&h<u&&I.push({y:a,left:h,right:u,dir:l.dir})}p&&(l.y<x&&(x=l.y),l.y>w&&(w=l.y))}while(I.length>0);return{data:C,width:t.width,height:t.height,bounds:{minX:b,minY:x,maxX:_,maxY:w}}}(t,e,i,n,r):function(t,e,i,n,r){var o,s,a,l,u,h,c,d,f,p,g=t.data,m=t.width,v=t.height,y=t.bytes,_=-1,b=m+1,w=-1,x=v+1,S=i*m+e,C=new Uint8Array(m*v),T=new Uint8Array(r||m*v);if(1===T[S])return null;var E=[g[S*=y],g[S+1],g[S+2],g[S+3]],I=[{y:i,left:e-1,right:e+1,dir:1}];do{for(p=!1,s=(l=I.shift()).left+1;s<l.right;s++)if(S=((c=l.y*m)+s)*y,1!==T[c+s]&&!((o=g[S]-E[0])>n||o<-n||(o=g[S+1]-E[1])>n||o<-n||(o=g[S+2]-E[2])>n||o<-n)){for(p=!0,C[c+s]=1,T[c+s]=1,h=s-1;h>-1&&(S=(d=c+h)*y,1!==T[d])&&!((o=g[S]-E[0])>n||o<-n)&&!((o=g[S+1]-E[1])>n||o<-n)&&!((o=g[S+2]-E[2])>n||o<-n);)C[d]=1,T[d]=1,h--;for(u=s+1;u<m&&(S=(f=c+u)*y,1!==T[f])&&!((o=g[S]-E[0])>n||o<-n)&&!((o=g[S+1]-E[1])>n||o<-n)&&!((o=g[S+2]-E[2])>n||o<-n);)C[f]=1,T[f]=1,u++;h<b&&(b=h+1),u>_&&(_=u-1),(a=l.y-l.dir)>=0&&a<v&&(h<l.left&&I.push({y:a,left:h,right:l.left,dir:-l.dir}),l.right<u&&I.push({y:a,left:l.right,right:u,dir:-l.dir})),(a=l.y+l.dir)>=0&&a<v&&h<u&&I.push({y:a,left:h,right:u,dir:l.dir})}p&&(l.y<x&&(x=l.y),l.y>w&&(w=l.y))}while(I.length>0);return{data:C,width:t.width,height:t.height,bounds:{minX:b,minY:x,maxX:_,maxY:w}}}(t,e,i,n,r)},n.gaussBlur=function(t,e){var i,n,r,o,s,a,l,u=2*e+1,h=e*e,c=new Float32Array(u),d=0,f=t.width,p=t.height,g=t.data,m=t.bounds.minX,v=t.bounds.maxX,y=t.bounds.minY,_=t.bounds.maxY;for(i=0;i<e;i++){var b=(e-i)*(e-i),w=Math.exp(-b/(2*h))/(2*Math.PI*h);c[e+i]=c[e-i]=w,d+=2*w}for(i=0;i<u;i++)c[i]/=d;var x=new Uint8Array(f*p),S=e+f,C=e+p;for(s=y;s<_+1;s++)for(o=m;o<v+1;o++){for(a=0,l=S-o<u?S-o:u,r=(n=s*f+o)-e,i=e-o>0?e-o:0;i<l;i++)a+=g[r+i]*c[i];for(l=C-s<u?C-s:u,r=n-e*f,i=e-s>0?e-s:0;i<l;i++)a+=g[r+i*f]*c[i];x[n]=a>.5?1:0}return{data:x,width:f,height:p,bounds:{minX:m,minY:y,maxX:v,maxY:_}}},n.gaussBlurOnlyBorder=function(t,e,i){var n,r,o,s,a,l,u,h,c,d,f=function(t,e,i){var n,r,o,s,a,l,u,h=t.width,c=t.height,d=t.data,f=new Uint8Array(d),p=t.bounds.minX,g=t.bounds.maxX,m=t.bounds.minY,v=t.bounds.maxY,y=h*c,_=new Uint8Array(y),b=[],w=Math.max(p,1),x=Math.min(g,h-2),S=Math.max(m,1),C=Math.min(v,c-2);if(i&&i.length>0)for(a=0;a<y;a++)1===i[a]&&(f[a]=1);for(s=S;s<C+1;s++)for(n=w;n<x+1;n++)0!==d[a=s*h+n]&&(l=a+h,u=a-h,0!==f[a+1]&&0!==f[a-1]&&0!==f[l]&&0!==f[l+1]&&0!==f[l-1]&&0!==f[u]&&0!==f[u+1]&&0!==f[u-1]||b.push(a));if(0==p)for(s=m;s<v+1;s++)1===d[s*h]&&b.push(s*h);if(g==h-1)for(s=m;s<v+1;s++)1===d[s*h+g]&&b.push(s*h+g);if(0==m)for(n=p;n<g+1;n++)1===d[n]&&b.push(n);if(v==c-1)for(n=p;n<g+1;n++)1===d[v*h+n]&&b.push(v*h+n);var T,E=[],I=e+h,A=e+c,P=2*e+1;for(y=b.length,o=0;o<y;o++){for(_[a=b[o]]=1,E.push(a),s=(a-(n=a%h))/h,T=I-n<P?I-n:P,l=a-e,r=e-n>0?e-n:0;r<T;r++)0===_[u=l+r]&&(_[u]=1,E.push(u));for(T=A-s<P?A-s:P,l=a-e*h,r=e-s>0?e-s:0;r<T;r++)0===_[u=l+r*h]&&(_[u]=1,E.push(u))}return E}(t,e,i),p=2*e+1,g=2*e*e,m=new Float32Array(p),v=0,y=t.width,_=t.height,b=t.data,w=t.bounds.minX,x=t.bounds.maxX,S=t.bounds.minY,C=t.bounds.maxY,T=f.length;for(o=0;o<e;o++)r=(e-o)*(e-o),n=Math.exp(-r/g)/Math.PI,m[e+o]=m[e-o]=n,v+=2*n;for(o=0;o<p;o++)m[o]/=v;var E=new Uint8Array(b),I=e+y,A=e+_;for(o=0;o<T;o++){for(c=0,h=((a=f[o])-(u=a%y))/y,d=I-u<p?I-u:p,l=a-e,s=e-u>0?e-u:0;s<d;s++)c+=b[l+s]*m[s];if(c>.5)E[a]=1,u<w&&(w=u),u>x&&(x=u),h<S&&(S=h),h>C&&(C=h);else{for(d=A-h<p?A-h:p,l=a-e*y,s=e-h>0?e-h:0;s<d;s++)c+=b[l+s*y]*m[s];c>.5?(E[a]=1,u<w&&(w=u),u>x&&(x=u),h<S&&(S=h),h>C&&(C=h)):E[a]=0}}return{data:E,width:y,height:_,bounds:{minX:w,minY:S,maxX:x,maxY:C}}},n.createBorderMask=function(t){var e,i,n,r,o,s=t.width,a=t.height,l=t.data,u=t.bounds.minX,h=t.bounds.maxX,c=t.bounds.minY,d=t.bounds.maxY,f=h-u+1,p=d-c+1,g=new Uint8Array(f*p),m=Math.max(u,1),v=Math.min(h,s-2),y=Math.max(c,1),_=Math.min(d,a-2);for(i=y;i<_+1;i++)for(e=m;e<v+1;e++)0!==l[n=i*s+e]&&(r=n+s,o=n-s,0!==l[n+1]&&0!==l[n-1]&&0!==l[r]&&0!==l[r+1]&&0!==l[r-1]&&0!==l[o]&&0!==l[o+1]&&0!==l[o-1]||(g[(i-c)*f+(e-u)]=1));if(0==u)for(i=c;i<d+1;i++)1===l[i*s]&&(g[(i-c)*f]=1);if(h==s-1)for(i=c;i<d+1;i++)1===l[i*s+h]&&(g[(i-c)*f+(h-u)]=1);if(0==c)for(e=u;e<h+1;e++)1===l[e]&&(g[e-u]=1);if(d==a-1)for(e=u;e<h+1;e++)1===l[d*s+e]&&(g[(d-c)*f+(e-u)]=1);return{data:g,width:f,height:p,offset:{x:u,y:c}}},n.getBorderIndices=function(t){var e,i,n,r,o,s=t.width,a=t.height,l=t.data,u=[],h=s-1,c=a-1;for(i=1;i<c;i++)for(e=1;e<h;e++)0!==l[n=i*s+e]&&(r=n+s,o=n-s,0!==l[n+1]&&0!==l[n-1]&&0!==l[r]&&0!==l[r+1]&&0!==l[r-1]&&0!==l[o]&&0!==l[o+1]&&0!==l[o-1]||u.push(n));for(i=0;i<a;i++)1===l[i*s]&&u.push(i*s);for(e=0;e<s;e++)1===l[e]&&u.push(e);for(n=s-1,i=0;i<a;i++)1===l[i*s+n]&&u.push(i*s+n);for(n=(a-1)*s,e=0;e<s;e++)1===l[n+e]&&u.push(n+e);return u},n.traceContours=function(t){var e,i,n,r,o,s,a,l,u,h,c,d,f,p,g,m=function(t){var e,i,n=t.width,r=t.data,o=t.bounds.minX,s=t.bounds.maxX,a=t.bounds.minY,l=t.bounds.maxY,u=s-o+3,h=l-a+3,c=new Uint8Array(u*h);for(i=a;i<l+1;i++)for(e=o;e<s+1;e++)1===r[i*n+e]&&(c[(i-a+1)*u+(e-o+1)]=1);return{data:c,width:u,height:h,offset:{x:o-1,y:a-1}}}(t),v=[],y=0,_=m.width,b=2*_,w=m.height,x=m.data,S=m.offset.x,C=m.offset.y,T=new Uint8Array(x),E=[[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1]];for(r=1;r<w-1;r++)for(n=1;n<_-1;n++)if(1===x[o=r*_+n])for(e=-_;e<b;e+=b)if(0===x[o+e]&&0===T[o+e]){for(y++,a=[],u=(l=e===_)?2:6,d=f=h={x:n,y:r},c=null;;){for(T[d.y*_+d.x]=y,i=0;i<8;i++){if(g=E[u=(u+1)%8],1===x[s=(p={x:d.x+g[0],y:d.y+g[1]}).y*_+p.x]){T[s]=y;break}T[s]=-1,p=null}if(null===p)break;if(d=p,c){if(f.x===h.x&&f.y===h.y&&d.x===c.x&&d.y===c.y)break}else c=p;a.push({x:f.x+S,y:f.y+C}),f=d,u=(u+4)%8}null!=p&&(a.push({x:h.x+S,y:h.y+C}),v.push({inner:l,label:y,points:a}))}return v},n.simplifyContours=function(t,e,i){var n,r,o,s,a,l,u,h,c,d,f,p,g,m,v,y,_,b,w,x,S,C=t.length,T=[];for(r=0;r<C;r++)if(a=(s=t[r]).points,(l=s.points.length)<i){for(u=[],o=0;o<l;o++)u.push({x:a[o].x,y:a[o].y});T.push({inner:s.inner,label:s.label,points:u,initialCount:l})}else{h=[0,l-1],c=[{first:0,last:l-1}];do{if(!((d=c.shift()).last<=d.first+1)){for(f=-1,p=d.first,n=d.first+1;n<d.last;n++)w=a[n],x=a[d.first],S=a[d.last],_=w.x-x.x,b=w.y-x.y,m=Math.sqrt(_*_+b*b),_=w.x-S.x,b=w.y-S.y,v=Math.sqrt(_*_+b*b),_=x.x-S.x,b=x.y-S.y,y=Math.sqrt(_*_+b*b),(g=m>=Math.sqrt(v*v+y*y)?v:v>=Math.sqrt(m*m+y*y)?m:Math.abs((b*w.x-_*w.y+x.x*S.y-S.x*x.y)/y))>f&&(p=n,f=g);f>e&&(h.push(p),c.push({first:d.first,last:p}),c.push({first:p,last:d.last}))}}while(c.length>0);for(u=[],l=h.length,h.sort((function(t,e){return t-e})),o=0;o<l;o++)u.push({x:a[h[o]].x,y:a[h[o]].y});T.push({inner:s.inner,label:s.label,points:u,initialCount:s.points.length})}return T},n);null!==t&&(t.exports=r),"undefined"!=typeof window&&null!==window&&(window.MagicWand=r)},209:function(t,e){!function(t){"use strict";function e(t,e){return t>e?1:t<e?-1:0}var i=function(t,i){void 0===t&&(t=e),void 0===i&&(i=!1),this._compare=t,this._root=null,this._size=0,this._noDuplicates=!!i},n={size:{configurable:!0}};function r(t,e,i,n,o){var s=o-n;if(s>0){var a=n+Math.floor(s/2),l={key:e[a],data:i[a],parent:t};return l.left=r(l,e,i,n,a),l.right=r(l,e,i,a+1,o),l}return null}function o(t,e,i,n,r){if(!(i>=n)){for(var s=t[i+n>>1],a=i-1,l=n+1;;){do{a++}while(r(t[a],s)<0);do{l--}while(r(t[l],s)>0);if(a>=l)break;var u=t[a];t[a]=t[l],t[l]=u,u=e[a],e[a]=e[l],e[l]=u}o(t,e,i,l,r),o(t,e,l+1,n,r)}}i.prototype.rotateLeft=function(t){var e=t.right;e&&(t.right=e.left,e.left&&(e.left.parent=t),e.parent=t.parent),t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.left=t),t.parent=e},i.prototype.rotateRight=function(t){var e=t.left;e&&(t.left=e.right,e.right&&(e.right.parent=t),e.parent=t.parent),t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.right=t),t.parent=e},i.prototype._splay=function(t){for(;t.parent;){var e=t.parent;e.parent?e.left===t&&e.parent.left===e?(this.rotateRight(e.parent),this.rotateRight(e)):e.right===t&&e.parent.right===e?(this.rotateLeft(e.parent),this.rotateLeft(e)):e.left===t&&e.parent.right===e?(this.rotateRight(e),this.rotateLeft(e)):(this.rotateLeft(e),this.rotateRight(e)):e.left===t?this.rotateRight(e):this.rotateLeft(e)}},i.prototype.splay=function(t){for(var e,i,n,r,o;t.parent;)(i=(e=t.parent).parent)&&i.parent?((n=i.parent).left===i?n.left=t:n.right=t,t.parent=n):(t.parent=null,this._root=t),r=t.left,o=t.right,t===e.left?(i&&(i.left===e?(e.right?(i.left=e.right,i.left.parent=i):i.left=null,e.right=i,i.parent=e):(r?(i.right=r,r.parent=i):i.right=null,t.left=i,i.parent=t)),o?(e.left=o,o.parent=e):e.left=null,t.right=e,e.parent=t):(i&&(i.right===e?(e.left?(i.right=e.left,i.right.parent=i):i.right=null,e.left=i,i.parent=e):(o?(i.left=o,o.parent=i):i.left=null,t.right=i,i.parent=t)),r?(e.right=r,r.parent=e):e.right=null,t.left=e,e.parent=t)},i.prototype.replace=function(t,e){t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.parent=t.parent)},i.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},i.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},i.prototype.insert=function(t,e){var i=this._root,n=null,r=this._compare;if(this._noDuplicates)for(;i;){if(n=i,0===r(i.key,t))return;i=r(i.key,t)<0?i.right:i.left}else for(;i;)n=i,i=r(i.key,t)<0?i.right:i.left;return i={key:t,data:e,left:null,right:null,parent:n},n?r(n.key,i.key)<0?n.right=i:n.left=i:this._root=i,this.splay(i),this._size++,i},i.prototype.find=function(t){for(var e=this._root,i=this._compare;e;){var n=i(e.key,t);if(n<0)e=e.right;else{if(!(n>0))return e;e=e.left}}return null},i.prototype.contains=function(t){for(var e=this._root,i=this._compare;e;){var n=i(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1},i.prototype.remove=function(t){var e=this.find(t);if(!e)return!1;if(this.splay(e),e.left)if(e.right){var i=this.minNode(e.right);i.parent!==e&&(this.replace(i,i.right),i.right=e.right,i.right.parent=i),this.replace(e,i),i.left=e.left,i.left.parent=i}else this.replace(e,e.left);else this.replace(e,e.right);return this._size--,!0},i.prototype.removeNode=function(t){if(!t)return!1;if(this.splay(t),t.left)if(t.right){var e=this.minNode(t.right);e.parent!==t&&(this.replace(e,e.right),e.right=t.right,e.right.parent=e),this.replace(t,e),e.left=t.left,e.left.parent=e}else this.replace(t,t.left);else this.replace(t,t.right);return this._size--,!0},i.prototype.erase=function(t){var e=this.find(t);if(e){this.splay(e);var i=e.left,n=e.right,r=null;i&&(i.parent=null,r=this.maxNode(i),this.splay(r),this._root=r),n&&(i?r.right=n:this._root=n,n.parent=r),this._size--}},i.prototype.pop=function(){var t=this._root,e=null;if(t){for(;t.left;)t=t.left;e={key:t.key,data:t.data},this.remove(t.key)}return e},i.prototype.next=function(t){var e=t;if(e)if(e.right)for(e=e.right;e&&e.left;)e=e.left;else for(e=t.parent;e&&e.right===t;)t=e,e=e.parent;return e},i.prototype.prev=function(t){var e=t;if(e)if(e.left)for(e=e.left;e&&e.right;)e=e.right;else for(e=t.parent;e&&e.left===t;)t=e,e=e.parent;return e},i.prototype.forEach=function(t){for(var e=this._root,i=[],n=!1,r=0;!n;)e?(i.push(e),e=e.left):i.length>0?(t(e=i.pop(),r++),e=e.right):n=!0;return this},i.prototype.range=function(t,e,i,n){for(var r=[],o=this._compare,s=this._root;0!==r.length||s;)if(s)r.push(s),s=s.left;else{if(o((s=r.pop()).key,e)>0)break;if(o(s.key,t)>=0&&i.call(n,s))return this;s=s.right}return this},i.prototype.keys=function(){for(var t=this._root,e=[],i=[],n=!1;!n;)t?(e.push(t),t=t.left):e.length>0?(t=e.pop(),i.push(t.key),t=t.right):n=!0;return i},i.prototype.values=function(){for(var t=this._root,e=[],i=[],n=!1;!n;)t?(e.push(t),t=t.left):e.length>0?(t=e.pop(),i.push(t.data),t=t.right):n=!0;return i},i.prototype.at=function(t){for(var e=this._root,i=[],n=!1,r=0;!n;)if(e)i.push(e),e=e.left;else if(i.length>0){if(e=i.pop(),r===t)return e;r++,e=e.right}else n=!0;return null},i.prototype.load=function(t,e,i){if(void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===i&&(i=!1),0!==this._size)throw new Error("bulk-load: tree is not empty");var n=t.length;return i&&o(t,e,0,n-1,this._compare),this._root=r(null,t,e,0,n),this._size=n,this},i.prototype.min=function(){var t=this.minNode(this._root);return t?t.key:null},i.prototype.max=function(){var t=this.maxNode(this._root);return t?t.key:null},i.prototype.isEmpty=function(){return null===this._root},n.size.get=function(){return this._size},i.createTree=function(t,e,n,r,o){return new i(n,o).load(t,e,r)},Object.defineProperties(i.prototype,n);var s=0,a=1,l=2,u=3,h=0,c=1,d=2,f=3;function p(t,e,i){null===e?(t.inOut=!1,t.otherInOut=!0):(t.isSubject===e.isSubject?(t.inOut=!e.inOut,t.otherInOut=e.otherInOut):(t.inOut=!e.otherInOut,t.otherInOut=e.isVertical()?!e.inOut:e.inOut),e&&(t.prevInResult=!g(e,i)||e.isVertical()?e.prevInResult:e));var n=g(t,i);t.resultTransition=n?m(t,i):0}function g(t,e){switch(t.type){case s:switch(e){case h:return!t.otherInOut;case c:return t.otherInOut;case d:return t.isSubject&&t.otherInOut||!t.isSubject&&!t.otherInOut;case f:return!0}break;case l:return e===h||e===c;case u:return e===d;case a:return!1}return!1}function m(t,e){var i,n=!t.inOut,r=!t.otherInOut;switch(e){case h:i=n&&r;break;case c:i=n||r;break;case f:i=n^r;break;case d:i=t.isSubject?n&&!r:r&&!n}return i?1:-1}var v=function(t,e,i,n,r){this.left=e,this.point=t,this.otherEvent=i,this.isSubject=n,this.type=r||s,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},y={inResult:{configurable:!0}};function _(t,e){return t[0]===e[0]&&t[1]===e[1]}v.prototype.isBelow=function(t){var e=this.point,i=this.otherEvent.point;return this.left?(e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1])>0:(i[0]-t[0])*(e[1]-t[1])-(e[0]-t[0])*(i[1]-t[1])>0},v.prototype.isAbove=function(t){return!this.isBelow(t)},v.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},y.inResult.get=function(){return 0!==this.resultTransition},v.prototype.clone=function(){var t=new v(this.point,this.left,this.otherEvent,this.isSubject,this.type);return t.contourId=this.contourId,t.resultTransition=this.resultTransition,t.prevInResult=this.prevInResult,t.isExteriorRing=this.isExteriorRing,t.inOut=this.inOut,t.otherInOut=this.otherInOut,t},Object.defineProperties(v.prototype,y);var b=11102230246251565e-32,w=134217729,x=(3+8*b)*b;function S(t,e,i,n,r){var o,s,a,l,u=e[0],h=n[0],c=0,d=0;h>u==h>-u?(o=u,u=e[++c]):(o=h,h=n[++d]);var f=0;if(c<t&&d<i)for(h>u==h>-u?(a=o-((s=u+o)-u),u=e[++c]):(a=o-((s=h+o)-h),h=n[++d]),o=s,0!==a&&(r[f++]=a);c<t&&d<i;)h>u==h>-u?(a=o-((s=o+u)-(l=s-o))+(u-l),u=e[++c]):(a=o-((s=o+h)-(l=s-o))+(h-l),h=n[++d]),o=s,0!==a&&(r[f++]=a);for(;c<t;)a=o-((s=o+u)-(l=s-o))+(u-l),u=e[++c],o=s,0!==a&&(r[f++]=a);for(;d<i;)a=o-((s=o+h)-(l=s-o))+(h-l),h=n[++d],o=s,0!==a&&(r[f++]=a);return 0===o&&0!==f||(r[f++]=o),f}function C(t,e){for(var i=e[0],n=1;n<t;n++)i+=e[n];return i}function T(t){return new Float64Array(t)}var E=(3+16*b)*b,I=(2+12*b)*b,A=(9+64*b)*b*b,P=T(4),k=T(8),R=T(12),L=T(16),F=T(4);function M(t,e,i,n,r,o,s){var a,l,u,h,c,d,f,p,g,m,v,y,_,b,T,E,M,O,$=t-r,D=i-r,j=e-o,N=n-o;c=(T=(p=$-(f=(d=w*$)-(d-$)))*(m=N-(g=(d=w*N)-(d-N)))-((b=$*N)-f*g-p*g-f*m))-(v=T-(M=(p=j-(f=(d=w*j)-(d-j)))*(m=D-(g=(d=w*D)-(d-D)))-((E=j*D)-f*g-p*g-f*m))),P[0]=T-(v+c)+(c-M),c=(_=b-((y=b+v)-(c=y-b))+(v-c))-(v=_-E),P[1]=_-(v+c)+(c-E),c=(O=y+v)-y,P[2]=y-(O-c)+(v-c),P[3]=O;var B=C(4,P),U=I*s;if(B>=U||-B>=U)return B;if(a=t-($+(c=t-$))+(c-r),u=i-(D+(c=i-D))+(c-r),l=e-(j+(c=e-j))+(c-o),h=n-(N+(c=n-N))+(c-o),0===a&&0===l&&0===u&&0===h)return B;if(U=A*s+x*Math.abs(B),(B+=$*h+N*a-(j*u+D*l))>=U||-B>=U)return B;c=(T=(p=a-(f=(d=w*a)-(d-a)))*(m=N-(g=(d=w*N)-(d-N)))-((b=a*N)-f*g-p*g-f*m))-(v=T-(M=(p=l-(f=(d=w*l)-(d-l)))*(m=D-(g=(d=w*D)-(d-D)))-((E=l*D)-f*g-p*g-f*m))),F[0]=T-(v+c)+(c-M),c=(_=b-((y=b+v)-(c=y-b))+(v-c))-(v=_-E),F[1]=_-(v+c)+(c-E),c=(O=y+v)-y,F[2]=y-(O-c)+(v-c),F[3]=O;var z=S(4,P,4,F,k);c=(T=(p=$-(f=(d=w*$)-(d-$)))*(m=h-(g=(d=w*h)-(d-h)))-((b=$*h)-f*g-p*g-f*m))-(v=T-(M=(p=j-(f=(d=w*j)-(d-j)))*(m=u-(g=(d=w*u)-(d-u)))-((E=j*u)-f*g-p*g-f*m))),F[0]=T-(v+c)+(c-M),c=(_=b-((y=b+v)-(c=y-b))+(v-c))-(v=_-E),F[1]=_-(v+c)+(c-E),c=(O=y+v)-y,F[2]=y-(O-c)+(v-c),F[3]=O;var V=S(z,k,4,F,R);c=(T=(p=a-(f=(d=w*a)-(d-a)))*(m=h-(g=(d=w*h)-(d-h)))-((b=a*h)-f*g-p*g-f*m))-(v=T-(M=(p=l-(f=(d=w*l)-(d-l)))*(m=u-(g=(d=w*u)-(d-u)))-((E=l*u)-f*g-p*g-f*m))),F[0]=T-(v+c)+(c-M),c=(_=b-((y=b+v)-(c=y-b))+(v-c))-(v=_-E),F[1]=_-(v+c)+(c-E),c=(O=y+v)-y,F[2]=y-(O-c)+(v-c),F[3]=O;var G=S(V,R,4,F,L);return L[G-1]}function O(t,e,i,n,r,o){var s=(e-o)*(i-r),a=(t-r)*(n-o),l=s-a;if(0===s||0===a||s>0!=a>0)return l;var u=Math.abs(s+a);return Math.abs(l)>=E*u?l:-M(t,e,i,n,r,o,u)}function $(t,e,i){var n=O(t[0],t[1],e[0],e[1],i[0],i[1]);return n>0?-1:n<0?1:0}function D(t,e){var i=t.point,n=e.point;return i[0]>n[0]?1:i[0]<n[0]?-1:i[1]!==n[1]?i[1]>n[1]?1:-1:j(t,e,i)}function j(t,e,i,n){return t.left!==e.left?t.left?1:-1:0!==$(i,t.otherEvent.point,e.otherEvent.point)?t.isBelow(e.otherEvent.point)?-1:1:!t.isSubject&&e.isSubject?1:-1}function N(t,e,i){var n=new v(e,!1,t,t.isSubject),r=new v(e,!0,t.otherEvent,t.isSubject);return _(t.point,t.otherEvent.point)&&console.warn("what is that, a collapsed segment?",t),n.contourId=r.contourId=t.contourId,D(r,t.otherEvent)>0&&(t.otherEvent.left=!0,r.left=!1),t.otherEvent.otherEvent=r,t.otherEvent=n,i.push(r),i.push(n),i}function B(t,e){return t[0]*e[1]-t[1]*e[0]}function U(t,e){return t[0]*e[0]+t[1]*e[1]}function z(t,e,i,n,r){var o=[e[0]-t[0],e[1]-t[1]],s=[n[0]-i[0],n[1]-i[1]];function a(t,e,i){return[t[0]+e*i[0],t[1]+e*i[1]]}var l=[i[0]-t[0],i[1]-t[1]],u=B(o,s),h=u*u,c=U(o,o);if(h>0){var d=B(l,s)/u;if(d<0||d>1)return null;var f=B(l,o)/u;return f<0||f>1?null:0===d||1===d?r?null:[a(t,d,o)]:0===f||1===f?r?null:[a(i,f,s)]:[a(t,d,o)]}if((h=(u=B(l,o))*u)>0)return null;var p=U(o,l)/c,g=p+U(o,s)/c,m=Math.min(p,g),v=Math.max(p,g);return m<=1&&v>=0?1===m?r?null:[a(t,m>0?m:0,o)]:0===v?r?null:[a(t,v<1?v:1,o)]:r&&0===m&&1===v?null:[a(t,m>0?m:0,o),a(t,v<1?v:1,o)]:null}function V(t,e,i){var n=z(t.point,t.otherEvent.point,e.point,e.otherEvent.point),r=n?n.length:0;if(0===r)return 0;if(1===r&&(_(t.point,e.point)||_(t.otherEvent.point,e.otherEvent.point)))return 0;if(2===r&&t.isSubject===e.isSubject)return 0;if(1===r)return _(t.point,n[0])||_(t.otherEvent.point,n[0])||N(t,n[0],i),_(e.point,n[0])||_(e.otherEvent.point,n[0])||N(e,n[0],i),1;var o=[],s=!1,h=!1;return _(t.point,e.point)?s=!0:1===D(t,e)?o.push(e,t):o.push(t,e),_(t.otherEvent.point,e.otherEvent.point)?h=!0:1===D(t.otherEvent,e.otherEvent)?o.push(e.otherEvent,t.otherEvent):o.push(t.otherEvent,e.otherEvent),s&&h||s?(e.type=a,t.type=e.inOut===t.inOut?l:u,s&&!h&&N(o[1].otherEvent,o[0].point,i),2):h?(N(o[0],o[1].point,i),3):o[0]!==o[3].otherEvent?(N(o[0],o[1].point,i),N(o[1],o[2].point,i),3):(N(o[0],o[1].point,i),N(o[3].otherEvent,o[2].point,i),3)}function G(t,e){if(t===e)return 0;if(0!==$(t.point,t.otherEvent.point,e.point)||0!==$(t.point,t.otherEvent.point,e.otherEvent.point))return _(t.point,e.point)?t.isBelow(e.otherEvent.point)?-1:1:t.point[0]===e.point[0]?t.point[1]<e.point[1]?-1:1:1===D(t,e)?e.isAbove(t.point)?-1:1:t.isBelow(e.point)?-1:1;if(t.isSubject!==e.isSubject)return t.isSubject?-1:1;var i=t.point,n=e.point;return i[0]===n[0]&&i[1]===n[1]?(i=t.otherEvent.point,n=e.otherEvent.point,i[0]===n[0]&&i[1]===n[1]?0:t.contourId>e.contourId?1:-1):1===D(t,e)?1:-1}function q(t,e,n,r,o,s){for(var a,l,u,c=new i(G),f=[],g=Math.min(r[2],o[2]);0!==t.length;){var m=t.pop();if(f.push(m),s===h&&m.point[0]>g||s===d&&m.point[0]>r[2])break;if(m.left){l=a=c.insert(m),a=a!==(u=c.minNode())?c.prev(a):null,l=c.next(l);var v=a?a.key:null;if(p(m,v,s),l&&2===V(m,l.key,t)&&(p(m,v,s),p(m,l.key,s)),a&&2===V(a.key,m,t)){var y=a;p(v,(y=y!==u?c.prev(y):null)?y.key:null,s),p(m,v,s)}}else m=m.otherEvent,l=a=c.find(m),a&&l&&(a=a!==u?c.prev(a):null,l=c.next(l),c.remove(m),l&&a&&V(a.key,l.key,t))}return f}var W=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function K(t){var e,i,n,r,o=[];for(i=0,n=t.length;i<n;i++)((e=t[i]).left&&e.inResult||!e.left&&e.otherEvent.inResult)&&o.push(e);for(var s=!1;!s;)for(s=!0,i=0,n=o.length;i<n;i++)i+1<n&&1===D(o[i],o[i+1])&&(r=o[i],o[i]=o[i+1],o[i+1]=r,s=!1);for(i=0,n=o.length;i<n;i++)(e=o[i]).otherPos=i;for(i=0,n=o.length;i<n;i++)(e=o[i]).left||(r=e.otherPos,e.otherPos=e.otherEvent.otherPos,e.otherEvent.otherPos=r);return o}function X(t,e,i,n){var r,o=t+1,s=e[t].point,a=e.length;for(o<a&&(r=e[o].point);o<a&&r[0]===s[0]&&r[1]===s[1];){if(!i[o])return o;r=e[++o].point}for(o=t-1;i[o]&&o>n;)o--;return o}function Y(t,e,i){var n=new W;if(null!=t.prevInResult){var r=t.prevInResult,o=r.outputContourId;if(r.resultTransition>0){var s=e[o];if(null!=s.holeOf){var a=s.holeOf;e[a].holeIds.push(i),n.holeOf=a,n.depth=e[o].depth}else e[o].holeIds.push(i),n.holeOf=o,n.depth=e[o].depth+1}else n.holeOf=null,n.depth=e[o].depth}else n.holeOf=null,n.depth=0;return n}function H(t){var e,i,n=K(t),r={},o=[],s=function(){if(!r[e]){var t=o.length,i=Y(n[e],o,t),s=function(e){r[e]=!0,n[e].outputContourId=t},a=e,l=e,u=n[e].point;for(i.points.push(u);s(a),s(a=n[a].otherPos),i.points.push(n[a].point),(a=X(a,n,r,l))!=l;);o.push(i)}};for(e=0,i=n.length;e<i;e++)s();return o}W.prototype.isExterior=function(){return null==this.holeOf};var Z=Q,J=Q;function Q(t,e){if(!(this instanceof Q))return new Q(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||tt,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)}function tt(t,e){return t<e?-1:t>e?1:0}Q.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,i=this.compare,n=e[t];t>0;){var r=t-1>>1,o=e[r];if(i(n,o)>=0)break;e[t]=o,t=r}e[t]=n},_down:function(t){for(var e=this.data,i=this.compare,n=this.length>>1,r=e[t];t<n;){var o=1+(t<<1),s=o+1,a=e[o];if(s<this.length&&i(e[s],a)<0&&(o=s,a=e[s]),i(a,r)>=0)break;e[t]=a,t=o}e[t]=r}},Z.default=J;var et=Math.max,it=Math.min,nt=0;function rt(t,e,i,n,r,o){var s,a,l,u,h,c;for(s=0,a=t.length-1;s<a;s++)if(l=t[s],u=t[s+1],h=new v(l,!1,void 0,e),c=new v(u,!1,h,e),h.otherEvent=c,l[0]!==u[0]||l[1]!==u[1]){h.contourId=c.contourId=i,o||(h.isExteriorRing=!1,c.isExteriorRing=!1),D(h,c)>0?c.left=!0:h.left=!0;var d=l[0],f=l[1];r[0]=it(r[0],d),r[1]=it(r[1],f),r[2]=et(r[2],d),r[3]=et(r[3],f),n.push(h),n.push(c)}}function ot(t,e,i,n,r){var o,s,a,l,u,h,c=new Z(null,D);for(a=0,l=t.length;a<l;a++)for(u=0,h=(o=t[a]).length;u<h;u++)(s=0===u)&&nt++,rt(o[u],!0,nt,c,i,s);for(a=0,l=e.length;a<l;a++)for(u=0,h=(o=e[a]).length;u<h;u++)s=0===u,r===d&&(s=!1),s&&nt++,rt(o[u],!1,nt,c,n,s);return c}var st=[];function at(t,e,i){var n=null;return t.length*e.length==0&&(i===h?n=st:i===d?n=t:i!==c&&i!==f||(n=0===t.length?e:t)),n}function lt(t,e,i,n,r){var o=null;return(i[0]>n[2]||n[0]>i[2]||i[1]>n[3]||n[1]>i[3])&&(r===h?o=st:r===d?o=t:r!==c&&r!==f||(o=t.concat(e))),o}function ut(t,e,i){"number"==typeof t[0][0][0]&&(t=[t]),"number"==typeof e[0][0][0]&&(e=[e]);var n=at(t,e,i);if(n)return n===st?null:n;var r=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],s=ot(t,e,r,o,i);if(n=lt(t,e,r,o,i))return n===st?null:n;for(var a=H(q(s,t,e,r,o,i)),l=[],u=0;u<a.length;u++){var h=a[u];if(h.isExterior()){for(var c=[h.points],d=0;d<h.holeIds.length;d++){var f=h.holeIds[d];c.push(a[f].points)}l.push(c)}}return l}function ht(t,e){return ut(t,e,c)}function ct(t,e){return ut(t,e,d)}function dt(t,e){return ut(t,e,f)}function ft(t,e){return ut(t,e,h)}var pt={UNION:c,DIFFERENCE:d,INTERSECTION:h,XOR:f};t.diff=ct,t.intersection=ft,t.operations=pt,t.union=ht,t.xor=dt,Object.defineProperty(t,"__esModule",{value:!0})}(e)},798:()=>{},244:t=>{"use strict";var e=function(t){return t!=t};t.exports=function(t,i){return 0===t&&0===i?1/t==1/i:t===i||!(!e(t)||!e(i))}},609:(t,e,i)=>{"use strict";var n=i(289),r=i(559),o=i(244),s=i(624),a=i(281),l=r(s(),Object);n(l,{getPolyfill:s,implementation:o,shim:a}),t.exports=l},624:(t,e,i)=>{"use strict";var n=i(244);t.exports=function(){return"function"==typeof Object.is?Object.is:n}},281:(t,e,i)=>{"use strict";var n=i(624),r=i(289);t.exports=function(){var t=n();return r(Object,{is:t},{is:function(){return Object.is!==t}}),t}},987:(t,e,i)=>{"use strict";var n;if(!Object.keys){var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,s=i(414),a=Object.prototype.propertyIsEnumerable,l=!a.call({toString:null},"toString"),u=a.call((function(){}),"prototype"),h=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=function(t){var e=t.constructor;return e&&e.prototype===t},d={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!d["$"+t]&&r.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{c(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();n=function(t){var e=null!==t&&"object"==typeof t,i="[object Function]"===o.call(t),n=s(t),a=e&&"[object String]"===o.call(t),d=[];if(!e&&!i&&!n)throw new TypeError("Object.keys called on a non-object");var p=u&&i;if(a&&t.length>0&&!r.call(t,0))for(var g=0;g<t.length;++g)d.push(String(g));if(n&&t.length>0)for(var m=0;m<t.length;++m)d.push(String(m));else for(var v in t)p&&"prototype"===v||!r.call(t,v)||d.push(String(v));if(l)for(var y=function(t){if("undefined"==typeof window||!f)return c(t);try{return c(t)}catch(t){return!1}}(t),_=0;_<h.length;++_)y&&"constructor"===h[_]||!r.call(t,h[_])||d.push(h[_]);return d}}t.exports=n},215:(t,e,i)=>{"use strict";var n=Array.prototype.slice,r=i(414),o=Object.keys,s=o?function(t){return o(t)}:i(987),a=Object.keys;s.shim=function(){Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return r(t)?a(n.call(t)):a(t)}):Object.keys=s;return Object.keys||s},t.exports=s},414:t=>{"use strict";var e=Object.prototype.toString;t.exports=function(t){var i=e.call(t),n="[object Arguments]"===i;return n||(n="[object Array]"!==i&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===e.call(t.callee)),n}},676:function(t,e,i){var n=i(155);t.exports=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}var r=function(){function t(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null}return t}();function o(t,e){return t>e?1:t<e?-1:0}function s(t,e,i){for(var n=new r(null,null),o=n,s=n;;){var a=i(t,e.key);if(a<0){if(null===e.left)break;if(i(t,e.left.key)<0){var l=e.left;if(e.left=l.right,l.right=e,null===(e=l).left)break}s.left=e,s=e,e=e.left}else{if(!(a>0))break;if(null===e.right)break;if(i(t,e.right.key)>0&&(l=e.right,e.right=l.left,l.left=e,null===(e=l).right))break;o.right=e,o=e,e=e.right}}return o.right=e.left,s.left=e.right,e.left=n.right,e.right=n.left,e}function a(t,e,i,n){var o=new r(t,e);if(null===i)return o.left=o.right=null,o;var a=n(t,(i=s(t,i,n)).key);return a<0?(o.left=i.left,o.right=i,i.left=null):a>=0&&(o.right=i.right,o.left=i,i.right=null),o}function l(t,e,i){var n=null,r=null;if(e){var o=i((e=s(t,e,i)).key,t);0===o?(n=e.left,r=e.right):o<0?(r=e.right,e.right=null,n=e):(n=e.left,e.left=null,r=e)}return{left:n,right:r}}function u(t,e,i){return null===e?t:(null===t||((e=s(t.key,e,i)).left=t),e)}function h(t,e,i,n,r){if(t){n(e+(i?"└── ":"├── ")+r(t)+"\n");var o=e+(i?"    ":"│   ");t.left&&h(t.left,o,!1,n,r),t.right&&h(t.right,o,!0,n,r)}}var c=function(){function t(t){void 0===t&&(t=o),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=a(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var i=new r(t,e);null===this._root&&(i.left=i.right=null,this._size++,this._root=i);var n=this._comparator,o=s(t,this._root,n),a=n(t,o.key);return 0===a?this._root=o:(a<0?(i.left=o.left,i.right=o,o.left=null):a>0&&(i.right=o.right,i.left=o,o.right=null),this._size++,this._root=i),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,i){var n;return null===e?null:0===i(t,(e=s(t,e,i)).key)?(null===e.left?n=e.right:(n=s(t,e.left,i)).right=e.right,this._size--,n):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=s(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,i=this._comparator;e;){var n=i(t,e.key);if(0===n)return e;e=n<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=s(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,i=this._comparator;e;){var n=i(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var i=this._root,n=[],r=!1;!r;)null!==i?(n.push(i),i=i.left):0!==n.length?(i=n.pop(),t.call(e,i),i=i.right):r=!0;return this},t.prototype.range=function(t,e,i,n){for(var r=[],o=this._comparator,s=this._root;0!==r.length||s;)if(s)r.push(s),s=s.left;else{if(o((s=r.pop()).key,e)>0)break;if(o(s.key,t)>=0&&i.call(n,s))return this;s=s.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var i=e.key;return t.push(i)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var i=e.data;return t.push(i)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,i=!1,n=0,r=[];!i;)if(e)r.push(e),e=e.left;else if(r.length>0){if(e=r.pop(),n===t)return e;n++,e=e.right}else i=!0;return null},t.prototype.next=function(t){var e=this._root,i=null;if(t.right){for(i=t.right;i.left;)i=i.left;return i}for(var n=this._comparator;e;){var r=n(t.key,e.key);if(0===r)break;r<0?(i=e,e=e.left):e=e.right}return i},t.prototype.prev=function(t){var e=this._root,i=null;if(null!==t.left){for(i=t.left;i.right;)i=i.right;return i}for(var n=this._comparator;e;){var r=n(t.key,e.key);if(0===r)break;r<0?e=e.left:(i=e,e=e.right)}return i},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return p(this._root)},t.prototype.load=function(t,e,i){void 0===e&&(e=[]),void 0===i&&(i=!1);var n=t.length,r=this._comparator;if(i&&v(t,e,0,n-1,r),null===this._root)this._root=d(t,e,0,n),this._size=n;else{var o=m(this.toList(),f(t,e),r);n=this._size+n,this._root=g({head:o},0,n)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return h(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,i){var n=this._comparator,r=l(t,this._root,n),o=r.left,s=r.right;n(t,e)<0?s=a(e,i,s,n):o=a(e,i,o,n),this._root=u(o,s,n)},t.prototype.split=function(t){return l(t,this._root,this._comparator)},t}();function d(t,e,i,n){var o=n-i;if(o>0){var s=i+Math.floor(o/2),a=t[s],l=e[s],u=new r(a,l);return u.left=d(t,e,i,s),u.right=d(t,e,s+1,n),u}return null}function f(t,e){for(var i=new r(null,null),n=i,o=0;o<t.length;o++)n=n.next=new r(t[o],e[o]);return n.next=null,i.next}function p(t){for(var e=t,i=[],n=!1,o=new r(null,null),s=o;!n;)e?(i.push(e),e=e.left):i.length>0?e=(e=s=s.next=i.pop()).right:n=!0;return s.next=null,o.next}function g(t,e,i){var n=i-e;if(n>0){var r=e+Math.floor(n/2),o=g(t,e,r),s=t.head;return s.left=o,t.head=t.head.next,s.right=g(t,r+1,i),s}return null}function m(t,e,i){for(var n=new r(null,null),o=n,s=t,a=e;null!==s&&null!==a;)i(s.key,a.key)<0?(o.next=s,s=s.next):(o.next=a,a=a.next),o=o.next;return null!==s?o.next=s:null!==a&&(o.next=a),n.next}function v(t,e,i,n,r){if(!(i>=n)){for(var o=t[i+n>>1],s=i-1,a=n+1;;){do{s++}while(r(t[s],o)<0);do{a--}while(r(t[a],o)>0);if(s>=a)break;var l=t[s];t[s]=t[a],t[a]=l,l=e[s],e[s]=e[a],e[a]=l}v(t,e,i,a,r),v(t,e,a+1,n,r)}}var y=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},_=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var i=t.ll.x<e.ll.x?e.ll.x:t.ll.x,n=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:i,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:n,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},b=Number.EPSILON;void 0===b&&(b=Math.pow(2,-52));var w=b*b,x=function(t,e){if(-b<t&&t<b&&-b<e&&e<b)return 0;var i=t-e;return i*i<w*t*e?0:t<e?-1:1},S=function(){function e(){t(this,e),this.reset()}return i(e,[{key:"reset",value:function(){this.xRounder=new C,this.yRounder=new C}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),e}(),C=function(){function e(){t(this,e),this.tree=new c,this.round(0)}return i(e,[{key:"round",value:function(t){var e=this.tree.add(t),i=this.tree.prev(e);if(null!==i&&0===x(e.key,i.key))return this.tree.remove(t),i.key;var n=this.tree.next(e);return null!==n&&0===x(e.key,n.key)?(this.tree.remove(t),n.key):t}}]),e}(),T=new S,E=function(t,e){return t.x*e.y-t.y*e.x},I=function(t,e){return t.x*e.x+t.y*e.y},A=function(t,e,i){var n={x:e.x-t.x,y:e.y-t.y},r={x:i.x-t.x,y:i.y-t.y},o=E(n,r);return x(o,0)},P=function(t){return Math.sqrt(I(t,t))},k=function(t,e,i){var n={x:e.x-t.x,y:e.y-t.y},r={x:i.x-t.x,y:i.y-t.y};return E(r,n)/P(r)/P(n)},R=function(t,e,i){var n={x:e.x-t.x,y:e.y-t.y},r={x:i.x-t.x,y:i.y-t.y};return I(r,n)/P(r)/P(n)},L=function(t,e,i){return 0===e.y?null:{x:t.x+e.x/e.y*(i-t.y),y:i}},F=function(t,e,i){return 0===e.x?null:{x:i,y:t.y+e.y/e.x*(i-t.x)}},M=function(t,e,i,n){if(0===e.x)return F(i,n,t.x);if(0===n.x)return F(t,e,i.x);if(0===e.y)return L(i,n,t.y);if(0===n.y)return L(t,e,i.y);var r=E(e,n);if(0==r)return null;var o={x:i.x-t.x,y:i.y-t.y},s=E(o,e)/r,a=E(o,n)/r;return{x:(t.x+a*e.x+(i.x+s*n.x))/2,y:(t.y+a*e.y+(i.y+s*n.y))/2}},O=function(){function e(i,n){t(this,e),void 0===i.events?i.events=[this]:i.events.push(this),this.point=i,this.isLeft=n}return i(e,null,[{key:"compare",value:function(t,i){var n=e.comparePoints(t.point,i.point);return 0!==n?n:(t.point!==i.point&&t.link(i),t.isLeft!==i.isLeft?t.isLeft?1:-1:D.compare(t.segment,i.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),i(e,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,i=0,n=e.length;i<n;i++){var r=e[i];this.point.events.push(r),r.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var i=this.point.events[e];if(void 0===i.segment.consumedBy)for(var n=e+1;n<t;n++){var r=this.point.events[n];void 0===r.consumedBy&&i.otherSE.point.events===r.otherSE.point.events&&i.segment.consume(r.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,i=this.point.events.length;e<i;e++){var n=this.point.events[e];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&t.push(n)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,i=new Map,n=function(n){var r=n.otherSE;i.set(n,{sine:k(e.point,t.point,r.point),cosine:R(e.point,t.point,r.point)})};return function(t,e){i.has(t)||n(t),i.has(e)||n(e);var r=i.get(t),o=r.sine,s=r.cosine,a=i.get(e),l=a.sine,u=a.cosine;return o>=0&&l>=0?s<u?1:s>u?-1:0:o<0&&l<0?s<u?-1:s>u?1:0:l<o?-1:l>o?1:0}}}]),e}(),$=0,D=function(){function e(i,n,r,o){t(this,e),this.id=++$,this.leftSE=i,i.segment=this,i.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=i,this.rings=r,this.windings=o}return i(e,null,[{key:"compare",value:function(t,e){var i=t.leftSE.point.x,n=e.leftSE.point.x,r=t.rightSE.point.x,o=e.rightSE.point.x;if(o<i)return 1;if(r<n)return-1;var s=t.leftSE.point.y,a=e.leftSE.point.y,l=t.rightSE.point.y,u=e.rightSE.point.y;if(i<n){if(a<s&&a<l)return 1;if(a>s&&a>l)return-1;var h=t.comparePoint(e.leftSE.point);if(h<0)return 1;if(h>0)return-1;var c=e.comparePoint(t.rightSE.point);return 0!==c?c:-1}if(i>n){if(s<a&&s<u)return-1;if(s>a&&s>u)return 1;var d=e.comparePoint(t.leftSE.point);if(0!==d)return d;var f=t.comparePoint(e.rightSE.point);return f<0?1:f>0?-1:1}if(s<a)return-1;if(s>a)return 1;if(r<o){var p=e.comparePoint(t.rightSE.point);if(0!==p)return p}if(r>o){var g=t.comparePoint(e.rightSE.point);if(g<0)return 1;if(g>0)return-1}if(r!==o){var m=l-s,v=r-i,y=u-a,_=o-n;if(m>v&&y<_)return 1;if(m<v&&y>_)return-1}return r>o?1:r<o||l<u?-1:l>u?1:t.id<e.id?-1:t.id>e.id?1:0}}]),i(e,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,i=this.rightSE.point,n=this.vector();if(e.x===i.x)return t.x===e.x?0:t.x<e.x?1:-1;var r=(t.y-e.y)/n.y,o=e.x+r*n.x;if(t.x===o)return 0;var s=(t.x-e.x)/n.x,a=e.y+s*n.y;return t.y===a?0:t.y<a?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),i=t.bbox(),n=_(e,i);if(null===n)return null;var r=this.leftSE.point,o=this.rightSE.point,s=t.leftSE.point,a=t.rightSE.point,l=y(e,s)&&0===this.comparePoint(s),u=y(i,r)&&0===t.comparePoint(r),h=y(e,a)&&0===this.comparePoint(a),c=y(i,o)&&0===t.comparePoint(o);if(u&&l)return c&&!h?o:!c&&h?a:null;if(u)return h&&r.x===a.x&&r.y===a.y?null:r;if(l)return c&&o.x===s.x&&o.y===s.y?null:s;if(c&&h)return null;if(c)return o;if(h)return a;var d=M(r,this.vector(),s,t.vector());return null===d?null:y(n,d)?T.round(d.x,d.y):null}},{key:"split",value:function(t){var i=[],n=void 0!==t.events,r=new O(t,!0),o=new O(t,!1),s=this.rightSE;this.replaceRightSE(o),i.push(o),i.push(r);var a=new e(r,s,this.rings.slice(),this.windings.slice());return O.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),O.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(r.checkForConsuming(),o.checkForConsuming()),i}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,i=this.windings.length;e<i;e++)this.windings[e]*=-1}},{key:"consume",value:function(t){for(var i=this,n=t;i.consumedBy;)i=i.consumedBy;for(;n.consumedBy;)n=n.consumedBy;var r=e.compare(i,n);if(0!==r){if(r>0){var o=i;i=n,n=o}if(i.prev===n){var s=i;i=n,n=s}for(var a=0,l=n.rings.length;a<l;a++){var u=n.rings[a],h=n.windings[a],c=i.rings.indexOf(u);-1===c?(i.rings.push(u),i.windings.push(h)):i.windings[c]+=h}n.rings=null,n.windings=null,n.consumedBy=i,n.leftSE.consumedBy=i.leftSE,n.rightSE.consumedBy=i.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,i=this._afterState.windings,n=this._afterState.multiPolys,r=0,o=this.rings.length;r<o;r++){var s=this.rings[r],a=this.windings[r],l=e.indexOf(s);-1===l?(e.push(s),i.push(a)):i[l]+=a}for(var u=[],h=[],c=0,d=e.length;c<d;c++)if(0!==i[c]){var f=e[c],p=f.poly;if(-1===h.indexOf(p))if(f.isExterior)u.push(p);else{-1===h.indexOf(p)&&h.push(p);var g=u.indexOf(f.poly);-1!==g&&u.splice(g,1)}}for(var m=0,v=u.length;m<v;m++){var y=u[m].multiPoly;-1===n.indexOf(y)&&n.push(y)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(K.type){case"union":var i=0===t.length,n=0===e.length;this._isInResult=i!==n;break;case"intersection":var r,o;t.length<e.length?(r=t.length,o=e.length):(r=e.length,o=t.length),this._isInResult=o===K.numMultiPolys&&r<o;break;case"xor":var s=Math.abs(t.length-e.length);this._isInResult=s%2==1;break;case"difference":var a=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=a(t)!==a(e);break;default:throw new Error("Unrecognized operation type found ".concat(K.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,i,n){var r,o,s,a=O.comparePoints(t,i);if(a<0)r=t,o=i,s=1;else{if(!(a>0))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));r=i,o=t,s=-1}return new e(new O(r,!0),new O(o,!1),[n],[s])}}]),e}(),j=function(){function e(i,n,r){if(t(this,e),!Array.isArray(i)||0===i.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=r,this.segments=[],"number"!=typeof i[0][0]||"number"!=typeof i[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var o=T.round(i[0][0],i[0][1]);this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};for(var s=o,a=1,l=i.length;a<l;a++){if("number"!=typeof i[a][0]||"number"!=typeof i[a][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var u=T.round(i[a][0],i[a][1]);u.x===s.x&&u.y===s.y||(this.segments.push(D.fromRing(s,u,this)),u.x<this.bbox.ll.x&&(this.bbox.ll.x=u.x),u.y<this.bbox.ll.y&&(this.bbox.ll.y=u.y),u.x>this.bbox.ur.x&&(this.bbox.ur.x=u.x),u.y>this.bbox.ur.y&&(this.bbox.ur.y=u.y),s=u)}o.x===s.x&&o.y===s.y||this.segments.push(D.fromRing(s,o,this))}return i(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,i=this.segments.length;e<i;e++){var n=this.segments[e];t.push(n.leftSE),t.push(n.rightSE)}return t}}]),e}(),N=function(){function e(i,n){if(t(this,e),!Array.isArray(i))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new j(i[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var r=1,o=i.length;r<o;r++){var s=new j(i[r],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=n}return i(e,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,i=this.interiorRings.length;e<i;e++)for(var n=this.interiorRings[e].getSweepEvents(),r=0,o=n.length;r<o;r++)t.push(n[r]);return t}}]),e}(),B=function(){function e(i,n){if(t(this,e),!Array.isArray(i))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof i[0][0][0]&&(i=[i])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var r=0,o=i.length;r<o;r++){var s=new N(i[r],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=n}return i(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,i=this.polys.length;e<i;e++)for(var n=this.polys[e].getSweepEvents(),r=0,o=n.length;r<o;r++)t.push(n[r]);return t}}]),e}(),U=function(){function e(i){t(this,e),this.events=i;for(var n=0,r=i.length;n<r;n++)i[n].segment.ringOut=this;this.poly=null}return i(e,null,[{key:"factory",value:function(t){for(var i=[],n=0,r=t.length;n<r;n++){var o=t[n];if(o.isInResult()&&!o.ringOut){for(var s=null,a=o.leftSE,l=o.rightSE,u=[a],h=a.point,c=[];s=a,a=l,u.push(a),a.point!==h;)for(;;){var d=a.getAvailableLinkedEvents();if(0===d.length){var f=u[0].point,p=u[u.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(f.x,",")+" ".concat(f.y,"]. Last matching segment found ends at")+" [".concat(p.x,", ").concat(p.y,"]."))}if(1===d.length){l=d[0].otherSE;break}for(var g=null,m=0,v=c.length;m<v;m++)if(c[m].point===a.point){g=m;break}if(null===g){c.push({index:u.length,point:a.point});var y=a.getLeftmostComparator(s);l=d.sort(y)[0].otherSE;break}var _=c.splice(g)[0],b=u.splice(_.index);b.unshift(b[0].otherSE),i.push(new e(b.reverse()))}i.push(new e(u))}}return i}}]),i(e,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],i=1,n=this.events.length-1;i<n;i++){var r=this.events[i].point,o=this.events[i+1].point;0!==A(r,t,o)&&(e.push(r),t=r)}if(1===e.length)return null;var s=e[0],a=e[1];0===A(s,t,a)&&e.shift(),e.push(e[0]);for(var l=this.isExteriorRing()?1:-1,u=this.isExteriorRing()?0:e.length-1,h=this.isExteriorRing()?e.length:-1,c=[],d=u;d!=h;d+=l)c.push([e[d].x,e[d].y]);return c}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,i=this.events.length;e<i;e++){var n=this.events[e];O.compare(t,n)>0&&(t=n)}for(var r=t.segment.prevInResult(),o=r?r.prevInResult():null;;){if(!r)return null;if(!o)return r.ringOut;if(o.ringOut!==r.ringOut)return o.ringOut.enclosingRing()!==r.ringOut?r.ringOut:r.ringOut.enclosingRing();r=o.prevInResult(),o=r?r.prevInResult():null}}}]),e}(),z=function(){function e(i){t(this,e),this.exteriorRing=i,i.poly=this,this.interiorRings=[]}return i(e,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,i=this.interiorRings.length;e<i;e++){var n=this.interiorRings[e].getGeom();null!==n&&t.push(n)}return t}}]),e}(),V=function(){function e(i){t(this,e),this.rings=i,this.polys=this._composePolys(i)}return i(e,[{key:"getGeom",value:function(){for(var t=[],e=0,i=this.polys.length;e<i;e++){var n=this.polys[e].getGeom();null!==n&&t.push(n)}return t}},{key:"_composePolys",value:function(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i];if(!r.poly)if(r.isExteriorRing())e.push(new z(r));else{var o=r.enclosingRing();o.poly||e.push(new z(o)),o.poly.addInterior(r)}}return e}}]),e}(),G=function(){function e(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:D.compare;t(this,e),this.queue=i,this.tree=new c(n),this.segments=[]}return i(e,[{key:"process",value:function(t){var e=t.segment,i=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),i;var n=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!n)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var r=n,o=n,s=void 0,a=void 0;void 0===s;)null===(r=this.tree.prev(r))?s=null:void 0===r.key.consumedBy&&(s=r.key);for(;void 0===a;)null===(o=this.tree.next(o))?a=null:void 0===o.key.consumedBy&&(a=o.key);if(t.isLeft){var l=null;if(s){var u=s.getIntersection(e);if(null!==u&&(e.isAnEndpoint(u)||(l=u),!s.isAnEndpoint(u)))for(var h=this._splitSafely(s,u),c=0,d=h.length;c<d;c++)i.push(h[c])}var f=null;if(a){var p=a.getIntersection(e);if(null!==p&&(e.isAnEndpoint(p)||(f=p),!a.isAnEndpoint(p)))for(var g=this._splitSafely(a,p),m=0,v=g.length;m<v;m++)i.push(g[m])}if(null!==l||null!==f){var y=null;y=null===l?f:null===f||O.comparePoints(l,f)<=0?l:f,this.queue.remove(e.rightSE),i.push(e.rightSE);for(var _=e.split(y),b=0,w=_.length;b<w;b++)i.push(_[b])}i.length>0?(this.tree.remove(e),i.push(t)):(this.segments.push(e),e.prev=s)}else{if(s&&a){var x=s.getIntersection(a);if(null!==x){if(!s.isAnEndpoint(x))for(var S=this._splitSafely(s,x),C=0,T=S.length;C<T;C++)i.push(S[C]);if(!a.isAnEndpoint(x))for(var E=this._splitSafely(a,x),I=0,A=E.length;I<A;I++)i.push(E[I])}}this.tree.remove(e)}return i}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var i=t.rightSE;this.queue.remove(i);var n=t.split(e);return n.push(i),void 0===t.consumedBy&&this.tree.insert(t),n}}]),e}(),q=void 0!==n&&n.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,W=void 0!==n&&n.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,K=new(function(){function e(){t(this,e)}return i(e,[{key:"run",value:function(t,e,i){K.type=t,T.reset();for(var n=[new B(e,!0)],r=0,o=i.length;r<o;r++)n.push(new B(i[r],!1));if(K.numMultiPolys=n.length,"difference"===K.type)for(var s=n[0],a=1;a<n.length;)null!==_(n[a].bbox,s.bbox)?a++:n.splice(a,1);if("intersection"===K.type)for(var l=0,u=n.length;l<u;l++)for(var h=n[l],d=l+1,f=n.length;d<f;d++)if(null===_(h.bbox,n[d].bbox))return[];for(var p=new c(O.compare),g=0,m=n.length;g<m;g++)for(var v=n[g].getSweepEvents(),y=0,b=v.length;y<b;y++)if(p.insert(v[y]),p.size>q)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var w=new G(p),x=p.size,S=p.pop();S;){var C=S.key;if(p.size===x){var E=C.segment;throw new Error("Unable to pop() ".concat(C.isLeft?"left":"right"," SweepEvent ")+"[".concat(C.point.x,", ").concat(C.point.y,"] from segment #").concat(E.id," ")+"[".concat(E.leftSE.point.x,", ").concat(E.leftSE.point.y,"] -> ")+"[".concat(E.rightSE.point.x,", ").concat(E.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(p.size>q)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(w.segments.length>W)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var I=w.process(C),A=0,P=I.length;A<P;A++){var k=I[A];void 0===k.consumedBy&&p.insert(k)}x=p.size,S=p.pop()}T.reset();var R=U.factory(w.segments);return new V(R).getGeom()}}]),e}());return{union:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return K.run("union",t,i)},intersection:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return K.run("intersection",t,i)},xor:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return K.run("xor",t,i)},difference:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return K.run("difference",t,i)}}}()},155:t=>{var e,i,n=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===r||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(i){try{return e.call(null,t,0)}catch(i){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:r}catch(t){e=r}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var a,l=[],u=!1,h=-1;function c(){u&&a&&(u=!1,a.length?l=a.concat(l):h=-1,l.length&&d())}function d(){if(!u){var t=s(c);u=!0;for(var e=l.length;e;){for(a=l,l=[];++h<e;)a&&a[h].run();h=-1,e=l.length}a=null,u=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];l.push(new f(t,e)),1!==l.length||u||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},166:function(t){t.exports=function(){"use strict";function t(t,i,r,o,s){e(t,i,r||0,o||t.length-1,s||n)}function e(t,n,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,l=n-r+1,u=Math.log(a),h=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*h*(a-h)/a)*(l-a/2<0?-1:1);e(t,n,Math.max(r,Math.floor(n-l*h/a+c)),Math.min(o,Math.floor(n+(a-l)*h/a+c)),s)}var d=t[n],f=r,p=o;for(i(t,r,n),s(t[o],d)>0&&i(t,r,o);f<p;){for(i(t,f,p),f++,p--;s(t[f],d)<0;)f++;for(;s(t[p],d)>0;)p--}0===s(t[r],d)?i(t,r,p):i(t,++p,o),p<=n&&(r=p+1),n<=p&&(o=p-1)}}function i(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function n(t,e){return t<e?-1:t>e?1:0}return t}()},510:(t,e,i)=>{"use strict";t.exports=r,t.exports.default=r;var n=i(166);function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,i,n,r){r||(r=g(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<i;s++)o=t.children[s],l(r,t.leaf?n(o):o);return r}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(t,e,i,r,o){for(var s,a=[e,i];a.length;)(i=a.pop())-(e=a.pop())<=r||(s=e+Math.ceil((i-e)/r/2)*r,n(t,s,e,i,o),a.push(e,s,s,i))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!p(t,e))return i;for(var r,o,s,a,l=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],p(t,a=e.leaf?n(s):s)&&(e.leaf?i.push(s):f(t,a)?this._all(s,i):l.push(s));e=l.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!p(t,e))return!1;for(var n,r,o,s,a=[];e;){for(n=0,r=e.children.length;n<r;n++)if(o=e.children[n],p(t,s=e.leaf?i(o):o)){if(e.leaf||f(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=g([]),this},remove:function(t,e){if(!t)return this;for(var i,n,r,s,a=this.data,l=this.toBBox(t),u=[],h=[];a||u.length;){if(a||(a=u.pop(),n=u[u.length-1],i=h.pop(),s=!0),a.leaf&&-1!==(r=o(t,a.children,e)))return a.children.splice(r,1),u.push(a),this._condense(u),this;s||a.leaf||!f(a,l)?n?(i++,a=n.children[i],s=!1):a=null:(u.push(a),h.push(i),i=0,n=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:u,compareMinY:h,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var r,o=i-e+1,a=this._maxEntries;if(o<=a)return s(r=g(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(r=g([])).leaf=!1,r.height=n;var l,u,h,c,d=Math.ceil(o/a),f=d*Math.ceil(Math.sqrt(a));for(m(t,e,i,f,this.compareMinX),l=e;l<=i;l+=f)for(m(t,l,h=Math.min(l+f-1,i),d,this.compareMinY),u=l;u<=h;u+=d)c=Math.min(u+d-1,h),r.children.push(this._build(t,u,c,n-1));return s(r,this.toBBox),r},_chooseSubtree:function(t,e,i,n){for(var r,o,s,a,l,u,h,d,f,p;n.push(e),!e.leaf&&n.length-1!==i;){for(h=d=1/0,r=0,o=e.children.length;r<o;r++)l=c(s=e.children[r]),f=t,p=s,(u=(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-l)<d?(d=u,h=l<h?l:h,a=s):u===d&&l<h&&(h=l,a=s);e=a||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t:n(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),l(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var o=this._chooseSplitIndex(i,r,n),a=g(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,s(i,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},_splitRoot:function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,r,o,s,l,u,h,d,f,p,g,m,v,y;for(u=h=1/0,n=e;n<=i-e;n++)r=a(t,0,n,this.toBBox),o=a(t,n,i,this.toBBox),f=r,p=o,g=void 0,m=void 0,v=void 0,y=void 0,g=Math.max(f.minX,p.minX),m=Math.max(f.minY,p.minY),v=Math.min(f.maxX,p.maxX),y=Math.min(f.maxY,p.maxY),s=Math.max(0,v-g)*Math.max(0,y-m),l=c(r)+c(o),s<u?(u=s,d=n,h=l<h?l:h):s===u&&l<h&&(h=l,d=n);return d},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:u,r=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var r,o,s=this.toBBox,u=a(t,0,e,s),h=a(t,i-e,i,s),c=d(u)+d(h);for(r=e;r<i-e;r++)o=t.children[r],l(u,t.leaf?s(o):o),c+=d(u);for(r=i-e-1;r>=e;r--)o=t.children[r],l(h,t.leaf?s(o):o),c+=d(h);return c},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)l(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():s(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},697:t=>{"use strict";var e=Object,i=TypeError;t.exports=function(){if(null!=this&&this!==e(this))throw new i("RegExp.prototype.flags getter called on non-object");var t="";return this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.sticky&&(t+="y"),t}},847:(t,e,i)=>{"use strict";var n=i(289),r=i(559),o=i(697),s=i(721),a=i(753),l=r(o);n(l,{getPolyfill:s,implementation:o,shim:a}),t.exports=l},721:(t,e,i)=>{"use strict";var n=i(697),r=i(289).supportsDescriptors,o=Object.getOwnPropertyDescriptor,s=TypeError;t.exports=function(){if(!r)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");if("gim"===/a/gim.flags){var t=o(RegExp.prototype,"flags");if(t&&"function"==typeof t.get&&"boolean"==typeof/a/.dotAll)return t.get}return n}},753:(t,e,i)=>{"use strict";var n=i(289).supportsDescriptors,r=i(721),o=Object.getOwnPropertyDescriptor,s=Object.defineProperty,a=TypeError,l=Object.getPrototypeOf,u=/a/;t.exports=function(){if(!n||!l)throw new a("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=r(),e=l(u),i=o(e,"flags");return i&&i.get===t||s(e,"flags",{configurable:!0,enumerable:!1,get:t}),t}},379:(t,e,i)=>{"use strict";var n,r=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},o=function(){var t={};return function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[e]=i}return t[e]}}(),s=[];function a(t){for(var e=-1,i=0;i<s.length;i++)if(s[i].identifier===t){e=i;break}return e}function l(t,e){for(var i={},n=[],r=0;r<t.length;r++){var o=t[r],l=e.base?o[0]+e.base:o[0],u=i[l]||0,h="".concat(l," ").concat(u);i[l]=u+1;var c=a(h),d={css:o[1],media:o[2],sourceMap:o[3]};-1!==c?(s[c].references++,s[c].updater(d)):s.push({identifier:h,updater:m(d,e),references:1}),n.push(h)}return n}function u(t){var e=document.createElement("style"),n=t.attributes||{};if(void 0===n.nonce){var r=i.nc;r&&(n.nonce=r)}if(Object.keys(n).forEach((function(t){e.setAttribute(t,n[t])})),"function"==typeof t.insert)t.insert(e);else{var s=o(t.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}return e}var h,c=(h=[],function(t,e){return h[t]=e,h.filter(Boolean).join("\n")});function d(t,e,i,n){var r=i?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(t.styleSheet)t.styleSheet.cssText=c(e,r);else{var o=document.createTextNode(r),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function f(t,e,i){var n=i.css,r=i.media,o=i.sourceMap;if(r?t.setAttribute("media",r):t.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var p=null,g=0;function m(t,e){var i,n,r;if(e.singleton){var o=g++;i=p||(p=u(e)),n=d.bind(null,i,o,!1),r=d.bind(null,i,o,!0)}else i=u(e),n=f.bind(null,i,e),r=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else r()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=r());var i=l(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var n=0;n<i.length;n++){var r=a(i[n]);s[r].references--}for(var o=l(t,e),u=0;u<i.length;u++){var h=a(i[u]);0===s[h].references&&(s[h].updater(),s.splice(h,1))}i=o}}}},608:()=>{}},i={};function n(t){var r=i[t];if(void 0!==r)return r.exports;var o=i[t]={id:t,loaded:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,t=[],n.O=(e,i,r,o)=>{if(!i){var s=1/0;for(u=0;u<t.length;u++){for(var[i,r,o]=t[u],a=!0,l=0;l<i.length;l++)(!1&o||s>=o)&&Object.keys(n.O).every((t=>n.O[t](i[l])))?i.splice(l--,1):(a=!1,o<s&&(s=o));a&&(t.splice(u--,1),e=r())}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[i,r,o]},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t={355:0,392:0};n.O.j=e=>0===t[e];var e=(e,i)=>{var r,o,[s,a,l]=i,u=0;for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(l)var h=l(n);for(e&&e(i);u<s.length;u++)o=s[u],n.o(t,o)&&t[o]&&t[o][0](),t[s[u]]=0;return n.O(h)},i=self.webpackChunk=self.webpackChunk||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})(),n.O(void 0,[392],(()=>n(282)));var r=n.O(void 0,[392],(()=>n(798)));r=n.O(r)})();